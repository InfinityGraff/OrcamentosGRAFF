<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Operador - Placar</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/CSSBiblioteca.css" rel="stylesheet">
    <script src="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/PreScript.js"      ></script>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <script> // Base de Dados
      const SUPABASE_URL      = "https://adxigvfxtafvlmpvwwvb.supabase.co"
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkeGlndmZ4dGFmdmxtcHZ3d3ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1Njc1NTEsImV4cCI6MjA2NzE0MzU1MX0.wc90qDuSNhtolJBd4qLEux3xCwJwPuTTFb3gZMKUBYU"
      const supabase          =  window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
      const BASE_URL          = `https://adxigvfxtafvlmpvwwvb.supabase.co/storage/v1/object/public/Jogo/Imgs`
    </script>
</head>

<style>
  *     {margin:0;padding:0;font-family:Montserrat,Arial}
  body  {background:#f0f2f5;color:#333;padding:20px}
  h1    {font-size:2.5rem;margin-bottom:30px;color:#636363 ; font-weight:700;font-family:Montserrat,Arial}
  .Times{display:flex ; align-items:start; gap:12px}

  label {display:block; font-weight:bold; margin-top:15px;}
  input,select             {width:200px; padding:10px; margin-top:5px; border-radius:8px; border:1px solid #ccc; font-size:1rem; transition:border 0.2s, box-shadow 0.2s; }
  input:focus,select:focus {border-color:#4a90e2; box-shadow:0 0 5px #4a90e280; outline:none}
  button      {padding:8px 10px;font-size:1.2rem; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:700;}
  
  .Drop       { border:2px dashed #a1c2d8; border-radius:10px; text-align:center; background:#ffffff1a; cursor:pointer; position:relative; overflow:hidden;   min-height:60px;min-width:200px}
  .Drop:hover { background:#63a6dd33}.Drop.hover { background:#63a6dd33}
  .Drop img   { width:auto ; height:80px; border-radius:10px; }

  .T_A,.T_B   {background:#fff;border-radius:12px;box-shadow:0 2px 10px #0000001a;padding:10px;width:50%;}

  .botoes{margin-top:20px; margin-bottom:20px; gap:5px; opacity:0.2}

  .headA,.headB{padding:30px; width:100%;}
  .headA > *,.headB >*{width:50%;}

  .C_Gol      {background:#28a745}.C_Amr      {background:#ffc107;color:#3d2d00}.C_Red      {background:#dc3545}.C_Flt,.C_Sub            {background:#6c757d}.Blu      {background:#357ABD}
  .C_Gol:hover{background:#218838}.C_Amr:hover{background:#e0ac00;color:#3d2d00}.C_Red:hover{background:#c82333}.C_Flt:hover,.C_Sub:hover{background:#5a6268}.Blu:hover{background:#2c639d}

  .Gols{font-size:80px;font-weight:900;color:#007bff;margin:6px 0;}
  .hist{width:100%;border-top:1px solid #ddd;margin-top:5px;padding-top:5px;font-size:13px;text-align:left;max-height:150px;overflow-y:auto;}

  .DivTime{gap: 7px}
  .DivStars{gap: 7px}
</style>

<script> // Biblioteca
  const Prvn2 = ev=>(ev||event).preventDefault()

  function PrepDrop(Eu,nome){
    Inn(Eu,'<a>Adicionar Imagem</a><input type="file" accept="image/*" class="none">')
    const f=$('input',Eu),d=$('a',Eu)

    const Enviar = async F=>{
      if (!F) return
      const ext  = F.name.split('.').pop()
      const Nome = `${nome}.${ext}`
      Inn(d, `<img src="${URL.createObjectURL(F)}?v=${Date.now()}"`)
      await UPPImg(F,`${Nome}`)
      Inn(d,`<img src="${BASE_URL}/${Nome}?v=${Date.now()}" name="${Nome}">`)
    }
    Eu.onclick   =()=> f.click(),f.onchange=e=>Enviar(e.target.files[0]),
    Eu.ondragover =e=>(Prvn2(e),Add(Eu,'hover')),
    Eu.ondragleave=_=> Rmv(Eu,'hover'),
    Eu.ondrop     =e=>(Prvn2(e),Rmv(Eu,'hover'),Enviar(e.dataTransfer.files[0]))
  }
</script>

<body class="Cl">
  <h1>Operador do Placar</h1>

  <div class="w100 Times">
    <div class="Cl T_A">
      <header class="headA Ct">
        <div class="Cl">
          <div class="Drop Ct" onload="PrepDrop(this,'Time_A')"></div>
          <label>Time A:</label><input class="Nome" placeholder="Nome do Time A...">
        </div>
        <div class="Gols">0</div>
      </header>
      <div class="botoes Ct" onload="LoadBtns('A',this)"></div>
      <div class="hist" id="histA"></div>
    </div>

    <div class="Cl T_B">
      <header class="headA Ct">
        <div class="Gols">0</div>
        <div class="Cl">
          <div class="Drop Ct" onload="PrepDrop(this,'Time_B')"></div>
          <label>Time B:</label><input class="Nome" placeholder="Nome do Time B...">
        </div>
      </header>
      <div class="botoes Ct" onload="LoadBtns('B',this)"></div>
      <div class="hist" id="histB"></div>
    </div>
  </div>

  <div class="Ct DivTime">
    <div class="Start2"><label>Tempo:  </label><select id="Tempo"></select><script>load_Opts($('#Tempo'),["1º Tempo","2º Tempo","Prorrogação","Acréscimos","Pênaltis","Encerrado"])</script></div>
    <div class="Start2"><label>Minutos:</label><input type="number"></div>
  </div>
  <div class="DivStars Ct">
    <button class="Blu"   onclick="Atualizar()" style="margin-top: 10px;">Configurar Jogo ✔️</button>
    <button class="C_Gol" onclick="Atualizar()" style="margin-top: 10px;">Iniciar Jogo</button>
    <button class="C_Amr" onclick="Atualizar()" style="margin-top: 10px;">Pausa</button>
  </div>
</body>

<script>
  let Placar = {A:0,B:0}

  function AGORAA(){return '15:57'}

  function LoadBtns(AB,Eu){
    const Typ=[{t:"Gol",l:"Gol"},{t:"Amr",l:"Amarelo"},{t:"Red",l:"Vermelho"},{t:"Flt",l:"Falta"},{t:"Sub",l:"Substituição"}]
    Inn(Eu,Typ.map(b=>`<button class="C_${b.t}" onclick="AddEvento('${AB}','${b.t}',this)">${b.l}</button>`).join(''))
  }

  async function Atualizar(){
    const obj = {
      Tim_A:  $Vl('.T_A .Nome'),
      Tim_B:  $Vl('.T_B .Nome'),
      Gol_A: +Inn('.T_A .Gols'),
      Gol_B: +Inn('.T_B .Gols'),
      Tempo:  $Vl('#Tempo'    ),
      Img_A:  Nm($('.T_A img')),
      Img_B:  Nm($('.T_B img')),
    }
    LOG(obj)
    const {error}=await supabase.from('placar').update(obj).eq('id',1)
    if(error){console.error(error)}
    else{alert('✅ Jogo Configurado!') ; $$('.botoes').forEach(e=>{Add($$('button',e),'Hov');e.style.opacity = 1 })}
    
  }

  function AddEvento(AB,Ev){
    $(`#hist${AB}`).innerHTML+=`<div>${AGORAA()} - ${Ev}</div>`
    if(Ev==='Gol'){Placar[AB]++;Inn($(`.T_${AB} .Gols`),Placar[AB])}
  }

  async function UPPImg(file,nome){
    const path = `Imgs/${nome}`
    const {error} = await supabase.storage.from('Jogo').upload(path,file,{upsert:true})
       if (error)  return alert('❌ Erro ao enviar imagem'),null
    return supabase.storage.from('Jogo').getPublicUrl(path).publicUrl
  }
  Onloads('body')
</script>
</html>
<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orcamento</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/CSSBiblioteca.css">
    <link rel="stylesheet" href="./cssGRAFF.css">
    <script                 src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/PreScript.js"></script>
    <script                 src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/Base.js"     ></script>
    <script                 src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/BaseGRAFF.js"></script>
    <script                 src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/Templates.js"></script>
    <script src="./Dados.js"></script>
</head>

<style> /*CSS Genérico*/
    .svg-Lixo {width:auto; height:100px; fill:#ffbb00}
    .ClntATV{background:#ff4500}
    p,div{cursor: default}
    #FormServ{width: 500px; background: #363636}
    .Trav{border:2px solid #ff7300}
    input[type="checkbox"]{height: auto;}
    select{background: #7e7e7e28 !important}
    .SelectSoma{background: red}
    .Ubuiaxik{width: 800px; height: 500px;}
    .Nuevoevo{color: white;background-color: #53004873;padding: 2px;}
    .R_Cor{background:#ff0000}.Tr-R_Cor{background:#ff000086}
    .G_Cor{background:#008000}.Tr-G_Cor{background:#1c9e1c85}
    .B_Cor{background:#0000ff}.Tr-B_Cor{background:#0000ff81}
    .SuggSelects   {background:#f357d1}
    .RecolorSelects{background:#f357d1}
    .THSugg p:hover{background:#f357d1}
    .THSugg{z-index: 500;}
    .Formt_Verd{background:rgba(95, 219, 95 );color:#274e24;font-weight:bold}
    .Formt_Azul{background:rgb(104, 180, 224);color:#131a5f;font-weight:bold}
    .Formt_Redd{background:rgb(224, 104, 104);color:#910000;font-weight:bold}


    .Dark optgroup{color:#ffffff3f;background:#3d3d3d;font-size: 10px; text-align: left;padding-left: 80px}
    .Dark option{color:white;background:#3d3d3d}
    .Lite optgroup{color:#00000038;background:white;  font-size: 10px; text-align: left;padding-left: 80px}
    .Lite option{color:black;background:white}
</style>

<script> // Base de Dados
    // const Abrev = {'Serv':'Serviço','Tipo':'Tipo','Cbmt':'Acabamento','Gram':'Gramatura','Otro':'Outros'} // OBSOLETO
    const D_brev={Tipo:'Tipo',Serv:'Serviço',Lrg:'Largura',Alt:'Altura',Cmp:'Comprimento',Cbmt:'Acabamento',Gram:'Gramatura',Qnt:'QNT',Und:'Valor UND',SbTt:'SubTotal'}
    function tmplt_Img(){return ''}

    const Prod = {
        Adesivo  :{Calc:'M2', Stts:'Disp', Prvw:'CanvMdd', Desc:'Adesivo Impresso'    ,Extra:{'Aplicação':10},Variantes:{
                Brilho        :{item:'1',Tipo:'',Valr:60 ,Cust:20},
                Fosco         :{item:'2',Tipo:'',Valr:60 ,Cust:20},
                Blackout      :{item:'3',Tipo:'',Valr:70 ,Cust:25},
                Transparente  :{item:'4',Tipo:'',Valr:70 ,Cust:25},
                Laminado      :{item:'6',Tipo:'',Valr:70 ,Cust:20},
                Espelhado     :{item:'7',Tipo:'',Valr:80 ,Cust:20},
                Perfurado     :{item:'5',Tipo:'',Valr:100,Cust:35},
            }},
        Etiqueta :{Calc:'M2', Stts:'Disp', Prvw:'CanvMdd', Desc:'Impressão + Recorte' ,Variantes:{
                'Refilada'        :{item:'6',Tipo:'',Valr:70,Cust:20},
                'Redonda'         :{item:'7',Tipo:'',Valr:75,Cust:30},
                'Personalizada'    :{item:'7',Tipo:'',Valr:80,Cust:30},
            }},
        Lona     :{Calc:'M2', Stts:'Disp', Prvw:''       , Desc:'Banner, Faixa, ilhós',Variantes:{
                'Banner'          :{item:'8' ,Tipo:''                              ,Valr:70,Cust:22}, // Adicionar dentro do option um botão pra medida padrão
                'Faixa'           :{item:'9' ,Tipo:['Só Madeira','Madeira e ilhós'],Valr:70,Cust:22}, // dar Limite pra Altura
                'com ilhós'       :{item:'11',Tipo:['Completo'  ,     'nas Pontas'],Valr:70,Cust:22},
                'Sem Acabamento'  :{item:'13',Tipo:''                              ,Valr:60,Cust:20},
        }},
        Quadro   :{Calc:'M2', Stts:'Disp', Prvw:'CanvMdd', Desc:'Quadro sem Moldura' ,Variantes:{ // dar Limite pra largura de todos
                'PVC 2mm'           :{item:'14',Tipo:'',Valr:150,Cust:'        '}, 
                'PVC 3mm'           :{item:'15',Tipo:'',Valr:170,Cust:43.00 + 20}, // Folha de PVC com (2,44 x 1,22) R$ 86,00
                'PVC 5mm'           :{item:'16',Tipo:'',Valr:' ',Cust:'        '},
                'PS 1mm '           :{item:'17',Tipo:'',Valr:100,Cust:21.25 + 20}, // Folha de PVC com (2,00 x 1,00) R$ 42,50
                'PS 2mm '           :{item:'18',Tipo:'',Valr:130,Cust:'        '},
            }},
        'ímã'    :{Calc:'M2', Stts:'Disp', Prvw:'CanvMdd', Desc:'Geladeira ou Carro' ,Variantes:{ // Adicional de Calendário (Acima de 500 UND) // Adicionar dentro do option um botão pra medida padrão // Adicionar Limite pra o ímã
                '0.3 - Geladeira'     :{item:'19',Tipo:'',Valr: 70.00+60,Cust:35.00}, // 0.3 - R$ 21,00 (0,60 x 1,00) || o Metro fica: 
                '0.4 - Geladeira'     :{item:'20',Tipo:'',Valr: 95.00+60,Cust:48.33}, // 0.4 - R$ 29,00 (0,60 x 1,00) || o Metro fica: 
                '0.8 - Carro    '     :{item:'21',Tipo:'',Valr:180.00+60,Cust:98.33}, // 0.8 - R$ 59,00 (0,60 x 1,00) || o Metro fica: 
            }},
        Recorte  :{Calc:'M2', Stts:'Offf', Prvw:'CanvMdd', Desc:'Adesivo Recortado'  ,Variantes:{
            Vinil        :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70 },
            Holografico  :{item:'23',Calc:'M2',Tipo:'',Valr:200,Valor:100},
        }},
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        'Cartão'   :{Calc:'OFS',Stts:'Disp', Prvw:''       , Desc:'Medida: 9cm x 5cn'  ,Variantes:{
                'Brilho'      :{Table:[
                    ['Frente' ,'250g',[['500', 90,31],['1.000',135,45]]],
                    ['F.Verso','250g',[['500',115,42],['1.000',150,54]]], 
                    ['Frente' ,'300g',[['500',130,49],['1.000',145,56]]], 
                    ['F.Verso','300g',[['500',150,58],['1.000',165,65]]], ]},
                'Brilho Local':{Table:[
                    ['Frente' ,'300g',[['500',155,62],['1.000',190,78]]],
                    ['F.Verso','300g',[['500',190,80],['1.000',230,99]]], ]},
            }},
        'Panfleto' :{Calc:'OFS',Stts:'Disp', Prvw:''       , Desc:'Gramatura: 90g'     ,Variantes:{
                '10 x 15':{Table:[
                    ['Frente' ,'90g',[['1.000',130, 67],['2.500',180, 85],['5.000' , 270,170],['10.000',650,340]]],
                    ['F.Verso','90g',[['2.500',280,135],['5.000',320,220],['10.000', 720,392]]], ]},
                '15 x 20':{Table:[
                    ['Frente' ,'90g',[['1.000',270,127],['2.500',340,170],['5.000' , 650,340],['10.000',900,600]]],
                    ['F.Verso','90g',[['2.500',500,270],['5.000',700,440],['10.000',1200,800]]], ]},
            }},
        'Talão'    :{Calc:'OFS',Stts:'Disp', Prvw:''       , Desc:'Gramatura: 90g'     ,Variantes:{
                '10 x 15':{Table:[
                    ['Preto e Branco','1 Via',[['4',60,30],['8', 90,45],['12',130,65],['20',170, 85]]],
                    ['Colorido'      ,'1 Via',[['4',80,40],['8',110,55],['12',150,75],['20',200,100]]],
                    ['Preto e Branco','2 Via',[['4',75,35],['8',105,55],['12',145,70],['20',185, 80]]],
                    ['Colorido'      ,'2 Via',[['4',95,45],['8',125,65],['12',165,85],['20',215,110]]],
                ]},
                '15 x 20':{Table:[
                    ['Preto e Branco','1 Via',[['2',60,30],['4', 90,45],['10',170, 85],['20',300,150]]],
                    ['Colorido'      ,'1 Via',[['2',80,40],['4',110,55],['10',200,100],['20',350,175]]],
                    ['Preto e Branco','2 Via',[['2',75,35],['4',105,55],['10',185, 90],['20',315,165]]],
                    ['Colorido'      ,'2 Via',[['2',95,45],['4',125,65],['10',215,110],['20',365,195]]],
                ]},
                ' 9 x 21':{Table:[
                    ['Preto e Branco','1 Via',[['3',60,30],['6', 90,45],['9',130,65],['12',150,75]]],
                    ['Colorido'      ,'1 Via',[['3',80,40],['6',110,55],['9',170,85],['12',190,95]]],
                    ['Preto e Branco','2 Via',[['3',75,35],['6',105,55],['9',145,70],['12',165, 80]]],
                    ['Colorido'      ,'2 Via',[['3',95,45],['6',125,65],['9',185,85],['12',205,100]]],
                ]},
        }},
        'Tag'      :{Calc:'OFS',Stts:'Offf', Prvw:''       , Desc:'Gramatura: 90g'     ,Variantes:{
                    'Reto' :{},
                    'Curva':{},
            }},

        'Cardápio' :{Calc:'OFS',Stts:'Offf', Prvw:''       , Desc:'Gramatura: 90g'     ,Variantes:{
                    '1Pag':{},
                    '2pag':{},
        }},
        Camisa   :{Calc:'QNT',Stts:'Offf', Prvw:''       , Desc:'Sublimação Total'   ,Variantes:{
            'M.Curta'  :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['Helanquinha','Dry Furado'],Valor:0,Icon:tmplt_Img(['Cam1','Cam2','Cam3','Cam4'])},
            Regata     :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['Helanquinha','Dry Furado'],Valor:0,Icon:tmplt_Img(['Cam1','Cam2','Cam3','Cam4'])},
            Polo       :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['                        '],Valor:0,Icon:tmplt_Img(['Cam1','Cam2','Cam3','Cam4'])},
            'M.Longa'  :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['Helanquinha','Dry Furado'],Valor:0,Icon:tmplt_Img(['Cam1','Cam2','Cam3','Cam4'])},
        }},
        'Calção'      :{Calc:'QNT',Stts:'Offf', Prvw:''       , Desc:'Gramatura: 90g'     ,Variantes:{
                'Bermuda' :{},
                'Short'   :{},
        }},  
        WindFlag :{Calc:'QNT',Stts:'Offf', Prvw:''       , Desc:'Tecido: Oxford'     ,Extra:{'Base':80},Variantes:{
            Faca         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            Vela         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            Pena         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            Gota         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            }},
        BigBall  :{Calc:'QNT',Stts:'Offf', Prvw:''       , Desc:'Tecido: Oxford'     ,Extra:{'Base':80},Variantes:{
                P         :{Tipo:[''],Valr:0,Cust:0},
                M         :{Tipo:[''],Valr:0,Cust:0},
                G         :{Tipo:[''],Valr:0,Cust:0},
            }},
    
        'Bandeira'      :{Calc:'QNT',Stts:'Offf', Prvw:''       , Desc:'Gramatura: 90g'     ,Variantes:{
                'Oxford' :{},
                'Cettin' :{},
        }},    
        }
    const AllServM2  = ObjKey(Prod).filter(k=>Prod[k].Calc==='M2')
    const AllServOFS = ObjKey(Prod).filter(k=>Prod[k].Calc==='OFS'||Prod[k].Calc==='QNT')
    const AllProd = [...AllServM2,...AllServOFS]
    const Vari=e=>ObjKey(Prod[e].Variantes)
</script>

<script> // Base de Dados 2
    const Edi   = 'contenteditable="true"'
    const Link  = 'http://localhost:3000'
    const Atual = {Pag:'#Pag_ORC'}
    const Navv  = ['Pedidos','Servicos','Pagamentos','Grades','MPago','Clientes']
    const NavImg= ['LOJA','PDDS','SERV','LIN','PGMT','GRAD','LIN','CLNT']
    let scrollPosition = [0,0]
    const D = {PDDS:0,SERV:0,CLNT:0,PGMT:0,GRAD:0,OOSS:0,UBER:0,MPAG:0}
    const O = {
         Forn:['','Grafit','Inová','Bureal','BPrint','Stock','Arte','JLTal','Varyus','Tatiane','-'],
         Serv:['','Adesivo','Banner','Cartão','Talão','Sub.Total','Varios','Panfleto','Lona','Quadro','Arte','Serigrafia','Recorte','Faixa','Envelopamento','Figurinha','Router','Topo de Bolo','Cardápio','Vendas'],
         Arte:['','Allan','Baby','Fexta','Ja Tinha','n tem',''],
         Form:['','Pix','Av','Card','1x','2x','3x','4x','5x']}
 
     const CRYPP = {F:'Fx',I:'Inpt',B:'Bndj',S:'Slct',A:'Auto',C:'Chek',G:'Sugg',M:'Img',E:'Edit',D:'Grds',V:'SVG'} // Aqui pode ter Data, Valr (vai facilitar pra encontrar) já q n to usando mt input
     const CrypF = {T:'Total',C:'Config'}
     const BS = {
         PDDS:{ID:['F','w0',''],Data:['E','', ''],Clnt:['B','','' ],Serv:['B','','' ],Valr:['A','','Total'],Pgmt:['B','','Total'],Lcro:['E','',''],Stts:    ['E','',''],'-'     :['F','w0','']},  // Removi 'RG'
         SERV:{ID:['F','w0',''],Serv:['S','', ''],Desc:['E','','' ],Calc:['B','','' ],Arte:['S','','' ]    ,Valr:['E','','']     ,Forn:['S','','']     ,OK:  ['C','',''],Entregue:['C','',''],DataEntg:['E','',''],Coment:['E','',''],SVG:['V','',''],Grad:['F','',''],Clnt:['F','',''],Data:['F','',''],'-':['F','w0','']},
         PGMT:{ID:['F','w0',''],Data:['I','', ''],Clnt:['F','','' ],Valr:['E','','' ],Form:['S','','']     ,Desc:['E','','']     ,Stts:['E','',''],Link:    ['E','',''],Mpag    :['E','',''],'-':['F','w0','']},
         CLNT:{ID:['F','w0',''],Clnt:['E','', ''],Cmpt:['E','','' ],Cntt:['E','','' ],Lcal:['E','','']     ,Loja:['E','','']     ,CtLj:['E','',''],Cat:     ['E','',''],Stts    :['E','',''],Link:['E','',''],'-':['F','w0','']},
         GRAD:{ID:['F','w0',''],Data:['I','','C'],Emal:['E','','' ],Forn:['S','','C'],OS  :['E','','C']    ,Nome:['D','','']     ,Cont:['E','',''],Uber:    ['E','',''],Valr    :['E','',''],Valr2:['E','',''],NSrv:['E','',''],Link:['G','',''],Imag:['M','',''],'-':['F','w0','']},
         OOSS:{ID:['F','w0',''],Nome:['E','','C'],Link:['E','','' ],Desc:['E','','' ],'-' :['F','w0','']},
         UBER:{ID:['F','w0',''],Data:['I','','C'],Dest:['E','','C'],Hora:['E','','' ],Valr:['E','','C']    ,Dirc:['E','','C']    ,Prds:['E','','C'],Desc:['E','','C'],Grad:['E','','C'],Link:['G','','C'],'-':['F','w0','']},
         MPAG:{ID:['F','w0',''],Data:['I','', ''],Clnt:['E','','' ],Valr:['E','','' ],Hora:['E','','']     ,Form:['E','','']     ,Mpag:['E','',''],Link:['G','',''],'-':['F','w0','']} // Removi 'Cpvt'
     }
 
     const CC = {
         // PDDS:{},
         SERV:[
             {Forn:["['Stock','Arte'].includes()",                            'Stok','Formt_Azul'],OK:['==true'],Entregue:['==true'],DataEntg:[`!==""`],Grad:[` ==""`]}, // O Primeiro Define a cor, o Resto Define a Intencidade  
             {Forn:["['Grafit','BPrint','Inová','Bureal','JLTal'].includes()",'Grad','Formt_Verd'],OK:['==true'],Entregue:['==true'],DataEntg:[`!==""`],Grad:[`!==""`]}, // O Primeiro Define a cor, o Resto Define a Intencidade  
             {Forn:["['Varyus'].includes()",'Varys','Formt_Verd'],OK:['==true'],Entregue:['==true'],DataEntg:[`!==""`],Grad:[`!==""`]}, // O Primeiro Define a cor, o Resto Define a Intencidade  
         ],
         // CLNT:{},
         // PGMT:{},
         // GRAD:{},
         // OOSS:{},
         // UBER:{},
         // MPAG:{}
     }
</script>

<script> // Bibliotecas
    const Dat=e=>new Date(e)
    const Rx2=arry=>Rx(['Rastr',...arry])
    const OjKy=Typ=>ObjKey(BS[Typ])
    const ExtObj=Obj=>[0,1,2].map(i=>ObjVal(Obj).map(arr=>arr[i]))
    const D_Rastr=e=>Extrat_Clss(e,'Rastr-').split('-') // Simplificar pra D_R e incluir closeset aqui dentro mesmo, caso precise.
    const TogTd=e=>$('input',e)!==event.target && TogNoSh([$('input', e),$('p',e)])
    const ALERT=e=>{Inn('#ALERT span',JSON.parse(e).Dados.map(e=>`<div style="margin:3px">"${e}"</div>`).join(''));ShowTime('#ALERT',3)}
    const RgxPixAV=e=>e.trim().match(/(\d+[\.,]?\d*)([a-zA-Z]+)/) || []
    const SunPix=Stg=>Stg.split('|').map(p=>parseFloat(p.replace(/[^\d.,]/g,'').replace(',','.'))||0).reduce((sum,n)=>sum+n,0)
    const J_Filt=(Typ,e)=>J[Typ].filter(E=>E.ID==(e+"|").split('|')[0])
    const J_Find=(Typ,e)=>J[Typ].filter(E=>E.ID==(e+"|").split('|')[0])[0]
    const BSBS=(typ,x,idx)=>BS[typ][OjKy(typ)[x]][idx]
    const Coll=(x)=>`td:nth-child(${x})`
    const Col=(typ,col)=>`td:nth-child(${FIdx(OjKy(typ),col)+1})`
    function EnterBlur(e){KeyEntr(()=>e.blur())}
    const SERV_Find_CLNT=e=>J_Find('CLNT',J_Find('PDDS',e.ID).Clnt).Clnt
    const FindClnt=e=>J_Find('CLNT',e.Clnt).Clnt
    const Block=e=>e.style.display = 'block'
    const Add_N=e=>Add(e,'none')
    const Rmv_N=e=>Rmv(e,'none')
    const Tog_N=e=>Tog(e,'none')
    const ConvertDATA=e=>/^\d{4}-\d{2}-\d{2}$/.test(e)?DMY(e):e
    const H_Col_p=(Typ,col)=>`#H_${Typ} > tbody > tr > ${Col(Typ,col)} p`

    const llv2 = (e,v)=>{if(e.tagName === 'INPUT' && e.type === 'checkbox'){e.checked = typeof v === 'string' ? JSON.parse(v) : v;} else {e.value = v}}


    function VAL(td){ // e deve ser um 'td'
        const R = D_Rastr(td) // se e for td entra 'e' se não for, faz o closeset('td') aqui dentro mesmo
        const val = R[3]==='Edit' ? $('p',td).textContent.trim()
                  : R[3]==='Fx'   ? $('p',td).textContent.trim()
                  : R[3]==='Sugg' ? $('p',td).textContent.trim()
                  : R[3]==='Auto' ? $('p',td).textContent.trim()
                  : R[3]==='SVG'  ? $('p',td).textContent.trim()
                  : R[3]==='Bndj' ? $('p',td).textContent.trim()
                  : R[3]==='Slct' ? $('select',td).value
                  : R[3]==='Inpt' ? $('input' ,td).value
                  : R[3]==='Chek' ? $('input' ,td).checked
                  : is(td,'input')? td.value
                  : R[3]==='Lixo' ? '-'
                  : null
        return val
    }
    //Evento de Click na Página inteira, com a intenção de Ocultar tudo que for Bandeijas
    function NoneBndj(){if(event.target.closest('.bndj')||event.target.classList.contains('NObj')){return}else{None($$('.bndj'))}}
    const Trc2=(e,add,rmv)=>{Add($(e),add);Rmv($(e),rmv)}
    const DarkLite2=(e,Check)=>{if(Check){Trc2(e,'Dark','Lite')}else{Trc2(e,'Lite','Dark')} ; console.log('Chamou DarkLite',e,Check)}
</script>

<script> // Template Tabelas
    const Tm_thSort=arr=>arr.map((e,x)=>`<th class="Rltv noslt"><p class="ppt" onclick="Filtrar(this,1)" oncontextmenu="Filtrar(this,0)">${e}</p> <a class="Abslt ppt" onclick="OrdenarRows(this,'${x}','p')">▼</a> <div class="Abslt none THSugg Sugg Shdw rd Cl"></div> </th>`).join('')
</script>

<script> // Template String
    
    const Tm_Rastr=(e,x,typ,id)=>`Rastr-${typ}-${e[id]}-${OjKy(typ)[x]}-${CRYPP[BSBS(typ,x,0)]}` //Argumento 'id', recebe string 'ID' se for Obj, e recebe '0' se for array
    const Tm_Config=typ=>`<input type="checkbox" onchange="TrcTog($('#H_${typ}'),'hMin','hMax');SaveConfig()"> <input type="checkbox" onchange="Tog($('#H_${typ}'),'w100');SaveConfig()">`
    const Tm_Table=(typ,obj)=>obj.map(e=>`<tr class="tr-${e.ID}">${ObjOrdn(e,OjKy(typ)).map((c,x)=>`<td class="${Tm_Rastr(e,x,typ,'ID')} ${BSBS(typ,x,1)}">${c}</td>`).join('')}<td class="w0 Rastr-${typ}-${e.ID}-Lixo-Lixo"><a onclick="${typ==='PDDS'?'Rmv':'Exc'}ROW('${typ}','${e['ID']}',this)">${SVG.Lixo}</a></td></tr>`).join('')
    const Tm_tdFoot=(arr,typ)=>arr.map((e,x)=>`<td class="Rastr-Foot-${e}-${OjKy(typ)[x]}-${typ}"><p>${e}</p></td>`).join('')

    // Strings Extras
    const Tm_PixAv=(Pix,Av)=>`<div class="Ct Ev"><div class="Ct">${Tm_RS(SOMA(Pix))}Pix</div> <div class="Ct">${Tm_RS(SOMA(Av))}Av</div></div>`

    const Tm_SuSg=()=>`<span class="Sugg Shdw rd Abslt Cl none"></span>`
    const Tm_Sugg=()=>`${Tm_SuSg()}<div class="Sugg ppt SuggFoot Shdw rd Abslt Ct Hov none" onclick="Linkar(this)" name="Gambiarra-sopranbugar">Linkar </div>`
    const Tm_SuggCLNT=()=>`<div class="DivSugg Rltv"> <input class="w100" oninput="Sugg($Vl(this),J['CLNT'],'Clnt',SibQSl(this,'span'),'ClickSugg2');Nm(this,'')" onblur="" onkeydown="KeyEntr(()=>TesteClnt(this,this))" placeholder="Cliente">${Tm_SuSg()}</div>`
    

    const Tm_Bndj=()=>{
        const MORE =(arr,Typ)=>`<table class="Bdj_${Typ} TableMORE"><thead><tr>${arr[0].map(t=>`<th>${t}</th>`).join('')}</tr></thead>
                                      <tbody>${arr.slice(1).map(LL=>`<tr class="tr-${LL['ID']}">${LL.map((v,x)=>`<td class="${Tm_Rastr(LL,x,Typ,0)}">${v}</td>`).join('')}</tr>`).join('')}</tbody>
                                  </table> ${Typ==='SERV'||Typ==='PGMT'?`<div class="Nuevoevo RD Hov" onclick="NovaLinhaBDj(this)">Nova Linha +</div>`:''}`
        function Process(e,R){
            e.onclick = ()=>{ShowBndj(e,SVG.Ponta)}
            const Typ   = R[2].toUpperCase()
            const Find  = Typ==='SERV' ? J[Typ].filter(E=>(E.ID).split('|')[0]==R[1]) :
                          Typ==='PGMT' ? J[Typ].filter(E=>(E.Link)==R[1]) : 
                          J[Typ].filter(E=>E.ID==Inn(e))
                          
            const Title = Typ==='PGMT' ? Find.map(e=>`${e['Valr']}${e['Form']}`).join(' | ') :
                          Typ==='SERV' ? Find.map(e=>`${e[R[2]]} ${e['Desc']}` ).join(' | ') :
                          Find.map(e=>e[R[2]]).join(' | ')
            const NewPg = Typ==='PGMT' && Title==='' ? '-' : ''
            const Lista = Find.map((e,x)=>x===0 ? MORE(ArrObj_ArrArr(Find),Typ):'').join('')
            const Zindx = R[0]==='PDDS' ? `style="z-index:${R[1]}"` : ''
            e.innerHTML = `<p class="P-P" ${Typ==='PGMT'?`name="${SunPix(Title)}"`:`name="${Title}"`}>${Title}</p><div class="Bandj Shdw none rd Cl" ${Zindx}>${NewPg==='-' || Title==='-'?'<a class="FikaFika"></a>':Lista}</div>`
            //e.innerHTML = `<div class="Ct"><p class="P-P" ${Typ==='PGMT'?`name="${SunPix(Title)}"`:`name="${Title}"`}>${Title}</p><div class="Bandj Shdw none rd Cl" ${Zindx}>${NewPg==='-' || Title==='-'?'<a class="FikaFika"></a>':Lista}</div></div>`
        }

        const MORE2 =(arr,Typ)=>`<table class="Bdj_${'Calc'} TableMORE"><thead><tr>${arr[0].map(t=>`<th>${t}</th>`).join('')}</tr></thead>
                                    <tbody>${
                                        arr.slice(1).map(LL=>`<tr class="tr-Mdds">${
                                            LL.map((v,x)=>`<td class="">${v}</td>`).join('')
                                        }</tr>`).join('')
                                    }</tbody>
                                 </table>`

        function Process2(e,R){
            e.onclick = ()=>{ShowBndj(e,SVG.Ponta)}
            const Typ   = R[2]
            const Find  = J['SERV'].filter(E=>E.ID==R[1])[0].Calc
            const F2    = [ObjKey(Find).map(e=>e),ObjVal(Find).map(e=>e)]
            const Title = `${Find.Qnt} - ${Find.Lag}x${Find.Alt}${Find.Val==''?'':` R$ ${Cm(Find.Val)}`}`
            const Lista = MORE2(F2,'SERV')
            const Zindx = `style="z-index:${'30'}"`
            
//            console.log(Typ,Title)
            e.innerHTML = `<div class="Ct"><p name="${Title}">${Title}</p><div class="Bandj Shdw none rd Cl" ${Zindx}>${Title==='-'?'<a class="FikaFika"></a>':Lista}</div></div></td>`
        }
        
        $$(Rx2(['PDDS','Bndj'])).forEach(e=>{Process (e,D_Rastr(e))})
        $$(Rx2(['SERV','Bndj'])).forEach(e=>{Process2(e,D_Rastr(e))})
    }

    function Format(){
        const Fixo=e=>`<p class="P-P Ct ColorFix" name="${YMD(ConvertDATA(Inn(e)))}">${ConvertDATA(Inn(e))}</p>` // Botei o Convert Caso seja Data
        const Edit=e=>`<p class="P-P Ct" ${Edi} onfocus="Add(Pai(this),'Foco')" name="${Inn(e)}" onkeydown="EnterBlur(this)" onblur="Rmv(Pai(this),'Foco');EditCell(this)">${Inn(e)}</p>`
        const Slct=e=>`<select class="P-P w100" onchange="EditCell(this)">${Tm_Opts(O[D_Rastr(e)[2]],Inn(e))}</select>`
        const Chek=e=>`<input  class="P-P"      onchange="EditCell(this)" type="checkbox" ${Inn(e)==='true'?'checked':''}>`
        
        const Imgs=e=>`<img onclick="AbrirImg(this)" draggable="false" src="./Base/Grads/${Inn(e)}.webp">`
        const Svvg=e=>`<img onclick="AbrirSVG(this,'${Inn(e)}')" draggable="false" src="./Base/Recorte/${Inn(e)}">`
        const Data=e=>`<p class="Ct" name="${YMD(Inn(e))}" onclick="TrcFih(this)">${BrevData(DMY(Inn(e)))}</p><input type="date" class="none" value="${YMD(Inn(e))}" onchange="EditCell(this)" onblur="TrcFih(this)">`
        const Valr=e=>`<p class="Ct" onclick="TrcFih(this)">${RS(Inn(e))}</p><input class="none" value="${Inn(e)}" onkeydown="KeyEntr(()=>{TrcFih(this)})" onblur="EditCell(this);EditVlr(this,'blur');TrcFih(this)">`
        
        const Sugg=(e,Typ)=>`<div class="Rltv Linke"><p onclick="SuggLink(this,'${Typ}')">${Inn(e)}</p>${Tm_Sugg()}</div>`
        const RGB=()=>['R','G','B'].map(e=>`<div class="RGB Rltv" onclick="ExibRecolor(this)"> <a>${e}</a> ${Tm_SuSg()} </div>`).join('')

        const Valr2=e=>`<p class="Ct" ${Edi} oninput="MaskNum2(this)">${RS(Inn(e))}</p>`


        $$(Rx2(['Fx'         ])).forEach(e=>Inn(e,Fixo(e)))
        $$(Rx2(['Edit'       ])).forEach(e=>Inn(e,Edit(e)))
        $$(Rx2(['Chek'       ])).forEach(e=>Inn(e,Chek(e)))
        $$(Rx2(['Slct'       ])).forEach(e=>Inn(e,Slct(e)))
        $$(Rx2(['Img'        ])).forEach(e=>Inn(e,Imgs(e)))
        $$(Rx2(['SVG'        ])).forEach(e=>Inn(e,Inn(e)==""?Edit(e):Svvg(e)))
        $$(Rx2(['GRAD','Sugg'])).forEach(e=>Inn(e,Sugg(e,'SERV')))
        $$(Rx2(['UBER','Sugg'])).forEach(e=>Inn(e,Sugg(e,'GRAD')))
        $$(Rx2(['MPAG','Sugg'])).forEach(e=>Inn(e,Sugg(e,'PGMT')))
        $$(Rx2(['GRAD','Grds'])).forEach(e=>Inn(e,Inn(e).split('|').map(E=>`<a>${E.trim()}</a>`).join('')))

        // NOVOS sem Input
        $$(Rx2(['Edit','Valr'])).forEach(e=>Inn(e,Valr2(e)))



        // Independente do q foi passado Genérioco, este aqui reescreve por cima!
        $$(Rx2(['GRAD','Cont'])).forEach(e=>Inn(e,`<p>${$$(`${Col('GRAD','Nome')} a`,_tr(e)).length}</p>`))

        $$(Rx2(['PDDS','Valr'])).forEach(e=>{const id_PDDS = Extrat_Clss(Pai(e),'tr-');const trus = J['SERV'].filter(E=>(E.ID).split('|')[0] == id_PDDS);e.innerHTML = `<p class="P-P Soma" name="${SOMA_Obj(trus,'Valr')}" onclick="CtrlSoma(this)">R$ ${Cm(SOMA_Obj(trus,'Valr'))}</p>`})

        $$(Rx2(['Foot','Total','Valr'])).forEach(e=>{const R = D_Rastr(e) ; e.innerHTML = `Total: R$ ${Cm(SOMA($$(`#H_${R[3]} > tbody > tr > td:nth-child(${FIdx(ObjKey(BS[R[3]]),R[2])+1}) > p`),(e)=>{return Num(Inn(e))}))}`})
        $$(Rx2(['Foot','Total','Pgmt'])).forEach(e=>{const R = D_Rastr(e) ; e.innerHTML = `${SOMAPgmt($$(`#H_${R[3]} > tbody > tr > td:nth-child(${FIdx(ObjKey(BS[R[3]]),R[2])+1}) > div > p`))}`})

        $$(Rx2(['SERV','Clnt'])).forEach(e=>{$('p',e).innerHTML = J['CLNT'].filter(E=>E.ID==$('p',e).innerHTML).map(E=>E.Clnt)})
        $$(Rx2(['PGMT','Clnt'])).forEach(e=>{$('p',e).innerHTML = J['CLNT'].filter(E=>E.ID==$('p',e).innerHTML).map(E=>E.Clnt)})
        $$(Rx2(['SERV','Grad'])).forEach(e=>{$('p',e).innerHTML = J['GRAD'].filter(E=>E.ID==$('p',e).innerHTML).map(E=>`${E.Forn}-${$('p',e).innerHTML}`)})

        $$(Rx2(['Foot','C'])).forEach(e=>{Inn(e,`<div class="Ct">${RGB()}</div>`);$$('.Rltv',e).forEach(EE=>RecolorFil(EE))})
    }
</script>

<script> // Templates OBSOLETOS
    // const tmplt_OptDisable=e=>`<option value="" disabled selected>Escolha um ${e}</option>`
    // const tmplt_InptsClnt =e=>`<div class="Ct"><input placeholder="Nome"><input placeholder="Contato"></div>`
    // const tmplt_Orcs      =(e,idx,form)=>`<div class="Ct"><h1>${idx}</h1><a class="Bt RD">${tmplt_InptsClnt(e)}<button onclick="TogClss($('.EspacoForm',Avo(this)),'none')">Editar</button></a><div class="EspacoForm none">${form}</div></div>`
    // const tmplt_FormSlct  =arry=>arry.map(e=>`<div class="Div-Inpt"><label>${Abrev[e]}</label><select class="I_${e}" onchange="InnerOptions('${e}',this.value,Bzv(this));ShowTipo(Ttv(this))"></select></div>`).join('') // Função Muito específica, q só Funciona aqui, não da pra ir pra biblioteca
    // const tmplt_Cores     =e=>`<li class="Ct Rd ppt" style="background:${e}" onclick="mudarCor(this,'${e}');VariasCor(this,'${e}')"></li>`
    // const tmplt_table     =arry=>arry.map(e=>`<th class="${e.match('-')?'none':''}">${e.replace('-','')}</th>`).join('')
    // const tmplt_CrudDefaut=arry=>arry.map(e=>`<td class="${e.match('-')?'none':''}"><div data="CrudA"></div><input class="none" data="CrudB" ${e.match(/\+/)?`oninput="MaskNum(this)"`:''}></td>`).join('')
</script>

<script> // Manipulações
    //FILTROS == Se clicar com o Direito Soma os Filtros, se Clicar com Botão Esquerdo Sobrepõe o Filtro
        function Filtrar(e,Clik){event.preventDefault() // isso deveria ser tm_SuggFilt()
            const Sugg = $('.THSugg',_th(e))  ;  TogShow(Sugg)
            const qry = `#${_table(e).id} > tbody > tr > td:nth-child(${IdxDe(_th(e))+1}) > .P-P`
            const blx = $$(qry)
            const ArrVAL = Clik==1 ? Uniq(blx.map(e=>VAL(_td(e)))) : Uniq(blx.map(e=>{if(Notem(_tr(e),'none')){return VAL(_td(e))}}))
            const arrayLimpo = ArrVAL.filter(e => e !== undefined)
            Inn(Sugg,arrayLimpo.map(e=>`<p onclick="FILT_Clik(this,'${qry}',1)" oncontextmenu="FILT_Clik(this,'${qry}',0)">${e}</p>`).join(''))
        }
        function FILT_Clik(Eu,Qry,Clik){event.preventDefault()
            if(event.ctrlKey){}else{None($$('.THSugg'))}
            $$(Qry).forEach(e=>{
                if(VAL(_td(e))==Inn(Eu)){ // aqui eu tenho q usar contem

                    if(Clik==1){Rmv_N(_tr(e))}}else{Add_N(_tr(e))}})
        }
        function Pesquisa(Val,Typ){ // incluir conteudo da bandeija, e sem conteudo da bandeija
            $$(`#H_${Typ} > tbody > tr`).forEach(tr=>{
                const Concat = $$(':scope > td',tr).map(td=>VAL(td)).join('-')
                const match  = Concat.toLowerCase().includes(Val.toLowerCase())
                if(match){Rmv_N(tr)}else{Add_N(tr)}
            })
        }
        function LimparFiltro(Typ){
            Rmv_N($$(`#H_${Typ} tr`)) ; None($$('.THSugg'))}
    //FILTROS

    //RECOLOR
        function RRecolor(){ // esta função está sendo chamada pelo EditCell()
            // talvez aqui de pra fazer recolor de forma individual
            console.log('Sera feito o Recolor sem Demora!')
        }
        // Recoloração igual ao Filter (pra separar tipos, Agrupar e Ordenar)
        // Recoloração por Status de Conclusão
        // quero fazer tudo no Rodapé e Salvar um Json pra manter Fixo pra as Próximas Atualizações
        // e também quero Pressets de combinações de Cores pra eu Já ir Direto!

        function ReStts(){
            ObjKey(CC).forEach(Typ=>{
                $$(`#H_${Typ} > tbody > tr`).forEach(tr=>Nm(tr,'')) // Limpar o Name de todas Linhas da Tabela
                $$(`#H_${Typ} > tbody > tr`).forEach(tr=>{
                    let id = VAL($(`:scope > ${Coll(1)}`,tr))
                    let Acc = []
                    let Grup = []

                    // Validar pra saber se Corresponde ao Critério lá da base de dados
                    function Validar(K){
                            const td = $(`:scope > ${Col(Typ,K[0])}`,tr)
                            const valor = VAL(td)
                            const Stg = K[1][0].replace('()',`('${valor}')`)
                            const Result = eval(`${K[1][0].includes('includes') ?'':'valor'} ${Stg}`)
                            return Result
                    }

                    // Conferir de qual Grupo ele Pertence
                        CC[Typ].forEach((e,x)=>{const K = ObjEtr(e)[0] ; if(Validar(K)){Grup = [K[0],K[1][1],K[1][2],x]}})
                    // Dar String vazia caso não Pertença a nenhum Grupo
                        if(Grup.length == 0){Grup = ['','','',0]}
                    // Conferir Intensidade
                        ObjEtr(CC[Typ][Grup[3]]).forEach(K=>{Acc.push(Validar(K) ? [K[0],true]: [K[0],false])})
                    // Fazer o Concar pra Botar no SetAtributes
                        const Concat = Acc.map(e=>{return e[1]==true ? e[0] : ''}).join('-')
//                        console.log(id,Concat.replace(/\-*/,'-'))
                        // tr.setAttribute('data-Color','john_doe')
                        
                        
                        //console.log(VAL(td),Stg,Result==true?'verdadeiro':'falsos')
                        //
                    
                    //console.log(id,Acc)

                })
            })
        }

        function ExibRecolor(Eu){if(Pai(event.target)==Eu){Tog_N($('span',Eu))}}
        function TogCorlor(eu,Typ){Tog(eu,'RecolorSelects') ; RloadColor()}

        function RecolorFil(Eu){
            $('span',Eu).style.width = '150px'
            const R = D_Rastr(_td(Eu))
            Inn($('span',Eu),`${R[2]=='Data'||R[2]=='Valr'?`<div>Acima de</div>   <div>Abaixo de</div>`:``}
                              ${Uniq(J[R[3]].map(e=>e[R[2]])).map(e=>`<div onclick="TogCorlor(this,'${R[3]}')">${e}</div>`).join('')}`)
        }

        function RloadColor(){
            // tentar Simplificar isso depois, em 1 Unica Linha
            $$('.R_Cor,   .G_Cor,   .B_Cor'   ).forEach(e=>{Rmv(e,'R_Cor'   );Rmv(e,'G_Cor'   );Rmv(e,'B_Cor'   )})
            $$('.Tr-R_Cor,.Tr-G_Cor,.Tr-B_Cor').forEach(e=>{Rmv(e,'Tr-R_Cor');Rmv(e,'Tr-G_Cor');Rmv(e,'Tr-B_Cor')})

            $$('.RGB').forEach(e=>{
                const   cor = Inn($('a',e))
                const valid = $$('.RecolorSelects',e).map(E=>E==null?null:Inn(E))  
                const     X = IdxDe(_td(e))+1
                const     R = D_Rastr(_td(e))
                console.log(R[3])
                // só roda isso, se tiver certo ai o R[3] com nome da tabela
                $$(`#H_${'UBER'} > tbody > tr ${Coll(X)}`).forEach(td=>{ if(valid.includes(VAL(td))){Add(td,`${cor}_Cor`)} })
            })

            // tentar Simplificar isso depois, em 1 Unica Linha
            $$('.R_Cor').forEach(e=>{Add(_tr(e),'Tr-R_Cor')})
            $$('.G_Cor').forEach(e=>{Add(_tr(e),'Tr-G_Cor')})
            $$('.B_Cor').forEach(e=>{Add(_tr(e),'Tr-B_Cor')})
        }
    //RECOLOR

    //SUGGLINK
    function SuggLink(Eu,Typ){
        TogShow(SibQSl(Eu,'span'))
        TogShow(SibQSl(Eu,'div'))
        const Fillt=e=>{
            console.log()
            return  Typ=='SERV' ? e.Grad=='' && !['Stock','Arte','-'].includes(e.Forn) :
                    Typ=='PGMT' ? e.Mpag=='' && e.Form!='Av' :
                    Typ=='GRAD' ? Dat(e.Data) <= Dat(VAL($(`${Col('UBER','Data')}`,_tr(Eu)))) && VAL($(`${Col('UBER','Prds')}`,_tr(Eu))).split(',').includes(e.Forn) :
                    true
        }
        if(Typ=='GRAD'){
            SibQSl(Eu,'span').innerHTML = `<table class="w100">${J[Typ].filter(e=>Fillt(e)).map(e=>{
                return e.Nome.split('|').map(s=>`<tr onclick="Tog(this,'SuggSelects')"><td>${e.ID}</td><td>${DMY(e.Data)}</td><td>${s}</td></tr>`).join('')
            }).join('')
            }</table>`
            
        }else{
            SibQSl(Eu,'span').innerHTML = J[Typ].filter(e=>Fillt(e)).map(e=>`<div><a onclick="Tog(this,'SuggSelects')">${
            Typ=='SERV' ? `${e.ID} - ${SERV_Find_CLNT(e)} ${e.Serv} ${e.Desc}` :
            Typ=='PGMT' ? `${e.ID} - ${FindClnt(e)} - R$ ${e.Valr} (${e.Form}) ${e.Data}` :
            ``
            }</a></div>`).join('')
        }
    }

    function Linkar(Eu){
        if(_table(Eu).id == 'H_MPAG'){
            EditCell(Eu,$$('.SuggSelects',Pai(Eu)).map(e=>Inn(e).split('-')[0].trim()))
        }
        if(_table(Eu).id == 'H_GRAD'){
            const ArryAntg = Inn($('p',Eu.closest('td'))).split(',')
            const NovoArry = $$('.SuggSelects',Pai(Eu)).map(e=>Inn(e).split('-')[0].trim())
            if(Inn($('p',Eu.closest('td')))=='-'){
                EditCell(Eu,NovoArry)
            }else{
                EditCell(Eu,[...ArryAntg,...NovoArry])
            }
            
        }
        else{
            console.log($('span',Pai(Eu)))}
    }
    //SUGGLINK

    function SOMAPgmt(Divs){
        let pixArray = [] ; let avArray = []
        Divs.forEach(e=>{Inn(e).split('|').forEach(I=>{if(I===''){return}
                if (RgxPixAV(I)[2] === 'Pix') {pixArray.push(Num(RgxPixAV(I)[1]))}
                else if (RgxPixAV(I)[2] === 'Av') {avArray.push(Num(RgxPixAV(I)[1]))} }) })
        return Tm_PixAv(pixArray,avArray)
    }

    function CtrlSoma(Eu){
        // Conferir se tem Tecla Cntrl
        Tog(Eu,'SelectSoma')
        Inn('#Sommma',`Soma: ${RS(SOMA($$('.SelectSoma').map(e=>Nm(e))))}`)
    }

    function Format_Bndj_Clnt(){
        $$(`.FikaFika`).forEach(e=>{
            const R = D_Rastr(_td(e))
            if(R[2]==='Pgmt'){e.innerHTML = `<div class="LugyLygy"><input placeholder="0Av | 0Pix" onblur="EditCellFake2(this)" onkeydown="KeyEntr(()=>{None(Bzv(this))})"></div>`}
            if(R[2]==='Clnt'){e.innerHTML = `<div class="LugyLygy">${Tm_SuggCLNT()}</div><a class="sppns none" onclick="EditCellFake(this)"></a>`}
        })
        $$(`#H_PDDS ${Rx2(['CLNT','ID'])}`).forEach(e=>{
            Inn(e,`<p class="Ct" onclick="None($$('.LugyLygy'));Show(SibNxt(this))">${$('p',e).innerHTML}</p>
                        <div class="LugyLygy Abslt none">${Tm_SuggCLNT()}</div>
                        <a class="sppns none" onclick="EditCellFake(this)"></a>`)})
    }

    const MonitoreBandeja=()=>{
        console.log('nada Monitorar bandeja pra ver a hora q ela é fechada pra atualizar a div')
    }

    function AbrirImg(img){MdalShow('#FormIMG')
        Inn($('#FormIMG'),`<div class="Ubuiaxik Ct"><img class="h100" src="${img.src}"><span>aquificara fica Os<span><div>`)
    }

    function AbrirSVG(img,Nome){MdalShow('#FormIMG')
        $('#FormIMG').innerHTML = `<div class="Ubuiaxik Ct"><img class="h100" src="${img.src}">
            <span>Nome: ${Nome}<span>
            <button onclick="LimparNomeSVG('${_td(img).className.trim()}')">Limpar</button>
        <div>`  
    }

    function LimparNomeSVG(Clss){
        const Edit=e=>`<p class="Ct" ${Edi} onfocus="Add(Pai(this),'Foco')" name="${Inn(e)}" onkeydown="EnterBlur(this)" onblur="Rmv(Pai(this),'Foco');EditCell(this)">${Inn(e)}</p>`
        const td = $(`td[class="${Clss}"]`)
        EditCell(td,'')
    }

</script>

<body class="Dark" onclick="NoneBndj()">

    <header class="Bt Fx"> <!--HEADER-->
        <style> /*CSS do Header*/
            body > header{background:url(./SVG/Fundo.png);background-size: cover;height:60px;padding:0px;z-index: 999;} /*linear-gradient(to left,#530048,#83007b)*/
            #Sommma{position:fixed; top:0px; right:0px; padding:8px; background:#11111150}
            #H_Nav{margin-right:15px}
            #H_Nav, #H_Nav img{height:45px}
            #H_Nav img,h1{filter: drop-shadow(0px 0px 8px #3a002b)}
            #H_Nav img:hover{filter: drop-shadow(0px 0px 5px #f030c0)}
            #ALERT{right:0px;top:0px;margin:10px;padding:10px;background:#696969}
        </style>
        <script> // Funções do Header
            const OFF =()=> 'OFF'
            const ArryMais=()=> OFF() ? ['Cnfg','Help','LOff','Term'] : ['Troc','Edit','Cnfg','Help','LOff','Term'] // fazer isso simplesmente só ocultar e mostrar oq tem abaixo do mais
            function ExieMais2(E,Off){ event.preventDefault() ;if(false/*Off*/){MdalShow('#ModalLogin')}else{TogShow('#H_Mais')}}
            function AbreLogin(){MdalShow('#ModalLogin');Inn('#Span-Login','');Foco('#Inpt-Senha')}
        </script>

        <div id="Div-Titulo"> <!--Titulo-->
            <style> /*Titulo PC e Cell*/
                #Div-Titulo div{margin-left:15px}
                #Div-Titulo img{margin:5px; height:30px}
                #Div-Titulo h1{color: white !important}
                #Title1 h1{font-size:12px}
                #Title2 h1{font-size:40px}
                @media (max-width:1250px){#Title2 h1{font-size:29px}}
                @media (max-width:1100px){#Title2 h1{font-size:25px}}
            </style>

            <div id="Title1" class="Cl" onclick="Tog($('#BarraLateral'),'none')"> <!--Titulo Mobile-->
                <img draggable="false" src="./Img/Logo.png"><h1 class="noslt">InfinityAPP 7.2</h1>
            </div>
            <div id="Title2" class="Ct"> <!--Titulo PC-->
                <img draggable="false" onclick="Tog($('#BarraLateral'),'none')" src="./Img/Logo.png"><h1 class="noslt" onclick="NavPag('#Pag_ORC',this)">InfinityAPP 7.2</h1>
            </div>
        </div>

        <div id="Div-Pesq" class="Rltv hov"> <!--Pesquisa-->
            <style> /*Input de Pesquisa*/
                #Div-Pesq{width: 30%}
                #H_Pesq{background:#00000018; color:#ffffff;border: 1px solid #ef3aff}
                #H_Pesq::placeholder{color: #ffffff;opacity: 0.5}
                #Lupa{top: 8px; right: 6px; width: 17px; opacity: 0.5;}
                #Lupa:hover{opacity: 1;}
                @media (max-width:500px){ #Div-Pesq{width: 50%} }
            </style>
            <input id="H_Pesq" class="w100" placeholder="Pesquisar..." oninput="Pesquisa(this.value,'PDDS')">
            <img id="Lupa" class="Abslt HOV" src="./SVG/Icon_Lupa.svg">
        </div>

        <div class="Ct"> <!--Nav e Perfil-->
            <style>
                #Img-Perfil{width:45px;height:45px;margin:5px 5px;top: 2px}
                #IMG-PerfiL{width:45px;height:45px;margin:5px 5px;top: 2px}
            </style>
            <nav id="H_Nav" class="Ct"></nav>
            <script>Inn('#H_Nav',NavImg.map(e=>`<img class="ppt HOV" src="./SVG/${e}.svg" onclick="NavPag('#Pag_${e}',this);Atual['Pag']='#Pag_${e}'">`).join(''))</script>
            
            <div id="BdjLogin" class="Cl">
                <img id="LoginVazio" draggable="false" src="./Img/FundoLogo.png" class="ppt NObj" height="60px" onclick="AbreLogin()">
                <img id="IMG-PerfiL" draggable="false" src="./Img/LogOff.png" class="          Abslt NObj"      onclick="AbreLogin()" oncontextmenu="ExieMais2($('#MAIS'),true)">
                <img id="Img-Perfil" draggable="false"                        class="ImgPerfil Abslt NObj none" onclick="ExieMais2($('#MAIS'),true)">
                <div id="Login-Top"  class="Ct LgTp2 none"  onclick="AbreLogin()"> Login </div>
            </div>

            <style>
                #MAIS{background:#4e4e4e; width: 250px;}
                #MAIS div{padding:10px;cursor:pointer;font-size:15px;width: 100%;}
                #MAIS div:not(:last-child):hover{background:gray;color:var(--Txt-Wit-Hover)}
                #MAIS div:last-child{padding: 10px}
                #MAIS img{height:25px;margin-right:10px}
                #MAIS p,#MAIS p a{font-size: 10px}
                #H_Mais{top: 60px;right: 0px;}
            </style>

            <div id="H_Mais" class="Abslt none bndj">
                <div id="MAIS" class="Ct Pose">
                    <div class="Start" onclick="AbreLogin()">               <img draggable="false" src="./SVG/Mais_Troc.svg"><a> Trocar de Conta  </a></div>
                    <div class="Start" onclick="MdalShow('#EditarPerfil')"> <img draggable="false" src="./SVG/Mais_Edit.svg"><a> Editar Perfil    </a></div>
                    <div class="Start" onclick="MdalShow('#ConfigPag')">    <img draggable="false" src="./SVG/Mais_Cnfg.svg"><a> Configurações    </a></div>
                    <div class="Start" onclick="MdalShow('#PagSUPORTE')">   <img draggable="false" src="./SVG/Mais_Help.svg"><a> Central de Ajuda </a></div>
                    <div class="Start" onclick="LogOff()">                  <img draggable="false" src="./SVG/Mais_LOff.svg"><a> Sair             </a></div>
                    <div><p>Confira os <a class="Link">Termos de Serviço</a> e as <a class="Link">Política de Privacidade</a></p></div>
                </div>
            </div>
        </div>

        <div id="Sommma" class="none">Soma: 00,00</div>
        
        <div id="ALERT" class="Abslt rd none">
            <div class="Ct"><img draggable="false" src="./SVG/Plan.png" height="30px"><p style="margin-left: 5px;">Salvo com Sucesso</p></div>
            <span class="w100 Ct" style="height: 30px"></span>
        </div>

        <div id="BarraLateral" class="Abslt none">
            <style>
                #BarraLateral{
                    background: #ff4160;
                    height: 100vh;
                    top: 60px;
                    width: 250px;
                    z-index: 5;
                }

            </style>
            marionete
        </div>

        <script> // Titulo CSS
            function TrocarTitle(){if(window.innerWidth<=500){
                        Show($('#Title1'),$('#Title2'))
                        None($('#H_Nav')) }
                else {  Show($('#Title2'),$('#Title1'))
                        Show($('#H_Nav'))
                }
            }
            window.addEventListener('resize',()=>TrocarTitle())
            TrocarTitle()
        </script>
    </header>

    <div id="PAGES" style="margin-top: 60px">
        <style> /*Styles das Tabelas Principais*/
            table{text-align:center;border-collapse:collapse}
                .Dark .TBLAA table{background: #222222}
                .Lite .TBLAA table{background: white}
            .TBLAA th{padding:4px 6px}
                .Dark .TBLAA th,.Dark .TBLAA td{border:1px solid #cccccc27}
                .Lite .TBLAA th,.Lite .TBLAA td{border:1px solid #00000041}
                .Dark .TBLAA th{background: #161616;color:white}
                .Lite .TBLAA th{background: #8b0085;color:white}
                    .Lite .TBLAA td.Foco{background:#c300ff2a}
                    .Dark .TBLAA td.Foco{background:#ffffff18}
                .Dark .TBLAA tfoot{background:#111111;color:white}
                .Lite .TBLAA tfoot{background:#8b0085;color:white}

            .Dark .TBLAA tbody tr td:nth-child(1){color: #ffffff3b;background: #00000034}
            .Lite .TBLAA tbody tr td:nth-child(1){color: #0000008c}
            
            .TBLAA td p{width: 100%; height: 100%; padding: 2px 6px; text-align: center}

            .TBLAA .hMin td{height:10px}
            .TBLAA .hMin td select,.hMin td input{height: 17px !important}
                .TBLAA .hMin td .svg-Lixo{height:17px}
                .TBLAA .hMin td img{height:17px; width: auto;}
            .TBLAA .hMin tfoot td{padding:8px 6px}

            .Sugg{top:100%;left:0;right:0;max-height: 250px;overflow-y:auto;z-index: 500}
                .Lite .Sugg{background: #ffffff;border: 3px #ff00c8 solid ; color:#000000}
                .Dark .Sugg{background: #585858;border: 1px #2e2e2e solid ; color:#ffffff}
                .Sugg a p {padding: 3px}
                .Sugg a p:first-child {font-size: 10px; opacity: 0.6}
                    .Lite .Sugg a:hover {background: #ffaced}
                    .Dark .Sugg a:hover {background: #757575}
            .Linke .Sugg{width: 350px !important; transform: translate(-40%,0%)}
            .SuggFoot{top: 256px !important; background:#ff00c8 !important;color: white !important;}

            .Bandj{padding:5px}
                .Dark .Bandj{background:#363636}
                .Lite .Bandj{background:#bb0092}


            .TBLAA th a{font-size:9px;right:0px;top:50%;transform:translate(-0%,-50%)}
            .TableMORE thead{background:#0000007c}
            .More{margin:5px; padding:5px 10px; height:20px}

            .TBLAA tfoot a{color: #00df00;}
            .TBLAA tfoot .RS{color: #00df00; font-size: 7px;}

            .teste{color: #79ff79;}

            #Rodape{height: 200px;}

            .ColorFix{background: #a7a7a78e !important;}
        </style>

        <div id="Pag_PDDS" class="TBLAA none Cl">
            <div class="Ct Bt Red">
                <button onclick="NovoPedido()">Novo Pedido +</button>
                <script>
                    const LrOrden=Typ=>Math.floor(MaxNum($$(H_Col_p(Typ,'Stts')).map(e=>Inn(e)))+1)
                    function NovoPedido(){AddROW('PDDS',{RG:AGORA(),OFF:1,Clnt:0,Data:'-',Stts:`${LrOrden('PDDS')}`}) /* AddROW('SERV',{ID:`${D.PDDS}|1`}) */ }
                </script>
                <button onclick="LimparFiltro('PDDS')">Limpar Filtro</button>
            </div>
            <table id="H_PDDS" class="hMin">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PDDS)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('PDDS',J.PDDS.filter(e=>e.OFF===1)))"></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.PDDS)[2],'PDDS'))"></tr></tfoot>
            </table>

            <div style="margin-top:100px"><!--comentários-->
                <ul>
                    <li>se eu Clicar com Direito no th eu mostrarei apenas os que estão visiveis, com esquerdo mostra todos</li>
                    <li>Como usar o Filter, Clicando com Esquerdo Sobrepõe o Filtro, Clicando com Esquerdo Soma os Filtros</li>
                    <br>
                    <li>1 - Ordem de Data não ta Funcionando</li>
                    <li>2 - Pressioanndo Ctrl: Quero Poder Escolher 2 Critérios do Mesmo Filtro</li>
                    <li>3 - Limpar os THSugg apertando Enter</li>
                </ul>
            </div>
        </div>

        <div id="Pag_SERV" class="TBLAA none Cl">
            <div class="Ct Bt">
                <input id="SERV_TrocaCor" type="checkbox" onchange="Condicional()">
                <div id="COnf_SERV" class="Configs Ct"></div><script>Inn($('#COnf_SERV'),Tm_Config('SERV'))</script>
                <button onclick="LimparFiltro('SERV')">Limpar Filtro</button>
            </div>
            <table id="H_SERV" class="hMin">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.SERV)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('SERV',J['SERV']))"></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.SERV)[2],'SERV'))"></tr></tfoot>
            </table>
        </div>

        <div id="Pag_PGMT" class="TBLAA none Cl">
            <div class="Ct Bt">
                <button onclick="AddROW('PGMT')">Nova Linha +</button>
                <input id="PGMT_TrocaCor" type="checkbox" onchange="Condicional()">
                <div id="COnf_PGMT" class="Configs Ct"></div><script>Inn($('#COnf_PGMT'),Tm_Config('PGMT'))</script>
                <button onclick="LimparFiltro('PGMT')">Limpar Filtro</button>
            </div>
            <table id="H_PGMT" class="hMin">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PGMT)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('PGMT',J['PGMT']))"></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.PGMT)[2],'PGMT'))"></tr></tfoot>
            </table>

            <div class="Ct Bt">
                <input id="MPAG_TrocaCor" type="checkbox" onchange="Condicional()">
                <div id="COnf_MPAG" class="Configs Ct"></div><script>Inn($('#COnf_MPAG'),Tm_Config('MPAG'))</script>
                <button onclick="LimparFiltro('MPAG')">Limpar Filtro</button>
            </div>
            <table id="H_MPAG" class="w100 hMax">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.MPAG)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('MPAG',J['MPAG']))"></tbody>
            </table>
        </div>

        <div id="Pag_GRAD" class="TBLAA none Cl">
            <div class="Ct Bt">
                <button onclick="AddROW('GRAD')">Grad +</button>
                <button onclick="AddROW('OOSS')">OS +</button>
                <button onclick="AddROW('UBER')">Uber +</button>
                <div id="COnf_GRAD" class="Configs Ct"></div><script>Inn($('#COnf_GRAD'),Tm_Config('GRAD'))</script>
                <div id="COnf_OOSS" class="Configs Ct"></div><script>Inn($('#COnf_OOSS'),Tm_Config('OOSS'))</script>
                <div id="COnf_UBER" class="Configs Ct"></div><script>Inn($('#COnf_UBER'),Tm_Config('UBER'))</script>
                <input id="UBER_TrocaCor" type="checkbox" onchange="Condicional()">
            </div>
            <table id="H_GRAD" class="w100 hMax">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.GRAD)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('GRAD',J['GRAD']))"></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.GRAD)[2],'GRAD'))"></tr></tfoot>
            </table>
            <table id="H_OOSS" class="w100 hMax">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.OOSS)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('OOSS',J['OOSS']))"></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.OOSS)[2],'OOSS'))"></tr></tfoot>
            </table>
            <table id="H_UBER" class="w100 hMax">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.UBER)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('UBER',J['UBER']))"></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.UBER)[2],'UBER'))"></tr></tfoot>
            </table>
        </div>

        <div id="Pag_CLNT" class="TBLAA none Cl">
            <div class="Ct Bt">
                <button onclick="AddROW('CLNT')">Nova Linha +</button>
                <button onclick="LimparFiltro('CLNT')">Limpar Filtro</button>
            </div>
            <table id="H_CLNT" class="hMin">
                <thead class="Stky"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.CLNT)))"></tr></thead>
                <tbody onload="Inn(this,Tm_Table('CLNT',J['CLNT']))"></tbody>
            </table>
        </div>

        <div id="Pag_LOJA" class=" none Cl">
            <style>
                #Pag_LOJA img {width: 50%;margin: 15px}
            </style>
            <img src="./Fotos/001_Camisa.webp">
            <img src="./Fotos/002_Calão.webp">
            <img src="./Fotos/003_WindFlag.webp">
            <img src="./Fotos/004_Cartão.webp">
            <img src="./Fotos/005_Panfleto.webp">
            <img src="./Fotos/005_Panfleto.webp">
            <img src="./Fotos/006_Talão 2.webp">
        </div>

        <div id="Pag_ORC" class="none Cl" style="margin-top:60px;padding-top:20px">

            <div class="Ct w90"> <!--IMAGENS dos PRODUTOS-->
                <style>
                    #Div-Prod          {margin-bottom:30px; overflow-x:scroll; flex-wrap:nowrap}
                    #Div-Prod > div    {margin:9px 4px; display:flex; flex-direction:column}
                    #Div-Prod span     {margin-left:10px; margin-bottom:10px}
                    #Div-Prod span p   {margin:0px; font-size:9px}
                    #Div-Prod span img {margin:5px; height:30px; width:30px}
                    #Div-Prod span h3  {font-size:19px}
                    #Div-Prod .DivVrnts{margin-top:20px}

                    #Div-Prod .Opts               {top:45px; width:100%; height:30px; left:4px}
                    #Div-Prod .Opts img           {height:23px; width:23px; margin:3px 7px}
                    #Div-Prod .Opts div           {bottom:0; height:30px; width:50%; transition:all 0.1s ease-in-out; color: #000000;}
                        #Div-Prod .Opts div.Pre   {border-radius: 20px 0px 0 0 !important ; background:linear-gradient(to left,#bdb5be,#ffffff)}
                        #Div-Prod .Opts div.Pos   {border-radius: 0px 20px 0 0 !important ; background:linear-gradient(to right, #bdb5be,#ffffff)}
                        #Div-Prod .Opts div:hover {height: 35px ; border-radius: 20px 20px 0 0 !important}
                        #Div-Prod .Opts div.Atv   {z-index: 99 !important; border-radius: 20px 20px 0 0 !important ; box-shadow: -5px 0 10px #3c363f59, 5px 0 10px #3c363f59 ;  background:linear-gradient(to right,#ffffff,#ffffff)} /*background:white;  era pra ter background mas ele ta fazendo Piscar, ai tirei*/ 

                    


                    #Div-Prod .Conteudo{padding-top:10px; z-index:999}

                    #Div-Prod .Conteudo,.offf{height:250px ; width:200px; margin:4px ; padding-bottom:15px; border-radius: 0px 0px 20px 20px ;background:linear-gradient(to top,#b3b3b3,#ffffff); color:#575757;}
                    .offf{ top: 40px; background: #808080d7; color: #ffffff;font-size: 20px;}
                    
                    #Div-Prod .Conteudo .fotO{height:160px; width:150px}

                    #Div-Prod button{background: #ff006a}
                </style>
                <div id="Div-Prod" class="Start"></div>
                <script>


                    function ShowVrnts(e){$$('.DivVrnts > div',Avo(e)).forEach((E,x)=>{
                        $$('div',Pai(e)).forEach((B,x,l)=>{
                            Rmv(B,'Atv')

                            if(x < IdxDe(e)){
                                Add(B,'Pre');Rmv(B,'Pos')
                                B.style.zIndex = (l.length+x) - IdxDe(e)+10
                            }else{
                                Add(B,'Pos');Rmv(B,'Pre')
                                B.style.zIndex = (l.length-x) + IdxDe(e)+10
                            }

                        })
                        Add(e,'Atv')
                        if(x===IdxDe(e)){Show(E)}else{None(E)}
                    })}

                    function tmplt_Prod(e){ //GRANDE
                        return `<div class="Rltv">
                            <span class="Start"><img src="./Prod/IconProd/${e}.svg"><div class="Start2"><h3>${e}</h3><p>${Prod[e].Desc}</p></div></span>
                            <div class="KeyInn none">...</div>

                                <div class="Ct w100 Opts Abslt">${
                                    Vari(e).map((vv,x,l)=>{
                                        const pose = `left:${(x*(200/l.length))-(x===0?0:15)}px;`
                                        const Larg = `width:${(200/l.length)+15}px;`
                                        const Zidx = `z-index:${(l.length-x)+10};`
                                        return `<div style="${pose+Larg+Zidx}" onclick="ShowVrnts(this)" class="Ct Abslt ppt Pos ${x===0?'Atv':''}"><a class="none">${vv}</a> <img name="${vv}" src="./Prod/IconProd/${e}_${vv}.svg"></div>`
                                }).join('')}</div>

                            <div class="Ct DivVrnts">
                            ${Vari(e).map((V,x)=>{ const OBJ = Prod[e].Variantes[V]
                                return `<div class="Conteudo Cl ${x===0?'':'none'}">
                                            ${Prod[e].Stts==="Offff"?`<div class="Ct Abslt offf">Indisponível no momento...</div>`:''}
                                            <div class="KeyVariants">${V}</div>
                                            <img class="fotO" src="./Prod/${e}_${V}.webp" onclick="MdalShow('#Mdal-Prod')">
                                            <div class="Ct w100 ${OBJ.Calc==="QNT" || OBJ.Calc==="OFS"?'none':''}">${'tmplt_mdd'}</div>
                                            <div class="RsutProduto w100 Ev">${/*OBJ.Valr.map((e,idx)=>{return tmplt_VlrTtl(OBJ.Valor[idx],e)}).join('')*/''}</div>
                                            <button class="Abslt tec" onclick="Show('#Rodape-List');CarregaRodape($('img',Pai(this)))">Carrinho</button>
                                </div>`
                            }).join('')}
                            </div>
                        </div>`
                    }

                    

                    function ReOrdenar(){ //  GRANDE
                        $('#Div-Prod').innerHTML = ''
                        AllProd.forEach(e=>{$('#Div-Prod').innerHTML+=tmplt_Prod(e)})
                    }

                    ReOrdenar()
                                    
                </script>
            </div>

            <div id="NovoForm" class="Cl w90 Rltv Rd" style="background:#ffffff0a;padding:10px">

                <div id="CONFIG" class="Abslt" style="right:10px;top:10px"> <!--CONFIGURAÇÕES-->
                    <img draggable="false" src="./SVG/CONFIG.svg" class="NObj" style="width:20px;opacity:0.2" onclick="TogShow($('#CONFIG_Bdj'))">
                    <script>
                        function Hdd_Cblh(Valid){if(Valid){Add($$(`#ORC thead`),'none')}else{Rmv($$(`#ORC thead`),'none')}}
                        function Hdd_Cust(){Tog($$(`[class^="ORC_CUST_"]`),'none')}
                        function Hdd_Crct(){Tog($$(`[class^="ORC_CRCT_"]`),'none')}
                        document.addEventListener("keydown",function(e){if(e.key==="'"){e.preventDefault();Hdd_Cust()}})
                    </script>
                    <style>#CONFIG_Bdj{width: 150px; right: 0px; background: #363636; padding: 10px}</style>
                    <div id="CONFIG_Bdj" class="Abslt none Start2 bndj">
                        <div class="Ct"><input id="Hdd-Cbclh" class="GETConfig" type="checkbox" onchange="Hdd_Cblh(this.checked)" onclick="SaveConfig(this)"><label>Exibir Cabeçalho</label></div>
                        <div class="Ct"><input type="checkbox" onchange="Hdd_Cust()"><label>Exibir Custo</label></div>
                        <div class="Ct"><input type="checkbox" onchange="Hdd_Crct()"><label>Exibir Crescente</label></div>
                    </div>
                </div>

                <script> // Templates e Ações para Tabela de Orçamento
                    // Biblioteca
                        const cla = `[class^="ORC_CUST_"],[class^="ORC_CRCT_"],[class^="ORC_RSUT_"]`
                        const AddTrue=(e,Clss,True)=>$$(cla).forEach(e=>{if(True(e)){Add(e,Clss)}else{Rmv(e,Clss)}})
                        const InNa_RS=(e,val)=>{Inn(e,Tm_RS(val)) ; Nm(e,val)}
                        const ClrSlct=(arry)=>arry.forEach(e=>e.selectedIndex=0) // Deixar Junto com o Clear e Levar pra Biblioteca const Clear = e=>[e].flat().forEach(el=>$(el).value='')
                        
                    // Templates
                        const Tm_ORC_Th=ary=>ary.map(e=>`<th class="${e==''?'':'O_Tx'}">${e==''?'':`<a>${e}</a><p>${D_brev[e]}</p>`}</th>`).join('')
                        const Tm_RmvAll=()=>Inn($('#ORC thead th:nth-child(1 )'),`<div class="ppt HOV O_All" onclick="RmvAll()">❌</div>`)
                        const Tm_ClrAll=()=>Inn($('#ORC thead th:nth-child(10)'),`<div class="ppt HOV O_All" onclick="ClrAll()">🧹</div>`)
                        const Tm_Total=E=>[`CUST_${E} none`,`CRCT_${E} none`,`RSUT_${E}`].map(e=>`<div class="ORC_${e}" name="0">${Tm_RS(0)}</div>`).join('')
                    // Ações
                        function Check_W_Pag(){
                            if(window.innerWidth<=650){$$('#ORC .O_Tx').forEach(th=>Show($('a',th),$('p',th)))}
                            if(window.innerWidth> 650){$$('#ORC .O_Tx').forEach(th=>Show($('p',th),$('a',th)))}
                        }
                        const RecolorVlr=()=>AddTrue($$(cla),'Branc',(e)=>Nm(e)==0)
                        const Zerar=tr=>$$(cla,tr).forEach(e=>InNa_RS(e,0))
                        const AddRow=tr=>{const a = tr.cloneNode(true) ; $$('input',a).forEach(e=>e.value='') ; Zerar(a) ; Insert(Pai(tr)).After(a,tr)}
                    // Clean e Remove
                        const RmvAll=()=>{$$(`#ORC tbody td:nth-child(1 ) > div`).forEach((E,X)=>{if(X==0){return}else{DispClick(E)}}) ; ReloadTotal()}
                        const ClrAll=()=>{$$(`#ORC tbody td:nth-child(10) > div`).forEach(E=>DispClick(E)) ; ReloadTotal()}
                        const ClrRow=tr=>{Clear($$('input',tr)) ; ClrSlct($$('select',tr)) ; Zerar(tr)}
                        const RmvRow=tr=>tr.remove()
                    
                    // Objetivo aqui é remover o Tamanho dessas Strings (Principalmente os Querys)
                </script>
                <style>  /*CSS da Tabela de Orçamento*/
                    #ORC input,#ORC select{width:100% !important ; margin:0}
                    #ORC .RS{font-size:7px}
                    #ORC td{padding: 1px}
                    #ORC th a,#ORC th p{display: flex;align-items: center;justify-content: center;}
                    .Branc{color: #ffffff5d !important}
                    .imita{height: 30px !important; background: #ffffff11}
                    .Final a{font-size:20px ; font-family:var(--Medi)}
                    .Final .RS{margin-right:3px}
                    .sOFF{opacity:0.3}
                    [class^="ORC_CUST_"]{color:#ff6565}
                    [class^="ORC_CRCT_"]{color:#65b5ff}
                    [class^="ORC_RSUT_"]{color:#48ff00}
                </style>
                <table id="ORC" class="w90" onkeydown="HandArrow(this,event)">
                    <thead class="none"><tr onload="Inn(this,Tm_ORC_Th(['','','Serv','Tipo','Lrg','Alt','Qnt','Und','SbTt','']));Tm_RmvAll();Tm_ClrAll()"></tr></thead>
                    <tbody>
                        <tr class="TrRow" oninput="ORC_Calc(this);RecolorVlr()" onchange="ValidOpts()">
                            <td width="15px" style="fill:#ff0000"><div class="ppt OrcRmv" onclick="RmvRow(_tr(this));Rload_Tbl('#ORC');ReloadTotal()" onload="Inn(this,SVG.Fexa)"></div></td><!--❌-->
                            <td width="15px" style="fill:#ffa500"><div class="ppt OrcAdd" onclick="AddRow(_tr(this));Rload_Tbl('#ORC');ReloadTotal()" onload="Inn(this,SVG.Mais)"></div></td><!--➕-->
                            <td><select class="OrcServ" onchange="SERVChang(this)" onload="Inn(this,Tm_OptsGraff(['Serviços',...AllServM2,...AllServOFS]))"></select></td>
                            <td><select class="OrcTipo" onchange="TIPOChang(this)" onload="Inn(this,Tm_Opts(['Tipo']))"></select></td>
                            <td width="10%">
                                <select class="OrcCbmt none" onchange="CBMTChang(this)" onload="Inn(this,Tm_Opts(['Acabamento']))"></select>
                                <input class="ORC_INPT_Lrg" placeholder="Largura" oninput="MaskNum(this)">
                            </td>
                            <td width="10%">
                                <select class="OrcGram none" onchange="GRAMChang(this)" onload="Inn(this,Tm_Opts(['Gramatura']))"></select>
                                <input class="ORC_INPT_Alt" placeholder="Altura" oninput="MaskNum(this)">
                            </td>
                            <td width="10%">
                                <select class="OrcQntt none" onchange="QNTTChang(this)" onload="Inn(this,Tm_Opts(['Qnt']))"></select>
                                <input class="ORC_INPT_Qnt" placeholder="Quantidade">
                            </td>
                            <td width="10%"  onload="Inn(this,Tm_Total('Vund' ))" class="imita RD"></td>
                            <td width="10%"  onload="Inn(this,Tm_Total('SbTt' ))" class="imita RD"></td>
                            <td width="15px" style="fill:#ffa500"><div class="ppt OrcClr" onclick="ClrRow(_tr(this));Rload_Tbl('#ORC');ReloadTotal()" onload="Inn(this,SVG.Cler)"></div></td><!--🧹-->
                        </tr>
                    </tbody>
                </table>

                <script> // Funções do Tbody
                    function SERVChang(e){const Lista = ObjKey(Prod[e.value].Variantes);Inn($('.OrcTipo',_tr(e)),Tm_Opts(['Tipo',...Lista])) ; Tog_M2_OFS_UND(e)}
                    function TIPOChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;Inn($('.OrcCbmt',_tr(e)),Tm_Opts(['Acabamento',...Uniq(Lista.map(e=>e[0]))]))}
                    function CBMTChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;Inn($('.OrcGram',_tr(e)),Tm_Opts(['Acabamento',...Uniq(Lista.map(e=>e[1]))]))}
                    function GRAMChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;Inn($('.OrcQntt',_tr(e)),Tm_Opts(['Acabamento',...Uniq(Lista.map(e=>e[2])[0].map(e=>e[0]))]))}
                    function QNTTChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;ORC_Calc(_tr(e),Lista)}

                    function ORC_Calc(tr,Lista=null){
                        const TotalCress=(Valr,e)=>Math.round(e*(Valr+Valr*Crecent(e)))

                        const Serv = $('.OrcServ',tr).value
                        const Tipo = $('.OrcTipo',tr).value
                        const Cbmt = $('.OrcCbmt',tr).value
                        const Gram = $('.OrcGram',tr).value
                        const Qntt = $('.OrcQntt',tr).value
                        const Lrg = Num($('.ORC_INPT_Lrg',tr).value)
                        const Alt = Num($('.ORC_INPT_Alt',tr).value)
                        const Qnt = Num($('.ORC_INPT_Qnt',tr).value)

                        const Calc = Prod[Serv].Calc
                        const M2 = Prod[Serv]['Variantes'][Tipo]
                        const QNT = Num(Qntt.replace('.',''))

                        let F_Cust = 0
                        let F_Valr = 0
                        // Só pra OFS
                        if(Calc=='OFS'){
                            const filt   = Lista.filter(e=>e[0]===Cbmt && e[1]===Gram)
                            const filt2  = filt [0][2].filter(e=>e[0]===Qntt)
                            F_Cust = filt2[0][2]
                            F_Valr = filt2[0][1]
                        }

                        const Cust = M2?.Cust ?? 0
                        const Valr = M2?.Valr ?? 0
                        const CUSTO = Calc=='M2' ? Cust*Lrg*Alt*Qnt : F_Cust
                        const CRCT  = Calc=='M2' ? Valr*Lrg*Alt*Qnt : F_Cust
                        const VALOR = Calc=='M2' ? TotalCress(Valr,Lrg*Alt*Qnt) : F_Valr

                        InNa_RS($('.ORC_CUST_Vund',tr),CUSTO/Qnt)
                        InNa_RS($('.ORC_CUST_SbTt',tr),CUSTO)
                        InNa_RS($('.ORC_CRCT_Vund',tr),CRCT/Qnt)
                        InNa_RS($('.ORC_CRCT_SbTt',tr),CRCT)
                        InNa_RS($('.ORC_RSUT_Vund',tr),VALOR/Qnt)
                        InNa_RS($('.ORC_RSUT_SbTt',tr),VALOR)

                        ReloadTotal()
                    }
                    
                    function Tog_M2_OFS_UND(e){
                        if(Prod[e.value].Calc === 'M2'){console.log('M2')
                            None($$('.OrcCbmt,.OrcGram,.OrcQntt',_tr(e)))
                            Show($$('.ORC_INPT_Lrg,.ORC_INPT_Alt,.ORC_INPT_Qnt',_tr(e)))
                        }
                        if(Prod[e.value].Calc === 'OFS'){console.log('OFS')
                            Show($$('.OrcCbmt,.OrcGram,.OrcQntt',_tr(e)))
                            None($$('.ORC_INPT_Lrg,.ORC_INPT_Alt,.ORC_INPT_Qnt',_tr(e)))
                        }
                        if(Prod[e.value].Calc === 'UND'){console.log('UND')
                            None($$('.OrcCbmt,.OrcGram',_tr(e)))
                            Show($$('.ORC_INPT_Qnt',_tr(e)))
                        }
                    }

                    function ValidOpts(){$$('#ORC select').forEach(e=>$$('option',e).length==1 ? Add(e,'sOFF') : Rmv(e,'sOFF'))}

                    function Tm_OptsGraff(Ary,Stg=null){ //  Função que Carrega os Serviços dentro dos Grupos
                        const GpIt={}, GpOF={}
                        ObjEtr(Prod).forEach(([k,v])=>{GpIt[k] = v.Calc ; GpOF[k] = v.Stts})

                        return `<option value="" disabled selected>${Ary[0]}</option>
                            ${Object.entries(Ary.slice(1).reduce((a,e)=>{
                                (a[GpIt[e]]||=[]).push(`<option value=\"${e}\" ${Stg === e ? 'selected' : ''} ${GpOF[e] === 'Offf' ? 'style=\"color:red;\"' : ''}>${e}</option>`);return a
                            },{})).map(([g,o]) => `<optgroup label=\"${g}\">${o.join('')}</optgroup>`).join('')}
                        `}
                </script>

                <div> <!--Valores TOTAL-->
                    <p>Total</p>
                    <div class="ORC_CUST_FINAL Final none"></div>
                    <div class="ORC_CRCT_FINAL Final none"></div>
                    <div class="ORC_RSUT_FINAL Final"     ></div>
                    <script>
                        function ReloadTotal(){
                            Inn($('.ORC_CUST_FINAL'),Tm_RS(SOMA($$('.ORC_CUST_SbTt').map(e=>Nm(e)))))
                            Inn($('.ORC_CRCT_FINAL'),Tm_RS(SOMA($$('.ORC_CRCT_SbTt').map(e=>Nm(e)))))
                            Inn($('.ORC_RSUT_FINAL'),Tm_RS(SOMA($$('.ORC_RSUT_SbTt').map(e=>Nm(e)))))}
                    </script>
                </div>

                <script> // Funções Dedicadas a Tabelas de ORÇAMENTO
                    function Rload_Tbl(Tbl){Upp_Tabela(Tbl) ; Upp_RowCol(Tbl) ; RecolorVlr(Tbl) ; RecolorVlr()} ; Rload_Tbl('#ORC')
                    function Upp_Tabela(Tbl){
                        $$(`${Tbl} tbody tr`).length == 1 ? None($$('.OrcRmv',$(Tbl))) : Show($$('.OrcRmv',$(Tbl))) // Remover o X
                        $$(`${Tbl} tbody tr`).length == 1 ? None($$('.O_All')) : Show($$('.O_All'))
                        // aqui pode ter mais coisas pra Atualizar a Tabela
                    }
                    function Upp_RowCol(Tbl){
                        const Lmt = $$(`${Tbl} tr:nth-child(1) input`).length
                        $$(`${Tbl} input`).forEach((I,x)=>{
                            I.dataset.row = Math.floor(x/Lmt)
                            I.dataset.col = x % Lmt})
                    }
                    function HandArrow(Tbl,e){
                        if (e.key === "Enter"){
                            const Inpts = $$(`input`,Tbl)
                            const Elemt = $(':focus')
                            const Next = Inpts[Array.from(Inpts).indexOf(Elemt)+1]
                            if(Next){Next.focus() ; Next.select() }}
                        let act = document.activeElement
                        if (act.tagName !== "INPUT") return
                        let r = +act.dataset.row, c = +act.dataset.col, nxt
                        if (e.key === "ArrowRight") nxt = `[data-row='${ r }'][data-col='${c+1}']`
                        if (e.key === "ArrowLeft")  nxt = `[data-row='${ r }'][data-col='${c-1}']`
                        if (e.key === "ArrowDown")  nxt = `[data-row='${r+1}'][data-col='${ c }']`
                        if (e.key === "ArrowUp")    nxt = `[data-row='${r-1}'][data-col='${ c }']`
                        if (nxt){$(nxt)?.focus() ; setTimeout(()=>$(nxt)?.select(),0)}
                    }

                    window.addEventListener("resize",Check_W_Pag)
                    Check_W_Pag()
                    ValidOpts()
                </script>

                <div class="w100 Ct" style="margin-top: 80px"> <!--Informações Extras-->
                    <div class="Cl"><label>Nome</label><input placeholder="Nome"></div>
                    <div class="Cl"><label>Contato</label><input placeholder="Contato"></div>
                    <div class="Cl"><label>Endereço</label><input placeholder="Endereço"></div>
                    <div class="Cl"><label>Comentário</label><input placeholder="Comentário"></div>
                </div>
                <button onclick="VerNota()">Ver Nota</button>
                </form>
            </div>

            <div><!--Arte-->
                <style>
                    .container {
                        max-width: 300px;
                        margin: auto;
                        padding: 20px;
                        border: 1px solid #ccc;
                        border-radius: 10px;
                        box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
                    }
                    .tootal, .tootal span {
                        font-size: 18px;
                        font-weight: bold;
                        color: #00df00;
                    }
                    .Pcntalmt{
                        margin-top: 15px;
                        color: gray;
                    }
                </style>

                <div class="container" style="margin-bottom: 150px;margin-top: 50px;">
                    <h3>Orçamento de Arte:</h3>

                    <select id="designOptions" onchange="EscolheARTE()" class="w100">
                        <option value="20" data-extra="0">Post Digital - R$ 20,00</option>
                        <option value="20" data-extra="4">Carrossel - R$ 20,00 (+R$ 4,00 por unidade)</option>
                        <option value="25" data-extra="0">Banner Digital - R$ 25,00</option>
                        <option value="25" data-extra="0">Cartão de Visita - R$ 25,00</option>
                        <option value="50" data-extra="0">Flyer - R$ 50,00</option>
                        <option value="30" data-extra="0">Panfleto - R$ 30,00</option>
                        <option value="20" data-extra="0">Wing Banner - R$ 20,00</option>
                        <option value="50" data-extra="10">Cardápio - R$ 50,00 (+R$ 10,00 por página)</option>
                        <option value="25" data-extra="3">Backdrop Simples - R$ 25,00 (+R$ 3,00 por patrocinador)</option>
                        <option value="100" data-extra="0">Logo - R$ 100,00</option>
                        <option value="400" data-extra="0">Identidade - R$ 400,00</option>
                        <option value="40" data-extra="0">Manipulação/Tratamento - R$ 40,00</option>
                        <option value="25" data-extra="0">Vetorização - R$ 25,00</option>
                        <option value="5" data-extra="0">Banner Simples Texto - R$ 5,00</option>
                        <option value="30" data-extra="3">Arte para Camisa - R$ 30,00 (+R$ 3,00 por variação)</option>
                    </select>
                    
                    <label for="quantidade">Quantidade:</label><input type="number" id="quantidade" value="1" min="1" oninput="EscolheARTE()">

                    </select>
                    <div id="Bruxos">
                        <label><input type="checkbox" value="20" onchange="EscolheARTE()"> Identidade Visual (20%)</label><br>
                        <label><input type="checkbox" value="15" onchange="EscolheARTE()"> Roteirizar (15%)</label><br>
                        <label><input type="checkbox" value="25" onchange="EscolheARTE()"> Criar Logomarca (25%)</label><br>
                        <label><input type="checkbox" value="8"  onchange="EscolheARTE()"> Digitação (8%)</label><br>
                        <label><input type="checkbox" value="7"  onchange="EscolheARTE()"> Escolha de Imagens (7%)</label><br>
                        <label><input type="checkbox" value="5"  onchange="EscolheARTE()"> Montagem (5%)</label><br>
                    </div>

                    <div class="Pcntalmt"></div>
                    <div class="tootal">Total: R$ <span id="total">0.00</span></div>
                </div>

                <script>
                    function EscolheARTE(){
                        const Slt = $("#designOptions")
                        const Qnt = $("#quantidade").value
                        const Val = parseFloat(Slt.value)
                        const Ext = parseFloat(Slt.options[Slt.selectedIndex].getAttribute("data-extra")) || 0
                        let Porcent = 0
                        $$('#Bruxos input[type="checkbox"]:checked').forEach(e=>{console.log(e) ; Porcent += parseFloat(e.value)})
                        const Pcnt = Porcent.toFixed(2)/100
                        const Total = Val+(Ext*(Qnt-1))
                        const Total2 = Total+(Total*Pcnt)

                        $(".Pcntalmt").innerHTML = `Porcentagem: R$ ${parseFloat(Pcnt)*100}%`
                        $(".tootal").innerHTML = `R$ ${Total2.toFixed(2).replace('.', ',')}`
                    }

                </script>
            </div>
        </div>
    </div>

    <style> /*CSS dos Modais*/
        .Dark #FModal>div{background:#1b1b1b}
        .Lite #FModal>div{background:#ffffff}
        .Dark #FModal > #ModalNota{background:#ffffff;color:black}
              #FModal h1{font-size:25px}

        #ModalLogin{width:300px;height:400px}
        #ModalCadastro{width:70%}
        #Modal-Item .Feed{width:400px;height:400px}
        #Modal-Item .Stry{width:250px;height:440px}
        #Modal-Info1,#Modal-Info2{padding:30px}
        #InnerVazio input{position:absolute;width:200px}

        #ModalNota>div{padding:5px 0px}
        #Nota-Clnt>div>div>div{margin:0px 5px}
        #ModalNota img{width:50px;height:50px}
        .Start2 p{margin:1px 5px}
        #LugarFotoNotta{margin-right:3px}

        #TabelaNotinha{text-align: center;border-collapse: collapse;border: #d8d8d8 solid 1px;}
        #TabelaNotinha tr{background: #5F009E;color: white;font-size: 13px;}
        #TabelaNotinha td{background: #ffffff;color: black; padding: 3px;font-size: 13px;}
        #TabelaNotinha tfoot > tr > th {background: #575757}
        #TabelaNotinha td:nth-child(5){font-size: 13px;color:#4f4f4f;}
        #TabelaNotinha td:nth-child(6){font-weight: bold}
    </style>

    <div id="FModal" class="Ct">
        <script>function SairMdal(){None('#FModal')} </script>

        <div id="ModalLogin" class="Ct Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div class="Bt Loginn">Login</div>
              <div class="Ct Start">
                <label for="Senha">Senha</label>
                <input id="Inpt-Senha" class="Inputss" type="password" onkeyup="TestSenha(event,this)">
              </div>
              <span id="Span-Login" class="erro"></span>
              <div class="Bt">
                <button class="Ct w40" onclick="TestSenha('','#Inpt-Senha')">Logar</button>
                <button class="Ct w40" onclick="Deslogar();SairMdal()">Sair</button>
              </div>
        </div>

        <div id="FormIMG"></div>

        <div id="Mdal-Prod">
            fotrinhas
        </div>
    
        <div id="ModalNota" class="Cl Rltv Rd media30">
        <div class="Close Ct" onclick="SairMdal()">X</div>
        <div id="Titulo-Nota" class="w100 Bt Hr"></div>
            <div id="Nota-Empresa" class="Ct Row Hr Bt w100">
                <div class="Ct">
                <div id="LugarFotoNotta"><img src="Img/Logo2.png"></div>
                <div>
                    <h2>INFINITY GRAFF</h2>
                    <h2>IMPRESSÃO DIGITAL</h2>
                </div>
                </div>
        
                <div class="Start2">
                    <div class="FtBd Ct">Endereço: <p>Estrada do Tip, N° 54A</p></div>
                    <div class="FtBd Ct">Cidade: <p>SÃO LOURENÇO DA MATA</p></div>
                    <div class="FtBd Ct">Email: <p>infinitygraff@outlook.com</p></div>
                    <div class="FtBd Ct">Contato: <p class="B">(81) 98726.5401</p></div>
                </div>
            </div>
        
            <div class="Ct Cl Hr">
                <h2>CUPOM FISCAL</h2>
                <div id="DataNota"></div>
            </div>
        
            <div class="Start2 Hr">
                <div class="Ct"><p class="FtBd">ORDEM DE SERVIÇO:<p><p>${id}</p></div>
                <div class="Ct"><p class="FtBd">Data:</p><p>00/00/2023</p></div>
            </div>
        
            <div id="Nota-Clnt" class="Row w100 Ev">
                <div>
                <div class="Ct FtLt">Nome:     <div data="Clnt"></div> </div>
                <div class="Ct FtLt">Fone:     <div data="Cntt"></div> </div>
                </div>
                <div>
                <div class="Ct FtLt">Endereço: <div data="Local"></div></div>
                <div class="Ct FtLt">Cidade:   <div data="City"></div> </div>
                </div>
                <div>
                <div class="Ct FtLt">CPF/CNPJ: <div data="CNPJ"></div> </div>
                </div>
            </div>
        
            <div id="ConteudoNota" class="w100">
                <table id="TabelaNotinha" class="w100"><thead><tr><th style="color: white">Serviços</th></tr></thead></table>
                <div id="DescrNota" class="Ct Cl"></div>
                <h2 id="TotalNotta" class="Hr Ct"></h2>
            </div>
        
            <div class="w100 Ct">
            <button id="trocatroca" class="BTNota Ct RD magem" onclick="troctroc()">Troca-Troca</button>
            <button class="BTNota Ct RD magem" onclick="SairMdal()">Cancelar</button>
            <button class="BTNota Ct RD magem" onclick="NewPDF()">Imprimir<div id="imgnotta" class="Ct"></div></button>
            </div>
        </div>

        <div id="EditarPerfil" class="Cl Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div>Foto</div>
            <img src="./Img/Perfil_Allan.png" width="100">
            <div>Nome do Usuário</div>
            <input type="text" placeholder="Senha Atual">
            <input type="text" placeholder="Nova Senha">
            <input type="text" placeholder="Repetir Senha">
        </div>

        <div id="ConfigPag" class="Cl Rltv Rd">
            <div class="Ct Close" onclick="SairMdal()">X</div>
            <div><input id="DarkLite" type="checkbox" class="GETConfig" onchange="DarkLite2('body',this.checked)" onclick="SaveConfig(this)"> <label>Modo Escuro</label></div>
            <div><input id="TamFonte" type="range"> <label>Tamanho de Fonte</label></div>
        </div>

        <div id="PagSUPORTE" class="Cl Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div>informações de Suporte</div>
            <div>dicas de como usar o APP, principalmente pra mim</div>
        </div>
    </div>
</body>

<script> // Funções de Login
    let LgTp = {'Nome':'','Cod':'','Img':''} ; function SemLogin(){return LgTp.Cod===''}
    function TestSenha(e,ipt=null){

        function CrypPass(senha){
            const Cryp = senha.split('').map((c,idx)=>{
                if(/[0-9]/.test(c)){let N=parseInt(c)
                N=N===9?0:N+(idx%2===1?4:1);return N.toString()}
                else if(/[A-Za-z]/.test(c)){
                let L=c.charCodeAt(0)+(idx%2===1?5:1)
                if(L>90&&L<97)L-=26
                else if(L>122)L-=26
                return String.fromCharCode(L)}else{return c}})
            var par = [] ; var imp = []
            Cryp.forEach((e,idx)=>{idx%2===0?par.push(e):imp.push(e)})
            const Par=par.reverse().flatMap(C=>[`3${C}$`,`r${C}-`,`3${C}&`])
            const Imp=imp.reverse().flatMap(C=>[`-${C}e`,`V${C}9`,`@${C}K`])
            return Par.concat(Imp).join('')
        }

        const User={
            '34$r4-34&-7eV79@7K':['(Baby)','Baby Massia','Img/Perfil_Baby.png'],
            '32$r2-32&-6eV69@6K':['(Alan)','Allan MacLovin','Img/Perfil_Allan.png'],
            '31$r1-31&-4eV49@4K':['(Lisa)','Lisa Caramelo','Img/Perfil_Lisa.png'],
            '36$r6-36&-9eV99@9K':['(Segu)','Segunda Hippie','Img/Perfil_Segunda.png']
        }

        if(e==='Deslog'){
            Nm($('#Login-Top'),'')
            Inn('.LgTp2',IconLogin)
            Show('.LgTp')
            None('.ImgPerfil')
            $('.ImgPerfil').src=''
        
        }else if(e==='Storage'){ if(User[ipt] === undefined || User[ipt] === null){return}
            else{
                // localStorage.removeItem('SenhaCryp')
                // localStorage.setItem('SenhaCryp',input)
                Nm($('#Login-Top'),'Logado')
                Inn('.LgTp2',User[ipt][1])
                Show('.ImgPerfil')
                $('.ImgPerfil').src=User[ipt][2]
            }
        }
        else{
            let inpt=e==='' ? $(ipt) : ipt
            if(KeyEnter(e)||e===''){
                const Cryp = CrypPass(inpt.value)
                if(User[Cryp]){

                    None($('#IMG-PerfiL'))
                    SairMdal()
                    localStorage.removeItem('SenhaCryp')
                    localStorage.setItem('SenhaCryp',Cryp)
                    Nm($('#Login-Top'),"Logado")
                    Inn('.LgTp2',User[Cryp][1])
                    Show('.ImgPerfil')
                    Show('.ImgPerfil2')
                    $('.ImgPerfil').src=User[Cryp][2]

                }else{Inn('#Span-Login','Senha Inválida') ; inpt.placeholder='Senha Inválida'}
                inpt.value='';inpt.focus()
                console.log('Logou')
            }
        }
    }
    
    function LoginStorage(){const Pass = localStorage.getItem('SenhaCryp');if(Pass===null){return};TestSenha('Storage',Pass)}
    function Deslogar()    {localStorage.removeItem('SenhaCryp');TestSenha('Deslog','')}
    LoginStorage()
    /*
    idéias pra o Login
        Login com LocalStorage
        deixar o CryPass() na BaseDados da Biblioteca
        criar um Objeto no inicio com Nome User q vai passar todos os Dados do Usuário
        e é atravéz desses dados que toda a interface vai carregar de acordo com o usuário
        suas configurações e personalziações, suas informações e suas Listas de Pedidos
    */
</script>

<script> // Coisas da NOTA
    function VerNota(){
        MdalShow('#ModalNota')
        // Aqui em Baixo coletar tudo q ta no orçamento e Jogar pra cá!
        // deixar uma Opção pra Copiar o Texto
    }
</script>

<script> // Veio da Tabela MyPlan
    function AtivaEventos(){window.addEventListener("scroll",()=>{scrollPosition=[window.scrollX,window.scrollY]})}
    function Rfresh(){(async()=>{await GetJSON()})()}
    async function GetJSON(){
        async function UparClnt(){FetchPOST(Link+'/postUpar_Clnt_Data',[''])}
        async function UparLink(){FetchPOST(Link+'/postUparLink',[''])}
        async function UparLinkMPAG(){FetchPOST(Link+'/postUparLinkMPAG',[''])}
        async function Get_Json(End){return new Promise(r=>{FetchGET(`${Link}/getJSON/${End}`,e=>{D[End]=MAX(e,'ID')+1;J[End]=e;r()})})}
        await UparClnt() ; await UparLink() ; await UparLinkMPAG()
        for(let end of ['CLNT','SERV','PGMT','UBER','GRAD','OOSS','PDDS','MPAG']){await Get_Json(end)}
        PosGet()
    }
    let PrimeiraVez = true
    function PosGet(){
        // if(PrimeiraVez){GetConfig();PrimeiraVez=false} // tem um erro no GetConfig() no index 0
        Onloads('body');Tm_Bndj();Format();Format_Bndj_Clnt()
        NavPag(Atual['Pag'])
        // GetConfigOrdem()
        // Condicional()
        // window.scrollTo(scrollPosition[0],scrollPosition[1])
        // ReStts()
        // FinaldeTUDO()
    }

    async function EditCell(e,vall=null){
        const R = D_Rastr(_td(e))
        const Val = vall===""?"":VAL(_td(e))
        if(Val===Nm(e)){return}
        const arrays = [R[0],R[1],R[2],vall===""?"":vall?vall:Val] // [Tabela,Linha,Coluna,NovoValor]
        Nm(e,e.textContent.trim())
        console.log('arrayFinal',arrays)
        if(R[2]==='Data' && R[3]==='Inpt' || R[3]==='Sugg'){EditJSON(arrays)}else{EditJSON(arrays)}
        RRecolor()
    }
    
    function EditVlr(e,E){
        const R = D_Rastr(_td(e))
        console.log('Chamou',E,R)
    }///////////////////////////////////////////////////////////////

    function EditCellFake(eu){ 
        const val = Nm($('input',Pai(eu)))
        const R = D_Rastr(Avo(eu.closest('.Bandj')))
        const arrays = (['PDDS',R[1],'Clnt',val]) // [Tabela,Linha,Coluna,NovoValor]
        console.log(arrays)
        EditJSON(arrays)
    }
    const EditCellFake2=(e)=>{
        const R = D_Rastr(_td(e))
        e.value.split('|').forEach(E=>{
            // isso ta rodando 2 vezes mesmo quando só tem 1 no caso quando eu não digioto o |
            // talvez seja pq ta rodando 2 vezes, uma no Enter, e outra no Onblur
            AddROW('PGMT',{Link:R[1],Valr:RgxPixAV(E)[1],Form:RgxPixAV(E)[2]})
        })
    }

    const TesteClnt=(e,td=null)=>{
        if($('#ConfirCliente').checked){console.log('Perguntar')}
            if(confirm(`Tem Certeza que quer salvar: ${e.value} como Cliente?`)){
                if(Nmame(e)){return Nmame(e)}else{AddROW('CLNT',{Clnt:e.value});if(td){EditCell(td,D['CLNT'])} ; return D['CLNT']}}
    }

    function add_PDDS(e,nome){
        const TestePgmt=()=>{if(e[5]){AddROW('PGMT',{Desc:e[5]});return D['PGMT']}else{return '.'}}
        const TesteServ=()=>{AddROW('SERV',{ID:`${D['PDDS']}|1`,Serv:e[2],Desc:e[3],Valr:Num(e[4]),Forn:e[6],OK:false});return 1}
        AddROW('PDDS',{RG:AGORA(),OFF:1,Data:DMY(e[0]),Serv:TesteServ(),Clnt:TesteClnt(nome),Pgmt:TestePgmt()}) 
        Clear($$('#FormPDDS input, #FormPDDS select'))
        // neste Add_PDDS: quando salvar Pgmnt tem que Linkar o ID do Pedido
    }

    function NovaLinhaBDj(Eu){ // isso talvez deva ir la pra baixo
        const R = D_Rastr(_td(Eu))
        const Sv = $$('tbody tr',_td(Eu))
        if(R[2]=='Pgmt'){ AddROW(R[2].toUpperCase(),{Link:`${R[1]}`}) }
        if(R[2]=='Serv'){ AddROW(R[2].toUpperCase(),{ID:`${R[1]}|${Sv.length}`}) }
    }

    // Edit e Delet ta Funcionando
        // os que execulta antes de atualizar o Json "//FAST//"
        function AddROW(Pln,obj=null){/*AddRowPratica(Pln,obj,'<')*/ ; AddROWConst(Pln,obj) ; /* FetchPOST(Link+'/postLINHA',[Pln,obj],(e)=>{ALERT(e)}) */ }


            function AddRowPratica(Pln,obj,Pose){
                let tbody =  $(`#H_${Pln} > tbody`)
                let Colll = $$(`#H_${Pln} > thead th p`).map(p=>Inn(p))
                let Clone =  $('tr',tbody).cloneNode(true)
                $$(':scope > td',Clone).forEach((td,x)=>{if($('p',td)){Inn($('p',td),obj[Colll[x]]??'')}}) // Atualizar (este if ta aqui só por que a Lixeira não tem uma Tag <p> dai ela retorna Null) Atualizar de Forma Genérica (q Funcione com td Input, Edit, CheckBox tudo!)
                Pose === "<" ? tbody.prepend(Clone) : tbody.appendChild(Clone)
                // o Clone não ta Exibindo Bandeja corretamente talvez por causa da exibição de bandeija depende do ID, e não ta sendo passado corretamente na hora do clone
            }


        function RmvROW(Typ,id,eu){eu.closest('tr').remove() ; FetchPOST(Link+'/postDELETE' ,[Typ,id],(e)=>{ALERT(e)})}
        function ExcROW(Typ,id,eu){eu.closest('tr').remove() ; FetchPOST(Link+'/postEXCLUIR',[Typ,id],(e)=>{ALERT(e)})}
        function EditJSON(arry){FetchPOST(Link+'/postEDIT',arry,(e)=>{ALERT(e);return e})}


        function AddROWConst(Typ,obj=null){ // ESTE É BEM MELHOR que o AddRowPratica() NA TORA (depois mudar pra inserir no Inicio ou no Final)
            const LastRow=(obj,id)=>obj.reduce((max,e)=>Math.max(max,e[id]),0)
            const Arq = J[Typ]
            const Novo = {...Arq[Arq.length-1]}                    // Clona Nova Linha
            ObjKey(Novo).forEach(k=>(Novo[k]=''))                  // Limpa tudo
            Novo['ID'] = LastRow(Arq,'ID') + 1                     // Muda Id para um Novo
            if(obj){ObjEtr(obj).forEach((K)=>{Novo[K[0]] = K[1]})} // Atualizar o Restante dos Dados
            J[Typ].push(Novo)
            console.log(Novo)

            PosGet()
        }


    

    AtivaEventos()
    PosGet()

    
    
</script>

<div id="relatoio"></div>

<button onclick="GetConfig()"> Salve </button>
<button onclick="console.log('trigger Livre')">trigger</button>



<script> // Storage Salva Configurações

    function Disparos(e){console.log('Dispoaro >') ; e.dispatchEvent(new Event('change')); console.log('< Dispoaro')}

    function SaveConfig(e){StogeSet(e.id,Vll(e)) ; console.log('Save',e.id,Vll(e))}

    function GetConfig(){$$('.GETConfig').forEach(e=>{
        const Valor = StogeGet(e.id)
        if(Valor){

            llv2(e,Valor);Disparos(e)

        }})}
    

    window.onload = () => {GetConfig()}

    // function GetConfigOrdem(){OrdenarRows($(`#H_PDDS thead tr th:nth-child(${8}) a`),7,'p','desc')}
    // function savecoifigTABLE(){StogeSet('Orden',x)}
    // Save para MenuNav
</script>

<script> // comentários
    
    // Permitir Remover o Fx do <Header>
    // tenho q fazer uma Fila de Fetcher, pra não dar conflito caso faça varios d euma só vez
    // Método de Pesquisa
    // Mostrar o Valor por M2 ao Lado do Option
    // se não tiver valor Atualizado fica Vermelho, ou Inativo
    // Permitir Drag nas as Linhas
    // imitar Bureal no Futuro (deixando todas bandeijas aberta)
    // Exibir a Lista de Produtos e Serviços como se Fosse um Menu de Pesquisa igual da primeira página com Fotinha e tal
    // em quanto seleciona as opções o Menu de pesquisa já fica no Papo
    

    // no Select se oq está atualmente selecionado, existir no option da próxima rodada, então mantem ele
    // selecionar option automaticamente caso tenha apeans 1
    // quando Limpar, também limpa os Selects
    // Proibir Drag em Imagens

    // a soma de metros de produtos do mesmo tipo tem q resultar na Diminuição da Crescente
    // o Valor Crescente deve ficar verde, se ele for igual ao valor Final
    
    // qual foi o PC q deu a entrada, precisa registrar tbm, Adicionar RG tbm em Pedidos, e em Clientes e Pagamento
</script>

</html>
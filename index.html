<!DOCTYPE html>
<html lang='pt-BR'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orcamento</title>
    <link rel="icon" type="image/x-icon" href="Img/FavG_32.png">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/fontes.css"        rel="stylesheet">
    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/CSSBiblioteca.css" rel="stylesheet">
    <script src="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/PreScript.js"      ></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
        <script src="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/SB_Crud.js"        ></script>
        <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/SB_Crud.css">
    
        <!--
            <link href="../MyBiblioteca/SB_Crud.css" rel="stylesheet">
            <script src="../MyBiblioteca/SB_Crud.js"      ></script>
       -->
    <!--
        <link  href="../MyBiblioteca/fontes.css"        rel="stylesheet">
        <link  href="../MyBiblioteca/CSSBiblioteca.css" rel="stylesheet">
       
        <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/fontes.css"        rel="stylesheet">
        <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/CSSBiblioteca.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/PreScript.js"      ></script>
    -->
    
    <link  href="./CssGRAFF.css" rel="stylesheet">
    <script src="./BaseGRAFF.js"></script>
    <script src="./BiblGRAFF.js"></script>
    <script src="./Gera3D.js"></script>
    
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script> -->
    <!--<script src="https://threejs.org/build/three.js"></script>-->
</head>

<script> // Configuração do SupaBase
    const SUPABASE_URL      = "https://adxigvfxtafvlmpvwwvb.supabase.co"
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkeGlndmZ4dGFmdmxtcHZ3d3ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1Njc1NTEsImV4cCI6MjA2NzE0MzU1MX0.wc90qDuSNhtolJBd4qLEux3xCwJwPuTTFb3gZMKUBYU"
    const supaBASE          = window.supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY)
    const BASE_URL          = `https://adxigvfxtafvlmpvwwvb.supabase.co/storage/v1/object/public/uploads/`
</script>

<script> // BaseCRUD (Nessesário caso tenha SB_Crud.js)
    const J={},JJ={},ALL={} // nem sei se eu realmente to usando este ALL
    const Secund   = {SERV:'PDDS',PGMT:'PDDS'} // ver depois como Tirar isso daqui
    let SlideTable = {PDDS:0 ,SERV:0 ,PGMT:0 ,GRAD:0 ,MPAG:0 ,OOSS:0 ,UBER:0, CLNT:0 }
    //const D        = {PDDS:0 ,SERV:0,CLNT:0,PGMT:0,GRAD:0,OOSS:0,UBER:0,MPAG:0} // (apresentará erro quando Tentar usar ai vou descobrir ela)
    const PreTable = {PDDS:'',SERV:'',PGMT:'',GRAD:'',CLNT:''}
    let todoTitle  = {Serv:[],Cust:[],Soma:[],Sum_Valr:[],Sum_Cust:[],Clnt:[],Rg:[],Pgmt:[],OS:[]} // todos esses são quem tem Bndj e possuem uma Lista de titles para ser carregados no th Filter
    const Primary  = {PDDS:'Id',SERV:'Id',PGMT:'Id',CLNT:'Id',GRAD:'Grad',OOSS:'OS',UBER:'Id',MPAG:'Id',USER:'Pass'}
    const Llmt     = {PDDS:['2026-01-01','2026-12-30'],SERV:['2026-01-01','2026-12-30'],PGMT:['2026-01-01','2026-12-30']}
    let  ContGrad  = {} // Fundir essa com a Debaixo (e deixar a coisa grande igual a J)
    let  ContCLNT  = {} // Fundir essa com a DeCima  (e deixar a coisa grande igual a J)

    const Dbbrev = {T:'Tatiane',G:'Grafit',B:'BPrint',I:'Inová',U:'Bureal','-':'--'}
    const D_Brev = {HOME:'Principal',ORC:'Orçamento',LOJA:'Loja',GBRT:'Gabaritos',BBTC:'Biblioteca','|':'',PDDS:'Pedidos',SERV:'Serviços',PGMT:'Pagamentos',GRAD:'DashBoard',CLNT:'Clientes',CONF:'Configurações',CUST:'Custos',Tipo:'Tipo',Serv:'Serviço',Lrg:'Largura',Alt:'Altura',Cmp:'Comprimento',Cbmt:'Acabamento',Gram:'Gramatura',Matr:'Material',Qnt:'QNT',Und:'Valor UND',SbTt:'SubTotal',Aplic:'Aplicação',Vund:'Valor UND',_:'',X:'',Imgs:'Imgs',Extr:'Extra',RG:'Rg'}
    const dbCol  = {Id:"Id",Lin:"Lin",Data:"Data",Clnt:"Clientes",Serv:"Serviços",Valr:"Valor",Pgmt:"Pagamentos",Cust:"Custos",Lcro:"Lucros",Stts:"Etapa",Lixo:"",Tipo:"Tipo",Desc:"Descrição",Dsng:"Design",Arte:"Arte",Forn:"Fornecedor",OK:"OK",Entg:"Entregue",Detg:"Detg",Grad:"Grad",Gimg:"Gimg",OS:"OS",Uber:"Uber",Cmnt:"Comentário",SStts:"Status",Form:"Forma",Link:"Link",Mpag:"Mpag",Item:"Item",Dstn:"Destino",Pcnt:"Porcentagem",Cmpt:"Complemento",Cntt:"Contato",Lcal:"Local",Loja:"Loja",CtLj:"Ctt Loja",Cat:"Categoria",Emal:"Email",Cont:"Cont",Nome:"Nome",QntS:"Qnt",VUbr:"Valor Uber",AsStts:"Stts",Dest:"Destino",Hora:"Hora",Dirc:"Direção",Prds:"Paradas",Cpvt:"Comprovante",User:"Usuário",Qnt:"Qnt",Lag:"Lag",Alt:'Alt',TArt:'TArt',ImgU:"ImgU",ImgG:'ImgG',Oimg:'Oimg',SrvF:'Produto',VlrO:'VlrO',Cnt2:'Cnt2',Summ:'Summ',Manu:'Manu',Medi:'Media',Img:'Img',Deve:'Resta',Vlpg:'Valr PG',Tema:'Tema',Tempo:'Tempo',Dslk:'Rejeitados',Prazo:'Prazo',Nome:'Nome',Rg:'Rg'}
    const CRYCLS = {A:'AutoComp',I:'CorID'}
    const CRYPP  = {F:'Fixo',E:'Edit',D:'Data',V:'Valr',S:'Slct',C:'Chek',M:'Imgs',Z:'Mdds',B:'Bndj',    A:'Auto',O:'Soma',X:'Lixo',W:'Ssvg',Y:'Sync',K:'Link',G:'BjIn'}

    const BS = { // ['1º é Forma de Carregar', '2º são as Classes CSS // Pode ter um Terceiro q deva ter algo aver com AutoComp
        PDDS:{Id:['F','N'],  Rg:['B','' ],Data:['D','' ],Clnt:['K','' ],Serv:['B','' ],Valr:['A','' ],Pgmt:['B','' ],Deve:['A','' ],Cust:['A','' ],Lcro:['A','' ],Stts:['W','' ],Lixo:['X','' ]}, /*Valr - Cust - Lcro - Stts*/
        SERV:{Id:['F','I'],Data:['D','A'],Clnt:['E','A'],Serv:['S','' ],Tipo:['S','' ],Qnt :['E','' ],Lag :['Z','' ],Alt :['Z','' ],Desc:['E','' ],Surg:['A','' ],Valr:['V','A'],TArt:['S',''],Dsng:['S',''],Arte:['M','' ],CArt:['V',''],Grad:['E','']/*Tava 'K'*/,Gimg:['M','A'],Forn:['S','A'],OS:['Y','A'],Uber:['Y','A'],Cbmt:['E',''],VCbt:['V',''],OK:['C',''],Entg:['C',''],Detg:['D',''],Cmnt:['E',''],SStts:['W','A'],Lixo:['X','']}, // Arte, Gimg, OS, Uber, SStts
        PGMT:{Id:['F','I'],Data:['D','' ],Clnt:['E','' ],Valr:['V','' ],Form:['S','' ],Desc:['E','' ],Mpag:['K','' ],Lixo:['X','' ]},
        CLNT:{Id:['F','I'],Clnt:['E','' ],Cmpt:['E','' ],Cntt:['E','' ],Lcal:['E','' ],Loja:['E','' ],CtLj:['E','' ], Cat:['E','' ],Stts:['E','' ],Link:['F','A'],Lcro:['F','A'],Medi:['F','A'],Lixo:['X','']},
        
        GRAD:{Id:['F','I'],Grad:['E','' ],Data:['D','' ],ImgU:['M','A'],ImgG:['M','A'],Forn:['S','A'],SrvF:['S','' ], Qnt:['E','' ], Lag:['Z','' ], Alt:['Z','' ],Val1:['V',''],Valr:['Y','A'],Cont:['E',''],Cnt2:['F','A'],OS:['K',''],VlrO:['Y','A'],Summ:['Y','A'],Oimg:['M','A'],Uber:['E',''],VUbr:['Y','A'],Lixo:['X','']},
        OOSS:{Id:['F','I'],OS  :['E','' ],Valr:['V','' ],Oimg:['M','A'],Cont:['E','' ],Cnt2:['A','A'],Desc:['E','' ],Lixo:['X','' ]},
        UBER:{Id:['F','I'],Uber:['E','' ],Data:['D','' ], Img:['M','A'],Dest:['E','' ],Hora:['E','' ],Valr:['V','' ],Dirc:['E','' ],Prds:['E','' ],Desc:['E',''],Grad:['E',''],Link: ['E',''],Lixo:['X','']},

        MPAG:{Id:['F','I'],Data:['E',''],Clnt:['E',''],Valr:['E',''],Hora:['E',''], Form:['E',''],User:['E','' ],Pgmt:['K',''],Vlpg:['Y','A'],Lixo:['X','']}, // Removi 'Cpvt'
        RG  :{Rg:['F','' ],Data:['F',''],Hora:['F',''],User:['F',''],  PC:['F',''],Navgd:['F','']}, // isso aqui é o INFO
        ARTE:{Id:['F','I'],Nome:['E',''],Clnt:['E',''],Dsng:['S',''],Tema:['E',''],Tempo:['E',''],Img:['M',''],Dslk:['E',''],Valr:['V',''],Prazo:['D',''],Stts:['E',''],Lixo:['X','']},
        IMGS:{},
        GRD2:{Id:['E',''],Grafit:['E',''],Grafit_Cont:['E',''],BPrint:['E',''],BPrint_Cont:['E',''],Inová:['E',''],Inová_Cont:['E',''],Bureal:['E',''],Bureal_Cont:['E',''],Barraca:['E',''],Barraca_Cont:['E',''],Novalmp:['E',''],Novalmp_Cont:['E',''],JLTal:['E',''],JLTal_Cont:['E',''],Tatiane:['E',''],Tatiane_Cont:['E','']}


        
    }
    const Deff = Object.fromEntries(ObjEtr(BS).map(([t,c])=>[t,Object.fromEntries(ObjKey(c).map(k=>[k,'']))]))
</script>

<script> // aBase de Dados INFINITY GRAFF
    const USERlg = {}

    const Cgo  = { // Cargo
        Admn: { nav :['HOME','|','ORC','LOJA','ARTE','GBRT','BBTC','|','PDDS','|','PGMT','GRAD','CLNT','|','CONF'],
                orc :['Serigrafia','Figurinha','Cartela'],
                PDDS:[],
                PGMT:[],
                SERV:[]},

        Grnt: { nav :['HOME','|','ORC','ARTE','GBRT','|','PDDS','|','PGMT','GRAD','CLNT','|','CONF'],
                orc :[],
                PDDS:[],
                PGMT:[],
                SERV:[]},

        DSgn: { nav:['HOME','|','ORC','ARTE','|','PDDS','|','PGMT','|','CONF'] ,
                orc:['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo Bolo','Vendas','Placa','Sinalização','Cartela','Plotagem','Crachá','Carteira','Plaqueta'],
                PDDS:['Id','Cust','Lcro'],
                PGMT:['Id','Stts','Link','Mpag'],
                SERV:['Id','Forn','Detg','Grad','Gimg','OS','Uber','Cbmt','VCbt','Cmnt',"Oimg"]},

        Atnd: { nav:['HOME','|','ORC','ARTE','|','PDDS','|','PGMT','|','CONF'] ,
                orc:['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo Bolo','Vendas','Placa','Sinalização','Cartela','Plotagem','Crachá','Carteira','Plaqueta'],
                PDDS:['Id','Cust','Lcro'],
                PGMT:['Id','Stts','Link','Mpag'],
                SERV:['Id','Forn','Detg','Grad','Gimg','OS','Uber','Cbmt','VCbt','Cmnt',"CArt","Oimg"]},

        Clnt: { nav:['HOME','|','ORC','ARTE','|','CONF'],
                orc:['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo Bolo','Vendas','Placa','Sinalização','Cartela','Plotagem','Crachá','Carteira','Plaqueta'],
                PDDS:[],
                PGMT:[],
                SERV:[]}
    }
    const tipBS = {}
    const Atual    = {Pag:'ORC'}
    let U = {}
    let UCgo = {}

    let SVG_FILES = [] // esse é do de importar SVG pra calcular

    const ValForn = {
        Grafit:{
            'Adesivo'     :[{val: 20.00, data:"2025-01-01"}],
            'Transparente':[{val: 25.00, data:"2025-01-01"}],
            'Blackout'    :[{val: 25.00, data:"2025-01-01"}],
            'Perfurado'   :[{val: 35.00, data:"2025-01-01"}],
            'Recorte'     :[{val: 32.00, data:"2025-01-01"}],
            'Banner'      :[{val: 22.00, data:"2025-01-01"}],
            'Faixa'       :[{val: 22.00, data:"2025-01-01"}],
            'L.ilhos'     :[{val: 22.50, data:"2025-01-01"}],
            'Lona'        :[{val: 22.00, data:"2025-02-05"}],
        },BPrint:{
            'Adesivo'     :[{val: 20.00, data:"2025-01-01"}],
            'Transparente':[{val: 25.00, data:"2025-01-01"}],
            'Blackout'    :[{val: 25.00, data:"2025-01-01"}],
            'Perfurado'   :[{val: 33.00, data:"2025-01-01"}],
            'Recorte'     :[{val: 32.00, data:"2025-01-01"}],
            'Banner'      :[{val: 24.00, data:"2025-02-01"}],
            'Faixa'       :[{val: 24.00, data:"2025-01-15"}],
            'L.ilhos'     :[{val: 24.00, data:"2025-02-05"}],
            'Lona'        :[{val: 22.00, data:"2025-02-05"}],
        },'Inová':{
            'Camisa'   :[{val: 25.00, data:"2025-02-05"}],
        },Bureal:{
            'Cartão'   :[{val: 20.00}]
        }
    }

    const MATR={
            'Adesivo'  :{Calc:'M2' , Stts:'Disp' , Alll:'Al1' , Opts:'List' , Prvw:'CanvMdd' , Desc:'Adesivo Impresso'     , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Cbmt','Aplic']  , Extra:[]             , HotKey:["colar", "adesivar", "autocolante"       ] ,
            Tipos:{
                'Brilho'         :{Grad:'Ads(Blh)',Valr:60 ,Cust:20, Extra:['Laminação','Aplicação']},
                'Fosco'          :{Grad:'Ads(Fos)',Valr:60 ,Cust:20, Extra:['Laminação','Aplicação']},
                'Blackout'       :{Grad:'Ads(Blk)',Valr:70 ,Cust:25, Extra:['Laminação','Aplicação']},
                'Transparente'   :{Grad:'Ads(Trp)',Valr:70 ,Cust:25, Extra:['Laminação','Aplicação']},
                'Espelhado'      :{Grad:'Ads(Trp)',Valr:80 ,Cust:20, Extra:['Laminação','Aplicação']},
                'Perfurado'      :{Grad:'Ads(Prf)',Valr:100,Cust:35, Extra:['Laminação','Aplicação']}, // Cobrado pela Largura
            }},
    }

    // Dentro de Adesivo tem sim Acabamento q pode ser Laminação e Aplicação
    const ORDEM= ['Trofeu','Adesivo','Etiqueta','Perfurado','Lona','Quadro','ímã','Bandeira','Cartão','Panfleto','Talão','Tag','Cardápio','Tabela','Camisa','Calção','WindFlag','BigBall','Letreiro','Recorte','Arte','Vendas']
    const Prod = { // Adicionar pra todos eles a proporção do Desconto pela quantidade // adicionar também o comporta das cores
        // m2
        'Adesivo'  :{Calc:'M2' , Stts:'Disp' , Alll:'Al1' , Opts:'List' , Prvw:'CanvMdd' , Desc:'Adesivo Impresso'     , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Cbmt','Aplic']  , Extra:[]             , HotKey:["colar", "adesivar", "autocolante"       ] ,
            Tipos:{'Todos':{},
                'Adesivo':{Opts:'List',Cbmt:{
                    'Brilho'         :{Grad:'Ads(Blh)',Valr:0 ,Cust:20, matr:'Adesivo', Extra:['Laminação','Aplicação']},
                    'Blackout'       :{Grad:'Ads(Blk)',Valr:0 ,Cust:25, matr:'Adesivo', Extra:['Laminação','Aplicação']},
                    'Transparente'   :{Grad:'Ads(Trp)',Valr:0 ,Cust:25, matr:'Adesivo', Extra:['Laminação','Aplicação']},
                    'Espelhado'      :{Grad:'Ads(Trp)',Valr:0 ,Cust:20, matr:'Adesivo', Extra:['Laminação','Aplicação']},
                    'Fosco'          :{Grad:'Ads(Fos)',Valr:0 ,Cust:20, matr:'Adesivo', Extra:['Laminação','Aplicação']},
                }},
            }},
        'Etiqueta' :{Calc:'M2' , Stts:'Disp' , Alll:'Al1' , Opts:'List' , Prvw:'CanvMdd' , Desc:'Impressão + Recorte'  , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Corte']         , Extra:[]             , HotKey:["rótulo", "identificação", "label", "tag"] ,
            Tipos:{'Todos':{},
                'Etiqueta':{Opts:'List',Cbmt:{
                    'Refilada'       :{Grad:'Ads(Blh)',Valr:15 ,Cust:0  , matr:'Adesivo' , Extra:['Laminação']},
                    'Redonda'        :{Grad:'Ads(Rct)',Valr:20 ,Cust:12 , matr:'Adesivo' , Extra:[           ]},
                    'Personalizada'  :{Grad:'Ads(Rct)',Valr:25 ,Cust:12 , matr:'Adesivo' , Extra:[           ]},
                }},
            }},
        'Perfurado':{Calc:'M2' , Stts:'Disp' , Alll:'Al1' , Opts:'List' , Prvw:'CanvMdd' , Desc:'Adesivo Impresso'     , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Cbmt','Aplic']  , Extra:[]             , HotKey:["colar", "adesivar", "autocolante"       ] ,
            Tipos:{'Todos':{},
                'Perfurado':{Opts:'List',Cbmt:{
                    'Perfurado'      :{Grad:'Ads(Prf)',Valr:100,Cust:35 , matr:'Perfurado'       , Extra:['Aplicação']}, // Cobrado pela Largura
                }},
        }},
        'Lona'     :{Calc:'M2' , Stts:'Disp' , Alll:'Al1' , Opts:'List' , Prvw:''        , Desc:'Banner, Faixa, ilhós' , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Instal']        , Extra:[]             , HotKey:["painel"                                 ] ,
            Tipos:{'Todos':{},
                'Lona'    :{Opts:'List',Cbmt:{
                    'Banner'         :{Grad:'Lon(Bnn)',matr:'Lona',Valr:70,Cust:22 , Limit:{Max:{L:1.20,A:0},Min:{L:0.40,A:0.60}} , Mdds:['0,50 x 0,70' , '0,80 x 1,20' , '2,00 x 1,00']}, 
                    'Faixa'          :{Grad:'Lon(Fax)',matr:'Lona',Valr:70,Cust:22 , Limit:{Max:{L:0,A:1.20},Min:{L:0.60,A:0.40}} , Mdds:['2,00 x 0,50']}, 
                    'com ilhós'      :{Grad:'Lon(Ilh)',matr:'Lona',Valr:70,Cust:22 , Limit:{Max:{x:3.20,X:0},Min:{L:0.40,A:0.40}} , Mdds:['1,00 x 1,00']},
                    'Sem Acabamento' :{Grad:'Lon(Sem)',matr:'Lona',Valr:60,Cust:20 , Limit:{Max:{x:3.20,X:0},Min:{L:0.30,A:0.30}} , Mdds:[]},
                }},
            }},
        'Quadro'   :{Calc:'M2' , Stts:'Disp' , Alll:'Al2' , Opts:'List' , Prvw:'CanvMdd' , Desc:'Quadro sem Moldura'   , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Aplic','Cbmt']  , Extra:['PVC','Fita'] , HotKey:["moldura", "pôster", "cartaz"            ] ,
            Tipos:{'Todos' :{},
                   'PS 1mm' :{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr: 40, Cust:21.25, Limit:{Max:{x:2.00,X:1.00}} , Mdds:['0,30 x 0,20'] , matr:'Adesivo' , Extra:['Laminação']}}, // Folha de PS com (2,00 x 1,00) R$ 42,50
                 },'PS 2mm' :{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr: 70, Cust: 0.00, Limit:{Max:{x:2.00,X:1.00}} , Mdds:['0,30 x 0,20'] , matr:'Adesivo' , Extra:['Laminação']}},  
                 },'PVC 2mm':{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr: 90, Cust: 0.00, Limit:{Max:{x:2.44,X:1.22}} , Mdds:['0,30 x 0,20'] , matr:'Adesivo' , Extra:['Laminação']}},
                 },'PVC 3mm':{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr:110, Cust:43.00, Limit:{Max:{x:2.44,X:1.22}} , Mdds:['0,30 x 0,20'] , matr:'Adesivo' , Extra:['Laminação']}, // Folha de PVC com (2,44 x 1,22) R$ 86,00
                }},'PVC 5mm':{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr:200, Cust: 0.00, Limit:{Max:{x:2.44,X:1.22}} , Mdds:['0,30 x 0,20'] , matr:'Adesivo' , Extra:['Laminação']},
                }},
            }},
        'ímã'      :{Calc:'M2' , Stts:'Disp' , Alll:'Al2' , Opts:'List' , Prvw:'CanvMdd' , Desc:'Geladeira ou Carro'   , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Aplic','Cbmt']  , Extra:['Manta']      , HotKey:["magneto", 'manta magnética'             ] ,
            Tipos:{'Todos':{},
                  '03 Geladeira':{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr: 70.00, Cust:35.00 , Limit:{Max:{x:0.60,X:0}} , Mdds:['0,05 x 0,06'] , matr:'Adesivo' , Extra:['Laminação']}}, // 0.3 - R$ 21,00 (0,60 x 1,00) || o Metro fica: calc é assim:::> const precoPorMetro = (preco, largura, altura) => preco / (largura * altura)
                },'04 Geladeira':{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr: 95.00, Cust:48.33 , Limit:{Max:{x:0.60,X:0}} , Mdds:['0,05 x 0,06'] , matr:'Adesivo' , Extra:['Laminação']}}, // 0.4 - R$ 29,00 (0,60 x 1,00) || o Metro fica: 
                },'08 Carro'    :{Opts:'List',Cbmt:{'Refilado':{Grad:'Ads(Blh)',Valr:180.00, Cust:98.33 , Limit:{Max:{x:0.60,X:0}} , Mdds:['0,60 x 0,30'] , matr:'Adesivo' , Extra:['Laminação']}}, // 0.8 - R$ 59,00 (0,60 x 1,00) || o Metro fica: 
                },
            }},
        'Bandeira' :{Calc:'M2' , Stts:'Disp' , Alll:'Al1' , Opts:'List' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['Inová']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:['Sublimação',"Pano","Tecido"] ,
            Tipos:{'Todos':{},
                'Bandeira':{Opts:'List',Cbmt:{
                    'Redonda'   :{Grad:'Bandeira',Valr:75, Cust:0 , matr:['Oxford','Cettin']},
                    'Retangula' :{Grad:'Bandeira',Valr:75, Cust:0 , matr:['Oxford','Cettin']},
                }},
        }},
        // Offset
        'Cartão'   :{Calc:'OFS', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Medida: 9cm x 5cn'    , Forn:['BPrint','Bureal']           , Etpa:['Arte','Print','Cbmt']          , Extra:[]             , HotKey:["cartão de visita", "business card", "papel", "folha"] , 
            Tipos:{'Todos'    :{},
                'Brilho'      :{Table:[
                    ['Frente' ,'250g',[['500', 90,31,'on'],['1000',135,45,'on']]],
                    ['Frente' ,'300g',[['500',130,49     ],['1000',145,56     ]]], 
                    ['FVerso','250g',[['500',115,42,'on'],['1000',150,54,'on']]], 
                    ['FVerso','300g',[['500',150,58     ],['1000',165,65     ]]],]},
                'Brilho Local':{Table:[
                    ['Frente' ,'300g',[['500',155,62,'on'],['1000',190,78,'on']]],
                    ['FVerso','300g',[['500',190,80,'on'],['1000',230,99,'on']]],]},
        }},
        'Panfleto' :{Calc:'OFS', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Gramatura: 90g'       , Forn:['BPrint','Bureal']           , Etpa:['Arte','Print','Cbmt']          , Extra:[]             , HotKey:["folheto", "papel", "informativo",'folha'] , 
            Tipos:{'Todos':{},
                '10 x 15':{Table:[
                    ['Frente' ,'90g',[['1000',130, 67,'on'],['2500',180, 85,'on'],['5000',270,170],['10000',650,340]]],
                    ['FVerso','90g',[['1000',  0,  0,'on'],['2500',280,135,'on'],['5000',320,220],['10000',720,392]]],]},
                '15 x 20':{Table:[
                    ['Frente' ,'90g',[['1000',190,127,'on'],['2500',340,170,'on'],['5000',650,340],['10000',900,600 ]]],
                    ['FVerso','90g',[['1000',  0,  0,'on'],['2500',500,270,'on'],['5000',700,440],['10000',1200,800]]],]},
        }},
        'Talão'    :{Calc:'OFS', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Gramatura: 90g'       , Forn:['JLTal']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:[] , 
            Tipos:{
                'Todos'  :{},
                '10 x 15':{Table:[
                    ['Preto e Branco','1 Via',[['4',60,30,'on'],['8', 90,45],['12',130,65],['20',170, 85,'on']]],
                    ['Colorido'      ,'1 Via',[['4',80,40,'on'],['8',110,55],['12',150,75],['20',200,100,'on']]],
                    ['Preto e Branco','2 Via',[['4',75,35],['8',105,55],['12',145,70],['20',185, 80]]],
                    ['Colorido'      ,'2 Via',[['4',95,45],['8',125,65],['12',165,85],['20',215,110]]],]},
                '15 x 20':{Table:[
                    ['Preto e Branco','1 Via',[['2',60,30,'on'],['4', 90,45],['10',170, 85],['20',300,150,'on']]],
                    ['Colorido'      ,'1 Via',[['2',80,40,'on'],['4',110,55],['10',200,100],['20',350,175,'on']]],
                    ['Preto e Branco','2 Via',[['2',75,35],['4',105,55],['10',185, 90],['20',315,165]]],
                    ['Colorido'      ,'2 Via',[['2',95,45],['4',125,65],['10',215,110],['20',365,195]]],]},
                '9 x 21' :{Table:[
                    ['Preto e Branco','1 Via',[['3',60,30],['6', 90,45],['9',130,65],['12',150, 75]]],
                    ['Colorido'      ,'1 Via',[['3',80,40],['6',110,55],['9',170,85],['12',190, 95]]],
                    ['Preto e Branco','2 Via',[['3',75,35],['6',105,55],['9',145,70],['12',165, 80]]],
                    ['Colorido'      ,'2 Via',[['3',95,45],['6',125,65],['9',185,85],['12',205,100]]],]},
        }},
        'Tag'      :{Calc:'OFS', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Gramatura: 90g'       , Forn:['Bureal']                    , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["etiqueta", "rótulo", "marcador",'furo'  ] , 
            Tipos:{'Todos':{},
                '4 x 5':{Table:[
                    ['Reto' ,'250g',[['500',  0, 0,'on'],['1.000',130,73,'on']]],
                    ['Curva','250g',[['500',  0, 0,'on'],['1.000',150,85,'on']]],]},
                '5 x 9':{Table:[
                    ['Reto' ,'250g',[['500',100,57,'on'],['1.000',140,69,'on']]],
                    ['Curva','250g',[['500',120,67,'on'],['1.000',150,79,'on']]],]},
        }},
        'Cardápio' :{Calc:'OFS', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'LAZER, Plastificado'  , Forn:['BPrint']                    , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["menu", "lista de pratos", "menu de restaurante", "opções de comida", "restaurante", "cozinha"] ,
                    Tipos:{'Todos':{},
                'A4':{Table:[
                    ['Frente' ,'170g',[['1',15,6.90,'on']]],
                    ['F.Verso','170g',[['1',20,8.80,'on']]],
                ]},
                'A3':{Table:[
                    ['Frente' ,'170g',[['1',30,13.75,'on']]],
                    ['F.Verso','170g',[['1',35,17.50,'on']]],
                ]},
        }},
        'Tabela'   :{Calc:'OFS', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Tabela de Preço'      , Forn:['BPrint']                    , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["menu", "lista de pratos", "menu de restaurante", "opções de comida", "restaurante", "cozinha"] ,   
                    Tipos:{'Todos':{},
                'PS' :{Table:[
                    ['Frente' ,'170g',[['A4',20,0,'on'],['A3',38,0,'on']]],
                    ['F.Verso','170g',[['A4',28,0,'on'],['A3',46,0,'on']]],
                ]},
                'PVC':{Table:[
                    ['Frente' ,'170g',[['A4',30,0,'on'],['A3',58,0,'on']]],
                    ['F.Verso','170g',[['A4',46,0,'on'],['A3',88,0,'on']]],
                ]},
        }},
        // Tecido
        'Camisa'   :{Calc:'UND', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Sublimação Total'     , Forn:['Inová']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["blusa", "camiseta", "roupa", "estampa", "moda", "vestuário","Pano","Tecido"] ,
            Tipos:{
                'Todos'    :{},
                'MCurta'   :{Tipo:['Helanca','Dry Furado','Dry Fit','Manchaster'],Tamn:['PP','P','M','G','GG','XG'],
                    Table:[
                        ['Masculino_Normal','Helanca',[['1 UND',50,25,'on'],['10 UND',39,25,'on']]],
                        ['Masculino_Raglan','Helanca',[['1 UND',58, 0,'on'],['10 UND',47, 0,'on']]],
                        ['Masculino_V'     ,'Helanca',[['1 UND',55, 0,'on'],['10 UND',44, 0,'on']]],
                        ['Masculino_Padre' ,'Helanca',[['1 UND',57, 0,'on'],['10 UND',36, 0,'on']]],

                        ['Feminino_Normal' ,'Helanca',[['1 UND',50,25,'on'],['10 UND',39,25,'on']]],
                        ['Feminino_Raglan' ,'Helanca',[['1 UND',58, 0,'on'],['10 UND',47, 0,'on']]],
                        ['Feminino_V'      ,'Helanca',[['1 UND',55, 0,'on'],['10 UND',44, 0,'on']]],
                        ['Feminino_Padre'  ,'Helanca',[['1 UND',57, 0,'on'],['10 UND',36, 0,'on']]],

                        ['Infantil_Normal' ,'Helanca',[['1 UND',40, 0,'on'],['10 UND',29, 0,'on']]],
                        ['Infantil_Raglan' ,'Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],
                        ['Infantil_V'      ,'Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],
                        ['Infantil_Padre'  ,'Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],

                        ['Plus Size_Normal','Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],
                        ['Plus Size_Raglan','Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],
                        ['Plus Size_V'     ,'Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],
                        ['Plus Size_Padre' ,'Helanca',[['1 UND',0 , 0,'on'],['10 UND', 0, 0,'on']]],
                    ]
                },
                'MLonga'   :{Tipo:['Helanquinha','Dry Furado'],Tamn:['PP','P','M','G','GG'],Valr:{'1':60,'10':49},Cust:{'1':25}},
                'Regata'   :{Tipo:['Helanquinha','Dry Furado'],Tamn:['PP','P','M','G','GG'],Valr:{'1':40,'10':29},Cust:{'1':25}},
                'Polo'     :{Tipo:['Manchaster'              ],Tamn:['PP','P','M','G','GG'],Valr:{'1':80,'10':69},Cust:{'1':25}},
        }},
        'Calção'   :{Calc:'UND', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Sublimação Total'     , Forn:['Inová']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:['Short','Sublimação','roupa','pano'] ,
            Tipos:{
                'Bermuda' :{},
                'Short'   :{},
        }},  
        'WindFlag' :{Calc:'UND', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Tecido: Oxford'       , Forn:['Inová','NovaImp']           , Etpa:['Arte','Print']                 , Extra:['Base']       , HotKey:['Sublimação',"Pano","Tecido",'BigFlag','WindBanner','Bandeira do Vento'] ,
            Tipos:{'Todos':{},
                'P':{Cbmt:{
                    'Faca':{Grad:'WindFaca',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Vela':{Grad:'WindVela',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Pena':{Grad:'WindPena',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Gota':{Grad:'WindGota',Valr:0 , Cust:0 , matr:['Oxford']},}},
                'M':{Cbmt:{
                    'Faca':{Grad:'WindFaca',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Vela':{Grad:'WindVela',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Pena':{Grad:'WindPena',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Gota':{Grad:'WindGota',Valr:0 , Cust:0 , matr:['Oxford']},}},
                'G':{Cbmt:{
                    'Faca':{Grad:'WindFaca',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Vela':{Grad:'WindVela',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Pena':{Grad:'WindPena',Valr:0 , Cust:0 , matr:['Oxford']},
                    'Gota':{Grad:'WindGota',Valr:0 , Cust:0 , matr:['Oxford']},}},
            }},
        'BigBall'  :{Calc:'UND', Stts:'Disp' , Alll:'Al3' , Opts:'List' , Prvw:'Tabela'  , Desc:'Tecido: Oxford'       , Forn:['Inová','NovaImp']           , Etpa:['Arte','Print']                 , Extra:['Base']       , HotKey:['Sublimação',"Pano","Tecido"] ,
            Tipos:{'Todos':{},
                P   :{Valr:0,Cust:0},
                M   :{Valr:0,Cust:0},
                G   :{Valr:0,Cust:0},
            }},   
        // Cortes
        'Letreiro' :{Calc:'M2v', Stts:'Disp' , Alll:false, Opts:'List' , Prvw:'IptSVG'  , Desc:'Cortes em PVC 10mm'   , Forn:['Barraca','Jailson']         , Etpa:['Arte','Corte','Cbmt']          , Extra:[]             , HotKey:[]          , img:'Place',
            Tipos:{'Todos' :{},
                'PVC'      :{},
                'Acrilico' :{}
        }},
        'Recorte'  :{Calc:'M2v', Stts:'Disp' , Alll:false, Opts:'Cors' , Prvw:'IptSVG'  , Desc:'Adesivo Recortado'    , Forn:['Stock']                     , Etpa:['Arte','Corte','Cbmt','Aplic']  , Extra:[]             , HotKey:["Ploter",'Lamina','Siluet','Vetor'] ,
            Tipos:{'Todos'   :{},
                'Vinil'      :{Calc:'M2',Valr:150,Valor:70  , matr:['Preto','Branco','Prata','Vermelho','Azul','Verde','Amarelo','Laranja','Rosa','Roxo']},
                'Holografico':{Calc:'M2',Valr:200,Valor:100 , matr:['Holografico']},
        }},
    //   'Sinalização':{Calc:'M2v', Stts:'Offf' , Opts:'List' , Prvw:''        , Desc:'Chapa de PVC ou Zinco', Forn:['Stock']                     , Etpa:['Arte','Corte','Aplic','Cbmt']  , Extra:['PVC']        , HotKey:[]           , img:'Place',
    //         Tipos:{
    //             'Sinalização' :{}
    //     }},
        'Trofeu'   :{Calc:'M2' , Stts:'Disp' , Alll:'Al2', Opts:'List' , Prvw:'CanvMdd' , Desc:'Acrilico Cristal 2mm' , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Corte']         , Extra:['Acrilico']   , HotKey:['acrilico'] ,
            Tipos:{'Todos':{},
                'Virado'  :{Grad:'Ads(Trp)',Valr:60+30+180+100+17, Cust:20+15+90+60}, // Adesivo, Vinil, Acrilico, Corte (ultimos 15 é estouro)
                'Colado'  :{Grad:'Ads(Trp)',Valr:60+30+180+100+35, Cust:20+15+90+60}, // Adesivo, Vinil, Acrilico, Corte (ultimos 15 é estouro)
        }},
        // Serviços
        'Arte'     :{Calc:'MAO', Stts:'Offf' , Alll:false , Opts:'List' , Prvw:'MdalArt' , Desc:'Criação e Recriação'  , Forn:['Arte']                      , Etpa:['Arte']                         , Extra:[]             , HotKey:[]           , img:'Place',
            Tipos:{'Artes'     :{}
        }},
        // 'Plotagem' :{Calc:'MAO', Stts:'Offf' , Opts:'List' , Prvw:''        , Desc:'Aplciação de Adesivo' , Forn:['Stock','WM']                , Etpa:['Aplic']                        , Extra:[]             , HotKey:['Plotagem'] , img:'Place',
        //                 Tipos:{
        //             'Plotagem' :{}}
        // },

        // Produtos
        'Vendas'   :{Calc:'UND', Stts:'Offf' , Alll:false, Opts:'List' , Prvw:''        , Desc:'Produtos do Painel'   , Forn:['Stock']                     , Etpa:['']                             , Extra:[]             , img:'Place'      ,
            Tipos:{
                'Tanque'   :{},
                'Quadros'  :{},
                'Acrilico' :{},
                'Figurinha':{},
                'Recorte'  :{},
                'Cartela'  :{},
                'Rodagem'  :{},
        }},
        // Ferragem
        // 'Placa'    :{Calc:'M2v', Stts:'Offf' , Opts:'List' , Prvw:'Canv3D'  , Desc:'Fachada de Lojas'     , Forn:['Jailson']                   , Etpa:['']                             , Extra:[]             , img:'Place'      ,
        //             Tipos:{
        //                 'Placa' :{}}
        // }, 
        // Lombras
        // 'Serigrafia':{Calc:'UND', Stts:'Offf' , Opts:'List' , Prvw:''        , Desc:'Estampa de Camisa'    , Forn:['Stock']                     , Etpa:['']                             , Extra:[]             , img:'Place'      ,
        //         Tipos:{
        //             'Serigrafia' :{}}
        // },  
    }

    // Const Importante pra Compilar a Tabela de produtos pra deixa o Load Mais Rápido
    const EtrProd = ObjEtr(Prod)
    const AllProd = ObjEtr(Prod).map(([k])=>k).sort((a,b)=>ORDEM.indexOf(a)-ORDEM.indexOf(b))
    const HotKy   =      Object.fromEntries(EtrProd.map(([k,v])=>[k,v.HotKey||[]]))
    const AllAll  = stg=>Object.fromEntries(EtrProd.map(([k,v])=>[k,v[stg]  ||[]]))
    const Vari    = e=>Prod[e] ? ObjKey(Prod[e].Tipos) : ''
    const FiltOn  = E=>Object.entries(Prod[E]?.Tipos||{}).flatMap(([n,o])=>(o.Table||[]).flatMap(([l,g,q])=>q.filter(e=>e[3]=='on').map(e=>[[...e,g],`${E}_${n}_${l}`.replace(/\./g,'')])))

    const O = {
        Forn:['','Grafit','BPrint','Tatiane','Inová','Bureal','Stock','Arte','JLTal','Varyus','NovaImp','Barraca','Jailson','--'], // 'WM SilkSing','Casas leo'
        Serv:['',...AllProd],
        SrvF:['',...new Set(Object.values(ValForn).flatMap(Object.keys))],
        Tipo:['','Recorte',...Uniq(AllProd.flatMap(e=>Vari(e)))],
        Form:['','Pix','Av','Card'],
        Pgmt:['','Pix','Av','Card'],
        Dstn:['','Serv1','Serv2'],
        Stts:['','Orçamento','Arte','Analise Art','Impressão','Grad Uber','Falta Uber','Acabamento','Pronto','Entregue','Devendo','Concluído'],
        Cams:['','PP (Inf)','P (Inf)','M (Inf)','G (Inf)','PP','P','M','G','GG','XG','XXG'],
        TArt:['','Criação','Recriação','Vetorização','Digitação','Modificação','Adaptação',,'Restauração','Imagem','do Cliente','Ja Tinha','n Precisa'],
        Dsng:['','Allan','Baby','Fexta','Italo','Euryk','Eurik','Canva','Karol','--'], // Interessante cada um só poder botar a Si mesmo!
    }
    const AllList= ObjKey(O)

    const GetycCores = {
        'Preto'       : '#000000',
        'Branco'      : '#FFFFFF',
        'Prata'       : '#C0C0C0',
        'Vermelho'    : '#FF0000',
        'Azul'        : '#0000FF',
        'Verde'       : '#008000',
        'Amarelo'     : '#FFFF00',
        'Laranja'     : '#FFA500',
        'Rosa'        : '#FFC0CB',
        'Roxo'        : '#800080',
        'Holografico' : 'linear-gradient(135deg, #ff00ff, #00ffff, #ffff00, #ff6600, #00ff99, #0099ff)'
    }

    const COR  = {'Gren':'147,196,125','Yelw':'255,229,153','Roxo':'180,167,214','Azul':'164,194,244','Redd':'234,153,153','Opcy':'0,0,0,0'}
    const COR2 = {'Gren':'39,80,12'   ,'Yelw':'133,99,0'   ,'Roxo':'80,0,146'   ,'Azul':'0,54,146'   ,'Redd':'134,0,0'    ,'Opcy':'0,0,0,0'}
    const ListEtps = [['Orçamento','Roxo'],['Arte','Roxo'],['Impressão','Yelw'],['Acabamento','Yelw'],['Pronto','Azul'],['Entregue','Gren'],['Devendo','Redd']]
</script>

<script> // Bibliotecas
    // Epecíficas (as q Retorna)
        const RangeDATA=(arr,Typ)=>RangeDat(arr,Llmt[Typ][0],Llmt[Typ][1])
        const tr_ID   =tr =>getClss(tr,'tr-').split('-')[1]
        const TRs     =Typ=>$$(`#H_${Typ} > tbody > tr`)
        const Rx2     =arry=>Rx(['Rastr',...arry])
        const D_R     =R=>{const v = (typeof R === "string" ? R : getClssIN(R,'Rastr-')).split('-') ; return {r:v[0],Typ:v[1],Row:v[2],Col:v[3],Tm:v[4],ColX:v[5]}}
        const Colx    =(Typ,col)=>FIdx(OjKy(Typ),col)+1
        const COLLLL  =(Typ,col)=>{if (!Typ || !col) return "";return `td:nth-child(${Colx(Typ, col)})`}
        const Colls   =(Typ,col,n=null)=>$$(`#H_${Typ} > tbody > tr${n?':not([class*=" n"])':''} > ${COLLLL(Typ,col)} > div > .P-P`)
        const tr_Viw  =   Typ=>  $$(`#H_${Typ} > tbody > tr:not([class*=" n"])`)
        const TH      =(Typ,col)=>$(`#H_${Typ} > thead > tr ${COLLLL(Typ,col).replace('td:','th:')}`)        
        
        const AllI    =(table,Atv=null)=>$$(`:scope > thead > tr > th ${Atv=='Atv'?'i.Atv':'i'}`,table)
        const Listagem=(Typ,col)=>ALL[Typ] = Uniq(J[Typ].map(e=>e[col])) // pegar todos itens de uma determinada coluna no Json e botar na const all
        const slideTo=(i,Typ)=>{SlideTable[Typ] = Math.max(0,Math.min(2,i));$(`#Slide_${Typ}`).style.transform = `translateX(-${SlideTable[Typ] * 100}%)`}
        const ReszH=(Typ)=>{TrcTog($(`#H_${Typ}`),'hMin','hMax')                     ;SaveConfig('a')}
        const ReszW=(Typ)=>{Tog($(`#H_${Typ}`),'w100');Tog($(`.Confy_${Typ}`),'w100');SaveConfig('a')}

        //const D_P     =R=>{const v = (typeof R === "string" ? R : getClssIN(R,'Rpai-' )).split('-') ; return {r:v[0],Typ:v[1],Row:v[2],Col:v[3],Tm:v[4],ColX:v[5]}}
        //const Coll    =x=>`td:nth-child(${x})`
        //const H_Col_p =(Typ,col)=>  `#H_${Typ} > tbody > tr > ${Col(Typ,col)} p` // analisar se é realmente nessesário
        //const RgxPixAV=e=>e.trim().match(/(\d+[\.,]?\d*)([a-zA-Z]+)/) || [] // remover pois vai ficar "OBSOLETO"

        //Evento de Click na Página inteira, com a intenção de Ocultar tudo que for Bandeijas
        function NoneBndj(){if(event.target.closest('.bndj')||event.target.classList.contains('NObj')){return}else{None($$('.bndj'))}}
        const DarkLite2=(e,Chk)=>{if(Chk){Trc2(e,'Dark','Lite')}else{Trc2(e,'Lite','Dark')} ; LOG('Chamou DarkLite',e,Chk)} // conferir se essa é realmente nessesária
</script>

<div> <!--JS e CSS das Tabelas-->
    <div>   <!--TABELAS  - ⭐⭐⭐_ _ -->
        <style> /*CSS apenas da Tabela*/
            /*essa bndj deveria ter "Shdw rd Cl"*/
            .BNdj    {transform:translate(-50%,0%); left:50%; z-index:500 ; width:250px ; max-height:250px;  box-shadow:0 0 9px #00000069}
            .BNdj > a{position:absolute ; bottom:100%; left:50%; transform:translate(-50%,0%); z-index:1; width:20px ; height:11px} /*essa é a Pontinha da Bndj*/
            /*Particularidades*/
            .BndjFOT,.BndjFLT{overflow: hidden}
            .BndjSUG .Sugg    ,.BndjTBL .Sugg    ,.MySelect .Sugg    {border-radius:10px}
            .BndjSUG .Sugg > *,.BndjFOT .Sugg > *,.MySelect .Sugg > *{padding: 4px}
            .BndjTBL{padding:5px ; width:auto !important; height:auto !important}
            .BndjFOT{border-radius:10px 10px 0 0; bottom:0px}
            .BndjFLT{border-radius:0 0 10px 10px}
            .BjConf         {color:#ffffff; height:24px}
            .BjConf img     {height:18px; width:18px}
            .BjConf span.Atv{fill:#ffff00; background:#00df00}
            .BndjFLT input  {height:18px ; width:80px}
            .Sugg {overflow-x: hidden; overflow-y: auto; max-height: 200px; width: 100%;}
                th .Sugg div:hover div{opacity:1}
                th .Sugg div div      {opacity:0;font-size:15px; background:#d822ab; color:#ffffff; width:18px; height:18px; text-align: center; margin-left:10px ;} /*Bolinhas + e -*/
    
            /*Fica apenas nas Tabelas*/
            td          .grifoo{display:none  ; height:5px; width:5px ; left:0px}
            td.GrifNot2 .grifoo{display:block ; background:#ff880060}
            td.GrifNot1 .grifoo{display:block ; background:#ff8800fd}
            p.Psq,select.Psq {background:#ff7b00 !important} /*Grif do Select*/

            .TBLAA tfoot  [class*="Foot-Pgmt"] a{color:#00df00}
            .TBLAA tfoot .RS{color:#00df00; font-size:7px}
            .CorID     {background:#94949473}
            /*Maneiras de Selecionar uma Célula*/
                .SelectSoma{background:#ff0000; color:#ffffff}
                .LinkAtv   {background:#028602; color:#ffffff}
                
            /*Cria as Linahs de Divisórias de Serv*/ /*Algo assim também pode ser Aplicado pra as Larguras das Colunas*/
            :is(.Bdj_SERV, #H_SERV) > * > tr > :is(td,th):is(:nth-child(3),:nth-child(09),:nth-child(15),:nth-child(20),:nth-child(22),:nth-child(25)){border-right:4px solid #bb0092}
            :is(.Bdj_SERV, #H_SERV) > * > tr > :is(td,th):is(:nth-child(4),:nth-child(10),:nth-child(16),:nth-child(21),:nth-child(23),:nth-child(26)){border-left :4px solid #bb0092}

            :is(#H_GRAD) > * > tr > :is(td,th):is(:nth-child(13),:nth-child(17)){border-right:4px solid #bb0092}
            :is(#H_GRAD) > * > tr > :is(td,th):is(:nth-child(44),:nth-child(18)){border-left :4px solid #bb0092}

            /*.TBLAA p.P-P{display: inline-block; white-space: nowrap; }*/

            table.Card {background: none !important;}
            table.Card > thead{display: none}
            table.Card > tfoot{display: none}
            table.Card > tbody{display:flex; flex-wrap:wrap; gap:12px ; padding:10px}
            table.Card > tbody > tr{ /*CARD*/
                padding: 8px;
                background:#ffffff;
                border-radius: 16px;
                box-shadow: 0 4px 12px #0000001a;
            }
            table.Card > tbody > tr {
                display: grid;
                grid-template-areas:
                    " Id   Id  Data"
                    "Clnt Clnt Stts"
                    "Serv Serv Serv"
                    "Valr Pgmt Deve"
                    "Obs  Obs  Obs ";
                grid-template-columns: 1fr auto auto;
                gap: 4px 4px
            }
            table.Card > tbody > tr[class^="n"]{display: none;}
            table.Card .AutoComp,table.Card .CorID{background: transparent !important;}
                                       table.Card > tbody > tr{width:calc(25% - 9px)}        /*Largura dos Cards 4 por Linha*/
            @media (max-width: 800px) {table.Card > tbody > tr {width: calc(33.333% - 8px)}} /* 3 por linha */
            @media (max-width: 500px) {table.Card > tbody > tr {width: 100%}}                /* 1 por linha */
            
            table.Card > tbody > tr > td{padding: 5px; border-radius: 255px ; height: auto !important; } /*border: 1px solid red;*/
            table.Card > tbody > tr > td:nth-child(1) { grid-area: Id   }table.Card > tbody > tr > td:nth-child(1) > div > .P-P {color:#780096; font-size: 10px ; font-weight:bold}
            table.Card > tbody > tr > td:nth-child(2) { grid-area: Data }table.Card > tbody > tr > td:nth-child(2) > div > .P-P {color:#666666; text-align:right                        } table.Card > tbody > tr > td:nth-child(2) > div > .P-P > img{height:11px; margin-right:3px ; display: block;}
            table.Card > tbody > tr > td:nth-child(3) { grid-area: Clnt }table.Card > tbody > tr > td:nth-child(3) > div > .P-P {color:#000000d5; font-size: 18px ;                     } table.Card > tbody > tr > td:nth-child(3) > .Ct{justify-content:start}
            table.Card > tbody > tr > td:nth-child(4) { grid-area: Serv }table.Card > tbody > tr > td:nth-child(4) > div > .P-P {color:#000000;                 ;                       } table.Card > tbody > tr > td:nth-child(4) > .Ct{justify-content:start}
            table.Card > tbody > tr > td:nth-child(5) { grid-area: Valr }table.Card > tbody > tr > td:nth-child(5) > div > .P-P {color:#008000; font-size: 16px ; font-weight:bold      } table.Card > tbody > tr > td:nth-child(5) > .Ct{justify-content:start}
            table.Card > tbody > tr > td:nth-child(6) { grid-area: Pgmt }table.Card > tbody > tr > td:nth-child(6) > div > .P-P {color:#000000; }
            table.Card > tbody > tr > td:nth-child(7) { grid-area: Deve }table.Card > tbody > tr > td:nth-child(7) > div > .P-P {color:#c7380c; font-size: 12px}
            table.Card > tbody > tr > td:nth-child(8) { grid-area: Cust ;display: none}table.Card > tbody > tr > td:nth-child(8) > div > .P-P {color:#c7380c; font-size: 12px}
            table.Card > tbody > tr > td:nth-child(9) { grid-area: Lcro; display: none;}
            table.Card > tbody > tr > td:nth-child(10){ grid-area: Stts }table.Card > tbody > tr > td:nth-child(10) > div > .P-P{color:#999999; width: 50px;}
            table.Card > tbody > tr > td:nth-child(11){ grid-area: Obs  ; display: none; color:#757575; font-size: 12px}
            table.Card > tbody > tr > td:nth-child(12){ grid-area: Lixo ; display: none;}

            /*Rodar as Ecessões*/
            table.Card > tbody > tr > td:nth-child(3) {background: none !important}

            table.Tbla td[class*="Data"] a{display: none}
            table.Tbla td[class*="Data"] p{display: flex}
            table.Card td[class*="Data"] a{display: flex}
            table.Card td[class*="Data"] p{display: none}

            .TBLAA tbody td:not([class*="-Bndj-"]) > div:not(.Sklt)        {width: 100% !important; height: 100% !important;} /*pra pegar as de Fora da Bndj*/
            .BndjTBL tbody td                      > div:not(.Sklt)        {width: 100% !important; height: 100% !important;} /*pra pegar as de dentro*/
            .TBLAA tbody > td p:not([class*="-Bndj-"]):not([class*="-Auto-"]){height:100%; width: 100%}
            .TBLAA   tbody td p                                            {padding:2px 6px; text-align:center}
            .BndjTBL tbody td p                                            {height:100%; width: 100%; padding:2px 6px; text-align:center}

            .TBLAA tbody > tr:not([class*="Hoov"]):hover      {filter: saturate(1.6) brightness(1.05); z-index: 999999}
            .TBLAA tbody > tr td:not([class*="Hoov"]):hover   {background:#7469713a;filter: saturate(1.6) brightness(0.8) ; z-index: 999999}

            .GrifFora{left:20px;opacity:0.7}
        </style>

        <script>// TABELAS (Transitar na Tabela com as Setas do Teclado)
            const Tm_Sklt  =(Typ)=>For(16).map(()=>`<tr>${OjKy(Typ).map(()=>`<td><div class="Sklt"></div></td>`).join('')}</tr>`).join('') // Esqueleto
            const Tm_tdFoot=(arr,Typ)=>arr.map((e,x)=>`<td class="${Tm_R('Foot',x,Typ)} Rltv"></td>`).join('')
            const LoadBndj =(Eu,R)=>{if(Coten($('.BNdj',Pai(Eu)),'none')){Inn($('.BNdj > table',Pai(Eu)),Tm_Bndj(R,'','DOM'))}}
            function RenderSVVG(td){Inn($('span',td),Nm($('svg.P-P',td)))}//(GAMBIARRA) (Outras Formas de Exibir Bandeijas) isso talvez deva entrar em (BjIN)
            function CopyFone(Fone,Eu){LOG(Fone)}

            const ImgT_T=(col,e,R)=>  col=='Serv' ? e.Arte ? Tm_Tm['Imgs'](e.Arte,`SERV-${e.Id}-Arte-Imgs-Bj-Sc`) : ''
                                    : col=='Clnt' ? e.Cntt ? `<img class="HOV" loading="lazy" onclick="CopyFone('${e.Cntt}',this)"  src="./CrudSB/Fone.webp"                              >`:''
                                    : ''

            const FazerTitle=(col,Find)=>{ // fazer os Titulos para as Bandeijas
                return  col==='Serv' ? Find.length>3 ? Find[0].Desc : BrevTitle(Find.map(e=>e.Serv ? `${e.Qnt} - ${e.Serv} ${e.Lag&&e.Alt?`${Cm(e.Lag)} x ${Cm(e.Alt)}`:`${e.Lag}${e.Alt}`}` : `${e.Desc}`).join(' | ')) :
                        col==='Pgmt' ? Find.map(e=>`${e.Valr}${e.Form}` ).join(' | ') :
                                       Find.map(e=>`${e[col]}`          ).join(' | ')
            }
            
            function Tm_Bndj(R,Arr,DOM){
                const r = d_r(R)                              // Melhorar declarações
                const [Typ,col,Id,Tm]=[r.Ty,r.Cl,r.Id,r.Tm]   // Melhorar declarações (melhor usar _R.Ty e _R.Cl)
                const COL   = col=='OS' ? 'OOSS' : AA(col)    // GAMBIARRRRRRRRRRRA
                const Ordem = ObjKey(BS[COL])
                const dado  = Typ=='GRAD' ? J[Typ].find(j=>j.Id==Id)[col] : JJ[Typ][Id][col]
                const Find  =  Tm=='Bndj' ? (dado||[]) : Tm=='Link' ? [JJ[COL][dado]] : []
                if(Tm=='Link'&&Find[0]==undefined){return}    // só ta aqui pq no Link GRAD quando chamo OS ta dando um ERRO pois um item é Undefined
                const Title = FazerTitle(col,Find)
                const SunPix  =Stg=>Stg.split('|').map(p=>parseFloat(p.replace(/[^\d.,]/g,'').replace(',','.'))||0).reduce((sum,n)=>sum+n,0) // Ver se eu Consigo Eliminar isso!
                const NmTle = col==='Pgmt'? SunPix(Title) : Title // (GAMBIARRA preparar pra RMV)
                const Cimg  = Find.map(e=>ImgT_T(col,e,R)).join('')
                Find.map(e=>`${todoTitle[col].push(e[col])}`)

                const Bandeija=(arr,TYP,_P)=>`<thead><tr>${arr[0].map(t=>`<th>${t}</th>`).join('')}</tr></thead><tbody>${arr.slice(1).map((LL,X)=>`<tr class="tr-${LL[0]}-${X}">${LL.map((v,x)=>Tm_Td(v,LL,x,TYP,_P)).join('')}</tr>`).join('')}</tbody>`
                if(DOM){return `${Find.map((e,x)=>x===0 ? Bandeija(ArrObj_OrdnCol(Find,Ordem),COL,R):'').join('')}`} // isso Roda a Situação dentro da Table
                else{return `<div class="Ct" onclick="LoadBndj(this,'${R}');ShowBndj(Pai(this),'${Typ}')">
                            <p data-R="${R}" class="P-P T-T Ct PT" name="${NmTle}">${Title}</p>${Cimg}<i class="grifoo PT RD" onclick="Tog_N($('i',this))"><i class="none"></i></i></div>
                            <div class="Rltv w100"><div class="BndjTBL BNdj Abslt none Cl"><a>${SVG.Ponta}</a>
                                <table class="Bdj_${COL} ${COL=='RG'?'':NoVazi(Find[0]?.Id)?'':'none'}"></table>
                                ${Tm=='Bndj'?`<button class="Mini" AddRowBdj(this,'${R}')">+ Novo ${RmvPlural(D_Brev[COL])}</button>`:
                                  Tm=='Link'?`<button class="Mini" onclick="Tog_N($('.TrcLINK',Pai(this)))">Trocar ${ col }</button><div class="TrcLINK none">${Tm_Tm['Link2']('',R,'')}</div>`:''}
                            </div>
                        </div>`
                }
            }

            function loadtmtable(Typ,GAMBIARRRRRRRRRA,Lmt){
                const LOAD=(TYP)=>{
                    Add_N($(`#H_${TYP}`)) // Oculta a Table Original pra poder ver o Esqueleto
                    setTimeout(()=>{NewTyp = J[TYP].filter(e=>{
                            if (e.Lixo ==true) return false
                            if (e.Data=='') return true
                            if (ObjKey(Llmt).includes(Typ) && Lmt){return RangeDATA(e.Data,Typ)}
                            return true
                        })
                        Inn($(`#H_${TYP} > tbody`),Tm_Table(TYP, !GAMBIARRRRRRRRRA ? NewTyp.reverse() : NewTyp))
                        RFresh(TYP,'All')
                        Rmv_N($(`#H_${TYP}`)) // Exibir a table Original
                        if($(`#SKLT_${TYP}`)){Add_N($(`#SKLT_${TYP}`))} // Ocultar o Esqueleto
                },0)}

                if(ObjKey(J).includes(Typ)){
                    if(PreTable[Typ]==true&&!GAMBIARRRRRRRRRA){MyAlert(Mnsg['PreTbl'](D_Brev[Typ]));return} // Conferir se essa Aba já foi Aberta!
                         if(Typ=='PDDS'){LOAD(Typ);LOAD('SERV');LOAD('PGMT')             } // tem 3 Tabelas na #PagPDDS
                    else if(Typ=='PGMT'){LOAD('MPAG')                                    } // tem 2 Tabelas na #PagPGMT
                    else if(Typ=='GRAD'){LOAD(Typ);LOAD('OOSS');LOAD('UBER'),LOAD('GRD2')} // tem 3 Tabelas na #PagGRAD
                    else{LOAD(Typ)}                                                        // os demais tem só 1 tabela
                    PreTable[Typ]=true                                                     // Declarar que a Aba já foi Aberta!
                }
            }

            // Permitir que todas as Imagens Possam ter Upload (separar das que não pode, pq são aquelas que vem dentro de um SYNK)
            // não quero mais o Cntrl pra persistir BNDJ ngm nunca usou nem EU
            // 🚫 select deveria ter name pra n ser afetado pelo Realtime
            // 🚫 impedir que cliente seja excluido quando ele tiver atribuido a pelomenos 1 Pedido
            // 💡 Opção de mais de 1 Designer
            // 💡 Mover-se nas células com as Setas

            /*
                "ARTE FEXTA 2026 - 001.webp"
                "ARTE FEXTA 2026 - 002.webp"
                "ARTE FEXTA 2026 - 003.webp"
                "ARTE FEXTA 2026 - 004.webp"
                "ARTE FEXTA 2026 - 006.webp"
                "ARTE FEXTA 2026 - 009.webp"
            */
        </script>
    </div>

    <div>   <!--PESQUISA - ⭐⭐⭐⭐_  (⚡ sem DOM ⚡) (🎨 Apenas Melhorar a Interface) (⚠️ botar os Grifos na Bibliotecas pra tbm ser usado no Select)-->
        <style> /*CSS - PESQUISA*/
            #Lupa   {top:8px; right:6px; width:17px; opacity:0.5} #Lupa:hover{opacity:1}
            .pPesq a{color:#ffffff ; top:8px} .pPesq a.Atv{color:#00ff0d !important}
            .Pesq-A_{right:30px}.Pesq-Aa{right:50px}.Pesq-Bj{right:70px}.Pesq-Rx{right:90px}.Pesq-_C{right:110px}
            @media(max-width:500px){#Div-Pesq{width:50%}}
        </style>

        <script> // SCRIPT - PESQUISA
            let debounceTimer
            const Espelhar =(Org,Dst)=>{Dst.forEach(e=>{e.innerHTML = Org.innerHTML ; $('input',e) ? $('input',e).value = $('input',Org).value : null})}
            const RmvGrifo =e=>Inn(e,Inn(e).replace(/<strong[^>]*>(.*?)<\/strong>/gi,"$1"))
            const Acnto    =(s,Tru)=>Tru && s ? `${s}`.normalize("NFD").replace(/[\u0300-\u036f]/g,"") : s
            const GrifarAcc=(e,Rx,C)=>{
                const t  = e.textContent ; const tn = C ? t.normalize("NFD").replace(/[\u0300-\u036f]/g,"") : t
                const m  = tn.match(Rx) ; if (!m) return ; const i = m.index
                Inn(e,t.slice(0,i)+`<strong style="background:orange">${t.slice(i,i+m[0].length)}</strong>`+t.slice(i+m[0].length))
            }
            
            const Load_Pesq=Typ=>
                `<div class="pPesq Pesq_${Typ} Rltv" class="none">
                    <input class="w100 Pcy" placeholder="Pesquisar em ${D_Brev[Typ]}..." oninput="Pesq(this,'${Typ}')">
                    <i class="Abslt" onclick="Tog_N($('span',Pai(this)))">▼</i>
                    ${['Aa','A_','Bj','Rx','_C'].map(e=>`<a class="Abslt HOV Pesq-${e}" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">${e}</a>`).join('')}
                    <img id="Lupa" class="Abslt HOV" src="./SVG/Icon_Lupa.svg">
                    <span class="BndjPsq BNdj Abslt Ct none">
                        <select class="COL1" onload="Inn(this,Tm_Opt(['','','Clnt','Serv','Pgmt']))"></select>
                        <select class="COL2" onload="Inn(this,Tm_Opt(['','','Grad','Desc','Cmnt']))"></select>
                        <div onload="Tm_Check(this,'${SVG.Chek.replace(/"/g,'&quot;')}','Mais de uma Correspondência')"></div>
                        <div onload="Tm_Check(this,'${SVG.Chek.replace(/"/g,'&quot;')}','Aceitar Erros Ortográficos' )"></div>
                    </span>
                </div>`

            function Pesq(Ipt,Typ){ /*ao apagar todo o texto os icons SOME, */
                clearTimeout(debounceTimer) // Cancela Chamadas Anteriores ao escrever mt Rápido
                debounceTimer = setTimeout(()=>{
                    Espelhar(Pai(Ipt),$$(`.Pesq_${Typ}`).filter(e=>e!==Pai(Ipt)))
                    const I = Ipt.value.trim().replace(/\s+/g,' ') // Limpar exesso de Espaços
                    const Aa=$(`.Pesq_${Typ} .Pesq-Aa.Atv`)?  '' :'i'               // Funcionando
                    const A_=$(`.Pesq_${Typ} .Pesq-A_.Atv`)?'\\b':''                // Funcionando
                    const Bj=$(`.Pesq_${Typ} .Pesq-Bj.Atv`)                         // Funcionando
                    const rx=$(`.Pesq_${Typ} .Pesq-Rx.Atv`)                         // Funcionando
                    const _C=$(`.Pesq_${Typ} .Pesq-_C.Atv`)?false:true              // Funcionando
                    const RX = new RegExp(`${A_}${rx?I:EscpRgx(Acnto(I,_C))}${A_}`,Aa)
 
                    if(Typ=='ORC'){ // Página é Orçamento
                        $$('#Div-Prod > div').forEach(e=>{
                            $$(".rgx",e).forEach(Rx=>GrifarAcc(Rx,RX,_C))         // grifar  as Ocorrências
                            AddTrue(e,'NONE',!RX.test(Acnto(e.textContent,_C)))}) // Ocultar as Ausentes
                    }

                    else if(Coten($(`#Pag_${Typ}`),'TBLAA')){ // Página é uma Tabela
                        
                        TRs(Typ).forEach(tr=>{ // Rodar isso pra cada Tr
                            let trOK = false
                            const [C1,C2] = [Vll($('.COL1',Pai(Ipt))),Vll($('.COL2',Pai(Ipt)))]
                            const P_P = $$(`:scope ${C1?Rx7(Typ,C1):Rx7(Typ)}`,tr)          // Todos P-P da Camada1
                            P_P.forEach(p=>{
                                RmvGrifo(p) ; Rmv(p,'Psq')
                                if(I==='"'){if(`${VAL(p)}`.trim()===""){Add(p,'Psq');trOK=true}return} // Caso Seja Strng Vazia
                                const Chk = RX.test(Acnto(VAL(p),_C))
                                if(p.tagName=='P'){GrifarAcc(p,RX,_C)}                                 // Passa em cada P, grifa as Ocorrências e dar TrOK
                                if(p.tagName=='SELECT' && Chk && I!=""){Add(p,'Psq')}                  // Passa em cada Select e Pinta ele
                                if(Chk){trOK=true}
                            })
                            const PesqJJ=j=>{try{const has=v=>v&&RX.test(Acnto(v,_C)+""),ent=o=>ObjEtr(o).find(([k,v])=>has(v)),arr=a=>a&&a.map(ent).find(Boolean)
                                    if (C1) {const v1 = j[C1] ; if(r=arr(v1)) return[C1,r[0],r[1]]} else {;const r1 = ObjEtr(j).find(([k,v])=>isArr(v) && arr(v));if(r1){const r2=arr(r1[1]);return[r1[0],r2[0],r2[1]]}} // MODO 4 — pesquisa interna sempre ativa
                                    const v1 = j[C1] ; if (C1&&C2 && isArr(v1)) {const o2=v1.find(o=>o&&has(o[C2]));if(o2) return [C1,C2,o2[C2]]}                                                                        // MODO 3 — pesquisa em duas camadas (C1 + C2)
                                return false}catch{return false}
                            }
                            const bjj=PesqJJ(JJ[Typ][tr_ID(tr)])                            // 1° - Encontrar a Linha pelo Obj JJ e Faz o Match e Retorna o Caminho
                            $$('.GrifNot1',tr).forEach(e=>{Rmv(e,'GrifNot1')})              // 2° - Limpa todos os "grifNot"
                            $$('.GrifFora',tr).forEach(e=>{Inn(e,''        )})              // 2° - Limpa todos os "GrifFora"
                            const td = bjj ? _td($(Rx7(Typ,bjj[0]),tr)) : null
                            if(I!=''&&bjj){Add(td,'GrifNot1');Inn($('.grifoo i',td),bjj[2]) // 3° - Se algum Bater faz o grifNot apartir do Caminho de bjj
                            Inn($(':scope > td > div > .GrifFora',tr),bjj[2]);trOK=true}
                            if(trOK){Rmv(tr,'n0')}else{Add(tr,'n0')}                        // 4° - Exibir e Ocultar as tr OK
                        })
                        Re_Foot(Typ)
                    }
                },100)
            }

            // 🔨 Grifo, Bndj de Pesq deve Ocultar conforme Click Fora
            // 🔨 Fazer o Grifo Acontecer dentro da Bandeija apenas quando ela for Aberta!
            // 💡 Pesquisa por mais de uma Ocorrência:'^(?=.*Fraco)(?=.*Lutar).*$'
            // 💡 Aceitar Erro de Ortografia da pra usar aquele clean Regex q eu já tinha antes
        </script>
    </div>

    <div>   <!--FILTROS  - ⭐⭐⭐⭐_  (⚡ sem DOM ⚡) (🎨 Melhorias Bestas) -->
        <style> /*FILTROS - CSS*/
            /*Particularidades da BndjFLT*/
            .ThFilt > i    {position:absolute; cursor:pointer; font-size:9px; right:0px; top:50%; transform:translate(-0%,-50%);opacity:0.5}
            .ThFilt > i.Atv{opacity:1}
            .ThFilt > b    {position:absolute; border-radius:255px; width:15px; height:15px; text-align:center; top:-5px; }
            .ThFilt > b.Atv{background:#0c8f00; right:29px}
            .ThFilt > b.Rtv{background:#ff0000; right:10px}   

            .filtTrue{  color:#ffffff; background:#008000 !important} /*aplica no Tr*/
            .filtFals{  color:#ffffff; background:#ff0000 !important} /*aplica no Tr*/
            .ThFilt_Atv{color:#ffffff; background:#059b00}            /*aplica no Filt*/
            .ThFilt_Rtv{color:#ffffff; background:#ff0000}            /*aplica no Filt*/
        </style>
        <script> // FILTROS - SCRIPT
            const Tm_thSort=(arr,Typ)=>{             // ✔️ Carrega Todos os Cabeçalhos (melhorar os CSS do input=[date])
                return arr.map((e,x)=>e=='Lixo'?`<th><p>${''}</p></th>`:
                    `<th class="ThFilt Rltv PT" onclick="ShowBndj(this);OpcyFilt(_table(this).id);Tm_Filt(this,'${Typ}','${e}')">
                            <p class="PT" name="${e}">${Typ=="SERV"?e:dbCol[e]||e /*Gambiarra pra remvoer o DbCol*/}</p>
                            <i onclick="Orden(this,event,'${x}')">▼</i>
                            <b class="Ct none Atv">0</b>
                            <b class="Ct none Rtv">0</b>

                            <div class="Rltv w100">
                                <div class="BndjFLT BNdj Abslt none">
                                    <div class="BjConf Stky Ev" onclick="ShowDate(this,'${Typ}','${e}')"></div>
                                    ${e=='Data'?`<input type="date" onchange="RangeDate(this,'${Typ}','${e}')" class="D-Inn none">
                                                 <input type="date" onchange="RangeDate(this,'${Typ}','${e}')" class="D-Out none">` : ''}
                                    <span class="Sugg Cl">${e}</span>
                                </div>
                            </div>
                    </th>`).join('') // P=Texto, i=▼, b=Notfi, a=Config, span=Suggs
            }

            const Trato=(Arr,col)=>{                 // ❌ Corrige palavras (xDOM talvez já de pra eu Analisar isso!)
                return col==='Valr' ?  FazArry(Arr).map(e=>Cm(e.replace('R$','').trim()))     // Remove os R$ (não tão nessesário caso os dados venham certinhos)
                      : col==='Pgmt' ?      Arr.flatMap(e=>e.replace(/\d*/g,'').split(' | ')) // Pega apenas os ['Pix','Av'...]
                      : col==='Stts' ? ''
                      : Arr
            }

            function Palavras(Typ,Col,n,Brute){      // ✔️ Encontra e Modifica as palavras q vai Exibir no Filtro
                const IN = performance.now()                                
                    const Clientes = ['Id','Clnt','Cmpt','Cntt','Lcal','Loja','CtLj','Cat','Stts','Lin','Link']
                    const Servicos = ['Id','Serv','Desc','Data','Valr','Detg','Grad','OS','Uber','Cmnt']
                    const Pagament = ['Id','Desc','Data','Link','Mpag','Valr']
                    const Pedidoss = ['Id','Lin' ,'Data']
                    const Mercapag = ['Id','Valr','Data','Hora','Mpag','Link']

                    const Valls =   Brute=='Brute'                        ? Uniq(Colls(Typ,Col,n).map(e=>VAL(e)))             :
                                    Typ=="SERV" && Col==='OK'             ? ['true','false']            :
                                    Typ=="SERV" && Col==='Entg'           ? ['true','false']            : 
                                    Typ=="SERV" && Col==='Arte'           ? ['true','false']            : 
                                    Typ=="CLNT" && Clientes.includes(Col) ? Uniq(J.CLNT.map(E=>E[Col])) :
                                    Typ=="MPAG" && Mercapag.includes(Col) ? Uniq(J.MPAG.map(E=>E[Col])) :
                                    Typ=="SERV" && Servicos.includes(Col) ? Uniq(J.PDDS.flatMap(e=>e['Serv'].map(E=>Trato(E[Col],Col)))) :
                                    Typ=="PGMT" && Pagament.includes(Col) ? Uniq(J.PDDS.flatMap(e=>e['Pgmt'].map(E=>Trato(E[Col],Col)))) :
                                    Typ=="PDDS" && Pedidoss.includes(Col) ? Uniq(J.PDDS.map(e=>e[Col])) :
                                    Col=='Clnt' ? Uniq(todoTitle[Col]) :
                                    Typ=="PDDS" && ['Cust'].includes(Col) ? Uniq(todoTitle[Col]) :
                                    Typ=="PDDS" && Col==="Serv"           ? Uniq(todoTitle[Col]) :
                                    Typ=="PDDS" && Col==='Valr'           ? Uniq(todoTitle[`Sum_${Col}`].map(e=>Cm(e))) :
                                    Typ=="PDDS" && Col==='Stts'           ? ListEtps.map(e=>`${e[0]} <a style="fill:rgb(${COR[e[1]]})">${SVGEtapas[e[0]]}</a>`) :
                                    AllList.includes(Col) ? O[Col] :
                                    // o Obigetivo central da Função é Evitar isso!
                                    Uniq(Colls(Typ,Col,n).map(e=>VAL(e))) // PEZADO

                    MSRX(MS(IN)) < 1.0 ? null : LOG(`⏱️🟡 palavras:(${Typ},${Col}): ${MS(IN)}`) // quando eu venho por F_Filt() não precisa do Typ
                    return Valls
            }
            
            function Tm_Filt(Eu,Typ,col){            // ✔️ Depende da Tabela Carregada
                if(BS[Typ][col][1]==true){return} ; BS[Typ][col][1]=true // Evita q carregue 2 Vezes!
                const IN = performance.now()
                const ThSugg = $('.Sugg',Eu)
                const X = IdxDe(_th(ThSugg))+1           
                const qry   = `#H_${Typ} > tbody > tr > ${COLLLL(Typ,col)} > div > .P-P`
                const Qry_N = qry.replace('tr',"tr:not([class*=` n`])") // Aplicar apenas para Linhas Visiveis // Pode Sair!
                const QRY = [Typ,col]
                const Ex = `Ex_Filt('${Typ}','${col}')`

                $('.BjConf',_th(ThSugg)).innerHTML = `
                    <span class="HOV PT Ct" onclick="F_Filt(this,'${Typ}','${col}','Todos')"           ><img src="./SVG/Icon_Todos.svg">     <p class="none">Todos     </p> </span>
                    <span class="HOV PT Ct" onclick="F_Filt(this,'${Typ}','${col}','${Qry_N}','${X}')" ><img src="./SVG/Icon_Filtados.svg">  <p class="none">Filtados  </p> </span>
                    <input class="" placeholder="pesq">
                    <span id="icnFront_${col}" class="HOV PT Ct" onclick="TOV(this);${Ex}"             ><img src="./SVG/Icon_Lin.svg">                                      </span> 
                    <span class="HOV PT Ct" onclick="F_Rndn(this,'${Qry_N}')"                          ><img src="./SVG/Icon_Randomizar.svg"><p class="none">Randomizar</p> </span>
                    <span id="icnFilt_${col}"  class="HOV PT Ct" onclick="TOV(this);${Ex}"             ><img src="./SVG/Icon_Destacar.svg">  <p class="none">Destacar  </p> </span>
                `// no icon Linha ta afunção Ativa ou Desativa Frontira de palavras

                const Lista = Palavras(Typ,col)
                const NovoArry = Lista.map(e=>e===''?"'Vazio'":e).sort(e=>e==="'Vazio'"?-1:1)

                ThSugg.innerHTML = NovoArry.map(e=>`<div class="Ct w100">
                                                    <div class="PT RD HOV" onclick="F_Clik(this);${Ex}">-</div>
                                                    <p>${e}</p>
                                                    <div class="PT RD HOV" onclick="F_Clik(this);${Ex}">+</div>
                                                    </div>`).join('')

                MSRX(MS(IN)) < 1.0 ? null : LOG(`⏱️🔵 Tm_Filt(${Typ},${col}): ${MS(IN)}`)
            }

            function F_Filt(btn,Typ,cOl,Qry,Col){    // ✔️ Filtra o Filter (⚠️ descobrir pq n funciona com Numeros) talvez n tenha nada aver com xDOM
                const ThSugg = $('.Sugg',_th(btn))
                const FotBndj = Col ? $(`:scope > tfoot > tr > td:nth-child(${Col}) .BndjFOT`,_table(btn)) : null
                const arry    = FotBndj ? $$('span',FotBndj).map(s=>s.innerText.split(':')[0]) : null
                const Plvrs   = !arry && Trato(Palavras(Typ,cOl,true,'Brute'),cOl) // tem q ser no Brute pra poder pegar apenas os visíveis
                    $$('p',ThSugg).forEach(E=>{
                        if(Qry==='Todos'){Rmv_N(Pai(E))
                        }else if(arry){
                            if(arry.includes(E.innerText)){Rmv_N(Pai(E))
                            }else{Add_N(Pai(E))}               // da pra remover isso
                        }else if(Plvrs.includes(E.innerText)){Rmv_N(Pai(E))
                        }else{Add_N(Pai(E))}                   // da pra remover isso
                    })
            }

            function F_Clik(Eu){                     // ✔️ Pinta o Filt com Ativo e Desativo
                Prvn()
                const [r,a]=['ThFilt_Rtv','ThFilt_Atv']
                const PP = $('p',Pai(Eu)) // Valor Clicado
                if(Inn(Eu)=='+'){ LOG(Inn(Eu)) ; if(Coten(PP,r)){Rmv(PP,r)}else{Tog(PP,a)}}
                if(Inn(Eu)=='-'){ LOG(Inn(Eu)) ; if(Coten(PP,a)){Rmv(PP,a)}else{Tog(PP,r)}}
                const Notifi=e=>{const l = $$(`.ThFilt_${e}`,_th(Eu)).length ; const n = $(`b.${e}`,_th(Eu)) ; if(l==0){None(n)}else{Show(n)} ; Inn(n,l) } // Atualiza Notificações + ou -
                Notifi('Atv') ; Notifi('Rtv')
            }

            function Ex_Filt(Typ,col){               // ✔️ Executa o Filto na Tabela (⚠️ Adicioanr Maior < Menor >) parece q tbm n tem xDOM
                const thh    = TH(Typ,col)
                const cOR    = $(`#icnFilt_${Nm($('p',thh))}.Atv`)
                const Front  = $(`#icnFront_${col}.Atv`)
                const aTV    = $$('.ThFilt_Atv',thh).map(e=>Front?`\\b${Txt(e)}\\b`:Txt(e)).join('|') ; const RxAtv = new RegExp(aTV,'i')
                const rTV    = $$('.ThFilt_Rtv',thh).map(e=>Front?`\\b${Txt(e)}\\b`:Txt(e)).join('|') ; const RxRtv = new RegExp(rTV,'i')
                const x      = IdxDe(thh)+1
                const Add_C  = e=>Add(e,'filtTrue') ; const Add_F=e=>Add(e,'filtFals')
                const Rmv_C  = e=>Rmv(e,'filtTrue') ; const Rmv_F=e=>Rmv(e,'filtFals')

                if(true){ // depois vira (Combinado = && E) ou (Independente = || OU)
                    $$(`#H_${Typ} > tbody > tr ${Rx7(Typ,col)}`).forEach(e=>{
                        const VaL = `${VAL(e)}` || "'Vazio'"
                        const tr = _tr(e)
                        if(aTV=='' && rTV==''){ Rmv(tr,`n${x}`) ; Rmv_C(tr) ; Rmv_F(tr) }
                        else{
                                 if(aTV!=='' && RxAtv.test(VaL)){cOR ? Add_C(tr) : Rmv(tr,`n${x}`)}
                            else if(rTV!=='' && RxRtv.test(VaL)){cOR ? Add_F(tr) : Add(tr,`n${x}`)}
                            else{if(aTV!==''){cOR ? Rmv_C(tr) : Add(tr,`n${x}`)}
                                 if(rTV!==''){cOR ? Rmv_F(tr) : Rmv(tr,`n${x}`)} }
                        }
                    })
                }
                Re_Foot(Typ)
            }

            function F_Rndn(Eu,Qry,Clik){            // ✔️ Randomiza   parece q tbm n tem xDOM
                const noCopy       = true // impedir que pinte quando não tem cópias
                const PermitOculta = true // opção pra ocultar quem n tem Randon
                const QRY = Qry.replace('` n`','" n"')
                const ObbjClnt=()=>$$(QRY).map(e=>Inn(e))
                let NewObj = {}
                const QntCores = Uniq(ObbjClnt()).length
                const CoresEtr = ObjEtr(cRepet(ObbjClnt())).sort((a,b)=>b[1]-a[1]).forEach(([k,v])=>{
                        if(noCopy&&v===1   ){} // não faz nada caso seja apenas 1 ocorrência
                    else if(!k||k.trim()==''){} // n faz nada caso seja vazio
                    else{
                        if(true){NewObj[k]=RandoCor()}  // cor Randon
                        else{NewObj[k]=v}               // do maior pra o menor
                                                        // corsin Cor Não
                    }
                })
                $$(QRY).forEach(e=>{
                    Bkg(_tr(e),NewObj[Inn(e)])
                    if(PermitOculta && NewObj[Inn(e)]==undefined){Add(_tr(e),'none')} // tentar mudar pra UndfNull(NewObj[Inn(e)]) // pra usar a biblioteca
                })
                // pra melhorar o Randomize
                // ele deveria Randomizar com um Limite de cores dentro de um intervalo específico
                // e quando eu quser Pintar apenas o Td
                // e ter uma Limpeza apenas para o Random
                // ou caso a Limpeza Limpe tudo, mas que pelomenos refaça as cores do Recolor Etapas
            }
            
            function F_Clen(Typ){                    // ✔️ Limpa todos os Filtros
                TRs(Typ).forEach(e=>{For(20).forEach(E=>Rmv(e,`n${E}`)) ; Bkg(e,'')}) // Exibe todas as Linhas e Limpa o Random
                $$('.ThFilt b'  ).forEach(e=>None(e)) // Limpa Notifi dos Filter
                const Class = ['ThFilt_Atv','ThFilt_Rtv','filtTrue','filtFals','SelectSoma']
                Class.forEach(e=>{$$(`.${e}`).forEach(E=>{Rmv(E,e)})})
                Re_Foot(Typ)
            }

            function OpcyFilt(Typ){                  // ❌ Ativar Desativa opacy do Icon do F_Filt() //SIMPLIFICAR//
                const Valid = $$(`#${Typ} .ThFilt b`).some(e=>e.innerText!=0)
                const Icon1 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(1)`)
                const Icon2 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(2)`)
                const Icon3 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(4)`)
                const Icon4 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(5)`)
                if(Valid){Icon2.forEach(e=>e.style.opacity = 1)
                }else{Icon2.forEach(e=>e.style.opacity = 0.4)}
                // Precisa evitar o Click, tem q dar Return quando isso tiver Ativo!
            }

            function ShowDate(Eu,Typ,Col){           // ✔️ Oculta e Exibe a Bandeija de Range Data
                if(Col=='Data'){Tog($$(`.D-Inn,.D-Out`,_th(Eu)),'none')}
            }

            function RangeDate(Eu,Typ,col){          // ✔️ Seleciona o Intervalo de Data
                const inn   =  $(`.D-Inn`).value
                const out   =  $(`.D-Out`).value || inn
                $$('.Sugg > div',_th(Eu)).forEach(e=>{const D = $('p',e) // D é Data
                    if(Inn(D)>=inn && Inn(D)<=out){Add(D,'ThFilt_Atv')}
                    else{Rmv(D,'ThFilt_Atv')}
                })
                Ex_Filt(Typ,col)
                // Depois Evoluir pra Criar minha Próprio Calendário, pra eu poder fazer aquele Range de faixa
                // Adicionar Botão de Todo Período (oq seria Remover todos os Filtros)
            }

            function Orden(e,ev,x,order=null){       // ✔️
                function TogSeta(e,asc){AllI(_table(e)).forEach(i=>{DTV(i);i.textContent='▼'});const atu = SibQSl(e,'i') ; ATV(atu) ; atu.textContent = asc?'▼':'▲'}
                const table = _table(e)
                const cOl = $('p',_th(e))
                const tbody = $('tbody',table)
                const asc = order ? order === 'asc' : table.dataset.sortOrder !== "asc"
                const Get=E=>$('.P-P',E.children[x])

                const Ordn = [...tbody.rows].sort((a,b)=>{                    
                    if(KeyCtrl(ev)){ // se tiver com Cntrl Selecionado faz o Filtro por Caracteres
                        const lenA = (VAL(Get(a)) || '').length
                        const lenB = (VAL(Get(b)) || '').length
                        return asc ? lenA - lenB : lenB - lenA
                    }
                    if(cOl=='Data'){
                        // 📅 Se ambos forem datas válidas (ex: "2024-12-03")
                            const dateA = new Date(VAL(Get(a)).trim() || '2000-01-01')
                            const dateB = new Date(VAL(Get(b)).trim() || '2000-01-01')           
                            if(!isNaN(dateA) && !isNaN(dateB)){return asc ? dateA-dateB : dateB-dateA}
                    }
                    // Ordena se for Numeros
                        const valA = parseFloat(Txt(Get(a)).replace('R$',''))
                        const valB = parseFloat(Txt(Get(b)).replace('R$',''))
                        if(!isNaN(valA) && !isNaN(valB)){return asc ? valA-valB : valB-valA}
                        
                    // Ordena como texto se não forem números
                        const txtA = `${VAL(Get(a))}`.replace('R$','')
                        const txtB = `${VAL(Get(b))}`.replace('R$','')
                        return asc ? txtA.localeCompare(txtB) : txtB.localeCompare(txtA)
                })
                table.dataset.sortOrder = asc ? "asc" : "desc"
                Ordn.forEach(r=>tbody.appendChild(r))
                TogSeta(e,asc)
            }

            // Voltar ordem ao Normal
        </script>
        <script> // um tipo de Filtro que Reescreve
            function FiltMes(Mes,Typ){
                LOG('Mes',mesesObj[Mes])
                const Filt = RangeMes(J[Typ],mesesObj[Mes])
                Inn($(`#H_${Typ} > tbody`),Tm_Table(Typ,Filt))
                RFresh(Typ,'All')
            }
        </script>
    </div>

    <div>   <!--RECOLOR  - ⭐⭐⭐⭐_  (⚡ sem DOM ⚡) (🎨 Apenas Melhorar a Interface) (Recolorir ao Abrir Bndj) (Baixa Peformance)-->
        <style> /*RECOLOR - CSS*/
            .EtpSVG{height:25px; width:25px;pointer-events: none;}
            #H_PDDS > thead > tr > th:nth-child(1)      {display: none;}
            #H_PDDS > tbody > tr > td:nth-child(1)      {display: none;}
            #H_PDDS > tfoot > tr > td:nth-child(1)      {display: none;}
            #H_PDDS > tbody > tr > td:nth-child(6)  .P-P{font-size:13px ; border-radius: 255px ; cursor: pointer;} /*Valr*/
            #H_PDDS > tbody > tr > td:nth-child(7)  .T-T{font-size:13px}                                           /*Pgmt*/
            #H_PDDS > tbody > tr > td:nth-child(11)  svg{margin:0px 5px}                                           /*Lixo*/
        </style>

        <script> // RECOLOR  - SCRIPT
            const Igual2 =(j,a,_,b)=>{const x=j[a],y=j[b];if(!x) return false;return{'=':x==y,'>':x>y,'<':x<y,'!':x!=y}[_]||false}
            
            const CC = { // Criterio 1  é Obrigaório existir
                SERV:{OB:['Serv','TArt','Dsng','Grad','Uber','OK','Entg'],OC:[]},
                PGMT:{OB:['Data','Valr','Form']                          ,OC:[]},
                GRAD:{OB:[]                                              ,OC:[['Cont','=','Cnt2'],['VlrO','=','Summ']]},
                OOSS:{OB:[]                                              ,OC:[['Cont','=','Cnt2']]},
                CLNT:{OB:['Clnt','Cmpt','Cntt']                          ,OC:[]}
            }

            const LALEL = {
                SERV:{Serv: ['Orçamento'  ,COR['Roxo'],COR2['Roxo'],'black'],
                      TArt: ['Arte'       ,COR['Roxo'],COR2['Roxo'],'white'],
                      Dsng: ['Arte'       ,COR['Roxo'],COR2['Roxo'],'white'],
                      Grad: ['Impressão'  ,COR['Yelw'],COR2['Yelw'],'white'],
                      Uber: ['Acabamento' ,COR['Yelw'],COR2['Yelw'],'white'],
                      OK:   ['Pronto'     ,COR['Azul'],COR2['Azul'],'white'],
                      Entg: ['Entregue'   ,COR['Gren'],COR2['Gren'],'white'],
                      Deve: ['Devendo'    ,COR['Redd'],COR2['Redd'],'white'],
            }}

            const GetStts=(arr,L,O)=>{ // Função pra Encontrar as Etapas
                const S = new Set(arr)
                const m = O.find(e=>!S.has(e))
                const l = [...O].reverse().find(e=>S.has(e))
                if (!l) return L[m]
                if (!m) return L[O.at(-1)]
                return O.indexOf(m) < O.indexOf(l) ? ((r=[...L[m]]),(r[0]=L[l][0]),r) : L[l]
            }

            function IcnEtp(Typ,tr,Etp,cct){ // acho q da pra Remover isso! de OBJ
                const objj = {'PDDS':'Stts','SERV':'SStts'} // Provavelmente já n sei usa mais
                stt = $(`:scope ${Rx7(Typ,'Stts')}`,tr)
                const Bndjj=(e)=>`${e}<div class="BndjTBL MySelect BNdj Abslt none Cl"><a>${SVG.Ponta}</a><span class="Cl"></span></div>`
                if(cct){Nm(stt,cct)}                                                   // Joga o Concate no Name do td Stts
                Inn(stt,Bndjj(`<div class="Rltv" onclick="ShowBndj(_td(this));RenderSVVG(_td(this))" style="fill:rgb(${Etp[2]})">${SVGEtapas[Etp[0]]}</div>`)) // Dar o Inner do SVG dentro do Stts
            }

            function R_Cor(e,opc,Cor){ // nesta função dar apeans o Retorno caso "e" não seja DOM
                if(!isDOM(e)){return [opc,Cor]}
                if(e.tagName=='TD'){Bkg(e,`rgba(${Cor},${(opc).toFixed(2)})`)}        // Colore o Fundo com Opacidade
                else{Bkg(e,`rgb(${Cor.split(',').map(v=>Math.round(+v+(255-v)*(1-opc))).join(',')})`)} // Colore o Fundo sem Opacidade
                e.style.color        = `rgb(${Cor.split(',').map(e=>e/4).join(',')})` // Colore o Fundo
                e.style.borderBottom = `1px solid rgba(${Cor},${(opc).toFixed(2)})`   // Colore a Borda
                $$('select',e).forEach(E=>Bkg(E,'#00000000'))
                return [opc,Cor]
            }

            // tem como fazer isso sem Pintar?
            function R_Colr(tr,Typ,Mod,TR){ // Mod TEmperatura :: // Ta Funcionando pra GRAD,OOSS,PGMT
                const DOM = isDOM(tr)
                const bjj = JJ[Typ][DOM?tr_ID(tr):tr] ; if(!bjj){return}      // ✔️ Pega o Objeto pelo Id do tr
                const Atu = CC[Typ].OB.filter(e=>NoVazi(bjj[e]))              // ✔️ dos Obrigatórios retorna os Preenchidos
                const Crt1= CC[Typ].OB.map(e=>NoVazi(bjj[e]))                 // ✔️ Crit Obrigatório
                const Crt2= CC[Typ].OC.map(e=>Igual2(bjj,...e))               // ✔️ Crit Comparação
                const Crt = [...Crt1,...Crt2]                                 // ✔️ Crit Concatenados
                const opc = _0_1(Crt.filter(v=>v==true).length/Crt.length)    // ✔️ Part/Total == Porcentagem do que Falta

                if(DOM){Bkg(tr,'');$$('td',tr).forEach(e=>e.style.border='')} // ✔️ Zera Fundo e Borda
                if(Mod=='Etapa'&&Typ=="SERV"){
                    const TRR  = !DOM ? $(`[class^="tr-${tr}"]`,TR) : null
                    const Etp = GetStts(Atu,LALEL[Typ],CC[Typ].OB) ; if(!Etp){return}
                    if(!DOM && !TRR){return [opc,Etp[1],Etp]}              // Ativar ou Desativar quando tiver ou n DOM (to usando isso aqui pq n consigo Cancelar o Icone por aqui, a n ser que eu infie o Icone em R_Cor())
                    const trr = !DOM ? TRR : tr
                    /*DOM*/ IcnEtp(Typ,trr,Etp,Atu.join('-'))       // Adiciona o Icone em Serv
                    /*DOM*/ return [...R_Cor(trr,opc,Etp[1]),Etp]   // Pinta o Tr
                }// da pra melhorar isso pra n precisar ficar com treta de !DOM só passar isso dentro de R_Cor()
                else if(Crt.every(v=>v==true )){return R_Cor(tr,1,COR['Gren'])} // Todos os Crit são True Tentar usar o Próprio R_Cor pra dar Return tbm
                else if(Crt.every(v=>v==false)){return [0,'']}                  // Todos os Crit são False
                else{return R_Cor(tr,opc,COR['Yelw'])}
                // Após Colorir Confeir pra ver qual q vai se Destacas, e PDDS quem se Destaca é Valr (Fazer isso pra as Demais)
            }

            function Re_Colr(Typ,All){                // ✔️ Muda a cor de Todos os 'tr' ou de 1 'tr' só!
                const IN = performance.now()
                const trs = All=='All' ? TRs(Typ) : [All]
                if(Typ=='SERV'){trs.forEach(tr=>{R_Colr(tr,Typ,'Etapa')})}
                if(Typ=='GRAD'){trs.forEach(tr=>{R_Colr(tr,Typ,'Temperatura')})}
                if(Typ=='OOSS'){trs.forEach(tr=>{R_Colr(tr,Typ,'Temperatura')})}
                if(Typ=='PGMT'){trs.forEach(tr=>{R_Colr(tr,Typ,'Temperatura')})}
                if(Typ==='PDDS'){trs.forEach(tr=>{let ss = '' // Traz pra cá alem do ss todas as info importantes
                    const opc   =e=>e.reduce((a,v)=>a+v[0],0)/e.length
                    const Menor =arr=>arr?.length ? arr.reduce((m,a) => O['Stts'].indexOf(a[2][0]) < O['Stts'].indexOf(m[2][0]) ? a : m) : null
                    const Exec  =(typ,Mod)=>{const s = getArr(JJ[Typ][tr_ID(tr)][Aa(typ)]).map(tr2=>R_Colr(tr2.Id,typ,Mod,tr)) ; if(typ=='SERV'){ss=s}} // soma Opacidade de 'Clnt','Serv','Pgmt'
                    Exec('SERV','Etapa') ; Exec('PGMT','Temperatura') ; // Exec('CLNT','Temperatura') // por enquanto desativa Clnt pq n vai funcionar mt bem
                    if(ss.length==0){return} // Rodando agora na Linha tr
                    const Etp = Menor(ss)[2] // ⚠️ Essa Função precisa do DOM interno pra Saber qual é o Menor, Arrumar um Jeito de Descobrir Melhor isso. sem o DOM
                    const Vlr = $(`:scope ${Rx7(Typ,'Valr')}`,tr)  // pega Valr de PDDS (oq é a Soma de todos Valr de SERV em JJ)
                    const Pag = $(`:scope ${Rx7(Typ,'Pgmt')}`,tr)  // pega o valor q foi pago q é a Soma dos Valr de PGMT
                    const Dev = Etp[0]=='Entregue' && Nm(Vlr) > Nm(Pag)     // Conferir se já foi entrege e se ainda falta dinheiro ⚠️ A Validação de Ambos deve ser feita pelo const JJ['PDDS'][ID].Serv.map(e=>e.Valr) e depois com Pgmt
                    const E = Dev ? LALEL['SERV']['Deve'] : Etp
                    IcnEtp(Typ,tr,E)                           // Adicionar o Icone de Etapas
                    R_Cor(tr,opc(ss),E[1])                     // Pintar o Tr
                    Bkg(Vlr,`rgb(${E[2]})`,E[3])               // Pintar o P-P de Valr  (isso pode ficar Dentro de R_Cor() caso exista um argumento indicando quem é especial)
                    if(Dev){$$('td',tr).forEach(d=>Bkg(d,''))} // Quando Tiver Devendo Limpar as Cores dos Td
                })}
                if(All=="All"){LOG(`🔄 Re_Colr:(${Typ}) ${MS(IN)}`)}
            }

            // Modo:['Etapas','Temperatura','Opacidade']
            // Depois trabalhar na questão das Linhas border de Cada Tr tanto Pintado quando Sem cor
        </script>
    </div>
    
    <script> // AUTOCOMP - ⭐⭐⭐ _ _  (⚡ Precisa Funcionar sem BNDJ) (Recomp ao Abrir Bndj) (ainda falta Muito...)

        const Regra=v=>v==0 ? 0 : v < 10 ? 10 : v // Regras de Fornecerdores (BPRint e talvez Grafit) // Tirar isso e Imbutir dentro daquela Const Principal
        const TDp =(tr,Typ,col)=>$(`:scope ${Rx7(Typ,col)}`,tr)
        const FiM =(arr   )=>arr.slice(0,-1)

        function Tratamento(){ // Isso é usando antes de a tabela Carregar no DOM!
            ;['PDDS','CLNT'].forEach(Typ=>{Re_Cont(Typ,'All')}) // tem que ser chamado separado pois acessa 2 tabelas ao msm tempo
            ;['OOSS','UBER','GRAD','PDDS','CLNT','ARTE'].forEach(Typ=>{
                // fazer o tratamento de Reorden se quiser

                if(Typ=='CLNT'){criaCol_Typ('Lcro','CLNT');criaCol_Typ('Medi','CLNT')}
                if(Typ=='UBER'){criaCol_Typ('Img','PDDS')}

                
                //if(Typ=='PDDS'){criaCol_Typ('Deve','PDDS')}
                //if(Typ=='PDDS'){criaCol_Col('Grde','PDDS','Serv')}


                Re_Comp(Typ,'All')
                Re_Soma(Typ,'All')
            })
        }

        function RFresh(Typ,All,Auto,e){ // Tudo isso é Usado após Carregar no DOM!
            if(Typ=='GRAD' && Auto=='Auto'){return}
            //Re_Cont(Typ,All)
            if(All!=='All'){if(Auto!=='Auto'){Re_Comp(Typ,All)}} // ta com essa agonia toda mas vou ajeitar! (Provavelmente só o IF de All fica) (esse if de auto vai sair!)
            if(All!=='All'){Re_Soma(Typ,All)}
            Re_Colr(Typ,All)
            Re_Foot(Typ,All)
            LOG('🔄 Rfresh Geral')
        }

        function Re_Cont(Typ,All){  // ⭐⭐⭐_ _ Sempre é All contar quantas vezes algo aparece dentro e agrupar valores
            const IN = performance.now()
            if(Typ=='PDDS'){J['SERV'].forEach(({Grad,Id,Valr})=>{if (!Grad || Grad === "" || Grad === "--"){return}
                    ContGrad[Grad]??={Qnt:0,Sum:0,List:[]}
                    ContGrad[Grad].Qnt++
                    ContGrad[Grad].Sum += Number(Valr)
                    ContGrad[Grad].List.push(Id)
                })
            }
            else if(Typ=='CLNT'){J['PDDS'].forEach(({Clnt,Id,Serv})=>{if (!Clnt || Clnt === "" || Clnt === "--"){return}
                    if(Serv==''){return}
                    ContCLNT[Clnt]??={Qnt:0,Sum:0,List:[]}
                    ContCLNT[Clnt].Qnt++
                    ContCLNT[Clnt].Sum += Serv.reduce((acc,e)=>acc+Number(e.Valr),0)
                    ContCLNT[Clnt].List.push(Id)
                })
            }
            else{return}
            if(All=="All"){LOG(`🔄 Re_Cont:(${Typ}) ${MS(IN)}`)}
            // Fundir Informações Redundantes
        }

        const Splii = {
    /*Opt*/  S_Tipo:j=>j.Serv ? Vari(j.Serv) : []
    /*Opt*/ ,S_TArt:j=>j ? Prod[j.Serv]?.Etpa.includes('Arte')?FiM(O['TArt']):['n Precisa'] : O['TArt']
            ,S_Arte:j=>J['IMGS'][j.Id] ?? ''
            ,S_CArt:j=>''
    /*Opt*/ ,S_Dsng:j=>j ? ['do Cliente','Ja Tinha','n Precisa'].includes(j.TArt)?['--']:FiM(O['Dsng']) : O['Dsng']
            ,S_Surg:j=>{return Seguro(j.Alt * j.Lag * j.Qnt * Prod[j.Serv]?.Tipos[j.Tipo]?.Valr).toFixed(2)}
            ,S_Forn:j=>j.Grad ? [Dbbrev[j.Grad[0]]] : ''
            ,S_Gimg:j=>`${j.Grad}.webp`
            ,S_OS  :j=>{if(j.Grad==''){return ''} ; if(j.Grad=='--'){return '--'} ; const F = J['GRAD'].find(e=>e.Grad==j.Grad) ; const L = ContGrad[j.Grad] ; return F && L ? Seguro((Num(F.Valr)+(F.Val1)) * (j.Valr / L.Sum)).toFixed(2) : ''} // Pega uma Porcentagem do Valor do Uber  // se for NaN retorna Zero
            ,S_Uber:j=>{if(j.Grad==''){return ''} ; if(j.Grad=='--'){return '--'} ; const F = J['GRAD'].find(e=>e.Grad==j.Grad) ; const L = ContGrad[j.Grad] ; return F && L ? Seguro( F.VUbr                * (j.Valr / L.Sum)).toFixed(2) : ''} // Pega uma Porcentagem do Valor do Uber  // se for NaN retorna Zero // if(j.Grad=='B_264_2'){LOG('UB',L.Sum,F.VUbr)} ; 
            //-----------------------------------------------------------------------------------------------------------
            ,G_ImgU:j=>J['IMGS'][j.Grad] ?? ''
            ,G_ImgG:j=>J['IMGS'][j.Grad.replace(/_\d*$/,"")] ?? ''
    /*Opt*/ ,G_Forn:j=>[Dbbrev[j.Grad[0]]]
    /*Opt*/ ,G_SrvF:j=>ObjKey(ValForn[j.Forn]||{})
            ,G_Valr:j=>j.Forn=='Barraca' ? j.Qnt * 120 : Regra(NAN(j.Lag * j.Alt * ValForn[j.Forn]?.[j.SrvF]?.[0]?.val)) * j.Qnt
            ,G_Cnt2:j=>ContGrad[j.Grad]?.Qnt ?? ''
            ,G_VlrO:j=> JJ['OOSS'][j.OS]?.Valr || 0
            ,G_Summ:j=>j.OS=='' ? '' : sum(J['GRAD'].filter(e=>e.OS==j.OS).map(e=>e.Valr+Number(e.Val1)))
            ,G_Oimg:j=>`${j.OS}`  ?? ''
            ,G_VUbr:j=>{const u=J['UBER'].find(e=>e.Uber==j.Uber)?.Valr, q=J['GRAD']?.filter(e=>e.Uber==j.Uber).length||0 ; return q && u ? (u/q).toFixed(2) : 0}
            //-----------------------------------------------------------------------------------------------------------
            ,O_Oimg:j=>J['IMGS'][j.OS] ?? ''
            ,O_Cnt2:j=>J['GRAD'].filter(e=>e.OS==j.OS).length
            //-----------------------------------------------------------------------------------------------------------
            ,C_Link:j=>ContCLNT[j.Id]?.Qnt ?? ''
            ,C_Lcro:j=>ContCLNT[j.Id]?.Sum ?? ''
            ,C_Medi:j=>{const q = ContCLNT[j.Id]?.Qnt; const s = ContCLNT[j.Id]?.Sum; return (q != null && s != null && s !== 0) ? (s / q).toFixed(2) : ""}  
            //-----------------------------------------------------------------------------------------------------------
            ,U_Img:j=>J['IMGS'][j.Uber] ?? ''
            ,A_Img:j=>J['IMGS'][j.Nome] ?? ''
        }

        function Re_Comp(Typ,All){ // Chama: Bndj , Nova Linha+ , Lixeira)
            if(Typ=='SERV' ||  Typ=='PGMT'){return} // por enquanto iguinorar eles até eu dar o devido Trato!
            const IN = performance.now()
            const trs = All=='All' ? J[Typ] : [All] // se for Bandeija entra edição na Linha do Pai

            const Edit=(Pre,col,Mod,tr)=>{ // Por enquanto nenhum aqui precisa de SB
                
                const Coa = {S:'SERV',P:'PGMT'}
                const TYP = Coa[Pre]||Typ
                const Key = All=='All' ? tr[Primary[TYP]] : VAL($(`:scope ${Rx7(`${TYP}-${tr_ID(tr)}-${Primary[TYP]}`)}`,tr)) // Pegando a Chave Primaria
                const arg = All=='All' ? tr : JJ[TYP][Key]
                if(!arg){LOG('⚠️ o Objeto Não Existe') ; return}
                const Val = Splii[`${Pre}_${col}`](arg)   // arg deve sempre ser o Objeto!
                if(Mod.includes('O') && All!=='All'){ReOpt(TDp(tr,TYP,col),Val)}
                if(Mod.includes('V')){if(All=='All'){tr[col]=Val}else{EditCell($(TDp(tr,TYP,col)),'Edt',Val,'Auto','sem SB')}}
                if(Mod.includes('E')){if(All=='All'){tr[col]=Val}else{EditCell($(TDp(tr,TYP,col)),'Edt',Val,'Auto')}}
            }
            if(All!=='All'){LOG(`Edição Unica: ${Typ}`)}

            // xDOM subistituir esses Trs DOM por trs JJ[Typ]
            if(Typ=="PDDS"){      trs.forEach(TR=>(All=='All' ? TR.Serv||[] : $$('.Bdj_SERV > tbody > tr',TR)).forEach(tr=>[['Surg','EN'],['Tipo','ON'],['TArt','ON'],/*['Grad','V' ],['Cbmt','N' ],['VCbt','N']*/         ].forEach(c=>Edit('S',c[0],c[1],tr))))
                                  trs.forEach(TR=>(All=='All' ? TR.Serv||[] : $$('.Bdj_SERV > tbody > tr',TR)).forEach(tr=>[['Dsng','ON'],['Arte','VN'],['CArt','N' ],['Gimg','VN'],['Forn','ON'],['OS','VN'],['Uber','VN']].forEach(c=>Edit('S',c[0],c[1],tr)))) // Dependem de TArt e de Grad
                                  trs.forEach(tr=>''/*aqui roda a terceira vez, q esse aqui é pra ocultar, mas só fica disponivel se for Individual (mas eu planejei o novo Modelo de separar as Linhas e então vai poder ocultar colunas Sempre*/)
            }else if(Typ=="CLNT"){trs.forEach(tr=>[['Link','V'],['Lcro','V'],['Medi','V']                                                                 ].forEach(c=>Edit('C',c[0],c[1],tr)))
            }else if(Typ=="GRAD"){trs.forEach(tr=>[['ImgU','V'],['ImgG','V'],['Forn','O'],['Valr','V'],['Cnt2','V'],['Oimg','V'],['VlrO','V'],['VUbr','V']].forEach(c=>Edit('G',c[0],c[1],tr))) 
                                  trs.forEach(tr=>[['SrvF','O'],['Summ','V']                                                                              ].forEach(c=>Edit('G',c[0],c[1],tr))) /*SrvF-(Forn), Summ-(Valr,VlrO)*/
            }else if(Typ=='OOSS'){trs.forEach(tr=>[['Oimg','V'],['Cnt2','V']                                                                              ].forEach(c=>Edit('O',c[0],c[1],tr)))
            }else if(Typ=='UBER'){trs.forEach(tr=>[['Img' ,'V']                                                                                           ].forEach(c=>Edit('U',c[0],c[1],tr)))
            }else if(Typ=='ARTE'){trs.forEach(tr=>[['Img' ,'E']                                                                                           ].forEach(c=>Edit('A',c[0],c[1],tr)))
            }else{return}
            if(All=="All"){LOG(`🔄 Re_comp:(${Typ}) ${MS(IN)}`)}
        }

        function Re_Soma(Typ,All){ // ⭐⭐⭐⭐⭐ (Usado apenas em PDDS) (sem DOM) (Alta Peformance)
            const IN = performance.now()
            if(Typ==='PDDS'){
                const trs = All=='All' ? J[Typ] : [All]
                trs.forEach(tr=>{
                    const oID=All=='All'? tr.Id : tr_ID(tr)                                        // coleta Id
                    const Vai=(col,val)=>DarVAL($(Rx7(`${Typ}-${oID}-${col}`)),val)                // pega o td onde inserirei o valor da Soma
                    const ges=(typ,arr)=>sum(arr.flatMap(c=>getArr(JJ[Typ][oID]?.[typ]).map(e=>+e?.[c]||0))) // pega todos os Valores das Colunas passadas em array
                    const vzz=e=>e==0?'':RS(e)                                                     // conferir se ta tudo vazio
                    /*Soma*/ const sV = ges('Serv',['Valr'])                    ; All=='All' ? tr.Valr=vzz(sV) : Vai('Valr',vzz(sV))
                    /*Cust*/ const sC = ges('Serv',['CArt','OS','Uber','VCbt']) ; All=='All' ? tr.Cust=vzz(sC) : Vai('Cust',vzz(sC))
                    /*Lcro*/ const sL = sV-sC                                   ; All=='All' ? tr.Lcro=vzz(sL) : Vai('Lcro',vzz(sL))
                    /*Rest*/ const sD = sV-ges('Pgmt',['Valr'])                 ; All=='All' ? tr.Deve=vzz(sD) : Vai('Deve',vzz(sD))
                })
                if(All=="All"){LOG(`🔄 Re_Soma:(${Typ}) ${MS(IN)}`)}
            }
        }

        function Re_Foot(Typ,All){ // ⭐⭐⭐ _ _ Async (Não Usa DOM) (Alta Peformance)
            if(Typ=='PDDS'||Typ=='SERV'||Typ=='PGMT'){setTimeout(()=>{
                let IN = performance.now()
                const Ids = tr_Viw(Typ).map(e=>tr_ID(e)) // Todos que estão Visíveis (tem como isso ficar mais RÁPIDO)
                const SUM = {Valr:0,Cust:0,Lcro:0,Deve:0,PgPX:0,PgAV:0,Clnt:[],Serv:[]}
                /*Clnt*/ const cnt={},NM={},see=new Set()

                for (const id of Ids){const j = JJ[Typ][id] ; if (!j) continue // apenas pra 'PDDS' mas melhorar depois
                    SUM.Valr += Num(j.Valr) || 0
                    SUM.Cust += Num(j.Cust) || 0
                    SUM.Lcro += Num(j.Lcro) || 0
                    SUM.Deve += Num(j.Deve) || 0
                    const c = JJ['CLNT'][j.Clnt];if(c){const x=c.Clnt;const nm=c.Id;see.add(nm);cnt[x]=(cnt[x]||0)+1;NM[x]=nm}
                    for (const s of (j?.Serv ?? [])) SUM.Serv.push(s.Serv)
                    if(j.Pgmt){for(const p of j.Pgmt){const v=p.Valr||0 ; if(p.Form=='Pix'){SUM.PgPX+=v}else if(p.Form=='Av'){SUM.PgAV+=v}}}
                }
                const cLnth = see.size
                /*Serv*/ const JServ = SUM.Serv;const count = {};for(let i=0;i<JServ.length;i++){const k=JServ[i];count[k]=(count[k]||0)+1}

                Inn($(Rx2([Typ,'Foot','Id'  ])),`<div onclick="Tog_N($('.BndjFOT',Pai(this)))">${Ids.length  }         </div>`)
                Inn($(Rx2([Typ,'Foot','Clnt'])),`<div onclick="Tog_N($('.BndjFOT',Pai(this)))">${cLnth       } Clientes</div> <div class="Abslt none Cl BndjFOT BNdj"><span class="Sugg Cl w100">${ObjEtr(cnt).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<a class="w100 PT">${NM[k]} - ${k}: ${v}</a>`).join('')}</span><div class="BjConf Stky2 w100 Ct">${cLnth} Clientes</div></div>`)
                Inn($(Rx2([Typ,'Foot','Serv'])),`<div onclick="Tog_N($('.BndjFOT',Pai(this)))">${JServ.length} Serviços</div> <div class="Abslt none Cl BndjFOT BNdj"><span class="Sugg Cl w100">${ObjEtr(count).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<a class="w100 PT">${k}: ${v}</a>`).join('')}</span><div class="BjConf Stky2 w100 Ct">${JServ.length} Serviços</div></div>`)
                Inn($(Rx2([Typ,'Foot','Valr'])),RS_(SUM.Valr))
                Inn($(Rx2([Typ,'Foot','Pgmt'])),`<div class="Cl"><div class="Ct">${Tm_RS(SUM.PgPX)}Pix</div> <div class="Ct">${Tm_RS(SUM.PgAV)}Av</div></div>`)
                Inn($(Rx2([Typ,'Foot','Cust'])),RS_(SUM.Cust))
                Inn($(Rx2([Typ,'Foot','Lcro'])),RS_(SUM.Lcro))
                Inn($(Rx2([Typ,'Foot','Deve'])),RS_(SUM.Deve))

                if(All=="All"){LOG(`🔄 Re_Foot:(${Typ}): ${MS(IN)}`)}
            },0)}
        }
    </script>

    <div>     <!--LINKS  - ⭐⭐_ _ _    (⚡ Precisa Funcionar sem BNDJ) (mas acho q ele em Sí nem usa Bndj) -->
        <style> /*CSS apenas no SuggLinks*/
            .Sugg.Atv  {background: #d822ab; color: #ffffff} /*Deixar isso na Biblioteca Depois*/
        </style>

        <script> // LINK
            function LinkSug(inpt,Typ){
                if(Typ=='OS'){Typ='OOSS'}
                const Val   = inpt.value
                const list  = $('.Sugg',Pai(inpt))
                const oID   = tr_ID(_tr(inpt))
                const regex = new RegExp(`(${aa(Val)})`,'gi')                                              // Depois usar todos os Critérios de Pesquisa
                const Griff = e=>`${e}`.replace(regex,'<b style="background:#8f007c; color:white">$1</b>') // fazer o msm Griff de Pesquisa lá em Cima

                const tipo = { // não vou precisar chamar JJ clnt aqui pois farei um novo Objeto antes de tudo começar pra evitar isso!
                    Proc:(e,V)=>               ObjVal(e).some(v=>aa(`${v}`).includes(aa(V))),                                                 // serve pra Cliente exibir procurando na Tora!
                    Rest:(e,V)=>V=='' ? true : ObjEtr(e).some(([k,v])=>(k=='Clnt'?JJ['CLNT'][e.Clnt]?.Clnt??'' :aa(`${v}`)).includes(aa(V))), // Exibir os que Resta linkar
                }

                const exib = { // Fazer Várias formas de Templates lista, Tabela, e Card
                     CLNT:e=> Griff(`<p>  ${e.Id  } - ${e.Clnt}</p>`)                                                            // Pra Pesquisar dentro de PDDS
                    ,MPAG:e=> Griff(`<p>  ${e.Data} - ${e.Clnt}, ${e.Valr} ${e.Form}</p>`)                                       // Pra Pesquisar dentro de PGMT
                    ,PGMT:e=> Griff(`<p>  ${e.Id  } - ${JJ['CLNT'][e.Clnt]?.Clnt??''} - R$ ${e.Valr} (${e.Form}) ${e.Data}</p>`) // Pra Pesquisar dentro de MPAG
                    ,GRAD:e=> Griff(`<div>${e.Grad} - ${Tm_Tm[e.ImgU,{Col:''}] }</div>`)                                         // usando Bandeija em formato de Card
                    ,OOSS:e=> Griff(`<p>  ${e.Id  } - ${e.OS}</p>`)
                    //,SERV:e=> Griff(`<p>${e.Id} - ${JJ['CLNT'][e.Clnt]?.Clnt??''} ${e.Serv} ${e.Desc}</p>`)
                }

                Show(list)
                if(Val){// dentro desse if é onde eu faço a idéia de ter vazio e mostrar tudo
                    // tentar tratar de trazer o nome do cliente pra dentro bem Antes
                    const filt = Typ=='CLNT' ? J[Typ].filter(e=>tipo['Proc'](e,Val)) :
                                 Typ=='MPAG' ? J[Typ].filter(e=>tipo['Rest'](e,Val) && (!NoVazi(e['Pgmt'])||e['Pgmt']=='-')                 ) :
                                 Typ=='PGMT' ? J[Typ].filter(e=>tipo['Rest'](e,Val) && (!NoVazi(e['Mpag'])||e['Mpag']=='-') && e.Form=='Pix') :
                                 Typ=='OOSS' ? J[Typ].filter(e=>tipo['Proc'](e,Val))                                                       : []
                    
                    Inn(list,filt.map(e=>`<a class="PT w100 Ct" onclick="Linkar(this,'${e[Primary[Typ]]}','${oID}')">${exib[Typ](e)}</a>`).join('')) // Quando tem oID é por que é "Duplo" (não entendi a questão do Duplo)
                }else{None(list);Inn(list,'')}
            
            }
            
            // Assim como Link Cliente tem que ter Opção de (Trocar,Add +1,Criar um Novo)
            // 1 Link em "SERV" > linkar "Grad"
            // 3 Link em "GRAD" > linkar Cont q é "PDDS", "OS" e "UBER"
            // 2 Link em "OOSS" > linkar Cont q é "GRAD", "MPAG"
            // 2 Link em "UBER" > linkar Cont q é "GRAD", "MPAG"
        </script>
    </div>

    <div>  <!--INTERAÇÕES- ⭐_ _ _ _ -->
        <style> /*Preview*/
            .casusa{flex: 1 1 auto}
            .Wrapper {overflow-X: hidden; overflow-y: scroll; width: 100%;position: relative}
            .inherit {background: inherit;} /*Copiar a cor do Pai*/
            .Slide_Table {display: flex;transition: all 0.4s ease}
            .Slide_Table > div > div{transition: all 0.4s ease-in-out}
            .Slide_Table > div {flex: 0 0 100%;width: 100%;min-height: 100vh;box-sizing: border-box}
            #H_SERV{font-size: 10px}
            .Switch{margin: 8px;}
            #Sommma{color: white}
        </style>
        <script> // Previews
            function Tog_Card(Typ){ // xDOM
                const Card = Coten($(`#H_${Typ}`),'Card')
                    TRs(Typ).forEach(tr=>{
                        $$(`:scope > ${Rx(['Clnt'])}`,tr).forEach(e=>{Tog(e,'Hoov')})
                        $$(`:scope > ${Rx(['Stts'])}`,tr).forEach(e=>{Tog(e,'Hoov')})
                        $$(`:scope > ${Rx(['Serv'])} > div > .T-T`,tr).forEach(e=>{if(Card){Inn(e,Inn(e))}else{}})
                    })
            }

            function CtrlSoma(Eu){Tog(Eu,'SelectSoma');Inn('#Sommma',`Soma: ${RS(SOMA($$('.SelectSoma').map(e=>Nm(e))))}`)}
            
            const AbrevServs=arr=>arr.map(e=>{
                e.Serv = `${e.Serv} (${e.Tipo})`.replace('Lona (Banner)','Banner') // Fazer um Padrão com isso aqui
                delete e.Tipo
                e.Vund  ? e.Vund   = `R$ ${e.Vund}`  : null
                e.SbTt  ? e.SbTt   = `R$ ${e.SbTt}`  : null
                e._ = '-' ; e.X = 'x'
                return e
            })

        </script>
    </div>

    <div>  <!--MODAIS    - ⭐_ _ _ _ -->
        <script>
            function VerNota(Typ){
                MdalShow('#ModalNota')
                //const Clone = $('#ModalNota').cloneNode(true)
                let dados = []
                if (Typ == 'ORC'){
                    dados = $$('#ORC tbody tr').map(tr=>{
                        const NewObj = {}
                        const tipo = Array.from(tr.classList).find(c=>c.startsWith('Calc_'))
                        const Rsut = ',.ORC_RSUT_Vund,.ORC_RSUT_SbTt'
                        const arr  = tipo === 'Calc_M2'  ? '.oQnt ,.oServ,.oTipo,.oLrg ,.oAlt '
                                   : tipo === 'Calc_OFS' ? '.oQnt,.oServ,.oTipo,.oCbmt,.oMatr'
                                   : tipo === 'Calc_QNT' ? '.oQnt,.oServ,.oTipo,.oLrg ,.oAlt ' : ''
                        $$(arr + Rsut, tr).map(e => {
                            const cls_o   = Array.from(e.classList).find(c => c.startsWith('o'))
                            const cls_orc = Array.from(e.classList).find(c => c.startsWith('ORC_'))
                            const resto1  = cls_o   ? cls_o.slice(1)           : null
                            const resto2  = cls_orc ? cls_orc.split('_').pop() : null
                            const key   = resto1 || resto2
                            if (key) NewObj[key] = cls_o ? VAAL(e) : Inn($('a',e))
                        })
                        return NewObj})
                }
                // Deve Virar Biblioteca a diferença pra o outro é que esse filtra só as existentes
                const ArrObj_OrdnCol2 = (Obj,Ordn)=>{
                    const K = Object.keys(Obj[0])
                    const x = Ordn.filter(col => K.includes(col))
                    return [x, ...Obj.map(obj => x.map(col=>obj[col]))]
                }
                const dadosFmt = ArrObj_OrdnCol2(AbrevServs(dados),['Qnt','_','Serv','Cbmt','Matr','Lrg','X','Alt','Vund','SbTt'])
                const [head,...rows] = dadosFmt
                $('#ConteudoNota'/*,Clone*/).innerHTML = `
                    <table id="TabelaNotinha" class="w100">
                        <thead><tr>${head.map(c=>`<th>${D_Brev[c]??c}</th>`).join('')}</tr></thead>
                        <tbody>    ${rows.map(r=>`<tr>${r.map(v=>`<td>${v??''}</td>`).join('')}</tr>`).join('')}</tbody>
                    </table>
                    <h2 id="TotalNotta" class="Hr Ct">${RS(dados.reduce((a,e)=>a+Num(e.SbTt),0))}</h2>`
                //MODAL(Clone.innerHTML)
            }

            // este Modal Novo já não funciona mais com "Esc"
            // Login, Notas e Imagens
        </script>
    </div>
</div>

<body class="Cl" onclick="NoneBndj()">

    <style> /*CSS do Header*/
        /*Fixos*/
            header    {padding:0px ; z-index:999 ; transition: all ease-in-out 0.3s}
            header > *{transition: all ease-in-out 0.3s}
            #LgNome      , header nav div      {filter:drop-shadow(0px 0px 8px #3a002b)}
            #LgNome:hover, header nav div:hover{filter:drop-shadow(0px 0px 5px #f030c0)}
            #PAGES{flex:1 ; height:100% ; overflow-y:hidden}
            .ConfigOrc{transition: all ease-in-out 0.3s}
            .Body1 .ConfigOrc{height: 0px}
            .Body2 .ConfigOrc{height: 40px}
            .Body1 .Content{height:92vh;}
            .Body2 .Content{height:100vh;}
        /*Body1*/
            .BBody1{height:8vh  ; width:100vw ; position:sticky; top:0}
            .Body2 .BBody1{height: 0vh; pointer-events: none;}.Body2 .BBody1 > *{opacity: 0}
            .Body1 #PAGES > div{height:100%} /*Aqui são as Páginas de Fato*/
                .BBody1 #Title      {margin-left:15px}                @media(max-width:500px){.BBody1 #Title    {margin-left:3px}}
                .BBody1 #Title #Logo{margin:5px; height:30px}         
                .BBody1 #Title h1   {font-size:3vw}                   @media(max-width:500px){.BBody1 #Title h1 {display:none}}   
                .BBody1 nav         {margin:0px 10px}                 @media(max-width:700px){.BBody1 nav       {display:none}}
                .BBody1 nav img     {height:22px; margin:3px 3px}
                .BBody1 nav p       {display:none}
                .BBody1 nav div     {border-radius:5px ; margin: 0px 2px;}
                .Body1 #NavPerf     {flex-direction:row}
                .Body1 #LgNome      {display:none}
                .Body1 #LgMORE      {display:none}
        /*Body2*/
            .BBody2{height:100%;width:18% ; flex-direction: column}
            .Body1 .BBody2{width:0% ; pointer-events: none;}.Body1 .BBody2 > *{opacity: 0}
            .BBody2.recolhe{width:5% } @media(max-width:500px){.BBody2.recolhe{width:50% }}
            .BBody2.recolhe #Logo   {display: none}
                .BBody2 #Title      {width: 90%; justify-content: space-between}
                .BBody2 #Title #Logo{margin:5px; height:30px}
                .BBody2 #Title h1   {font-size:50% ; display:none}
                .BBody2 nav     {margin:10px 0px; flex-direction:column; width: 100%}
                .BBody2 nav img {height:22px; margin:5px 0px ; margin-right: 9px}                            .BBody2.recolhe nav img {margin-right: 0px}
                .BBody2 nav p   {display:block ; font-size: 14px}                                            .BBody2.recolhe nav p   {display:none}
                .BBody2 nav div {width: 90% ; justify-content: start; margin: 3px 0px ; border-radius: 8px}  .BBody2.recolhe nav div {justify-content:center}
                .BBody2 nav div:hover     {background: #ffffff15}
                .BBody2 nav #b1_HNVDv_LIN img{display: none}
                .BBody2 nav #b1_HNVDv_LIN    {border-bottom:1px solid #ffffff;opacity: 0.3}
                .BBody2 nav #b2_HNVDv_LIN img{display: none}
                .BBody2 nav #b2_HNVDv_LIN    {border-bottom:1px solid #ffffff;opacity: 0.3}
                .BBody2 #NavPerf         {flex-direction:column; width: 90%}
                .BBody2 #Div-Pesq        {display:none}
                .BBody2 #DivNav          {width:90%}
                .BBody2 #H_Login         {width: 100% ; justify-content: flex-end; background: #38003fa6}
                .BBody2 #LgNome          {display: flex; margin-right: 7px; font-size: 14px;}
                .BBody2 #LgMORE          {display: flex}
                nav > *.Atv              {background: #da00aa}
                nav > *.Atv:hover        {background: #ff00c8 !important; filter:drop-shadow(0px 0px 5px #f030c0) !important}
    </style>

    <header class="BBody1 Bt"> <!--Body1--> <!--HEADER-->

        <div id="Title" class="Ct"> <!--Titulo-->
            <img id="Logo"  draggable="false" src="./Img/Logo.png" onclick="TrocaBody()">
            <h1 class="PT" onclick="TrocaBody()">InfinityAPP 7.6</h1>
            <script>
                function TrocaBody(){if(window.innerWidth>500){TrcTog($('body'),'Body1','Body2')}else{Recolher()}}
                function Recolher(){Tog($('.BBody2'),'recolhe')}
                function TrocaCSS(nova){$('body').className = [...$('body').classList].filter(c=>!c.includes('CSS')).concat(nova).join(' ')}               
            </script>
        </div>
        <div class="w30"><div id="Div-Pesq" class="Rltv w100 hov"></div></div><!--Pesquisa-->
        <div id="DivNav"><nav class="Ct H_Nav"></nav></div><!--nav-->

        <script>
            function NavPag(Typ){// ao Navegar
                Atual.Pag=Typ
                Show(`#Pag_${Typ}`,$$('#PAGES > *'))             // Troca Página
                if(!Cgo.Admn.nav.includes(Typ)){DTV($$('.H_Nav > *')) ; None($$('.pPesq')); return} // Caso a página não exista no nNav
                ATV($(`#b1_HNVDv_${Typ}`),$$('.BBody1 .H_Nav > *')) // Troca nNav.Atv do BBody1
                ATV($(`#b2_HNVDv_${Typ}`),$$('.BBody2 .H_Nav > *')) // Troca nNav.Atv do BBody2
                Show($$(`.Pesq_${Typ}`),$$('.pPesq'))            // Troca Pesquisa
                setTimeout(()=>getSBPromise.then(()=>loadtmtable(Typ,false,true)),0) // 100% Assíncrono
            }
        </script>

        <div id="H_Login" class="Ct"> <!--Perfil-->
            <style>
                #LgFoto{background:url(./Img/FundoLogo.png); background-size:cover ; height: 100%; width: auto;}
                #LgFoto img{width:42px; height:42px; margin:4px 4px}
                .Body1 #H_Mais{top:55px; right:0px}
                .Body2 #H_Mais{bottom: 0%; left:170px}
                #MAIS{background:#4e4e4e; width:250px ; color:white}
                #MAIS div{padding:10px;cursor:pointer;font-size:15px; width:100%}
                #MAIS div:not(:last-child):hover{background:gray;color:var(--Txt-Wit-Hover)}
                #MAIS div:last-child{padding:10px}
                #MAIS img{height:25px;margin-right:10px}
                #MAIS p,#MAIS p a{font-size:10px}
            </style>
            <img id="LgMORE" src="./SVG/More.svg" class="Hov" style="width:18px" onclick="ShowMore()" oncontextmenu="Prvn();ShowMore()">
            <div id="LgNome" class="Ct PT"  onclick="AbreLogin(true)">Login</div>
            <div id="LgFoto"><img draggable="false" class="NObj" onclick="AbreLogin(true)" oncontextmenu="Prvn();ShowMore()"></div>

            <script>
                function ShowMore(){TogShow('#H_Mais')}

                function AbreLogin(valid){
                
                    if(valid){if(Inn($('#LgNome'))!=='Login'){ShowMore();return}} ; //MdalShow('#ModalLogin');Inn('#errPass','');Foco('#I_Pass')
                    
                    MODAL(`
                        <div id="ModalLogin" class="Ct Rltv Rd" style="width:300px;height:400px">
                        <div class="Bt Loginn">Login</div>
                        <div class="Ct Start">
                            <label for="Senha">Senha</label>
                            <input id="I_Pass" class="Inputss" type="password" onkeydown="KeyEntr(()=>TestSenha('Modal',this))">
                        </div>
                        <span id="errPass" class="erro"></span>
                        <div class="Bt">
                            <button class="Ct w40" onclick="TestSenha('Modal',$('#I_Pass'))">Logar</button>
                            <button class="Ct w40" onclick="TestSenha('Dslog')             ">Sair </button>
                            </div>
                        </div>
                    `)
            
                }

                const SaiMdal=()=>{if($('.FModal')){$('.FModal').remove()}} /*GAMBIARRA*/

                function TestSenha(Mod,p){
                    const nome=$('#LgNome'),foto=$('#LgFoto img')
                    const storg=e=>{StogeRmv('Pass');if(e){StogeSet('Pass',e)}}
                    const logaa=e=>{const U = JJ['USER'][e] ; Inn(nome,U.Nome);foto.src=U.Foto;storg(e);SaiMdal();PosLogin(U)}
                    if(Mod=='Dslog')     logaa(0)
                    if(Mod=='Storg') p ? logaa(p) : logaa(0)
                    if(Mod=='Modal'){if(JJ['USER'][Vll(p)]){logaa(Vll(p))}else{Inn('#errPass',TM.Pss) ; p.placeholder=TM.Pss};p.value='';p.focus()}
                }
                function PosLogin(U){
                    UCgo = Cgo[U.cgo]
                    $('body').className="" ; ['Ct',...U.body].forEach(e=>Add($('body'),e)) // Adiciona os CSS do Body
                    Inn('.BBody1 .H_Nav',UCgo.nav.map(e=>`<div id="b1_HNVDv_${e=='|'?'LIN':e}" class="Ct PT HOV" onclick="NavPag('${e}')"><img draggable="false" src="./SVG/${e=='|'?'LIN':e}.svg"><p>${D_Brev[e]}</p></div>`).join(''))
                    Inn('.BBody2 .H_Nav',UCgo.nav.map(e=>`<div id="b2_HNVDv_${e=='|'?'LIN':e}" class="Ct PT HOV" onclick="NavPag('${e}')"><img draggable="false" src="./SVG/${e=='|'?'LIN':e}.svg"><p>${D_Brev[e]}</p></div>`).join(''))
                    Inn('#Div-Pesq',UCgo.nav.map(Typ=>Load_Pesq(Typ)).join(''))
                    NavPag(Atual.Pag)
                    tmplt_Prod()
                    $$('.TBLAA').forEach(e=>Add(e,U.cgo)) // Adicionando class do Cargo do Usuário a todas as Tabelas
                    Load_Perfil(U)
                    LOG('✅ Perfil Logado!')
                }
            </script>

            <div id="H_Mais" class="Abslt none bndj">
                <div id="MAIS" class="Ct Pose">
                    <div class="Start" onclick="NavPag('PRFL');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Edit.svg"><a> Ver Perfil       </a></div>
                    <div class="Start" onclick="AbreLogin()   ;None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Troc.svg"><a> Trocar de Conta  </a></div>
                    <div class="Start" onclick="NavPag('CONF');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Cnfg.svg"><a> Configurações    </a></div>
                    <div class="Start" onclick="NavPag('SPRT');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Help.svg"><a> Central de Ajuda </a></div>
                    <div class="Start" onclick="TestSenha('Dslog');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_LOff.svg"><a> Sair             </a></div>
                    <div><p>Confira os <a class="Link">Termos de Serviço</a> e as <a class="Link">Política de Privacidade</a></p></div>
                </div>
            </div>
        </div>
    </header>

    <div class="Ct w100 Content"> <!--q é descontando a altura do Head-->
        <header class="BBody2 Bt"> <!--Body2-->
            <div id="Title" class="Ct"> <!--Titulo-->
                <img id="Logo"  draggable="false" src="./Img/Logo.png" onclick="TrocaBody()">
                <img id="recolhe" style="height: 18px" src="./SVG/Recolhe.svg" onclick="Recolher()">
            </div>
            <div id="DivNav"><nav class="H_Nav Ct"></nav></div><!--nav-->
        </header>

        <div id="PAGES"> <!--isso era pra ser main-->

            <div id="Pag_HOME"> <!--Dentro era pra ser Section-->
                <div class="Cl w100">
                    <div class="Cl w100" style="overflow: scroll;"> <!--GRAFICO-->
                        <style>
                            .Graficos {background:#1e1e2f; border-radius:20px; padding:20px; margin:10px;box-shadow: 0 0 30px rgba(200, 100, 255, 0.2), 0 0 50px rgba(255, 100, 150, 0.1)}
                            .Graficos{width: 40%;max-width: 40%; height: 300px; max-height: 300px;}
                        </style>
                        
                        <div class="Cl">
                            <h1>Semana1</h1>
                            <button onclick="RfreshGrafic(Pai(this),1)">Refresh</button> <!--CHAMAR isso ao clicar na PAGINA e não com este Botão-->
                            <div class="Ct">
                                <canvas class="Grfc_Ftura Graficos"></canvas> <!--Grafico de Fatura-->
                                <canvas class="Grfc_Servs Graficos"></canvas> <!--Gráfico de Serviço mais Pedido-->
                                <canvas class="Grfc_PixAv Graficos"></canvas> <!--Gráfico de Forma de Pagamento-->
                                <canvas class="Grfc_Forne Graficos"></canvas> <!--Gráfico de Cliente mais Lucrativo-->
                            </div>
                        </div>

                        <div class="Cl">
                            <h1>Semana2</h1>
                            <button onclick="RfreshGrafic(Pai(this),2)">Refresh</button> <!--CHAMAR isso ao clicar na PAGINA e não com este Botão-->
                            <div class="Ct">
                                <canvas class="Grfc_Ftura Graficos"></canvas> <!--Grafico de Fatura-->
                                <canvas class="Grfc_Servs Graficos"></canvas> <!--Gráfico de Serviço mais Pedido-->
                                <canvas class="Grfc_PixAv Graficos"></canvas> <!--Gráfico de Forma de Pagamento-->
                                <canvas class="Grfc_Forne Graficos"></canvas> <!--Gráfico de Cliente mais Lucrativo-->
                            </div>
                        </div>

                        <div class="Cl">
                            <h1>Semana3</h1>
                            <button onclick="RfreshGrafic(Pai(this),3)">Refresh</button> <!--CHAMAR isso ao clicar na PAGINA e não com este Botão-->
                            <div class="Ct">
                                <canvas class="Grfc_Ftura Graficos"></canvas> <!--Grafico de Fatura-->
                                <canvas class="Grfc_Servs Graficos"></canvas> <!--Gráfico de Serviço mais Pedido-->
                                <canvas class="Grfc_PixAv Graficos"></canvas> <!--Gráfico de Forma de Pagamento-->
                                <canvas class="Grfc_Forne Graficos"></canvas> <!--Gráfico de Cliente mais Lucrativo-->
                            </div>
                        </div>

                        <div class="Cl">
                            <h1>Semana4</h1>
                            <button onclick="RfreshGrafic(Pai(this),4)">Refresh</button> <!--CHAMAR isso ao clicar na PAGINA e não com este Botão-->
                            <div class="Ct">
                                <canvas class="Grfc_Ftura Graficos"></canvas> <!--Grafico de Fatura-->
                                <canvas class="Grfc_Servs Graficos"></canvas> <!--Gráfico de Serviço mais Pedido-->
                                <canvas class="Grfc_PixAv Graficos"></canvas> <!--Gráfico de Forma de Pagamento-->
                                <canvas class="Grfc_Forne Graficos"></canvas> <!--Gráfico de Cliente mais Lucrativo-->
                            </div>
                        </div>

                        <script>
                            const coresGrafic = ['#c084fc','#f97316','#fb7185','#a855f7','#9d00ff','#ff6fb5']
                            const IntrvlData=(arr,ini,fim)=>arr.filter(o=>{const d = o?.Data ; if(!d) return false ; const D = new Date(d) ; return !isNaN(D) && D >= new Date(ini) && D <= new Date(fim)})
                            const Semana=n=>{const ini = new Date(`2026-01-05`) ; ini.setDate(ini.getDate() + (n - 1) * 7) ; const fim = new Date(ini) ; fim.setDate(fim.getDate() + 6) ; const fmt = d => d.toISOString().slice(0,10) ; return [fmt(ini), fmt(fim)]}
                            const gG =(c,l,T)=>Charte(ObjKey(c),ObjVal(c),l,T?ObjKey(c).map((_,i)=>coresGrafic[i % coresGrafic.length]) : coresGrafic[0])
                            const gGG=(c,l,T)=>CharteGrup(c,l,coresGrafic)
                            const Soma_Dia=(a,k)=>a.slice().sort((a,b)=> new Date(a.Data) - new Date(b.Data)).reduce((s,e)=>{if(e?.Data) s[DMY(e.Data)] = (s[DMY(e.Data)]||0) + (+e?.[k]||0) ; return s},{})
                            const ContFrq2=(a,k)=>Object.fromEntries(Object.entries(a.reduce((o,e)=>(e?.[k]?.trim()&&(o[e[k].trim()]=(o[e[k].trim()]||0)+1),o),{})).sort(([,x],[,y])=>y-x))
                            const ContForn = a => a.reduce((o,e)=>(e?.Data && e?.Forn && ((o[DMY(e.Data)] ??= {})[e.Forn.trim()] = ((o[DMY(e.Data)]?.[e.Forn.trim()])||0) + (+e.Valr||0) + (+e.Val1||0)), o),{})
                            

                            function RfreshGrafic(Div,Semn){ 
                                const Filt=Typ=>IntrvlData(J[Typ],...Semana(Semn))
                                LOG(ContForn(Filt('GRAD')))
                                Load_Grfc('Barra', gG(Soma_Dia(Filt('PGMT'),'Valr'),'Faturamento Diário (R$)' ,0),$('.Grfc_Ftura',Div)) // 0 e 1 siguinifica Randomizar cores ou 1 cor só
                                Load_Grfc('Barra', gG(ContFrq2(Filt('SERV'),'Serv'),'Quantidade de Serviços'  ,1),$('.Grfc_Servs',Div))
                                Load_Grfc('Pizza', gG(ContFreq(Filt('PGMT'),'Form'),'Quantidade de Pagamentos',1),$('.Grfc_PixAv',Div))
                                Load_Grfc('Barra',gGG(ContForn(Filt('GRAD')       ),'Forn'                    ,1),$('.Grfc_Forne',Div))
                            }

                            // agora queros eparar o que foi Pagamentos de coisas da Semana Atual e Coisas da Semana Anteriro
                            // as Grades que mais Demoraram, Pedidos que mais Demoraram
                            // Mostrar mesmo quando tiver Zero
                        </script>
                    </div>
                </div>
            </div>

            <div id="Pag_ORC" class="none Cl" style="overflow: scroll;">

                <div class="ConfigOrc w100 Ct"><div id="PagPesq_ORC" class="PagPEsq" onload="Inn(this,Load_Pesq('ORC'))"></div></div>

                <div id="DivIMGProd" class="Bt w90"> <!--IMAGENS dos PRODUTOS-->
                    <style>
                        #Div-Prod                {overflow-x:scroll; flex-wrap:nowrap}
                        #Div-Prod, #Div-Detalhes {transition: all 0.3s cubic-bezier(0.8,0,0.8,1) ; height:360px ; margin-bottom:12px}
                        #DivIMGProd     #Div-Prod {width: 100%}
                        #DivIMGProd.Atv #Div-Prod {width:  59% ; box-shadow: inset -12px 0 12px -8px #36002431 ; border-radius: 20px;}

                        #DivIMGProd     #Div-Detalhes {width:  0% ; background: #00df0000}
                        #DivIMGProd.Atv #Div-Detalhes {width: 39% ; background: #00df0000 ; padding: 8px;}
                        #DivIMGProd     #Div-Detalhes > div {opacity: 0; pointer-events: none ; transition: all 0.3s cubic-bezier(0.8,0,0.8,1)}
                        #DivIMGProd.Atv #Div-Detalhes > div {opacity: 1; pointer-events: auto}
                        #DivIMGProd     .IconDtlh p         {opacity: 0; pointer-events: none ; transition: all 0.3s cubic-bezier(0.8,0,0.8,1)}
                        #DivIMGProd.Atv .IconDtlh p         {opacity: 1; pointer-events: auto}
                        .IconDtlh p            {font-size: 20px}
                        .DivCanvMdd            {height: 75%;width: 100%;padding:8px;}

                        #Div-Prod > div        {margin:9px 4px; display:flex; flex-direction:column}
                        #Div-Prod span         {margin-left:10px; margin-bottom:10px}
                        #Div-Prod span p       {margin:0px; font-size:9px}
                        #Div-Prod span p strong{font-size:9px}
                        #Div-Prod span img     {margin:5px; height:30px; width:30px}
                        #Div-Prod span h3, #Div-Prod span h3 strong{font-size:19px}
                        .CSS3 #Div-Prod span{color: #ffffff}
                        #Div-Prod .DivVrnts    {margin-top:20px}
                        .DivVrnts .vlM2        {margin-top: 5px;}
                        .DivVrnts .vlM2 a      {font-size: 15px;}
                        .DivVrnts .vlM2 p      {margin: 1px 2px;}
    
                        #Div-Prod .Opts               {top:45px; width:100%; height:30px; left:4px}
                        #Div-Prod .Opts img           {height:23px; width:23px; margin:3px 7px}
                        #Div-Prod .Opts div           {bottom:0; height:30px; width:50%; transition:height 0.1s ease-in-out, border-radius 0.1s ease-in-out, width 0.2s ease-in-out, left 0.2s ease-in-out; color: #000000}
                            #Div-Prod .Opts div.Pre   {border-radius: 20px 0px 0 0 !important ; background:linear-gradient(to left,#bdb5be,#ffffff)}
                            #Div-Prod .Opts div.Pos   {border-radius: 0px 20px 0 0 !important ; background:linear-gradient(to right, #bdb5be,#ffffff)}
                            #Div-Prod .Opts div:hover {height: 35px ; border-radius: 20px 20px 0 0 !important}
                            #Div-Prod .Opts div.Atv   {z-index: 99 !important; border-radius: 20px 20px 0 0 !important ; background:linear-gradient(to right,#ffffff,#ffffff)} /*background:white;  era pra ter background mas ele ta fazendo Piscar, ai tirei*/ 

                        #Div-Prod .Conteudo{transition: all 0.2s ease-in-out}
                        #Div-Prod .Conteudo{padding-top:10px; z-index:999}
                        :is(.CSS1,.CSS2) #Div-Prod .Conteudo,.offf{height:240px ; width:200px; margin:4px ; padding-bottom:15px; border-radius: 0px 0px 20px 20px ;background:linear-gradient(to top,#b3b3b3  ,#ffffff); color:#575757}
                                   .CSS3 #Div-Prod .Conteudo,.offf{height:240px ; width:200px; margin:4px ; padding-bottom:15px; border-radius: 0px 0px 20px 20px ;background:linear-gradient(to top,#b3b3b35b,#ffffff); color:#575757;box-shadow:inset 0 0 8px #fdfdfd6e}
          
                        #Div-Prod .Conteudo.Pecq{width:200px}
                        #Div-Prod .Conteudo.Grnd{width:270px}
                        .offf{ top: 70px; background: #80808071; color: #ffffff;font-size: 20px;}

                        #Div-Prod .BtnGrid        {width: 20px ; height:20px ; bottom:10px; right:16px; fill:#4d004d93}
                        #Div-Prod .BtnCarr        {width: 120px; top:310px   }
                    </style>
                    <style>
                        .Armz,.Armz .BxVlr,.V3,.V1,.TMRS,.TMRS *{transition: all 0.2s ease-in-out}
                        .BxVlr            {color:#ffffff}
                        .Indisdp          {font-size:6px;transform:rotate(-15deg);top:5px;left:4px}
                        .Armz > a         {right:  0px ; bottom: 0px}
                        .Pecq .Armz       {width: 90px ; height:66px}              .Grnd .Armz       {width:120px ; height:88px}
                        .Pecq .BxVlr      {width: 48px ; height:20px ; margin:1px} .Grnd .BxVlr      {width: 62px ; height:26px ; margin:2px}
                        .Pecq .BxVlr .TMRS{top:5px;left:2px}                       .Grnd .BxVlr .TMRS{top:7px; left:2px}
                        
                        .Pecq .V3         {right:0px;top:1px}                      .Grnd .V3      {right:0px;top:1px}
                        .Pecq .V1         {font-size:   4px}                       .Grnd .V1      {font-size:  6px}
                        .Pecq .TMRS b     {font-size:   7px}                       .Grnd .TMRS b  {font-size:  9px}
                        .Pecq .TMRS p     {font-size:  11px}                       .Grnd .TMRS p  {font-size: 15px}
                        .Pecq .V3         {font-size:   4px}                       .Grnd .V3      {font-size:  7px}
                        
                        .Variate2 a{background: #fd0061; margin: 2px; color: #ffffff;}
                        .Variate2 {margin: 2px}

                        .CanvasMedidas.Hmax{width: auto ; height: 100%}
                        .CanvasMedidas.Wmax{width: 100% ; height: auto}
                    </style>

                    <style> /*GAMBIARRA FEIOSA pra Ajeitar o Tamanho das Imagens dentro do TmpltProd*/
                        .fotO      {width:150px ; height:160px}
                        .fotO1 img {width:150px ; height:160px}
                        .fotO2 img {width:120px ; height:90px }
                        .fotO2T img{width:75px  ; height:90px }
                        .fotO3 img {width: 150px; height: 53px}
                        .fotO3I img{width: 75px ; height:96px } .fotO3I img:last-child{width:150px ; height:95px }
                        .fotO4 img {width:80px  ; height:80px }
                        .fotO5 img {width:80px  ; height:80px } .fotO5 img:last-child{display:none}
                        .fotO6 img {width:150px ; height:53px }
                    </style>

                    <div id="Div-Prod" class="Start"></div>

                    <div id="Div-Detalhes" class="Rltv">
                        <a class="IconDtlh Ct PT Start" onclick="TOV($('#DivIMGProd'))"><h3>⭐</h3><p>Detalhes</p></a>
                        <div id="NewCanvas"        class="canvi Ct Cnvs none"></div>
                        <div class="DetalheCanvMdds ORC_tr ORC_tr-1" class="Cl">
                            <div class="DivCanvMdd Rd Ct Boxy"><canvas class="CanvasMedidas canvi Cnvs Wmax"></canvas></div>
                            <div class="Ct w100" style="margin-top:5px">  <!--// Criar um pra cada linha--> 
                                <div class="Cl"><label>Largura Area</label><input class="I_AreaX" placeholder="Largura Area" value="1,00" oninput="Mask.Num(this);RodaCanvMdds(this)"></div>
                                <div class="Cl"><label>Altura Area </label><input class="I_AreaY" placeholder="Altura Area"  value="1,00" oninput="Mask.Num(this);RodaCanvMdds(this)"></div>
                            </div>
                        </div>
                    </div>

                    <script> // Focado no Preview de Produtos
                        const Bckg=e=>`style="background-image:url('./Prod/Avanc/${e}')"`
                        function AddBoxy(e){AddCarr(...e.split('_'))} // tentar tirar isso daqui só serve pra desconstruir
                        function Gmbrr(Eu){
                            $$('.Opts > div',Avo(Eu)).forEach(e=>{
                                if(Coten(Eu,'Atv')){(e.dataset.s??=e.style.cssText, e.style.cssText=e.getAttribute('name')||'') ; $$('.Conteudo',Avo(Eu)).forEach(c=>Trc(c,'Grnd','Pecq'))}
                                else{(e.style.cssText=e.dataset.s || '', delete e.dataset.s)                                    ; $$('.Conteudo',Avo(Eu)).forEach(c=>Trc(c,'Pecq','Grnd'))}
                            })
                        }

                        function ShowVrnts(e){$$('.DivVrnts > div',Avo(e)).forEach((E,x)=>{
                            $$('div',Pai(e)).forEach((B,x,l)=>{Rmv(B,'Atv')
                                if(x < IdxDe(e)){Add(B,'Pre');Rmv(B,'Pos') ; B.style.zIndex = (l.length+x)-IdxDe(e)+10}
                                else{            Add(B,'Pos');Rmv(B,'Pre') ; B.style.zIndex = (l.length-x)+IdxDe(e)+10}})
                            Add(e,'Atv')
                            if(x===IdxDe(e)){Show(E)}else{None(E)}
                        })}

                        function Armzn(Bx,ON){
                            const Tm_R$ =e=>`<div class="TMRS Abslt Ct"><b>R$</b><p>${e}</p><b>,00</b></div>`
                            const TmRSS =e=>e==0 ? `<b class="Ct Abslt Indisdp">Indisponível</b>` : Tm_R$(e)
                            const BoxVlr=e=>`<div class="BxVlr bckG Rltv HOV" ${Bckg('Base.svg')} onclick="AddBoxy('${e[1]}_${e[0][4]}_${e[0][0]}')">
                                                <p class="V1 Abslt">${e[0][0]} UND   </p>
                                                <p class="V2 Abslt">${TmRSS(e[0][1])}</p>
                                                <p class="V3 Abslt">${(Num(e[0][1])/Num(e[0][0])).toFixed(2)}</p>
                                            </div>`
                            return `<div class="Armz bckG Cl Rltv" name="${Bx}" ${Bckg(`${Bx}.webp`)}><a class="Abslt Cl">${ON.filter(Y=>Y[1]==Bx).map(Y=>BoxVlr(Y)).join('')}</a></div>`
                        }

                        function MudaArmzn(Eu,V){
                            $$('.Armz',Avo(Eu)).forEach(e=>{
                                if(Nm(e).includes(V) && Nm(e).includes(Nm(Eu))){Rmv_N(e)}else{Add_N(e)}
                            })
                        }

                        function tmplt_Prod(){ //GRANDE
                            Inn('#Div-Prod',AllProd.map(e=>{
                                if(UCgo.orc.includes(e)) return
                                const Fora = Prod[e].img=='Place' ? './SVG/placeholder.svg' : null
                                const vari = Prod[e].Tipos
                                const TblA = Prod[e].Prvw=='Tabela' ; const ON = FiltOn(e)
                                const iSVG = Prod[e].Prvw=='IptSVG'
                                const CalC = Prod[e].Calc
                                const Alll = Prod[e].Alll
                                const Brvv = {Masculino:'Masc',Feminino:'Femi'}
                                const onck = `onclick="ExibeFotinha('${e}')"`
                                const novo = (arr)=>arr.map(u=>u?.[1] ?? null)
                                const Flts = ObjKey(vari).flatMap(v=>e==v?ObjKey(Prod[e].Tipos[v].Cbmt):v)
                                const VVV  = Vari(e)
                                const VARI = (VVV.length === 2 &&VVV[0] === 'Todos' &&VVV[1] === e) ? [...Flts] : VVV

                                return `<div class="Rltv Start2">
                                    <span class="Start"><img ${TblA ? `class="PT" onclick="TOV(this);Gmbrr(this)"` : ''}  src="${Fora||`./Prod/IconProd/${e}.svg`}"><div class="Start2"><h3 class="rgx">${e}</h3><p class="rgx">${Prod[e].Desc}</p></div></span>
                                    <div class="KeyInn none">...</div>

                                    <div class="Ct w100 Opts Abslt">${ // Faz o Menusiho de opções de cima
                                        // Quando só tem 2 Tipos Todos e Repete o Prod então deve carregar todos os itens de dentro desse Prod
                                        //
                                        VARI.map((vv,x,l)=>{const L = l.length ; const U = L==1 ? 0 : 15
                                            const CS1 = `left:${(x*(200/L))-(x==0?0:U)}px ; width:${(200/L)+U}px ; z-index:${(L-x)+10}`
                                            const CS2 = `left:${(x*(270/L))-(x==0?0:U)}px ; width:${(270/L)+U}px ; z-index:${(L-x)+10}`
                                            return `<div style="${CS1}" name="${CS2}" onclick="ShowVrnts(this)" class="Ct Abslt PT Pos ${x===0?'Atv':''}"><a class="none rgx">${vv}</a> <img name="${vv}" src="${Fora || `./Prod/IconProd/${vv=='Todos'?`${vv}`:`${e}_${vv}`}.svg`}"></div>`
                                        }).join('')}
                                    </div>

                                    <div class="Ct DivVrnts">${
                                        VARI.map((V,x)=>{
                                            const obj  = vari[V]
                                            const Al   = V=='Todos'
                                            const Xo   = {'ímã':'I','Trofeu':'T'}

                                            return `<div class="Conteudo Pecq ${TblA?'Table':''} Cl ${x===0?'':'none'}">
                                            ${Prod[e].Stts=="Offf"?`<div class="Ct Abslt offf">Indisponível no momento...</div>`:''}
                                            <div class="KeyVari rgx">${V}</div>

                                            ${TblA&&e=='Camisa' ? `<div class="Variate2">${Uniq(novo(ON).map(b=>b.split('_')[2])).map(s=>`<a class="PT HOV" onclick="MudaArmzn(this,'${V}')" name="${s}">${Brvv[s]||s}</a>`).join('')}</div>` : ``}
                                            ${TblA&&e=='Camisa' ? `<div class="Variate2">${Uniq(novo(ON).map(b=>b.split('_')[3])).map(s=>`<a class="PT HOV" onclick="MudaArmzn(this,'${V}')" name="${s}">${s         }</a>`).join('')}</div>` : ``}

                                             ${Al&&iSVG  ? `<div class="Cl"><input id="svgInput" ${InptSVG}><button onclick="ReadSVG()">Carregar</button></div>`
                                              :Al&&TblA  ? `<div class="Ct">${Uniq(novo(ON)).map(Bx=>Armzn(Bx,ON)).join('')}</div>`
                                             :!Al&&TblA  ? `<div class="Ct">${Uniq(novo(ON)).filter(s=>{return s.includes(`${e}_${V}_`)}).map(Bx=>Armzn(Bx,ON)).join('')}</div>`
                                             :Al         ? `<div class="Ct fotO${Flts.length-1}${Xo[e]||''}">${Flts.map((vV)=>vV=='Todos'?'':`<img class="Hov" src="${Fora||`./Prod/${e}_${V}_${vV}.webp`}" onclick="AddCarr(${Alll=='Al1'?`'${e}','${e}','${vV}'` : Alll=='Al2'?`'${e}','${vV}',null,'Brilho'`:''})">`).join('')}</div>`
                                             /*de UND*/  : `<img class="fotO Hov" src="${Fora||`./Prod/${e}_${V}.webp`}" ${onck}>`
                                            }
                                            ${!Al&&CalC=='M2'?`<div class="Ct vlM2" ${onck}>${'Tm_RS(obj.Valr)'}<p>m²</p></div>`:''}
                                            <div class="rgx none">${(HotKy[e]||[]).join(',')}</div>
                                            <a class="Abslt BtnGrid">${SVG.Gemn}</a>
                                            <div>Prazo 3 dias</div>
                                            <img class="Abslt BtnCarr HOV" onclick="AddCarr('${e}','${V}')" src="./SVG/Adicionar.svg">
                                            </div>`
                                        }).join('')}
                                    </div>
                                </div>`
                            }).join(''))
                        }
                    </script>

                    <script> // Focados nos CANVAS
                        function ORCnewID(tr){ // dar o NOVO id pra cada linha do ORC
                            tr.classList.forEach(c=>c.startsWith('ORC_tr-') && tr.classList.remove(c))
                            const max = Math.max(0,...[...$$('tr',Pai(tr))].map(e=>[...e.classList].find(c=>c.startsWith('ORC_tr-'))).filter(Boolean).map(c=>+c.split('-')[1]||0))
                            Add(tr,`ORC_tr-${max+1}`)
                            const Dtlh = $('#Div-Detalhes .ORC_tr')
                            const clone = Dtlh.cloneNode(true)
                            clone.classList.forEach(c=>c.startsWith('ORC_tr-') && clone.classList.remove(c))
                            Add(clone,`ORC_tr-${max+1}`)
                            Insert(Pai(Dtlh)).After(clone,Dtlh)
                        }
                        function ReloadDetalhes(tr){ // acho q tr já é a ativa
                            const Tr = $(`#ORC tbody tr.Atv`); if (!Tr) return
                            const id = [...Tr.classList].find(c => c.startsWith('ORC_tr-'))?.split('-')[1]
                            $$('#Div-Detalhes .ORC_tr').forEach(c=>Add_N(c))
                            Rmv_N($(`#Div-Detalhes .ORC_tr-${id}`))
                        }
                        function TipoCanvas(tr){ // Trocar pra o Tipo de Canvas Conforme o Input Serv (Se tiver Ativo)
                            const serv = VAAL($('.oServ',tr))
                            if(Prod[serv]?.Prvw=='CanvMdd'){Show($('#CanvasMedidas' ))}
                            if(Prod[serv]?.Prvw=='Canva3D'){Show($('#NewCanvas'     ))}
                        }
                        function AtvMyMdds(Eu){// a Estrelinha que Ativa CanvasMdds
                            TOV(Eu) ; Tog(_tr(Eu),'CanvMddsATV')
                            ATV($('#DivIMGProd'))  // Ajeitar o negócio de tog reverso se já tiver com o detalhe aberto // se meu tr já tiver ATV e o detalhe tiver Oculto Apenas abre {pois já está ativo}
                            // Cria o Canvas com Tm_CnvsMdds()
                            // ao Remover este Click remove o Canvas Detalhe
                            // a Estrelinha só deve aparecer em quem tem "CanvMdd"
                            // Fundir com o de cima e arrumar uma estrelinha pra "Canva3D"
                            RodaCanvMdds(Eu)
                        }
                    </script>
                </div>
                
                <div id="NovoForm" class="Cl w90 Rltv Rd Boxy">
                    
                    <div id="CONFIG" class="Abslt Ct" style="right:10px;top:10px"> <!--CONFIGURAÇÕES-->
                        <div class="PT HOV O_All" onclick="ClrAll()">🧹</div>
                        <div class="PT HOV O_All" onclick="RmvAll()">❌</div>
                        <img draggable="false" src="./SVG/More.svg" class="NObj" style="width:20px;opacity:0.2" onclick="TogShow($('#CONFIG_Bdj'))">
                        <script>
                            function Hdd_Cblh(Valid){if(Valid){Add($$(`#ORC thead`),'none')}else{Rmv($$(`#ORC thead`),'none')}}
                            function Hdd_Cust(){Tog($$(`[class^="ORC_CUST_"]`),'none')}
                            function Hdd_Crct(){Tog($$(`[class^="ORC_CRCT_"]`),'none')}
                            document.addEventListener("keydown",function(e){if(e.key==="'"){Prvn();Hdd_Cust()}})
                        </script>
                        <style>#CONFIG_Bdj{width: 150px; right: 0px; background: #363636; padding: 10px}</style>
                        <div id="CONFIG_Bdj" class="Abslt none Start2 bndj">
                            <div class="Ct"><input id="Hdd-Cbclh" type="checkbox" checked onchange="Hdd_Cblh(this.checked)" onclick="SaveConfig(this)"><label>Exibir Cabeçalho</label></div>
                            <div class="Ct"><input type="checkbox" onchange="Hdd_Cust()"> <label>Exibir Custo    </label></div>
                            <div class="Ct"><input type="checkbox" onchange="Hdd_Crct()"> <label>Exibir Crescente</label></div>
                            <div class="Ct"><input type="checkbox" id="TrocaDetalheE">    <label>Trocar Detalhes </label></div> <!--q siguinfica mudar de Modal para Fixo na tela-->
                        </div>
                    </div>

                    <style>  /*CSS do ORC NovoForm*/
                        #NovoForm{padding:20px 10px;margin-bottom: 5px;}
                        #ORC input,#ORC select{width:100% !important ; margin:0}
                        #ORC   .RS    {font-size:9px  ; margin-right: 3px}
                        #ORC   .RS + a{font-size:15px ; font-weight: bold;}
                        .Final .RS + a{font-size:25px ; font-family:var(--Bold)}
                        .Final .RS    {margin-right:3px}
                        :is(.CSS1,.CSS2) [class^="ORC_CUST_"]{color:#ff6565}.CSS3 [class^="ORC_CUST_"]{color:#c42929}
                        :is(.CSS1,.CSS2) [class^="ORC_CRCT_"]{color:#65b5ff}.CSS3 [class^="ORC_CRCT_"]{color:#146bbd}
                        :is(.CSS1,.CSS2) [class^="ORC_RSUT_"]{color:#48ff00}.CSS3 [class^="ORC_RSUT_"]{color:#2c9402}
                        .CSS3 .ORC_RSUT_FINAL  {color:#ffffff !important;background:#2c9402;border-radius:255px;padding:0px 10px}
                        #ORC td{padding: 1px}
                        #ORC th a,#ORC th p{display: flex;align-items: center;justify-content: center; opacity: 0.8;}
                        #ORC .Atv input,#ORC .Atv select{border: solid 2px #ff008c}
                        #ORC .Atv .imita{box-shadow: 0 0 2px 2px #ff008c}
                        .Branc{color: #ffffff5d !important}
                        .imita{height: 30px; background: #ffffff11}
                        .sOFF{opacity:0.3}
                        #G_Cores div{width:80%;  height:30px; border:2px solid #ffffff2f}
                        #G_Cores p  {width:30px; height:30px; margin:2px}
                        .AvisoInpt{top: 25px;width: 70%;left: 50%;font-size: 10px;background: #710808;padding: 2px;transform: translate(-50%, 0%)}

                        .CSS1 :is(.OrcAdd,.OrcClr,.BtnoQnt){fill:#ffa500   !important}
                        .CSS2 :is(.OrcAdd,.OrcClr,.BtnoQnt){fill:#ffa500   !important}
                        .CSS3 :is(.OrcAdd,.OrcClr,.BtnoQnt){fill:#6900569c !important} :is(.OrcAdd,.OrcClr) svg{width: 18px;}
                        .OrcRmv     {fill:#ff0000e7 !important} .OrcRmv svg{width:15px}
                        .BtnoQnt.Atv{fill:#690056   !important}
                        .BtnoQnt    {width:15px; height:15px; top: 8px;right: 8px}
                        .oImgs      {width:30px; height:30px}
                        .oImgs svg  {width:100%; height:100%}
                    </style>

                    <script> // Templates e Ações para Tabela de Orçamento
                        const BurealMode = true
                        // Templates
                            const Tm_ORC_Th=ary=>ary.map(e=>`<th class="${e==''?'':'O_Tx'}">${e==''?'':`<a>${e}</a><p>${D_Brev[e]}</p>`}</th>`).join('')
                            const Tm_Total=E=>[`CUST_${E} none`,`CRCT_${E} none`,`RSUT_${E}`].map(e=>`<div class="ORC_${e}" name="0">${Tm_RS(0)}</div>`).join('')
                        // Ações
                            const ReadSVG    =()=>readSVGFiles(SVG_FILES,(svg)=>AddCarr('Recorte','','','','',svg))
                            const Check_W_Pag=()=>{if(window.innerWidth<=650){$$('#ORC .O_Tx').forEach(th=>Show($('a',th),$('p',th)))}
                                                   if(window.innerWidth> 650){$$('#ORC .O_Tx').forEach(th=>Show($('p',th),$('a',th)))}};window.addEventListener("resize",Check_W_Pag)
                        // Add, Rmv, Clear
                            const RmvORC=tr=>tr.remove()
                            const ClrORC=tr=>{Clear($$('input',tr)) ; Zerar(tr)}
                            const ClrAll=()=>{$$(`#ORC tbody tr`                  ).forEach(tr=>ClrORC(tr))            ; Rload_Tbl() }
                            const RmvAll=()=>{$$(`#ORC tbody tr:not(:first-child)`).forEach(tr=>RmvORC(tr)) ; ClrAll() ; Rload_Tbl() }
                            const AddORC=tr=>{const Tr=tr.cloneNode(true) ; ClrORC(Tr) ; Insert(Pai(tr)).After(Tr,tr)  ; ORCnewID(Tr) ; Rload_Tbl()}
                            // Ao Limpar a tr tbm deveria Limpar os Detalhes
                    </script>
                    <script> // Handlers 
                        function Rload_Tbl(){Upp_Tabela('#ORC') ; Upp_RowCol('#ORC') ; ReloadTotal()}
                        function Upp_Tabela(Tbl){
                            $$(`${Tbl} tbody tr`).length == 1 ? None($$('.OrcRmv',$(Tbl))) : Show($$('.OrcRmv',$(Tbl))) // Remover o X
                            $$(`${Tbl} tbody tr`).length == 1 ? None($$('.O_All')) : Show($$('.O_All'))
                        }
                        function Upp_RowCol(Tbl){
                            const Lmt = $$(`${Tbl} tr:nth-child(1) input`).length
                            $$(`${Tbl} input`).forEach((I,x)=>{
                                I.dataset.row = Math.floor(x/Lmt)
                                I.dataset.col = x % Lmt})
                        }
                        function HandArrow(Tbl,e){
                            if (e.key === "Enter"){
                                const Inpts = $$(`input`,Tbl)
                                const Elemt = $(':focus')
                                const Next = Inpts[Array.from(Inpts).indexOf(Elemt)+1]
                                if(Next){Next.focus() ; Next.select() }}
                            let act = document.activeElement
                            if (act.tagName !== "INPUT") return
                            let r = +act.dataset.row, c = +act.dataset.col, nxt
                            if (e.key === "ArrowRight") nxt = `[data-row='${ r }'][data-col='${c+1}']`
                            if (e.key === "ArrowLeft")  nxt = `[data-row='${ r }'][data-col='${c-1}']`
                            if (e.key === "ArrowDown")  nxt = `[data-row='${r+1}'][data-col='${ c }']`
                            if (e.key === "ArrowUp")    nxt = `[data-row='${r-1}'][data-col='${ c }']`
                            if (nxt){$(nxt)?.focus() ; setTimeout(()=>$(nxt)?.select(),0)}
                        }
                    </script>

                    <table id="ORC" class="w90" onkeydown="HandArrow(this,event)">
                        <thead><tr onload="Inn(this,Tm_ORC_Th(['','Imgs','Serv','Tipo','Cbmt','Matr','Lrg','Alt','Qnt','Extr','Und','SbTt','','']))"></tr></thead>
                        <tbody>
                            <tr class="ORC_tr ORC_tr-1" oninput="Orcamento(this)" onchange="ValidOpts()">
                                <td width="15px"><div class="PT Ct OrcAdd" onclick="AddORC(_tr(this));Rload_Tbl()" onload="Inn(this,SVG.Mais)" ></div></td>
                                <td             ><div   class="oImgs"></div></td>
                                <td             ><div   class="oServ" oninput="ChangE(this,'Tipo')"   onload="Tm_Select(this,'Serv',['Serviços',...AllProd])" ></div></td>
                                <td             ><div   class="oTipo" oninput="ChangE(this,'Cbmt',0)" onload="Tm_Select(this,'Tipo',['Tipo'])"                ></div></td>
                                <td             ><div   class="oCbmt" oninput="ChangE(this,'Matr',1)" onload="Tm_Select(this,'Cbmt',['Acabamento'])"          ></div></td>
                                <td             ><div   class="oMatr" oninput="ChangE(this,'Qnt' ,2)" onload="Tm_Select(this,'Matr',['Gramatura'])"           ></div></td>
                                <td class="Rltv"><input class="oLrg"  oninput="Mask.Num(this);RodaCanvMdds(this)" placeholder="Largura"><span class="Abslt AvisoInpt none RD"></span></td>
                                <td class="Rltv"><input class="oAlt"  oninput="Mask.Num(this);RodaCanvMdds(this)" placeholder="Altura" ><span class="Abslt AvisoInpt none RD"></span></td>
                                <td class="Rltv"><div   class="oQnt"  oninput="ChangE(this,'Finn')" onload="Tm_Select(this,'Qnt',['Qnt'])"></div><div class="BtnoQnt Abslt PT" style="z-index: 50;" onclick="AtvMyMdds(this)" onload="Inn(this,SVG.Gemn)"></div></td>
                                <td width="10px"><div onload="Tm_Check(this,`${SVG.Chek}`)"></div></td>
                                <td width="10%" ><div onload="Inn(this,Tm_Total('Vund'))" style="height:auto;min-height:30px" class="imita RD Ct"></div></td>
                                <td width="10%" ><div onload="Inn(this,Tm_Total('SbTt'))" style="height:auto;min-height:30px" class="imita RD Ct"></div></td>
                                <td width="15px"><div class="PT Ct OrcClr" onclick="ClrORC(_tr(this));Rload_Tbl()" onload="Inn(this,SVG.Cler)"   ></div></td>
                                <td width="15px"><div class="PT Ct OrcRmv" onclick="RmvORC(_tr(this));Rload_Tbl()" onload="Inn(this,SVG.Fexa)"   ></div></td>
                            </tr>
                        </tbody>
                    </table>

                    <div><p>Total</p>
                        <div class="ORC_CUST_FINAL Final none"></div>
                        <div class="ORC_CRCT_FINAL Final none"></div>
                        <div class="ORC_RSUT_FINAL Final"     ></div>
                    </div>

                    <button onclick="VerNota('ORC')">Ver Nota</button>

                    <script> // Funções Dedicadas a Tabelas de ORÇAMENTO
                        function AddCarr(Serv,Tipo,Cbmt,Matr,Qnt,Imgs){
                            const ut = $$('.OrcAdd').slice(-1)[0]       // Pega o Ultimo
                            if(vAL('Serv',ut)!==""){DispClick(ut)}      // Cria uma Linha Nova se Precisar
                            const tr = _tr($$('.OrcAdd').slice(-1)[0])  // Pega agora essa Nova Linha
                                     Inn($('.oImgs',tr),Imgs)
                            const SERV = $('.oServ input',tr) ; Vll(SERV,Serv) ; ChangE(SERV,'Tipo')
                            const TIPO = $('.oTipo input',tr) ; Vll(TIPO,Tipo) ; ChangE(TIPO,'Cbmt')
                            const CBMT = $('.oCbmt input',tr) ; Vll(CBMT,Cbmt) ; ChangE(CBMT,'Matr')
                            const GRAM = $('.oMatr input',tr) ; Vll(GRAM,Matr) ; ChangE(GRAM,'Qnt' )
                            const QNTT = $('.oQnt  input',tr) ; Vll(QNTT,Qnt ) ; ChangE(QNTT,'Finn')
                            return tr
                        }

                        const TipoCalc=(e,tr)=>{
                            ['M2','OFS','UND'].forEach(t=>{Prod[e].Calc==t ? Add(tr,'Calc_'+t) : Rmv(tr,'Calc_'+t)}) // Tog_M2_OFS_UND

                            if(!tr.classList.contains('Calc_OFS')){Add(_td($('.oQnt',tr)),'Rltv')}else{Rmv(_td($('.oQnt',tr)),'Rltv')} // tentar ver o qão isso não é nessesário
                        }

                        const VALS=tr=>Object.fromEntries(['Serv','Tipo','Cbmt','Matr','Lrg','Alt','Qnt','Qntt'].map(e=>[e,vAL(e,tr)]))

                        // Mostrar o Valor por m2 ao Lado do Option
                        // ativar e Desativar a Opção de imitar Bureal (Melhorar a Imitação)
                        // quando for algum M2 já da quantidade 1 logo no Inicio ao editar Serv

                        const sP=(Stg,tr)=>$(`.o${Stg} span` ,tr)
                        const sI=(Stg,tr)=>$(`.o${Stg} input`,tr)
                        
                        const cP=(tr,Md)=>{ // a idéia é fazer isso ser possível selecionar de traz pra frente também
                            const B = VALS(tr)
                            const Calc = Prod[B.Serv].Calc
                            const Faiz =e=> e ? MATR[e] ? ObjKey(MATR[e].Tipos) : [...e] : e
                                if(              Md=='Tipo'){return Uniq(ObjKey(Prod[B.Serv].Tipos                          )).filter(e=>e!=="Todos" )}
                                if(Calc=='OFS'&& Md=='Cbmt'){return Uniq(       Prod[B.Serv].Tipos[B.Tipo]?.Table.map(e=>e[0])                       )}
                                if(Calc=='OFS'&& Md=='Matr'){return Uniq(       Prod[B.Serv].Tipos[B.Tipo]?.Table.map(e=>e[1])                       )}
                                if(Calc=='OFS'&& Md=='Qnt' ){return Uniq(       Prod[B.Serv].Tipos[B.Tipo]?.Table.map(e=>e[2])[0].map(e=>e[0])       )}
                                if(Calc=='OFS'&& Md=='Finn'){return Uniq(       Prod[B.Serv].Tipos[B.Tipo]?.Table                                    )}
                                if(Calc=='M2' && Md=='Cbmt'){return Uniq(ObjKey(Prod[B.Serv].Tipos[B.Tipo]?.Cbmt             )).filter(e=>e!=="Todos")}
                                if(Calc=='M2' && Md=='Matr'){return Uniq(  Faiz(Prod[B.Serv].Tipos[B.Tipo]?.Cbmt[B.Cbmt].matr)).filter(e=>e!=="Todos")}
                                if(Calc=='M2' && Md=='Qnt' ){return null}
                        }

                        function ChangE(d,Md,X){ // a Função que Troca os Options Conforme Seleciona
                            const [e,tr]=[VAAL(d),_tr(d)]
                            if(Md=='Finn'){LOG(Md,cP(tr,Md)) ; Orcamento(tr,cP(tr,Md)) ; return}
                            const Dados = cP(tr,Md)                                                         // eliminar este array, pra deixar tudo em Objetos
                            if(Dados==null){return}                                                         // só apliquei isso pra tirar um ERRO, mas n sei se eu deveria realmente fazer isso!
                            const Opt   = Md=='Tipo' ? Prod[e].Opts : 'List'                                // se não for Change em Serv todo resto fica List por enquanto (Melhorar isso!)
                            Inn(sP(Md,tr),Tm_MyOpts(Dados||[],Opt))                                         // dar o Inner do MyOpts a (lista,Forma de Exibire)
                            if(Md=='Tipo'){TipoCalc(e,tr)}                                                  // Quando dou Change em Serv (Talvez n tem Problema Rodar toda Vez, vai Qui Né!)
                            if(!Dados.includes(vAL(Md,tr)||'')){Vll(sI(Md,tr),'')}                          // Analisar depois se precisa de Disparo
                            if(Dados.length==1            ){Vll(sI(Md,tr),Dados[0]) ; Dispinput(sI(Md,tr))} // se tiver apenas um Seleciona ele e dispara
                            // ainda acontece algo que quando eu troco o serv, a Limpeza só é efetuada no 'Tipo' por que ele já é o Próximo
                            // e só vai pra o terceiro se o tipo for apenas 1, pq bate com o critério acima e dar o Disparo, ai nesse caso atualiza o outro
                            // mas eu quero isso mais Poderoso, quero que ao trocar percorra todas elas pra analziar se as demais tão tudo OK msm!
                        }

                        function Orcamento(tr,Lista=null){
                            const TotalCress=(Valr,e)=>Math.round(e*(Valr+Valr*Crecent(e)))
                            let [Serv,Tipo,Cbmt,Matr,Lrg,Alt,Qnt,Qntt] = ['Serv','Tipo','Cbmt','Matr','Lrg','Alt','Qnt','Qntt'].map(e=>vAL(e,tr))
                            if(!Prod[Serv]){return} // Cancela se o Poduto não Exista
                            const Calc = Prod[Serv].Calc
                            const QNT  = Num(`${Qntt}`.replace('.',''))
                            
                            if(Calc=='OFS'){ // quando for Zero é pq ta indisponivel ent n deveria carregar
                                if(Lista==null){return} // caso não venha nenhuma Lista
                                const Flt=Lista.filter(e=>e[0]==Cbmt && e[1]==Matr)
                                if(Flt.length==0){return} // Caso não tenha Filter
                                const F = Flt[0][2].filter(e=>e[0]==Qntt)[0]
                                InnRsult(tr,QNT,F[2],F[1],F[1])                // (tr,Qnt,Cust,Crcnt,Valr)
                            }
                            if(Calc=='M2v'){
                                const svg = $('.oImgs svg',tr).outerHTML
                                const R   = CalcSVG(svg,[Lrg,Alt,Qnt],BS_Mtras[Tipo])
                                LOG('Corte: ',R.Cort,'Mtrl: ',R.Mtrl)
                                InnRsult(tr,Qnt,2,R.Cort+R.Mtrl,(R.Cort+R.Mtrl)*1.15) // (tr,Qnt,Cust,Crcnt,Valr)
                            }
                            if(Calc=='M2'){
                                const tipo = Prod[Serv].Tipos[Tipo].Cbmt[Cbmt]
                                CheckLimit(tipo,$('.oLrg',tr),$('.oAlt',tr),Lrg,Alt)
                                const m2   = Lrg*Alt*Qnt
                                const DESCt= m2<=5 ? 0 : m2>=15 ? 0.15 : m2/100 // Desconto pra cima de 5 Metros
                                const addi = Serv=='Trofeu' ? 1*Qnt : 0
                                const vCst = tipo?.Cust ?? 0
                                const MtrL = tipo?.matr=='Adesivo' ? MATR['Adesivo'].Tipos[Matr]?.Valr : 0
                                const vM2  = tipo?.Valr+MtrL ?? 0
                                const VV   = TotalCress(vM2,m2)+addi
                                const Cust = vCst*m2
                                const Crct = vM2*m2+addi
                                const Valr = Math.floor(VV-(VV*(DESCt)))
                                InnRsult(tr,Qnt,Cust,Crct,Valr)
                            }
                            // mostrar o Valor q sairia se fosse de UND quando eu escolher mais de 1
                        }

                        const Zerar=tr=>InnRsult(tr,0,0,0)
                        const InNa_RS=(e,v)=>{const V=isNaN(v)?0:v ; Inn(e,Tm_RS(V)) ; Nm(e,V) ; if(V==0){Add(e,'Branc')}else{Rmv(e,'Branc')}}
                        function ReloadTotal(){['CUST','CRCT','RSUT'].forEach(E=>{const v = SOMA($$(`.ORC_${E}_SbTt`).map(e=>Nm(e))) ; InNa_RS($(`.ORC_${E}_FINAL`),v)})}
                        
                        function InnRsult(tr,Qnt,F_Cust,F_Crct,F_Valr){    
                            InNa_RS($('.ORC_CUST_Vund',tr),(F_Cust/Qnt||0))
                            InNa_RS($('.ORC_CRCT_Vund',tr),(F_Crct/Qnt||0))
                            InNa_RS($('.ORC_RSUT_Vund',tr),(F_Valr/Qnt||0))
                            InNa_RS($('.ORC_CUST_SbTt',tr),F_Cust)
                            InNa_RS($('.ORC_CRCT_SbTt',tr),F_Crct)
                            InNa_RS($('.ORC_RSUT_SbTt',tr),F_Valr)
                            ReloadTotal()
                            // a soma de metros de produtos do mesmo tipo tem q resultar na soma da Diminuição da Crescente
                        }
                        Rload_Tbl() // Iniciar
                    </script>
                </div>

                <div class="Cl none">                   
                    <div class="Cl"><input id="Compmnt" type="text" placeholder="Comprimento" value="0"></div>
                    <div class="Cl none"><button class="Ct" onclick="ValTogg('#BackCub','0','1')">Completar Cubo</button><input id="BackCub" class="none" value="0"></div>
                    <button class="none" onclick="Gera3d($('#NewCanvas'))">Roda 3D</button>
                </div>
            </div>

            <div id="Pag_PDDS" class="     Cl TBLAA">

                <div onload="Tm_Switch(this,['Pedidos','Serviços','Pagamento'],`slideTo(x,'PDDS')`,'PPDS')"></div>

                <div class="Wrapper">
                    <div id="Slide_PDDS" class="Slide_Table">
                        <div class="Cl"> <!--PDDS-->
                            <div class="Confy_PDDS Cl">
                                <div class="Bt Stky copybody w100" style="height: 40px;">
                                    <button onclick="AddROW('PDDS','<')">Nova Linha +</button>
                                    <div id="PagPesq_PDDS" class="PagPEsq" onload="Inn(this,Load_Pesq('PDDS'))"></div>
                                    <div id="COnf_PDDS"    class="Configs Ct">
                                        <div onclick="ReszH('PDDS')" onload="Tm_Check(this,`${SVG.RszH}`,'')"></div>
                                        <div onclick="ReszW('PDDS')" onload="Tm_Check(this,`${SVG.RszW}`,'')"></div>
                                    </div>
                                    <div onclick="Tog($$('#H_PDDS .AutoComp'),'Cor')" onload="Tm_Check(this,`${SVG.Chek}`,'Auto')"></div>
                                    <div id="Sommma">Soma: 00,00</div>
                                    <div onclick="TrcTog($('#H_PDDS'),'Tbla','Card');Tog_Card('PDDS')" onload="Tm_Interup(this,`${SVG.List}`,`${SVG.Card}`)"></div>
                                    <select id="mesES" onload="Inn(this,Tm_Opt(meses))" onchange="FiltMes(this.value,'PDDS')"></select>
                                    <button onclick="F_Clen('PDDS')" onload="Inn(this,`${SVG.Cler.replace('HOV PT','')}Limpar`)"></button>
                                </div>  
                                <table id="SKLT_PDDS" class="hMin Tbla w90">
                                    <thead class="Stky" style="z-index: 510;top:40px;"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PDDS),'PDDS'))"></tr></thead>
                                    <tbody onload="Inn(this,Tm_Sklt('PDDS'))"></tbody>
                                    <tfoot class="Stky2"><tr></tr></tfoot>
                                </table>
                                <table id="H_PDDS" class="hMin Tbla">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PDDS),'PDDS'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.PDDS),'PDDS'))"></tr></tfoot>
                                </table>
                                <button onclick="loadtmtable('PDDS',true,false)">Carregar Tudo</button>
                            </div>
                        </div>

                        <div class="Cl"> <!--SERV-->
                            <div class="Confy_SERV">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="LOG('Indisponivel')">Nova Linha</button>
                                    <div id="PagPesq_SERV" class="PagPEsq" onload="Inn(this,Load_Pesq('SERV'))"></div>
                                    <div id="COnf_SERV" class="Configs Ct"></div>
                                    <button onclick="F_Clen('SERV')">Limpar</button>
                                </div>
                                <table id="H_SERV" class="hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.SERV),'SERV'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.SERV),'SERV'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl"> <!--PGMT-->
                            <div class="Confy_PGMT">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="LOG('Indisponivel')">Nova Linha</button>
                                    <div id="PagPesq_PGMT" class="PagPEsq" onload="Inn(this,Load_Pesq('PGMT'))"></div>
                                    <div id="COnf_PGMT" class="Configs Ct"></div>
                                    <button onclick="F_Clen('PGMT')">Limpar</button>
                                </div>
                                <table id="H_PGMT" class="hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PGMT),'PGMT'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.PGMT),'PGMT'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="Pag_PGMT" class="none Cl TBLAA">
                <div class="Wrapper">
                    <div id="Slide_MPAG" class="Slide_Table">
                        <div class="Cl">
                            <div class="Confy_MPAG">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('MPAG','<')">Nova Linha +</button>
                                    <div id="PagPesq_MPAG" class="PagPEsq" onload="Inn(this,Load_Pesq('MPAG'))"></div>
                                    <div id="COnf_MPAG" class="Configs Ct"></div>
                                    <button onclick="F_Clen('MPAG')">Limpar</button>
                                </div>
                                <table id="H_MPAG" class="w100 hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.MPAG),'MPAG'))"></tr></thead>
                                    <tbody></tbody>
                                </table>
                </div></div></div></div>
            </div>

            <div id="Pag_GRAD" class="none Cl TBLAA"> <!-- ⭐⭐_ _ _  (bem quse lá, na questão de organização e distribuição) -->

                <div onload="Tm_Switch(this,['GRAD','OS','UBER','GRD2'],`slideTo(x,'GRAD')`,'GRAD')"></div>

                <div class="Wrapper">
                    <div id="Slide_GRAD" class="Slide_Table">
                        <div class="Cl"> <!--GRAD-->
                            <div class="Confy_GRAD">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('GRAD','<')">Nova Linha +</button>
                                    <div id="COnf_GRAD" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>
                                <table id="H_GRAD" class="hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.GRAD),'GRAD'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.GRAD),'GRAD'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl"> <!--OOSS-->
                            <div class="Confy_OOSS">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('OOSS','<')">Nova Linha +</button>
                                    <div id="COnf_OOSS" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>

                                <table id="H_OOSS" class="hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.OOSS),'OOSS'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.OOSS),'OOSS'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl"> <!--GRD2-->
                            <div class="Confy_GRD2">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('GRD2','<')">Nova Linha +</button>
                                    <div id="COnf_GRD2" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>
                                <table id="H_GRD2" class="hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.GRD2),'GRD2'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.GRD2),'GRD2'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl"> <!--UBER-->
                            <div class="Confy_UBER">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('UBER','<')">Nova Linha +</button>
                                    <div id="COnf_UBER" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>
                                <table id="H_UBER" class="hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.UBER),'UBER'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.UBER),'UBER'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>


                    </div>
                </div>
            </div>

            <div id="Pag_CLNT" class="none Cl TBLAA">
                <div class="Wrapper">
                    <div id="Slide_CLNT" class="Slide_Table">
                        <div class="Cl">
                            <div class="Confy_CLNT">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('CLNT','<')">+ Nova Linha</button>
                                    <h1>Tabela de Clientes</h1>
                                    <button onclick="MesclaRow('CLNT',BS['CLNT'])">Mesclar</button>
                                    <div id="PagPesq_CLNT" class="PagPEsq" onload="Inn(this,Load_Pesq('CLNT'))"></div>
                                    <button onclick="F_Clen('CLNT')">Limpar Filtro</button>
                                </div>
                                <table id="H_CLNT" class="hMin">
                                    <thead class="Stky" style="z-index:510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.CLNT),'CLNT'))"></tr></thead>
                                    <tbody></tbody>
                                </table>
                </div></div></div></div>
            </div>

            <div id="Pag_GBRT" class="none Ct" style="overflow-y: scroll;"> <!--VIROU AGENDA-->
                <style>
                    #Agnda{display:grid;grid-template-columns:repeat(7,1fr);gap:5px}
                    #Agnda .box{padding: 3px; min-height: 100px ; min-width: 150px}
                    .evt{color:#fff;margin:2px 0;padding:2px}
                    .Cov:hover{background-color: #8b8b8b5d}
                    .Off{opacity: 0.3}
                    option.Off{color: red !important}
                    .bandj{width:500px;left:50%;transform:translateX(-50%);top: 35px;}
                    .bandj :is(input,select){width: 100px}
                </style>

                <script> // ====== BASE DE DADOS ======
                    let hoje = new Date(), ano=hoje.getFullYear(), mes=hoje.getMonth(), AGND=[], DaySel=null
                    const FUNC_COLOR = {Arte:'#6f42c1','Aplicação':'#0d6efd'}
                    const FUNC_TIME  = {Arte:120,'Aplicação':60}
                    const HORAS      = ["Hora","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00"]
                </script>

                <script> // ====== BIBLIOTECA ======
                    const LmtUser=(Arr,{Data,User})=>Arr.filter(e=>e.Data==Data && e.User==User).length>=5
                    const FmtDate=d=>d.toISOString().slice(0,10)
                    const FmtHora=d=>`${String(d.getHours()).padStart(2,'0')}:00`
                    const HoraMin=h=>+h.split(':')[0]*60
                    const MinHora=m=>`${String(m/60).padStart(2,'0')}:00`
                </script>

                <div>
                    <h1>AGENDA infinityGRAFF</h1>
                    <div class="box Cl Gap"><h2 id="mes"></h2><div id="Agnda" class="w100"></div></div>
                </div>

                <script>
                    /* ================== HORAS ================== */
                    function LoadHoras(dt,sel){
                        function Ocupadas(dt){
                            return AGND.filter(e=>e.Data===dt).flatMap(e=>{
                                let ini = HoraMin(e.Hora)
                                let dur = FUNC_TIME[e.Func]||60
                                return Array.from({length:dur/60},(_,i)=>MinHora(ini+i*60))})
                        }
                        let agora = new Date()
                        let usadas = Ocupadas(dt)
                        $$('option',sel).forEach(op=>{
                            let h = op.value || op.innerText
                            let off1 = usadas.includes(h)
                            let off2 = dt==FmtDate(agora) && h<=FmtHora(agora)
                            let off = off1 || off2
                            op.classList.toggle('Off', off)
                            op.disabled = off
                        })
                    }

                    /* ================== CALENDÁRIO ================== */
                    function Tm_Agnd(g, lista){
                        const DOW = ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb']
                        Inn(g,'') ; Inn('#mes', hoje.toLocaleString('pt-BR',{month:'long',year:'numeric'}))
                        let d0 = new Date(ano,mes,1).getDay()   // Domingo = 0
                        let dm = new Date(ano,mes+1,0).getDate()
                        let hj = FmtDate(new Date())
                        // Cabeçalho
                        DOW.forEach((d,i)=>{let off = (i === 0 || i === 6) ? 'Off' : '' ; g.innerHTML += `<div class="noslt ${off}"><b>${d}</b></div>`})
                        // Espaços antes do dia 1
                        for(let i=0;i<d0;i++) g.innerHTML += '<div></div>'
                        // Dias do mês
                        for(let d=1; d<=dm; d++){
                            let dt  = `${ano}-${String(mes+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`
                            let ev  = lista.filter(e=>e.Data===dt).sort((a,b)=>HoraMin(a.Hora)-HoraMin(b.Hora))
                            let dow = new Date(dt).getDay()   // 0 = Dom, 6 = Sáb
                            let off = dt < hj || dow == 6 || dow == 5 ? 'Off noClk' : 'Cov'
                            g.innerHTML += `<div class="box ${off} Rltv" ondblclick="OpenDay(this,event,'${dt}')"><b class="noslt">${d}</b>
                                ${ev.map(e=>`<div class="evt RD Hov" style="background:${FUNC_COLOR[e.Func]||'#007bff'}" onclick="EditItem(${e.id},this)">${e.Hora} • ${e.Nome} • ${e.Func}</div>`).join('')}
                                <div class="bandj gap Ct Box Abslt none"></div>
                            </div>`
                        }
                    }

                    /* ================== BANDEJA ================== */
                    function TplAgnd({mode='new',data={},id=null}={}){
                        const Alls = `$$('input, select',Avo(this))`
                        return `
                            <input  class="Nome" placeholder="Nome" value="${data.Nome||''}">
                            <select class="Func">${Tm_Opt(['Função','Arte','Aplicação'],data.Func)}</select>
                            <select class="User">${Tm_Opt(['Usuário','Allan','Baby','Fexta'],data.User)}</select>
                            <select class="Hora">${Tm_Opt(HORAS,data.Hora)}</select>
                            ${mode=='edit' ? `<input type="date" class="Data" value="${data.Data}">` : ''}
                            <div class="Ct Gap">
                                ${mode!='edit' ? `<button onclick="SB_Inst_AGND(${Alls})                   ">Salvar</button>`
                                            : `<button onclick="SB_Edit_AGND(${Alls},${id});XModal(this)">Salvar</button>
                                                <button onclick="SB_Dlet_AGND(${id})        ;XModal(this)">Excluir</button>`
                            }</div>
                        `
                    }

                    function OpenDay(Eu,ev,dt){
                        if (dt < FmtDate(new Date())) return ; DaySel = dt
                        None($$('.bandj'))
                        const Bj = $('.bandj',Eu)
                        Inn(Bj,TplAgnd())
                        LoadHoras(dt,$('.Hora',Bj))
                        Show(Bj)
                    }

                    function EditItem(id){
                        let e = AGND.find(a=>a.id==id) ; if(!e) return
                        MODAL(`<h2>Editar Agendamento</h2>${TplAgnd({mode:'edit',data:e,id})}`)
                        LoadHoras(e.Data,$('.FModal .Hora'))
                    }
                </script>

                <script>// ================== SUPABASE ==================
                    async function getAgnd(g){let {data}=await supaBASE.from('AGND').select('*') ; AGND=data||[] ; Tm_Agnd(g,AGND)}

                    async function SB_Inst_AGND(Ipnts){
                        let obj={}
                        Ipnts.forEach(i=>obj[i.className]=i.value)
                        obj.Data = DaySel
                        if(ObjVal(obj).some(v=>!v)) return alert('Preencha tudo')
                        if(LmtUser(AGND,obj))       return alert('Limite diário atingido')
                        await supaBASE.from('AGND').insert(obj)
                        DaySel=null
                        getAgnd($('#Agnda'))
                    }

                    async function SB_Edit_AGND(Ipnts,id){
                        let obj={}
                        Ipnts.forEach(i=>obj[i.className]=i.value)
                        if(ObjVal(obj).some(v=>!v)) return alert('Preencha tudo')
                        await supaBASE.from('AGND').update(obj).eq('id',id)
                        getAgnd($('#Agnda'))
                    }

                    async function SB_Dlet_AGND(id){
                        if(!confirm('Excluir este agendamento?')) return
                        await supaBASE.from('AGND').delete().eq('id',id)
                        $('.FModal')?.remove()
                        getAgnd($('#Agnda'))
                    }
                </script>

                <script>/* ================== INIT ================== */
                    getAgnd($('#Agnda'))
                    document.addEventListener('click',e=>{if(!e.target.closest('.bandj') && !e.target.closest('.Cov')){None($$('.bandj'))}})
                    // Filtrar pra exibir cada um
                    // Ocultar quando atingir Limit Diário LmtUser(AGND,obj)

                    // Campo pra Presencial, Waapp, Ligação
                </script>

            </div>

            <div id="Pag_LOJA" class="none Cl"></div>
            
            <div id="Pag_ARTE" class="none Cl TBLAA">
                <div class="Wrapper">
                    <div id="Slide_ARTE" class="Slide_Table">
                        <div class="Cl">
                            <div class="Confy_ARTE">
                                <div class="Bt Stky copybody" style="height: 40px;">
                                    <button onclick="AddROW('ARTE','<')">Nova Linha +</button>
                                    <div id="PagPesq_ARTE" class="PagPEsq" onload="Inn(this,Load_Pesq('ARTE'))"></div>
                                    <div id="COnf_ARTE" class="Configs Ct"></div>
                                    <button onclick="F_Clen('ARTE')">Limpar</button>
                                </div>
                                <table id="H_ARTE" class="w100 hMin">
                                    <thead class="Stky" style="z-index: 510;top:40px"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.ARTE),'ARTE'))"></tr></thead>
                                    <tbody></tbody>
                                </table>
                </div></div></div></div>
            </div>

            <div id="Pag_PRFL" class="none Cl" style="overflow-y: scroll;">

                <style> /*Analsisar a interferência deste CSS*/
                    #Pag_PRFL   {padding: 40px;}
                    .rs         {color:#8dff57}
                    .Box .rs    {font-size: 25px}
                    .Art .rs    {font-size: 25px}
                    h2,h3       {font-size: 25px}
                    .BOX        {padding:18px;border-radius:14px;background:#111;border:1px solid #222}
                    .Box        {width:130px; height:100px; padding:5px ;  transition:all 0.1s ease-in-out ;cursor: pointer;}
                    .Box:hover  {border:1px solid #93c47d;box-shadow:0 0 8px #93c47d99;transform:scale(1.05);}
                    #Perf .Box a{width: 40px; height: 40px}
                    .Desc a     {width: 15px; height: 15px}
                    .Pic        {width:120px;border-radius:50%}
                    .Art        {gap:3px}
                    .Art img    {width:120px;height:120px;object-fit:contain;border-radius:8px;background:#111}
                    .Fotoz      {width: 20px; height: auto;}

                    .Svg-P svg  {width: 15px; height: 15px;}
                    .Svg-M svg  {width: 30px; height: 30px;}
                    .Svg-G svg  {width: 40px; height: 40px;}

                    #Perf-Trfs table {width:100%; font-size:14px; color:#eee; background-color:#222}
                    #Perf-Trfs th, #Perf-Trfs td {border:1px solid #444; padding:8px 12px; text-align:left}
                    #Perf-Trfs th                {background-color:#333}
                    #Perf-Trfs tr:hover          {background-color:#444}
                    #Perf-Trfs td:first-child    {text-align:center; width:50px; }

                    .Hovoi{overflow-x: scroll;}
                </style>

                <div class="w100 Cl Gap">
                    <div id="Perf-Perf" class="BOX Ev Gap w100"></div>
                    <div id="Perf-Soli" class="BOX Cl Gap w100"></div>
                    <div id="Perf-Andm" class="BOX Cl Gap w100"></div>
                    <div id="Perf-Hist" class="BOX Cl Gap w100"></div>
                    <div id="Perf-Hist2" class="BOX Cl Gap w100"></div>
                    <div id="Perf-Trfs" class="BOX Cl Gap w100"></div>
                </div>

                <script>
                    let [__A,__M,__D,__S]=['','','','']
                    const Tm_SOliArt=(U,E)=>`<h3>Solicitações      </h3><div class="Start w100 Gap Hovoi">${E.map(e=>`<div class="    Ct Bt Hov BOX" onclick="Unyc('${U}','${e.Id}')"><div class="Cl Start2"><b>${e.Nome}</b><p>${e.Tema} • ${e.Prazo}</p></div><p>${Tm_RS2(e.Valr)}</p><button onclick="AceitarART(${U},${e.Id})">AceitarART</button></div>`).join("")}</div>`
                    const Tm_ListArt=(U,E)=>`<h3>Histórico de Artes</h3><div class="Start w100 Gap Hovoi">${E.map(e=>`<div class="Art Cl PT Hov BOX" onclick="Unyc('${U}','${e.Id}')"><img src="${BASE_URL}Img/${e.Nome}.webp"><p>${e.Nome}</p><p>${e.Tema}</p><p>${Tm_RS2(e.Valr)}</p></div>`).join("")}</div>`
                    const View=(U,Md)=>MODAL(Tm_ListArt(U,Md=='Dslk'?__D:__A))        // ao rodar o Modal Excluir o Antigo
                    const Unyc=(U,ID)=>MODAL(Tm_ListArt(U,__A.filter(e=>e.Id==ID))) // ao rodar o Modal Excluir o Antigo

                    function Load_Perfil(U){
                        const u = U.Nome
                        const Fil = RangeDATA(J['SERV'],'SERV')
                        __A = J['ARTE'].filter(o=>o.Dsng==u && o.Stts=='Ok' && !o.Dslk?.includes(u))
                        __M = J['ARTE'].filter(o=>o.Dsng==u && o.Stts=='Aceita')
                        __D = J['ARTE'].filter(o=>o.Dslk?.includes(u))
                        __S = J['ARTE'].filter(o=>o.Dsng==null||o.Dsng=="")
                        let Partic = 0 ; let Comiss = 0
                        Fil.forEach(e=>{if(e.Dsng==u){Partic+=1 ; Comiss+=e.CArt} /*if(e.Cbmt==U){Partic+=1 ; Comiss+=e.VCbt}*/ })

                        Inn($('#Perf-Perf'),`<img class="Pic" src="${U.Foto}">
                                <div class="Desc Cl Start2 Gap"><div class="Ct Gap"><h2>${U.Nome}</h2><p>${D_Brev2[U.cgo]}</p></div>
                                    ${['Emal','Lcal','Fone'].map(e=>`<div class="Ct gap"><a class="Svg-P f-Lrnj">${SVG[e]}</a><p>${U[e]}</p></div>`).join('')}
                                </div>
                                <div class="Ct Gap">
                                    <div class="BOX Cl Box"                              ><a class="Svg-G f-gren">${SVG['Okay']}</a><p>Participações     </p><h3>${Partic             }</h3></div>
                                    <div class="BOX Cl Box" onclick="View('${u}','Okay')"><a class="Svg-G f-gren">${SVG['Okay']}</a><p>Total de Artes    </p><h3>${__A.length         }</h3></div>
                                    <div class="BOX Cl Box" onclick="View('${u}','Dslk')"><a class="Svg-G f-redd">${SVG['Dslk']}</a><p>Total de rejeições</p><h3>${__D.length         }</h3></div>
                                    <div class="BOX Cl Box" onclick="View('${u}','Coin')"><a class="Svg-G f-gren">${SVG['Coin']}</a><p>Saldo Total       </p>${Tm_RS2(SOMA_Obj(__A,'Valr'))}</div>
                                </div>`)
                        Inn($('#Perf-Soli'),Tm_SOliArt(u,__S)) ; Inn($('#Perf-Andm'),Tm_SOliArt(u,__M)) ; Inn($('#Perf-Hist'),Tm_ListArt(u,__A)) // U.On?"Online":"Offline"
                            
                        const tableFilt = Fil.reverse().filter(e=>e.Dsng==u)

                        const rows = tableFilt.map(e=>`<tr>
                            <td>${JJ.CLNT[e.Clnt]?.Clnt}</td>
                            <td>${e.Serv}</td><td>${e.TArt}</td><td>${e.CArt}</td><td>${e.Dsng}</td>
                            <td><img class="Fotoz" src="${BASE_URL}Img/${J['IMGS'][e.Id]}"></td>
                        </tr>`).join('')

                        Inn($('#Perf-Trfs'),`<table><thead><tr>${['Cliente','Serviço','Tipo','Valor','Desing','Foto'].map(e=>`<th>${e}</th>`).join('')}</tr></thead><tbody>${rows}</tbody></table>`)
                        Inn($('#Perf-Hist2' ),`<h3>Histórico de Artes</h3><div class="Start w100 Gap Hovoi">${tableFilt.map(e=>`<div class="Art Cl PT Hov BOX" onclick="Unyc('${e.Id}')"><img src="${BASE_URL}Img/${J['IMGS'][e.Id]}"><p>${JJ.CLNT[e.Clnt]?.Clnt}</p><p>${e.TArt}</p><p>${Tm_RS2(e.CArt)}</p></div>`).join("")}</div>`)    
                    }

                    async function AceitarART(U,Id){const{error}=await supaBASE.from("ARTE").update({Stts:"Aceita",Dsng:U}).eq("Id",Id)
                        if(!error){alert("Solicitação aceita") ; location.reload()}
                    }

                </script>
            </div>

            <div id="Pag_BBTC" class="none Cl"></div>

            <div id="Pag_SPRT" class="none Cl">
                <div>informações de Suporte</div>
                <div>dicas de como usar o APP, principalmente pra mim</div>
                <button onclick="CopyGRAFF('Pix',this)">Copiar Pix</button>
            </div>

            <div id="Pag_CONF">
                <h1>Configurações</h1>
                <div id="ConfigPag" class="Cl Rltv Rd">
                    <div class="Ct Close" onclick="SairMdal()">X</div>
                    <div><input id="DarkLite" type="checkbox" onchange="DarkLite2('body',this.checked)" onclick="SaveConfig(this)"> <label>Modo Escuro</label></div>
                    <div><input id="TamFonte" type="range"> <label>Tamanho de Fonte</label></div>
                    <button onclick="TrocaCSS('CSS1')">CSS1</button>
                    <button onclick="TrocaCSS('CSS2')">CSS2</button>
                    <button onclick="TrocaCSS('CSS3')">CSS3</button>
                </div>
                <!--Tudo aqui será dependente do Login do Usuário-->
            </div>
        </div>
    </div>

    <div id="FModal" class="Ct">
        <style> /*CSS dos Modais*/
            .Dark #FModal>div{background:#1b1b1b}
            .Lite #FModal>div{background:#ffffff}
            #FModal h1{font-size:25px}
            #ModalNota>div{padding:5px 0px}
            #Nota-Clnt>div>div>div{margin:0px 5px}
            #ModalNota img{width:50px;height:50px}
            #ModalNota .Start2 p{margin:1px 5px}
            #LugarFotoNotta{margin-right:3px}
            #TabelaNotinha td{padding:3px ; font-size: 15px;}
            #TabelaNotinha th{padding:3px ; font-size: 13px;}
            #TabelaNotinha thead tr{background:#5F009E; color:#ffffff}
            #TabelaNotinha tbody td:nth-child(3){text-align:start}
            #TabelaNotinha tbody td:nth-child(4){text-align:end}
            #TabelaNotinha tbody td:nth-child(5){color:#4f4f4f}
            #TabelaNotinha tbody td:nth-child(6){margin-right: 6px ; text-align: start;}
            #TabelaNotinha tbody td:nth-child(7){color:#00000093 ; font-size: 13px;}
            #TabelaNotinha tbody td:nth-child(8){font-weight: bold ; color:var(--Laranja);}
        </style>

        <script>function SairMdal(){None('#FModal')}</script>

        <div id="ModalNota" class="Cl Rltv Rd media30">
            <div id="NOTA" class="w100" style="background: white;padding: 10px;color: black;">
                <div id="Titulo-Nota" class="w100 Bt Hr"></div>
                <div id="Nota-Empresa" class="Ct Row Hr Bt w100">
                    <div class="Ct">
                        <div id="LugarFotoNotta"><img src="./Img/Logo2.png" style="width: 50px;height: 50px;"></div>
                        
                        <div><h2>INFINITY GRAFF</h2><h2>IMPRESSÃO DIGITAL</h2></div>
                    </div>
                    <div class="Start2">
                        <div class="FtBd Ct">Endereço: <p>Estrada do Tip, N° 54A   </p></div>
                        <div class="FtBd Ct">Cidade:   <p>SÃO LOURENÇO DA MATA     </p></div>
                        <div class="FtBd Ct">Email:    <p>infinitygraff@outlook.com</p></div>
                        <div class="FtBd Ct">Contato:  <p>(81) 98726.5401          </p></div>
                    </div>
                </div>
                <div class="Ct Cl Hr"><h2>CUPOM FISCAL</h2><div id="DataNota"></div></div>
                <div class="Start2 Hr">
                    <div class="Ct"><p class="FtBd">ORDEM DE SERVIÇO:<p><p>   ${id}   </p></div>
                    <div class="Ct"><p class="FtBd">      Data:      </p><p>00/00/2023</p></div>
                </div>
                <div id="Nota-Clnt" class="Row w100 Ev">
                    <div><div class="Ct FtLt">Nome:     <div data="Clnt"  spellcheck="false" contenteditable="true">-</div></div>
                         <div class="Ct FtLt">Fone:     <div data="Cntt"  spellcheck="false" contenteditable="true" oninput="Mask2.fone(this)">-</div> </div></div>
                    <div><div class="Ct FtLt">Endereço: <div data="Local" spellcheck="false" contenteditable="true">-</div></div>
                         <div class="Ct FtLt">Cidade:   <div data="City"  spellcheck="false" contenteditable="true">-</div></div></div>
                </div>
                <div id="ConteudoNota" class="w100"></div>
            </div>
            <style>  /*isso é pra ser Biblioteca q são Propiriedades de Botões com SVG dentro*/
                .BtnNota button  {gap: 5px; padding: 0px 8px !important;}
                .BtnNota button a{width: 15px; height: 15px; fill: white}
            </style>
            <div class="BtnNota w100 Ct">
                <button  class="Ct"     onclick="SavePDF2($('#NOTA'),'Nota')"   >PDF <a onload="Inn(this,SVVG.PDFs)"></a></button>
                <button  class="Ct"     onclick="CopyTagImg(this,$('#NOTA'),2)">Print<a onload="Inn(this,SVVG.Prnt)"></a></button>
                <!--<button  class="Ct"     onclick="CopyNotaTxt()"                >Texto<a onload="Inn(this,SVVG.Copy)"></a></button>-->
                <button  class="BtnRed" onclick="SairMdal()"                   >Sair</button>
            </div>
            
        </div>
    </div>
</body>

<script> //CRUD das Tabelas com SupaBase ⭐⭐⭐_ _ PASSAR tudo ISSO pra o SB_Crud.js
        const orArr=(e,fallback=[])=>isArr(e) ? e : fallback
        const IdMaior=(arr)=>Math.max(...arr.map(o=>+o.Id.split('_')[1]))+1   

        function AddRowBdj(Eu,_P){ // ⭐⭐⭐⭐_ (Ta bem BOA!)
            const P = d_r(_P) ; const COL = AA(P.Cl)
            if(P.Tm=='Bndj'){
                const Pj   = JJ[P.Ty][P.Id]         // Localizar Linha pelo 'Id'
                const arr = orArr(Pj[P.Cl])         // se n for um array, return []
                const lngh= l0(arr)                 // conferir se é a Primeira vez!
                const Def = Deff[COL]               // Cria um Default Baseado na bndj
                const NId = lngh ? 1 : IdMaior(arr) // fazer isso só que procurando o Valor maior e não com Lenth
                Def.Id    = `${Pj.Id}_${NId}`       // Novo Id
                Def.Clnt  = Pj.Clnt                 // Clona Cliente
                if(P.Cl=='Serv'){Def.Data = Pj.Data}// Clona Data só pra Serv
                const _R = [COL,Def.Id,'Col',Def]
                /*Obj*/ arr.push(Def) // isso era pra usar DarJJ() pra tbm adicionar push em (SERV ou PGMT) mas n sei usar DarJJ('Add')
                /*DOM*/ lngh ? Inn(_td(Eu),Tm_Bndj(_P,'','DOM')) : Befor($('table tbody',_td(Eu)),Tm_Table(COL,[Def],_P))
                /*Sub*/ Sb_EDIT(supaBASE,P.Ty,P.Id,P.Cl,arr)
            }
        }

        function EditCell(e,Mod,vall=null,Auto,SB){ // ⭐⭐⭐⭐⭐✔️ (Muito Boa!) // e:Celula | Mod:'Edit/Add,Del' |  Val: Valor | Auto: veio Automatica | SB: tem SupaBase       
            const V  = vall==""?"":vall||VAL(e) ; if(V==Nm(e)/* || Nm(e)=='False'*/){return} // não foi Aterado || é uma img (esse False precisa sair, Pois se for uma imagem deve receber aqui seu SRC)
            const R  = d_r(e) ; let _R = R ? [R.Ty,R.Id,R.Cl,V]:null ; //LOG(Nyme[R.Bj][R.Sc])
            const P  = d_p(e) ; let _P = P ? [P.Ty,P.Id,P.Cl  ]:null
            const tR = _tr(Pai(_tr(e)))

            /*OBJ*/ DarJJ(Mod,..._R,R.Sc?_P:null)
            const ObjSec = P ? JJ[P.Ty][P.Id][P.Cl] : null // Dar o Objeto (Principal ou Bndj) se For Secundário adiciona o _P do Pai e depois Colata ele em 'ObjSec'            
            /*SUB*/ SB==null ? Sb_EDIT(supaBASE,...(R.Sc?[..._P,ObjSec]:_R)) : LOG('sem SB')
            /*DOM*/ $$(Rx7(..._R.slice(0,-1))).forEach(PP=>{
                const tr  = _tr(PP)
                const TD  = _td(Pai(PP))
                const T_T = TD && $('.T-T',TD)
                /*Del*/ if(Mod =='Del'){
                    tr.remove()
                    if(R.Bj && T_T && P && !Auto){InM(T_T,FazerTitle(P.Cl,ObjSec)) ; RFresh(P.Ty,tR,Auto,e)}
                /*Edt/Add*/}else{
                    DarVAL(PP,V)
                    if(!Auto){if(R.Bj && T_T){
                            if(R.Sc){InM(T_T,FazerTitle(P.Cl,ObjSec)) ; RFresh(P.Ty,tR,Auto,e)}
                        }else{RFresh(R.Ty,tr,Auto,e)}
                    }
                }
            })
        }

</script>

<script> // SupaBASE
    const getSBPromise = SB_Get(supaBASE,['USER','PDDS','CLNT','MPAG','GRAD','UBER','OOSS','ARTE','GRD2','IMGS'])
    
    function PosGET(){
        const INN = performance.now()
        TestSenha('Storg',StogeGet('Pass'))
        Listagem('CLNT','Clnt')
        Tratamento()    
        LOG(`✅ Pre-Trat OK: ${MS(INN)}`)
    }

    function Supa_RealTime(crud,nEw,Typ,old){ // ⭐⭐⭐_ _ (Adicionar e Remover Linha da Bandeija)
        if(crud==='UPDATE'){
            const NOVOO = NULL__([nEw])[0]
            const atual = JJ[Typ][nEw.Id]
            const Limparr = j => j ? Object.keys(j).length ? Object.fromEntries(Object.entries(j).filter(([k,v])=>BS[Typ][k]?.[1]!=='A')) : null : null
            const DiF = Limparr(Diferentes(NOVOO,atual,Typ))
            if(!DiF || (Object.keys(DiF).length == 1 && 'Id' in DiF)){LOG(`🌐 EDIT RealTime(${Typ},${nEw.Id}) OK👍`) ; return}
            function KeysSemId(obj){return Object.keys(obj).filter(k => k !== 'Id')}

            KeysSemId(DiF).forEach(Cl=>{
                LOG(`${Typ}-${nEw.Id}-${Cl}`,`${AA(Cl)}-`,DiF)
            })

            //EditCell(,'SB')

            /*Obj*/ ObjEtr(DiF).forEach(([col,Vlr])=>{if(col!=='Id'){atual[col]=NOVOO[col]}})// Atualiza a Const primeiro
            /*Obj*/ // falta atualziar o JJ[Typ]
            /*DOM*/ flatenObject(DiF,Typ).forEach(([TYP,ID,col,Vlr])=>{
                $$(Rx2([`${AA(TYP)}-${ID}-${col}`])).forEach(td=>{
                    if(col=='Clnt'){return}
                    if(col=='Lixo'){if(Vlr){_tr(td).remove() ; return}else{return}}
                    
                    if(td){if(VAL(td)!==Vlr){
                        if(D_R(td).Tm=='Auto'){return}  // a idéia é n precisar disso aqui pois isso só ta afetando a tabela de GRAD
                        if(D_R(td).Tm=='Sync'){return}
                        DarVAL(td,Vlr) // Editou valor
                         LOG(`✏️ RealTime() "${TYP}-${ID}-${col}" >> ${Vlr}`)} // chamar R_Color()
                    else{LOG('⚠️ RealTime() P-P ja Tava Igual')}}
                    else{LOG('⚠️ RealTime() P-P não Existe')}
                })
            })
        }
        else if(crud==='DELETE'){
            if(!J[Typ].some(e=>e.Id==old.Id)){LOG(`🌐 DELETE RealTime(${Typ},${old.Id}) OK👍`) ; return}
            RmvROW($(`${Rx2([Typ,old.Id,'Lixo'])} a`),true) //Simular o Click, true veio do SB 🌐
        }
        else if(crud==='INSERT'){
            if(J[Typ].some(e=>e.Id==nEw.Id)){LOG(`🌐 INSERT RealTime(${Typ },${nEw.Id}) OK👍`) ; return}
            AddROW(Typ,'<',NULL__([nEw]),'SB') // esse vazio é um input q fica em outra coisa relacionada a cliente, true veio do SB 🌐
        }
    }
    
    function PlayRealTime(){
        return supaBASE.channel('SuBs-CLNT').on('postgres_changes',{event:'*',schema:'public',table:'*'},e=>{
            const [crud,nEw,old,Typ] = [e.eventType,e.new,e.old,e.table] ; Supa_RealTime(crud,nEw,Typ,old)}).subscribe()
    };PlayRealTime()

    function SaveConfig(e){LOG('Salva Config no SB')}
</script>

<script>// Iniciação 
    function PosGet(){Onloads('body');Check_W_Pag();LOG('✅ Página Carregada!')}  ;PosGet()

    document.addEventListener('click',e=>{const targ = e.target
        Rmv($$('#ORC tr.Atv'),'Atv') // Remover todos Ativos
        if($('#ORC').contains(targ)){ATV(_tr(targ));ReloadDetalhes(_tr(targ))}
        if(targ.closest('.Sugg')){return}{Add_N($$('#ORC tr:not(.Atv) .Sugg'))} // LINDO TREXO é uma Gambiarra mais ta BOM (Fazer a Cascata igual Bureal Usando este metodo aqui!)
        // isso Deve virar Padão tipo algo genético, pra usar em varios
        // esta serve só pra ativar u desativar tr q estão dentro da tabela de ORC
    })
    document.addEventListener('DOMContentLoaded', function(){ // Função do Esc
        document.addEventListener('keydown',function(event){
            if(event.key==='Escape'){
                if(EShow($('#FModal'))){return}
                else{$$(`#Pag_${Atual.Pag} .BNdj, #Pag_${Atual.Pag} .BNfot`).forEach(e=>Add_N(e))}
            }// F_Clen(Atual.Pag) // se for outro botão
    })})
    GetPC()
</script>

<script> // comentários ⏳ ❌ ✔️ ⚠️ 🔝 ⚡ 💡
    // ERROS pra corrigir
    // Pesquisa em tabela de GRAD, da erro em VAL(...).trim is not a function
    // na Soma lá em baixo dar o . quando passar de mil
    // Adicionar o DROP, e no Drop CnltrV de imagem,
    // como impedir q a página dê zoom, pelo celular
    // Melhorar CSS de Login, e Atualziar a Página ao Logar
    // Criar uma Página de Cadastro
    // Criar a Interface de Cliente
    // Trabalhar em todos os Input Files daqui -- (type="file")


    // Sincronizar os PIX
    // Adicionar RR como Barraca
    // Descobrir pq o CSS ta feioso na hora de botar vários Itens na BNDJ
    // Criar uma Nova Tabela pra Finanças que são os Resultados dos Meses Todos
    // Melhorar a Página do Designer que fica aqui dentro mesmo
</script>

</html>
<!DOCTYPE html>
<html lang='pt-BR'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orcamento</title>

    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/fontes.css"        rel="stylesheet">
    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/CSSBiblioteca.css" rel="stylesheet">
    <script src="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/PreScript.js"      ></script>
    <script src="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/Templates.js"      ></script>
    <!--
        <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/fontes.css"        rel="stylesheet">
        <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/CSSBiblioteca.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/PreScript.js"      ></script>
        <script src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/Templates.js"      ></script>

        <link  href="../MyBiblioteca/fontes.css"        rel="stylesheet">
        <link  href="../MyBiblioteca/CSSBiblioteca.css" rel="stylesheet">
        <script src="../MyBiblioteca/PreScript.js"      ></script>
        <script src="../MyBiblioteca/Templates.js"      ></script>
    --> 

    <link  href="./_CssGRAFF.css" rel="stylesheet">
    <script src="./_BaseGRAFF.js"></script>
    <script src="./_BiblGRAFF.js"></script>
    
        <script src="./JSON/DadosPDDS.js"></script>
        <script src="./JSON/DadosGRAD.js"></script>
        <script src="./JSON/DadosMPAG.js"></script>
        <script src="./JSON/DadosCLNT.js"></script>
</head>

<script> // Base de Dados
    const Edi   = 'contenteditable="true"'
    const Err   = `onerror="this.src='./SVG/placeholder.svg'"`
    const Link  = 'http://localhost:3000'
    const LimitLin = 10
    const Atual = {Pag:'#Pag_GBRT'}
    const Navv  = ['Pedidos','Servicos','Pagamentos','Grades','MPago','Clientes']
    const N_Brev={HOME:'Principal',ORC:'Or√ßamento',LOJA:'Loja',GBRT:'Gabaritos',BBTC:'Biblioteca',LIN:'',PDDS:'Pedidos',SERV:'Servi√ßos',PGMT:'Pagamentos',GRAD:'DashBoard',CLNT:'Cliente',CONF:'Configura√ß√µes'}
    const NavImg= ['HOME','LIN','ORC','LOJA','GBRT','BBTC','LIN','PDDS','SERV','LIN','PGMT','GRAD','CLNT','LIN','CONF']
    const PreTable={PDDS:'',SERV:'',PGMT:'',GRAD:'',CLNT:''}
    let scrollPosition = [0,0]
    const D_brev={Tipo:'Tipo',Serv:'Servi√ßo',Lrg:'Largura',Alt:'Altura',Cmp:'Comprimento',Cbmt:'Acabamento',Gram:'Gramatura',Qnt:'QNT',Und:'Valor UND',SbTt:'SubTotal'}
    const Prod = { // Adicionar pra todos eles a propor√ß√£o do Desconto pela quantidade // adicionar tamb√©m o comporta das cores
        'Adesivo'  :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Adesivo Impresso'     , Forn:['Grafit','BPrint','Tatiane'  ] , Prdc:['Arte','Refile',{'Aplica√ß√£o':10}            ] , Extra:[            ] , HotKey:["colar", "adesivar", "autocolante"       ] ,
                        Variantes:{
                            'Brilho'          :{item:'1',Grad:'Ads(Blh)',Tipo:'',Valr:60 ,Cust:20},
                            'Fosco'           :{item:'2',Grad:'Ads(Fos)',Tipo:'',Valr:60 ,Cust:20},
                            'Blackout'        :{item:'3',Grad:'Ads(Blk)',Tipo:'',Valr:70 ,Cust:25},
                            'Transparente'    :{item:'4',Grad:'Ads(Trp)',Tipo:'',Valr:70 ,Cust:25},
                            'Laminado'        :{item:'6',Grad:'Ads(Blh)',Tipo:'',Valr:70 ,Cust:20},
                            'Espelhado'       :{item:'7',Grad:'Ads(Trp)',Tipo:'',Valr:80 ,Cust:20},
                            'Perfurado'       :{item:'5',Grad:'Ads(Prf)',Tipo:'',Valr:100,Cust:35},
            }},
        'Etiqueta' :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Impress√£o + Recorte'  , Forn:['Grafit','BPrint','Tatiane'  ] , Prdc:['Arte','Recorte'                            ] , Extra:[            ] , HotKey:["r√≥tulo", "identifica√ß√£o", "label", "tag"] ,
                        Variantes:{
                            'Refilada'        :{item:'6',Grad:'Ads(Blh)',Tipo:'',Valr:70 ,Cust:20},
                            'Redonda'         :{item:'7',Grad:'Ads(Rct)',Tipo:'',Valr:75 ,Cust:30},
                            'Personalizada'   :{item:'7',Grad:'Ads(Rct)',Tipo:'',Valr:80 ,Cust:30},
            }},
        'Lona'     :{Calc:'M2' , Stts:'Disp' , Prvw:''        , Desc:'Banner, Faixa, ilh√≥s' , Forn:['Grafit','BPrint','Tatiane'  ] , Prdc:['Arte'                                      ] , Extra:[            ] , HotKey:["painel"                                 ] ,
                        Variantes:{
                            'Banner'          :{item:'8' ,Grad:'Lon(Bnn)',Tipo:''                              ,Valr:70,Cust:22 , Limit:['0,00 x 1,20'] , Mdds:['0,50 x 0,70' , '0,80 x 1,20' , '2,00 x 1,00']}, 
                            'Faixa'           :{item:'9' ,Grad:'Lon(Fax)',Tipo:['S√≥ Madeira','Madeira e ilh√≥s'],Valr:70,Cust:22 , Limit:['0,00 x 1,20'] , Mdds:['2,00 x 0,50']}, 
                            'com ilh√≥s'       :{item:'11',Grad:'Lon(Ilh)',Tipo:['Completo'  ,     'nas Pontas'],Valr:70,Cust:22 , Limit:['0,00 x 3,20'] , Mdds:['1,00 x 1,00']},
                            'Sem Acabamento'  :{item:'13',Grad:'Lon(Sem)',Tipo:''                              ,Valr:60,Cust:20 , Limit:['0,00 x 3,20'] , Mdds:[]},
            }},
        'Quadro'   :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Quadro sem Moldura'   , Forn:['Grafit','BPrint','Tatiane'  ] , Prdc:['Arte','Aplica√ß√£o',{'Lamina√ß√£o':10},'Reflie'] , Extra:['PVC','Fita'] , HotKey:["moldura", "p√¥ster", "cartaz"            ] ,
                        Variantes:{  
                            'PS 1mm'          :{item:'17',Grad:'Ads(Blh)',Tipo:'',Valr:100,Cust:21.25 + 20, Limit:['2,00 x 1,00'] , Mdds:['0,30 x 0,20']}, // Folha de PVC com (2,00 x 1,00) R$ 42,50
                            'PS 2mm'          :{item:'18',Grad:'Ads(Blh)',Tipo:'',Valr:130,Cust:'        ', Limit:['2,00 x 1,00'] , Mdds:['0,30 x 0,20']},  
                            'PVC 2mm'         :{item:'14',Grad:'Ads(Blh)',Tipo:'',Valr:150,Cust:'        ', Limit:['2,44 x 1,22'] , Mdds:['0,30 x 0,20']},
                            'PVC 3mm'         :{item:'15',Grad:'Ads(Blh)',Tipo:'',Valr:170,Cust:43.00 + 20, Limit:['2,44 x 1,22'] , Mdds:['0,30 x 0,20']}, // Folha de PVC com (2,44 x 1,22) R$ 86,00
                            'PVC 5mm'         :{item:'16',Grad:'Ads(Blh)',Tipo:'',Valr:' ',Cust:'        ', Limit:['2,44 x 1,22'] , Mdds:['0,30 x 0,20']},
            }},
        '√≠m√£'      :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Geladeira ou Carro'   , Forn:['Grafit','BPrint','Tatiane'  ] , Prdc:['Arte','Aplica√ß√£o','Reflie'                 ] , Extra:['Manta'     ] , HotKey:["magneto", 'manta magn√©tica'             ] ,
                        Variantes:{ // Adicional de Calend√°rio (Acima de 500 UND)
                            '0.3 - Geladeira' :{item:'19',Grad:'Ads(Blh)',Tipo:'',Valr: 70.00+60,Cust:35.00 , Limit:['0,00 x 0,60'] , Mdds:['0,05 x 0,06']}, // 0.3 - R$ 21,00 (0,60 x 1,00) || o Metro fica: 
                            '0.4 - Geladeira' :{item:'20',Grad:'Ads(Blh)',Tipo:'',Valr: 95.00+60,Cust:48.33 , Limit:['0,00 x 0,60'] , Mdds:['0,05 x 0,06']}, // 0.4 - R$ 29,00 (0,60 x 1,00) || o Metro fica: 
                            '0.8 - Carro'     :{item:'21',Grad:'Ads(Blh)',Tipo:'',Valr:180.00+60,Cust:98.33 , Limit:['0,00 x 0,60'] , Mdds:['0,60 x 0,30']}, // 0.8 - R$ 59,00 (0,60 x 1,00) || o Metro fica: 
            }},
        'Recorte'  :{Calc:'M2' , Stts:'Offf' , Prvw:'CanvMdd' , Desc:'Adesivo Recortado'    , Forn:['Stock'                      ] , Prdc:['Arte','Aplica√ß√£o','Reflie'                 ] , Extra:[            ] , HotKey:["Ploter",'Lamina','Siluet','Vetor'       ] ,
                        Variantes:{
                            'Vinil'           :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Holografico'     :{item:'23',Calc:'M2',Tipo:'',Valr:200,Valor:100 , Limit:[] , Mdds:[]},
        }},
        'Trofeu'   :{Calc:'M2' , Stts:'Disp' , Prvw:''        , Desc:'Acrilico Cristal de 2mm' , Forn:['Stock','Barraca'            ] , Prdc:['Arte'                                      ] , Extra:['Acrilico'  ] , HotKey:['acrilico'                               ] ,
                        Variantes:{
                            'Virado'          :{Grad:'Ads(Trp)',Valr:60+30+180+100+17, Cust:20+15+90+60}, // Adesivo, Vinil, Acrilico, Corte (ultimos 15 √© estouro)
                            'Colado'          :{Grad:'Ads(Trp)',Valr:60+30+180+100+35, Cust:20+15+90+60}, // Adesivo, Vinil, Acrilico, Corte (ultimos 15 √© estouro)
        }},
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        'Cart√£o'   :{Calc:'OFS', Stts:'Disp' , Prvw:''        , Desc:'Medida: 9cm x 5cn'    , Forn:['BPrint','Bureal'] , Prdc:[] , Extra:[] , HotKey:["cart√£o de visita", "business card", "papel", "folha"] , 
                        Variantes:{
                'Brilho'      :{Table:[
                    ['Frente' ,'250g',[['500', 90,31],['1.000',135,45]]],
                    ['F.Verso','250g',[['500',115,42],['1.000',150,54]]], 
                    ['Frente' ,'300g',[['500',130,49],['1.000',145,56]]], 
                    ['F.Verso','300g',[['500',150,58],['1.000',165,65]]], ]},
                'Brilho Local':{Table:[
                    ['Frente' ,'300g',[['500',155,62],['1.000',190,78]]],
                    ['F.Verso','300g',[['500',190,80],['1.000',230,99]]], ]},
            }},
        'Panfleto' :{Calc:'OFS', Stts:'Disp' , Prvw:''        , Desc:'Gramatura: 90g'       , Forn:['Bureal'         ] , Prdc:[] , Extra:[] , HotKey:["folheto", "papel", "informativo",'folha'] , 
                        Variantes:{
                '10 x 15':{Table:[
                    ['Frente' ,'90g',[['1.000',130, 67],['2.500',180, 85],['5.000' , 270,170],['10.000',650,340]]],
                    ['F.Verso','90g',[['2.500',280,135],['5.000',320,220],['10.000', 720,392]]], ]},
                '15 x 20':{Table:[
                    ['Frente' ,'90g',[['1.000',270,127],['2.500',340,170],['5.000' , 650,340],['10.000',900,600]]],
                    ['F.Verso','90g',[['2.500',500,270],['5.000',700,440],['10.000',1200,800]]], ]},
            }},
        'Tal√£o'    :{Calc:'OFS', Stts:'Disp' , Prvw:''        , Desc:'Gramatura: 90g'       , Forn:['JLTal']           , Prdc:[] , Extra:[] , HotKey:[] , 
                        Variantes:{
                '10 x 15':{Table:[
                    ['Preto e Branco','1 Via',[['4',60,30],['8', 90,45],['12',130,65],['20',170, 85]]],
                    ['Colorido'      ,'1 Via',[['4',80,40],['8',110,55],['12',150,75],['20',200,100]]],
                    ['Preto e Branco','2 Via',[['4',75,35],['8',105,55],['12',145,70],['20',185, 80]]],
                    ['Colorido'      ,'2 Via',[['4',95,45],['8',125,65],['12',165,85],['20',215,110]]],
                ]},
                '15 x 20':{Table:[
                    ['Preto e Branco','1 Via',[['2',60,30],['4', 90,45],['10',170, 85],['20',300,150]]],
                    ['Colorido'      ,'1 Via',[['2',80,40],['4',110,55],['10',200,100],['20',350,175]]],
                    ['Preto e Branco','2 Via',[['2',75,35],['4',105,55],['10',185, 90],['20',315,165]]],
                    ['Colorido'      ,'2 Via',[['2',95,45],['4',125,65],['10',215,110],['20',365,195]]],
                ]},
                '9 x 21' :{Table:[
                    ['Preto e Branco','1 Via',[['3',60,30],['6', 90,45],['9',130,65],['12',150,75]]],
                    ['Colorido'      ,'1 Via',[['3',80,40],['6',110,55],['9',170,85],['12',190,95]]],
                    ['Preto e Branco','2 Via',[['3',75,35],['6',105,55],['9',145,70],['12',165, 80]]],
                    ['Colorido'      ,'2 Via',[['3',95,45],['6',125,65],['9',185,85],['12',205,100]]],
                ]},
        }},
        'Tag'      :{Calc:'OFS', Stts:'Offf' , Prvw:''        , Desc:'Gramatura: 90g'       , Forn:['Bureal'         ] , Prdc:[] , Extra:[] , HotKey:["etiqueta", "r√≥tulo", "marcador",'furo'  ] , 
                        Variantes:{
                    'Reto' :{},
                    'Curva':{},
            }},
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        'Card√°pio' :{Calc:'OFS', Stts:'Offf' , Prvw:''        , Desc:'Gramatura: 90g'       , Forn:['BPrint']          , Prdc:[] , Extra:[] , HotKey:["menu", "lista de pratos", "menu de restaurante", "op√ß√µes de comida", "restaurante", "cozinha"] ,
                        Variantes:{
                    '1Pag':{},
                    '2pag':{},
        }},
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        'Camisa'   :{Calc:'QNT', Stts:'Offf' , Prvw:''        , Desc:'Sublima√ß√£o Total'     , Forn:['Inov√°']   , Prdc:[] , Extra:[           ] , HotKey:["blusa", "camiseta", "roupa", "estampa", "moda", "vestu√°rio","Pano","Tecido"] ,
                        Variantes:{
            'M.Curta'  :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['Helanquinha','Dry Furado'],Valor:0,},
            Regata     :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['Helanquinha','Dry Furado'],Valor:0,},
            Polo       :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['                        '],Valor:0,},
            'M.Longa'  :{Tipo:'',Tamn:['PP','P','M','G','GG'],Valr:['Helanquinha','Dry Furado'],Valor:0,},
        }},
        'Cal√ß√£o'   :{Calc:'QNT', Stts:'Offf' , Prvw:''        , Desc:'Sublima√ß√£o Total'     , Forn:['Inov√°']   , Prdc:[] , Extra:[           ] , HotKey:['Short','Sublima√ß√£o','roupa','pano'] ,
                        Variantes:{
                'Bermuda' :{},
                'Short'   :{},
        }},  
        'WindFlag' :{Calc:'QNT', Stts:'Offf' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['NovaImp'] , Prdc:[] , Extra:[{'Base':80}] , HotKey:['Sublima√ß√£o',"Pano","Tecido",'BigFlag','WindBanner','Bandeira do Vento'] ,
                        Variantes:{
            Faca         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            Vela         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            Pena         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            Gota         :{Tipo:['P','M','G'],Valr:0,Cust:0},
            }},
        'BigBall'  :{Calc:'QNT', Stts:'Offf' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['NovaImp'] , Prdc:[] , Extra:[{'Base':80}] , HotKey:['Sublima√ß√£o',"Pano","Tecido"] ,
                        Variantes:{
                P         :{Tipo:[''],Valr:0,Cust:0},
                M         :{Tipo:[''],Valr:0,Cust:0},
                G         :{Tipo:[''],Valr:0,Cust:0},
            }},   
        'Bandeira' :{Calc:'QNT', Stts:'Offf' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['Inov√°']   , Prdc:[] , Extra:[           ] , HotKey:['Sublima√ß√£o',"Pano","Tecido"] ,
                        Variantes:{
                'Oxford' :{},
                'Cettin' :{},
        }},    
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        'Arte'           :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Arte']      ,
        Variantes:{
                    'Arte' :{}}
        },
        'Router'         :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Barraca','Jailson']      ,
        Variantes:{
                    'Router' :{}}
        },
        'Envelopamento'  :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Stock']      ,
        Variantes:{
                    'Plotagem' :{}}
        },
        'Serigrafia'     :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Stock']      ,
        Variantes:{
                    'Serigrafia' :{}}
        },
        'Figurinha'      :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Stock']      ,
            Variantes:{
                    'Figurinha' :{}}
        },
        'Topo de Bolo'   :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['BPrint']      ,
            Variantes:{
                    'Topo de Bolo' :{}}
        },
        'Vendas'         :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Stock']      ,
        Variantes:{
                    'Vendas' :{}}
        },
        'Placa'          :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['-']      ,
        Variantes:{
                    'Placa' :{}}
        },
        'Cartela'        :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Stock']      ,
        Variantes:{
                    'Cartela' :{}}
        },
        'Plotagem'       :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['Stock']      ,
        Variantes:{
                    'Plotagem' :{}}
        },
        'Sinaliza√ß√£o'          :{Calc:'UND', Stts:'Offf' , Prvw:'' , Forn:['-']      ,
        Variantes:{
                    'Sinaliza√ß√£o' :{}}
        }
        }
   
    // Const Importante pra Compilar a Tabela pra deixa o Load Mais R√°pido
    const EtrProd = ObjEtr(Prod)
    const AllProd = ObjKey(Prod)
    const HotKy   = Object.fromEntries(EtrProd.map(([k,v])=>[k,v.HotKey||[]]))
    const AllForn = Object.fromEntries(EtrProd.map(([k,v])=>[k,v.Forn  ||[]]))
    const Vari=e=>ObjKey(Prod[e].Variantes)

    const O = {
        Forn:['','Grafit','BPrint','Tatiane','Inov√°','Bureal','Stock','Arte','JLTal','Varyus','NovaImp','Barraca','Jailson','-'], // 'WM SilkSing','Casas leo'
        Serv:['','Adesivo','Banner','...'],
        Dsng:['','Allan','Baby','Fexta','Italo','Eurik','Canva','Ja Tinha','n tem',''],
        Form:['','Pix','Av','Card'],
        Pgmt:['','Pix','Av','Card'],
        Dstn:['','Serv1','Serv2'],
        Stts:['','Devendo','Entregue','JaFeito','Produ√ß√£o'],
        Tipo:['',...Uniq(AllProd.flatMap(e=>Vari(e)))],
        Cams:['','PP (Inf)','P (Inf)','M (Inf)','G (Inf)','PP','P','M','G','GG','XG','XXG']
    }
    const AllList = ObjKey(O)
    const AllClnt = Uniq(J.CLNT.map(E=>E['Clnt']))
    const D = {PDDS:0,SERV:0,CLNT:0,PGMT:0,GRAD:0,OOSS:0,UBER:0,MPAG:0,CUST:0}
        
    const CRYPP = {F:'Fixo',B:'Bndj',S:'Slct',A:'Auto',C:'Chek',G:'Sugg',M:'Imgs',E:'Edit',T:'Grds',V:'Valr',D:'Data',O:'Soma',X:'Lixo'}
    const CRYCLS = {A:'AutoComp',I:'CorID'}
    const BS = { // ['1¬∫ √© Forma de Carregar', '2¬∫ s√£o as Classes CSS
        PDDS:{Id:['F','I'], Lin:['E','' ],Data:['D','' ],Clnt:['B',''],Serv:['B',''],Valr:['O','A'],Pgmt:['B','' ],Cust:['B',''],Finc:['E','A'],Stts:['S','A'],Lixo:['X','']},
        SERV:{Id:['F','I'],Data:['D','A'],Clnt:['B','A'],Serv:['S',''],Tipo:['S',''],Desc:['E','']/*,Calc:['E','' ]*/,Valr:['V','A'],Dsng:['S',''],Arte:['M','' ],Forn:['S','A'],OK:  ['C',''],Entg:['C',''],Detg:['E',''],Grad:['E',''],Gimg:['M','A'],Abcd:['E','A'],OS:['E','A'],Uber:['E','A'],Cmnt:['E',''],SStts:['E','A'],Lixo:['X','']},
        PGMT:{Id:['F','I'],Data:['D','' ],Clnt:['B','' ],Valr:['V',''],Form:['S',''],Desc:['E','' ],Stts:['E','' ],Link:['E',''],Mpag:['G','' ],Lixo:['X','' ]},
        CUST:{Id:['F','I'],Data:['D','' ],Item:['E','' ],Valr:['V',''],Forn:['S',''],Dstn:['E','' ],Pcnt:['A','' ],Lixo:['X','']},
        FINC:{Valr:['F',''],Cust:['F',''],Lcro:['F','']},

        CLNT:{Id:['F','I'],Clnt:['E','' ],Cmpt:['E',''],Cntt:['E','' ],Lcal:['E','' ],Loja:['E',''],CtLj:['E','' ],Cat: ['E',''],Stts:['E',''],Link: ['E',''],Lixo:['X','']},
        GRAD:{Id:['F','I'],Data:['D','A'],Emal:['E',''],Forn:['S','A'],Grad:['M','A'],OS  :['E',''],Cont:['E','A'],ABCD:['B',''],Stts:['E',''],Lixo:['X','']},
        ABCD:{Id:['E','I'],Nome:['E','' ],Desc:['E',''],QntS:['E','A'],Valr:['V','A'],Uber:['E',''],VUbr:['V','A'],Link:['E',''],AsStts:['E','A']},
        UBER:{Id:['F','I'],Data:['D','' ],Dest:['E',''],Hora:['E','' ],Valr:['E','' ],Dirc:['E',''],Prds:['E','' ],Desc:['E',''],Grad:['E',''],Link: ['G',''],Lixo:['X','']},
        MPAG:{Id:['F','I'],Data:['D','' ],Clnt:['E',''],Valr:['E','' ],Hora:['E','' ],Form:['E',''],Mpag:['E','' ],Link:['G',''],Lixo:['X','']}, // Removi 'Cpvt'
        
        OOSS:{Id:['F','I'],Nome:['E',''],Link:['E',''],Desc:['E',''],Lixo:['X','']},
        CALC:{}
    }

    const ListaFora = ['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo de Bolo','Vendas','Placa','Sinaliza√ß√£o','Cartela','Plotagem']
    const ListaKits=['Zebu','Zimaz']
    let todoTitle = {Serv:[],Cust:[],Finc:[],Soma:[],Calc:[]}
</script>

<script> // Bibliotecas Curta
    const Dat=e=>new Date(e)
    const OjKy=Typ=>ObjKey(BS[Typ])
    const ExtObj=Obj=>[0,1,2].map(i=>ObjVal(Obj).map(arr=>arr[i]))
    const TogTd=e=>$('input',e)!==event.target && TogNoSh([$('input', e),$('p',e)])
    const ALERT=e=>{Inn('#ALERT span',JSON.parse(e).Dados.map(e=>`<div style="margin:3px">"${e}"</div>`).join(''));ShowTime('#ALERT',3)}
    const RgxPixAV=e=>e.trim().match(/(\d+[\.,]?\d*)([a-zA-Z]+)/) || []
    const SunPix=Stg=>Stg.split('|').map(p=>parseFloat(p.replace(/[^\d.,]/g,'').replace(',','.'))||0).reduce((sum,n)=>sum+n,0)
    const BSBS=(typ,x,idx)=>BS[typ][OjKy(typ)[x]][idx]
    function EnterBlur(e){KeyEntr(()=>e.blur())}
    const Block=e=>e.style.display = 'block'
    const ConvertDATA=e=>/^\d{4}-\d{2}-\d{2}$/.test(e)?DMY(e):e
    const H_Col_p=(Typ,col)=>`#H_${Typ} > tbody > tr > ${Col(Typ,col)} p`
    const reorderArr_Arr = (arr,o)=>arr.map(e=>o.map(k=>e[arr[0].indexOf(k)]))
    const ContRepete=arr=>arr.reduce((acc,e)=>{acc[e]=(acc[e] || 0) + 1 ; return acc},{}) // conta quantas vezes um nome se repete num Array
    const getClass=(e,Stg)=>[...e.classList].find(c=>c.includes(Stg)) || null
    const tr_ID=tr=>getClass(tr,'tr-').split('-')[1]
    const tr_X =tr=>getClass(tr,'tr-').split('-')[2]
    const minuscule = str => str[0].toUpperCase() + str.slice(1).toLowerCase()
    const LocPcnt = (parte,total) => (parte / total)
    const RGBa=(e,op=0.2)=>{const [r,g,b]=getComputedStyle(e).backgroundColor.match(/\d+/g) ; e.style.backgroundColor = `rgba(${r},${g},${b},${op})`}
    const zipObj=(arr1,arr2)=>Object.fromEntries(arr1.map((k,i)=>[k,arr2[i]]))
    const EscpRgx=Stg=>Stg.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
    function isImageLoaded(img){return img.complete && img.naturalWidth !== 0}
    const daClass=R=>BS[R[1]][R[3]][1].split('').map(e=>CRYCLS[e]).join(' ')
    const RandoCor=()=>'#'+Rndn(16777215).toString(16).padStart(6,'0')
    const isBdj=e=> !!e.closest('.BndjTBL')
    const isArr=e=>Array.isArray(e)

    const ATV=e=>Add($(e),'Atv')
    const DTV=e=>Rmv($(e),'Atv')
    const TOV=e=>Tog($(e),'Atv') // Modificar todos os Tog:Atv pra mudar pra TOV

    // Gets
        const Rx2=arry=>Rx(['Rastr',...arry])
        const Coll=(x)=>`td:nth-child(${x})`
        const Col=(Typ,col)=>`td:nth-child(${FIdx(OjKy(Typ),col)+1})`
        const Colls=(Typ,col,n=null)=>$$(`#H_${Typ} > tbody > tr${n?':not([class*=" n"])':''} > ${Col(Typ,col)} > div > .P-P`)
        const D_Rastr=e=>Extrat_Clss(e,'Rastr-').split('-') // Simplificar pra D_R e incluir closeset aqui dentro mesmo, caso precise.
        const D_Rastr2=R=>R.split('-')
        const TRs=(Typ)=>$$(`#H_${Typ} > tbody > tr`)
        const TH=(Typ,col)=>$(`#H_${Typ} > thead > tr ${Col(Typ,col).replace('td:','th:')}`)

    //Evento de Click na P√°gina inteira, com a inten√ß√£o de Ocultar tudo que for Bandeijas
        function NoneBndj(){if(event.target.closest('.bndj')||event.target.classList.contains('NObj')){return}else{None($$('.bndj'))}}
        const Trc2=(e,add,rmv)=>{Add($(e),add);Rmv($(e),rmv)}
        const DarkLite2=(e,Check)=>{if(Check){Trc2(e,'Dark','Lite')}else{Trc2(e,'Lite','Dark')} ; console.log('Chamou DarkLite',e,Check)}
    // Drags
        function Prvn(){event.preventDefault()}
        function Drag(){event.dataTransfer.setData("text",event.target.id)}
        function Drag2(){event.dataTransfer.setData("text",Pai(event.target).id)}
        function Drop(){Prvn();event.target.appendChild($(`#${event.dataTransfer.getData("text")}`))}
</script>

<div> <!--JS e CSS das Tabelas-->
    <style> /*CSS das Tabelas*/
        .BNdj{transform:translate(-50%,0%); left:50%; z-index:500 ; background: white;}
        .BNdj > a{position:absolute; bottom:100%; left:50%; transform:translate(-50%,0%) ; height:10px; z-index:1}

        .BndjSUG{padding:0px ; min-width: 200px}
        .BndjSUG > a{fill:#ff00c8}    
        .BndjSUG > i{background:#ff00c8; color:white; z-index:2 ; padding: 5px}

        .BndjTBL{padding:5px; background:#bb0092}
        .BndjTBL > a{fill:#bb0092}

        .ThFilt > i{position:absolute; cursor:pointer; font-size:9px; right:0px; top:50%; transform:translate(-0%,-50%)}
        .ThFilt > b.Atv{position:absolute; background:#0c8f00; border-radius:255px; width:15px; height:15px; text-align:center; top:-5px; right:29px}
        .ThFilt > b.Rtv{position:absolute; background:#ff0000; border-radius:255px; width:15px; height:15px; text-align:center; top:-5px; right:10px}
        .ThFilt > div > div > .conffffff {background: #ff00c8; color: white; height: 24px}
        .ThFilt > div > div > .conffffff img{height:18px ; width:18px}
        .ThFilt > div > div > .conffffff span.Atv{fill: #ffff00; background: #00df00;}
        
        .ShodShod{width: 250px}
    
        .THSugg{border-radius: 0 0 10px 10px !important}
            .THSugg div:hover{background:#df4ccb; color: white}
            .THSugg div:hover div{opacity: 1}
            .THSugg div div{font-size: 15px;background: #d822ab; color: white !important; width: 18px; height: 18px; text-align: center; margin-left:10px ; opacity: 0}
        
        .Sugg{top:100%;left:0;right:0;max-height: 250px;overflow-y:auto;z-index: 500 ; width: 100%}
                .Lite .Sugg{background: #ffffff;border: 3px #ff00c8 solid ; color:#000000}
                .Dark .Sugg{background: #585858;border: 1px #2e2e2e solid ; color:#ffffff}
                .Sugg a p {padding: 3px}
                .Sugg a p:first-child {font-size: 10px; opacity: 0.6}
                    .Lite .Sugg a:hover {background: #ffaced}
                    .Dark .Sugg a:hover {background: #757575}

        .RecolorSelects{background:#f357d1}                    
        .ThFilt_Atv{background: #059b00; color: white}
        .ThFilt_Rtv{background: #ff0000; color: white}
        .Sugg_Atv  {background: #d822ab; color: white}

        .filtTrue{background: green !important; color: white;}
        .filtFals{background: red   !important; color: white;}

        .n1{display: none}

        .Antig{color: #ffffff; font-size: 7px; top: 0px;}
        .Ant-Blu{background: #0000ff !important}
        .Ant-Red{background: #ff0000 !important}
        .Ant-Grn{background: #008000 !important}
        .Ant-Bol{width: 6px;height: 6px; border-radius: 255px}
        
        .AutoComp{background: #94949473}
        .AutoComp.Cor{background: #ffffff00}
        .CorID   {background: #94949473}

        td        .grifoo{display: none ; height: 5px; width: 5px ; left: 0px;}
        td.Grifo2 .grifoo{display: block ; background: #ff880060}
        td.Grifo1 .grifoo{display: block ; background: #ff8800fd}

            table{text-align:center;border-collapse:collapse}
                .Dark .TBLAA table{background: #222222}
                .Lite .TBLAA table{background: white}
            .TBLAA th{padding:4px 6px}
                .Dark .TBLAA tr{border:1px solid #cccccc27}
                .Lite .TBLAA tr{border:1px solid #00000027}
                .Dark .TBLAA th{background: #161616;color:white}
                .Lite .TBLAA th{background: #8b0085;color:white}
                    .Lite .TBLAA td.Foco{background:#c300ff2a}
                    .Dark .TBLAA td.Foco{background:#ffffff18}
                .Dark .TBLAA tfoot{background:#111111;color:white}
                .Lite .TBLAA tfoot{background:#8b0085;color:white}
            
            .TBLAA td p{height:100%; padding:2px 6px; text-align:center}

            .TBLAA .hMin td{height:10px}
            .TBLAA .hMin td select,.hMin td input{height: 17px !important}
                .TBLAA td .svg-Lixo{height:17px;width:auto; fill:#ffbb00}
                .TBLAA td img{height:17px; width: auto;}
            .TBLAA .hMin tfoot td{padding:8px 6px}
            
            .TableMORE thead{background:#0000007c}
            .More{margin:5px; padding:5px 10px; height:20px}

            .TBLAA tfoot a{color: #00df00;}
            .TBLAA tfoot .RS{color: #00df00; font-size: 7px;}

            .teste{color: #79ff79;}

            #Rodape{height: 200px;}

            .icoFone{height: 12px !important ; width: 12px !important ; top: -16px; right: -87px;}

            /*Talvez toda essa trolha de pra simplificar, pois isso √© s√≥ pra fazer as Linhas*/
            .Bdj_SERV > tbody > tr > td:nth-child(3) ,.Bdj_SERV > thead > tr > th:nth-child(3) {border-right: 4px solid #bb0092}
            .Bdj_SERV > tbody > tr > td:nth-child(9) ,.Bdj_SERV > thead > tr > th:nth-child(9) {border-right: 4px solid #bb0092}
            .Bdj_SERV > tbody > tr > td:nth-child(13),.Bdj_SERV > thead > tr > th:nth-child(13){border-right: 4px solid #bb0092}
            .Bdj_SERV > tbody > tr > td:nth-child(17),.Bdj_SERV > thead > tr > th:nth-child(17){border-right: 4px solid #bb0092}

            #H_SERV > tbody > tr > td:nth-child(3) ,    #H_SERV > thead > tr > th:nth-child(3) {border-right: 4px solid #bb0092}
            #H_SERV > tbody > tr > td:nth-child(9) ,    #H_SERV > thead > tr > th:nth-child(9) {border-right: 4px solid #bb0092}
            #H_SERV > tbody > tr > td:nth-child(13),    #H_SERV > thead > tr > th:nth-child(13){border-right: 4px solid #bb0092}
            #H_SERV > tbody > tr > td:nth-child(17),    #H_SERV > thead > tr > th:nth-child(17){border-right: 4px solid #bb0092}

            #H_SERV > tbody > tr > td:nth-child(11),    #H_SERV > thead > tr > th:nth-child(11){width: 15px !important;}
            #H_SERV > tbody > tr > td:nth-child(12),    #H_SERV > thead > tr > th:nth-child(12){width: 15px !important;}

            .TBLAA > table > tbody > tr > td:nth-child(1){background: #a7a7a78e !important}


            /*.TBLAA p.P-P{display: inline-block; white-space: nowrap; }*/
            
            .bnDJ .Bdj_ABCD td:nth-child(1){width: 23px;}
            .bnDJ .Bdj_ABCD td:nth-child(2){width: 190px;}
            .bnDJ .Bdj_ABCD td:nth-child(3){width: 50px;}
            .bnDJ .Bdj_ABCD td:nth-child(4){width: 23px;}
            .bnDJ .Bdj_ABCD td:nth-child(5){width: 80px;}
            .bnDJ .Bdj_ABCD td:nth-child(6){width: 50px;}
            .bnDJ .Bdj_ABCD td:nth-child(7){width: 80px;}
            /*.bnDJ .Bdj_ABCD td:nth-child(8){width: 200px;}*/
            .bnDJ .Bdj_ABCD td:nth-child(9){width: 30px;}

            .DivConf{background:#d6d6d6}
            .DivConf h1{font-size: 25px;}

            .Body1 .DivConf{top:55px ; height: 40px}
            .Body1 thead   {top:95px}
            .Body1 .PagPEsq{display:none}

            .Body2 .DivConf{top:0px  ; height: 40px}
            .Body2 thead   {top:39px}
            .Body2 .PagPEsq{display:block}

            th input{height: 18px ; width: 80px}
            .SelectSoma{background: #ff0000}
            .Ubuiaxik{width: 800px; height: 500px}
            .BtnMini{color:#ffffff; background:#53004873; padding:2px}
            
            .footbndjj{background:#ffffff; bottom:0px; overflow:scroll; height:auto; max-height:300px}
            .footbndjj span{color:#000000}
            select.Psq{background: #ff7b00} /*isso √© como o Select vai ficar quando √© corespondido a pesquisa*/

            .footbndjj{
                overflow: auto ; border:3px #ff00c8 solid ;
                box-shadow: 3px -4px 6px #0000004d;
                border-radius: 10px 10px 0 0 !important;
            }

            .confFoot{
                background: #ff00c8;
                color: white;
                height: 24px;
            }
    </style>

    <script>// Template String v7.3 (J√° Incluir o Numero da Coluna)
        const Tm_Rastr=(e,x,Typ,id)=>`Rastr-${Typ}-${e=='Foot'?'Foot':e[isArr(e)?0:id]}-${OjKy(Typ)[x]}-${CRYPP[BSBS(Typ,x,0)]}-${x+1}` //Argumento 'id', recebe string 'ID' se for Obj, e recebe '0' se for array
        const Tm_Config=Typ=>`<input type="checkbox" onchange="TrcTog($('#H_${Typ}'),'hMin','hMax');SaveConfig()"> <input type="checkbox" onchange="Tog($('#H_${Typ}'),'w100');SaveConfig()">`
        const Tm_tdFoot=(arr,Typ)=>arr.map((e,x)=>`<td class="${Tm_Rastr('Foot',x,Typ,'')} Rltv"></td>`).join('')
        const Tm_SuggCLNT=()=>`<div class="DivSugg Rltv"> <input class="w100" oninput="Sugg($Vl(this),J['CLNT'],'Clnt',SibQSl(this,'span'),'ClickSugg2');Nm(this,'')" onblur="" onkeydown="KeyEntr(()=>TesteClnt(this,this))" placeholder="Cliente"><span class="Sugg Shdw rd Abslt Cl none"></span></div>`
        const Tm_Antg=(A)=>A ? `<div class="Abslt Antig Ant-${A[0]} ${A[1]==''?'Ant-Bol':''}">${A[1]}</div>` : ''
        const BrevSrc={Grad:'Grad',Gimg:'Grad'}

        const Tm_Tm = {
            Fixo:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}">${e}</p>`, // o Fixo tamb√©m tem Data por isso tinha informa√ß√£o de data aqui
            Auto:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}">${e}</p>`,
            Edit:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}" ${Edi} onkeydown="EnterBlur(this)" onblur="Rmv(_td(this),'Foco');EditCell(this)" onfocus="Add(_td(this),'Foco')">${e}</p>`,
            Valr:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}" ${Edi} onkeydown="EnterBlur(this)" onblur="Rmv(_td(this),'Foco');EditCell(this)" onfocus="Add(_td(this),'Foco');CurAll(this)" oninput="MaskR$(this)">${RS(e)}</p>`,
            Data:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${YMD(e)}" onclick="TrcFih(this)">${BrevData(DMY(e))}</p><input type="date" class="none" value="${YMD(e)}" onchange="EditCell(this)" onblur="TrcFih(this)">`,
            Slct:(e,R,A)=>`${Tm_Antg(A)}<select class="P-P w100" onchange="EditCell(this)">${R[3]==='Serv' ? Tm_OptsGraff(['Servi√ßos',...AllProd],e) : Tm_Opts(O[R[3]],e)}</select>`,
            Chek:(e,R,A)=>`${Tm_Antg(A)}<input  class="P-P"      onchange="EditCell(this)" type="checkbox" ${e===true?'checked':''}>`,            
            Imgs:(e,R,A)=>`${Tm_Antg(A)}<img onclick="AbrirImg(this)" draggable="false" src="./Base/${BrevSrc[R[3]]||R[3]}/${R[3]=='Arte'&&ListARQ.includes(R[2])?`${R[2]}.svg`:e}" ${Err}>`,
            Lixo:(e,R,A)=>`<a onclick="RmvROW('${R[1]}','${e['Id']}',this)">${SVG.Lixo}</a>`,
            Grds:(e,R,A)=>`${e}`,
            Soma:(e,R,A)=>{const FiltID=id=>J['PDDS'].find(e=>e.Id==id)?.Serv??null ; const soma = SOMA_Obj(FiltID(R[2]),'Valr') ;todoTitle['Soma'].push(soma) ; return `<p class="P-P Ct" onclick="CtrlSoma(this)" name="${soma}">R$ ${Cm(soma)}</p>`},
            Sugg:(e,R,A)=>`<div class="Rltv"><p class="P-P">${e}</p><div class="BNdj BndjSUG Abslt Cl none"><a>${SVG.Ponta}</a><span class="Sugg Shdw rd Cl"></span><i class="ppt Shdw rd Ct Hov" onclick="Linkar(this)">Linkar</i></div></div>`,
                    // se o Sugg tiver vazio deixar pelomenos uma mensagem avisando
                    // descobrir quem √© quem do Sug, pelo t√≠tulo da coluna
                    // no Linkar deixar 2Bot√µes abaixo, para tipo de Sugg, ou de Troca, ou de Adi√ß√£o       
        }

        const Tm_Table=(typ,arry)=>{ const IN = performance.now()

            function Tm_Bndj(arr,Typ){
                return `<table class="Bdj_${Typ} TableMORE"><thead><tr>${arr[0].map(t=>`<th>${t}</th>`).join('')}</tr></thead>
                                            <tbody>${arr.slice(1).map((LL,X)=>`<tr class="tr-${LL[0]}-${X}">${LL.map((v,x)=>Tm_Td(v,LL,x,Typ,'vemBndj')).join('')}</tr>`).join('')}</tbody>
                                    </table> ${Typ==='CLNT'?'':`<div class="BtnMini RD Hov" onclick="NovaLinhaBDj(this)">Nova Linha +</div>`}`
                                    // conferir se typ √© CLNT √© desnesses√°rio pois, logo logo Clnt vai ser subistidio por 'LINK'
            }

            function _Tm_Bndj(arry,r){ // esse R √© o D_Raster

                const MORE2 =(arr,Typ)=>`<table class="Bdj_${'Calc'} TableMORE"><thead><tr>${['Larg','Alt','Qnt','Valor'].map(t=>`<th>${t}</th>`).join('')}</tr></thead>
                                        <tbody>${
                                            arr.map(LL=>`<tr class="tr-Mdds">${
                                                LL.map((v,x)=>`<td class="">${Tm_Tm['Edit'](v)}</td>`).join('') // se for o ultimo √© R$ no caso valr
                                            }</tr>`).join('')
                                        }</tbody>
                                    </table>`

                const R = D_Rastr2(r)
                const Typ   = R[3]
                const Find  = Typ==='Clnt' ? J[Typ.toUpperCase()].filter(E=>E.Id==arry) : Typ==='Calc' ? arry.map(e=>e.split('|')) : arry

                const F2    = [ObjKey(Find).map(e=>e),ObjVal(Find).map(e=>e)] // coisa penas do 'Calc'

                const Title =   Typ==='ABCD' ? Find.map(e=>`${e['Id']}`).join('') :
                                Typ==='Pgmt' ? Find.map(e=>`${e['Valr']}${ e['Form']}`).join(' | ') :
                                Typ==='Serv' ? Find.map(e=>`${e['Serv']} ${e['Desc']}`).join(' | ') :
                                Typ==='Cust' ? Find.map(e=>`${e['Valr']}`).join('') :
                                Typ==='Finc' ? Find.map(e=>`${e['Lcro']}`).join('') :
                                Typ==='Calc' ? `${Find.Qnt||'_'} - ${Find.Lag||'_'}x${Find.Alt||'_'}${Find.Val==''?'':` R$ ${Cm(Find.Val||'0')}`}` :
                                            Find.map(e=>e[R[3]]).join(' | ').replace('_ - _x_ R$ 0,00','')

                if(Title!=''){
                        if(['Cust','Finc','Calc'].includes(Typ)){
                            todoTitle[Typ].push(Title)}
                }
                
                Typ=='Serv' ? Find.map(e=>`${todoTitle[Typ].push(e['Serv'])}`) : null
                
                const NewPg = Typ==='Pgmt' && Title==='' ? '-' : ''
                const Reordem =()=>{if(Typ=='Serv'||Typ=='Pgmt'||Typ=='ABCD'){
                    return reorderArr_Arr(ArrObj_ArrArr(Find),ObjKey(BS[Typ.toUpperCase()]))
                    }else{return ArrObj_ArrArr(Find)}} 

                const Lista = Typ==='Calc' ?  MORE2(Find,'SERV') : Find.map((e,x)=>x===0 ? Tm_Bndj(Reordem(),Typ.toUpperCase()) : '').join('')
                const iconFone = Typ==='Clnt'? Find[0] ? Find[0].Cntt==='' ? '' : `<img class="icoFone HOV" onclick="console.log('FONE')" src="./SVG/Icon_Fone.svg">`:'' : ''
                const ConcatIMG = Typ==='Serv'? Find.map(e=>`${ListARQ.includes(e['Id']) ? `<img onclick="AbrirImg(this)" src="./Base/Arte/${e['Id']}.svg">` : ''}`).join('|') : ''
                const Grifo = `<i class="grifoo RD"></i>`

                return `<div class="Ct"><p class="P-P" ${Typ==='Pgmt'?`name="${SunPix(Title)}"`:`name="${Title}"`}>${Title}</p>${iconFone}${ConcatIMG}${Grifo}</div>
                            <div class="Rltv w100">
                                <div class="BndjTBL BNdj Abslt Shdw none rd Cl">
                                    <a>${SVG.Ponta}</a>
                                    ${NewPg==='-' || Title==='-'?'<a class="FikaFika"></a>':Lista}
                                </div>
                            </div>`

                // o Zindex √© o segfuinte o ultimo selecionado fica na Frente! e isso fica interessante ser exibido na hora do ShowBndj() pq funcionar√° para Bandejas e Filters
                // Op√ß√£o de Ordenar pelo q tem mais caract√©re (textos maiores em cima textos menores em baixo)
            }
            function Tm_Td(v,e,x,Typ,dado){const R = Tm_Rastr(e,x,Typ,'Id') ; const dR = D_Rastr2(R)
                return dR[4]=='Bndj'? `<td class="${R} ${daClass(dR)}" onclick="ShowBndj(this)">${_Tm_Bndj(v,R)}</td>` :
                       dR[4]=='Sugg'? `<td class="${R} ${daClass(dR)}" onclick="ShowBndj(this);SuggLink(this,'${R}')"><div class="Ct">${Tm_Tm[dR[4]](v,dR)}</div></td>`
                                    : `<td class="${R} Rltv ${daClass(dR)}"><div class="Ct">${Tm_Tm[dR[4]](v,dR)}</div></td>`
            } // Conferir se realmente eu posso deixar td Rltv, pra comportar a Div Antigo

            const Retorno = arry.map((e,X)=>{if(X>LimitLin){return} ; return `<tr class="tr-${e.Id}-${X}">${ObjOrdn(e,OjKy(typ)).map((v,x)=>Tm_Td(v,e,x,typ,'')).join('')}</tr>`}).join('')

            const Perform = (performance.now()-IN).toFixed(2)
            Perform < 0.5 ? null : console.log(`‚è±Ô∏èüî¥ Tm_Table(${typ}): ${Perform}ms`)
            return Retorno
            
            // Tipo de BndjTable = Array interno, ou Array de Fora
            // Permitir mudar os 2 Tipos de Bandeijas, dentro da cell, e em formato de bandeja
            // Transitar com as Setinhas na tabela do APP igual na Planilha
        }        

        function Format_Bndj_Clnt(){ // Esta Fun√ß√£o aqui precisa ser Corrigida!
            $$(`.FikaFika`).forEach(e=>{
                const R = D_Rastr(_td(e))
                if(R[2]==='Pgmt'){e.innerHTML = `<div class="LugyLygy"><input placeholder="0Av | 0Pix" onblur="EditCellFake2(this)" onkeydown="KeyEntr(()=>{None(Bzv(this))})"></div>`} // no caso o Lance de quando estiver vazio, (provavelmente se tiver vazio nem roda a Bandeja, pula direto pra isso!)
                if(R[2]==='Clnt'){e.innerHTML = `<div class="LugyLygy">${Tm_SuggCLNT()}</div><a class="sppns none" onclick="EditCellFake(this)"></a>`} // aqui a mesma coisa do de cima
            })
            $$(`#H_PDDS ${Rx2(['CLNT','Id'])}`).forEach(e=>{ // √© melhor mudar isso pra um bot√£o abaixo, com nome de trocar cliente, e ai carrega a Lista pra eu escolher (Lista com tudo, nome contato e tudo mais)
                Inn(e,`<p class="Ct" onclick="None($$('.LugyLygy'));Show(SibNxt(this))">${$('p',e).innerHTML}</p>
                            <div class="LugyLygy Abslt none">${Tm_SuggCLNT()}</div>
                            <a class="sppns none" onclick="EditCellFake(this)"></a>`)})      
            // Coment√°rios Antigos
            // inputs quando tiver Vazio, e alterar Cliente              
        }

        // ter uma op√ß√£o no thead na qual eu possa Ocultar a coluna e deiaxar apenas um Icone, e quando clicar q exibe uma Bandeja, ou voltar pra o normal
        // isso vai ser bem igual aquela troca de bandeija que tem dentro de ABCD grad, s√≥ q funcionando tamb√©m com um unico valor
    </script>

    <script> // SIMPLES  - ‚≠ê_ _ _ _ bot√£o pra Ocultar ID e Ocultar outras coisas tbm na Tabela 
        function CtrlSoma(Eu){Tog(Eu,'SelectSoma');Inn('#Sommma',`Soma: ${RS(SOMA($$('.SelectSoma').map(e=>Nm(e))))}`)}
        
        document.addEventListener('DOMContentLoaded', function(){ // Fun√ß√£o do Esc
            document.addEventListener('keydown',function(event){
                if(event.key==='Escape'){
                    if(EShow($('#FModal'))){return}
                    else{$$(`${Atual.Pag} .BNdj, ${Atual.Pag} .BNfot`).forEach(e=>Add_N(e))}
                }// F_Clen(Atual.Pag) // se for outro bot√£o
        })})
    </script>

    <script> // PESQUISA - ‚≠ê‚≠ê‚≠ê‚≠ê_
        const NavPesq =(Pesq   )=>{$$('.pPesq').forEach(e=>None(e));Show($$(Pesq))}
        const Grifar  =(e,Rgx  )=>e.replace(Rgx,match=>`<strong style="background:orange" name="">${match}</strong>`)
        const Espelhar=(Org,Dst)=>{Dst.forEach(e=>{e.innerHTML = Org.innerHTML ; $('input',e) ? $('input',e).value = $('input',Org).value : null})} // Provavelmnte da pra usar com outras coisas tbm fora Pesq
        let debounceTimer

        function Pesq(Inpt,Typ){                // ‚úîÔ∏è Fazer a Pesquisa
            clearTimeout(debounceTimer) // cancela chamadas anteriores
            debounceTimer = setTimeout(() => {
                Espelhar(Pai(Inpt),$$(`.Pesq_${Typ}`).filter(e=>e!==Pai(Inpt)))
                if(Typ=='ORC'){
                    const r = new RegExp(RxClear(Inpt.value),'i')
                    $$('#Div-Prod > div').forEach(e=>{
                        $$(".rgx",e).forEach(Rx=>{Rx.innerHTML = Grifar(Rx.textContent,r)}) // Grifar
                        e.style.display = r.test(RxClear(e.textContent)) ? '' : 'none'      // Ocultar
                })}
                else if($(`#Pag_${Typ}`).classList.contains('TBLAA')){ // Conferir se a pesquisa √© uma Tabela
                    const Aa=$(`.Pesq_${Typ} .Pesq-Aa.Atv`)?  '' :'i'
                    const A_=$(`.Pesq_${Typ} .Pesq-A_.Atv`)?'\\b':''
                    const Bj=$(`.Pesq_${Typ} .Pesq-Bj.Atv`)
                    const CleaVal = Inpt.value.replace(/\[[^\]]*\]/g,' ').replace(/\s+/g,' ').trim()
                    const regex = new RegExp(`${A_}${EscpRgx(CleaVal)}${A_}`,Aa)
                        const mtch = [...Inpt.value.matchAll(/\[([^\]]*)\]/g)]
                        const COL1 = mtch[0]?.[1] || false // Primeiro valor dentro de []
                        const COL2 = mtch[1]?.[1] || false // Segundo  valor dentro de []
                    TRs(Typ).forEach(tr=>{                                   
                        const P_P2  = !COL2 ? $$(`:scope > ${COL1?Col(Typ,COL1):'td'} ${Bj?'':'> div >'} .P-P`,tr)                                        // Fora ou Fora e Dentro
                                            : $$(`:scope > ${COL1?Col(Typ,COL1):'td'} .BndjTBL ${COL2?Col((COL1||'').toUpperCase(),COL2):'td'} .P-P`,tr)  // Apenas Dentro da Bandeja

                        const Cnct = P_P2.map(Rx=>VAL(Rx)).join('#')
                        P_P2.forEach(Rx=>{if(Rx.tagName=='P'){Inn(Rx,Grifar(Rx.textContent,regex))}else{regex.source!==''&&regex.test(VAL(Rx))&&Inpt.value!=='' ? Add(Rx,'Psq') : Rmv(Rx,'Psq')}})  // Grifar o Texto encontrado // o else √© se n for tag p, provavelmente √© um Select
                        $$(Rx2([Typ,'Bndj']),tr).forEach(e=>{                    // Cria a Bolinha
                            const Camada1_p = $$(':scope > div > .BndjTBL > table > tbody > tr > td > div > .P-P strong',e).some(E=>E.innerText!=='')
                            const Camada1_s = $$(':scope > div > .BndjTBL > table > tbody > tr > td > div > .Psq'       ,e).some(E=>VAL(E)!=='')
                            const Camada2_p = $$(               '.BndjTBL > table > tbody > tr > td > div > .P-P strong',e).some(E=>E.innerText!=='')
                            const Camada2_s = $$(               '.BndjTBL > table > tbody > tr > td > div > .Psq'       ,e).some(E=>VAL(E)!=='')
                            if(Camada1_p||Camada1_s){Add(e,'Grifo1')}else{Rmv(e,'Grifo1')}
                            if(Camada2_p||Camada2_s){Add(e,'Grifo2')}else{Rmv(e,'Grifo2')}
                        })                       
                        if(regex.test(Cnct)){Rmv(tr,'n0')}else{Add(tr,'n0')}      // Ocultar (Aplica None)
                    })
                    Rfresh_Foot(Typ)
                }
            },100)
            // Depois Encontrar mais de 1 Correpond√™ncia na mesma linha
            // Depois criar uma configura√ß√£o de Pesquisa q troca de oninput para onkeyEnter (pra n ficar muito Pezado)
        }
        // Op√ß√£o de pesquisar com Enter
        // n√£o chamar a fun√ß√£o se digitar bem R√°pido
    </script>

    <script> // FILTROS  - ‚≠ê‚≠ê‚≠ê‚≠ê_       
        const Tm_thSort=(arr,Typ)=>{             // ‚úîÔ∏è Carrega Todos os Cabe√ßalhos (melhorar os CSS do input=[date])
            return arr.map((e,x)=>e=='Lixo'?`<th><p>${e}</p></th>`:
                `<th class="ThFilt Rltv noslt" onclick="ShowBndj(this);OpcyFilt(_table(this).id);Load_ThFilt(this,'${Typ}','${e}')">
                        <p class="ppt">${e}</p>
                        <i onclick="Orden(this,'${x}','p')">‚ñº</i>
                        <b class="Ct none Atv">0</b>
                        <b class="Ct none Rtv">0</b>

                        <div class="Rltv w100">
                            <div class="ShodShod BNdj Abslt Shdw none">
                                <div class="conffffff Ev" onclick="ShowDate(this,'${Typ}','${e}')"></div>
                                ${e=='Data'?`<input type="date" onchange="RangeDate(this,'${Typ}','${e}')" class="D-Inn none">
                                             <input type="date" onchange="RangeDate(this,'${Typ}','${e}')" class="D-Out none">` : ''}
                                <span class="THSugg Sugg Shdw Cl">${e}</span>
                            </div>
                        </div>
                </th>`).join('') // P=Texto, i=‚ñº, b=Notfi, a=Config, span=Sugg
        }

        const Trato=(Arr,col)=>{                 // ‚ùå Corrige Palavras
            return col==='Valr' ?  FazArry(Arr).map(e=>Cm(e.replace('R$','').trim()))     // Remove os R$ (n√£o t√£o nesses√°rio caso os dados venham certinhos)
                 : col==='Pgmt' ?      Arr.flatMap(e=>e.replace(/\d*/g,'').split(' | ')) // Pega apenas os ['Pix','Av'...]
                 : Arr
        }

        function Palavras(Typ,Col,n,Brute){      // ‚úîÔ∏è Encontra e Modifica as Palavras q vai Exibir no Filtro
            const IN = performance.now()                                
                const Clientes = ['Id','Clnt','Cmpt','Cntt','Lcal','Loja','CtLj','Cat','Stts','Lin','Link']
                const Servicos = ['Id','Serv','Desc','Data','Valr','Detg','Grad','OS','Uber','Cmnt']
                const Pagament = ['Id','Desc','Data','Link','Mpag','Valr']
                const Pedidoss = ['Id','Lin' ,'Data']
                const Mercapag = ['Id','Valr','Data','Hora','Mpag','Link']

                const Valls =   Brute=='Brute'                        ? Uniq(Colls(Typ,Col,n).map(e=>VAL(e)))             :
                                Typ=="SERV" && Col==='OK'             ? ['true','false']            :
                                Typ=="SERV" && Col==='Entg'           ? ['true','false']            : 
                                Typ=="CLNT" && Clientes.includes(Col) ? Uniq(J.CLNT.map(E=>E[Col])) :
                                Typ=="MPAG" && Mercapag.includes(Col) ? Uniq(J.MPAG.map(E=>E[Col])) :
                                Typ=="SERV" && Servicos.includes(Col) ? Uniq(J.PDDS.flatMap(e=>e['Serv'].map(E=>Trato(E[Col],Col)))) :
                                Typ=="PGMT" && Pagament.includes(Col) ? Uniq(J.PDDS.flatMap(e=>e['Pgmt'].map(E=>Trato(E[Col],Col)))) :
                                Typ=="PDDS" && Pedidoss.includes(Col) ? Uniq(J.PDDS.map(e=>e[Col])) :
                                Col=='Clnt' ? AllClnt :
                                Typ=="PDDS" && ['Cust','Finc','Calc'].includes(Col) ? Uniq(todoTitle[Col]) :
                                Typ=="PDDS" && Col==="Serv"                         ? Uniq(todoTitle[Col]) :
                                Typ=="PDDS" && Col==='Valr'                         ? Uniq(todoTitle['Soma'].map(e=>Cm(e))) :
                                AllList.includes(Col) ? O[Col] :
                                // o Obigetivo central da Fun√ß√£o √© Evitar isso!
                                Uniq(Colls(Typ,Col,n).map(e=>VAL(e))) // PEZADO

                const Perform = (performance.now()-IN).toFixed(2)
                Perform < 0.5 ? null : console.log(`‚è±Ô∏èüü° Palavras:(${Typ},${Col}): ${Perform}ms`) // quando eu venho por F_Filt() n√£o precisa do Typ
                return Valls
        }

        function Tm_Filt(Eu,Typ,col){            // ‚úîÔ∏è Depende da Tabela Carregada
            const IN = performance.now()
            const th = $('.THSugg',Eu)
            const X = IdxDe(_th(th))+1           
            const qry   = `#H_${Typ} > tbody > tr > ${Col(Typ,col)} > div > .P-P`
            const Qry_N = qry.replace('tr',"tr:not([class*=` n`])") // Aplicar apenas para Linhas Visiveis // Pode Sair!
            const QRY = [Typ,col]
            const Ex = `Ex_Filt('${Typ}','${col}')`

            $('.conffffff',_th(th)).innerHTML = `
                <span class="HOV ppt Ct" onclick="F_Filt(this,'${Typ}','${col}','Todos')"           ><img src="./SVG/Icon_Todos.svg">     <p class="none">Todos     </p> </span>
                <span class="HOV ppt Ct" onclick="F_Filt(this,'${Typ}','${col}','${Qry_N}','${X}')" ><img src="./SVG/Icon_Filtados.svg">  <p class="none">Filtados  </p> </span>
                <input class="" placeholder="pesq">
                <span id="icnFront_${col}" class="HOV ppt Ct" onclick="TOV(this);${Ex}"             ><img src="./SVG/Icon_Lin.svg">                                      </span> 
                <span class="HOV ppt Ct" onclick="F_Rndn(this,'${Qry_N}')"                          ><img src="./SVG/Icon_Randomizar.svg"><p class="none">Randomizar</p> </span>
                <span id="icnFilt_${col}"  class="HOV ppt Ct" onclick="TOV(this);${Ex}"             ><img src="./SVG/Icon_Destacar.svg">  <p class="none">Destacar  </p> </span>
            `// no icon Linha ta afun√ß√£o Ativa ou Desativa Frontira de Palavras

            const Lista = Palavras(Typ,col)
            const NovoArry = Lista.map(e=>e===''?"'Vazio'":e).sort(e=>e==="'Vazio'"?-1:1)

            th.innerHTML = NovoArry.map(e=>`<div class="Ct w100">
                                                <div class="ppt RD HOV" onclick="F_Clik(this);${Ex}">-</div>
                                                <p>${e}</p>
                                                <div class="ppt RD HOV" onclick="F_Clik(this);${Ex}">+</div>
                                                </div>`).join('')
            
            const Perform = (performance.now()-IN).toFixed(2)
            Perform < 0.5 ? null : console.log(`‚è±Ô∏èüîµ Tm_Filt:(${Typ},${col}): ${Perform}ms`)
        }

        function F_Filt(btn,Typ,cOl,Qry,Col){    // ‚úîÔ∏è Filtra o Filter (descobrir pq n funciona com Numeros)
            const ThSug = $('.THSugg',_th(btn))
            const FotBndj = Col ? $(`:scope > tfoot > tr > td:nth-child(${Col}) .footbndjj`,_table(btn)) : null
            const arry    = FotBndj ? $$('span',FotBndj).map(s=>s.innerText.split(':')[0]) : null
            const Plvrs   = !arry && Trato(Palavras(Typ,cOl,true,'Brute'),cOl) // tem q ser no Brute pra poder pegar apenas os vis√≠veis
                $$('p',ThSug).forEach(E=>{
                    if(Qry==='Todos'){Rmv_N(Pai(E))
                    }else if(arry){
                        if(arry.includes(E.innerText)){Rmv_N(Pai(E))
                        }else{Add_N(Pai(E))}               // da pra remover isso
                    }else if(Plvrs.includes(E.innerText)){Rmv_N(Pai(E))
                    }else{Add_N(Pai(E))}                   // da pra remover isso
                })
        }

        function F_Clik(Eu){                     // ‚úîÔ∏è Pinta o Filt com Ativo e Desativo
            event.preventDefault()
            const PP = $('p',Pai(Eu)) // Valor Clicado
            if(Inn(Eu)=='+'){if(PP.classList.contains('ThFilt_Rtv')){Rmv(PP,'ThFilt_Rtv')}else{Tog(PP,'ThFilt_Atv')}} // Decide se √© +
            if(Inn(Eu)=='-'){if(PP.classList.contains('ThFilt_Atv')){Rmv(PP,'ThFilt_Atv')}else{Tog(PP,'ThFilt_Rtv')}} // Decide se √© -
            const Notifi=e=>{const l = $$(`.ThFilt_${e}`,_th(Eu)).length ; const n = $(`b.${e}`,_th(Eu)) ; if(l==0){None(n)}else{Show(n)} ; Inn(n,l) } // Atualiza Notifica√ß√µes + ou -
            Notifi('Atv') ; Notifi('Rtv')
        }

        function Ex_Filt(Typ,col){               // ‚úîÔ∏è Executa o Filto na Tabela (Adicioanr Maior < Menor >)
            const thh    = TH(Typ,col)
            const Corlor = $(`#icnFilt_${Inn($('p',thh))}.Atv`)
            const Front = $(`#icnFront_${col}.Atv`)
            const Ativos = $$('.ThFilt_Atv',thh).map(e=>Front?`\\b${Inn(e)}\\b`:Inn(e)).join('|') ; const RxAtv = new RegExp(Ativos,'i')
            const Rtivos = $$('.ThFilt_Rtv',thh).map(e=>Front?`\\b${Inn(e)}\\b`:Inn(e)).join('|') ; const RxRtv = new RegExp(Rtivos,'i')
            const x = IdxDe(thh)+1           
            const Add_C=e=>Add(e,'filtTrue') ; const Add_F=e=>Add(e,'filtFals')
            const Rmv_C=e=>Rmv(e,'filtTrue') ; const Rmv_F=e=>Rmv(e,'filtFals')

            if(true){ // depois vira (Combinado = && E) ou (Independente = || OU)
                const Qry   = `#H_${Typ} > tbody > tr > ${Col(Typ,col)} > div > .P-P`
                $$(Qry).forEach(e=>{
                    const VaL = `${VAL(_td(e))}` || "'Vazio'"
                    const tr = _tr(e)
                    if(Ativos=='' && Rtivos==''){Rmv(tr,`n${x}`);Rmv_C(tr);Rmv_F(tr)}
                    else{
                             if(Ativos!=='' && RxAtv.test(VaL)){Corlor ? Add_C(tr) : Rmv(tr,`n${x}`)}
                        else if(Rtivos!=='' && RxRtv.test(VaL)){Corlor ? Add_F(tr) : Add(tr,`n${x}`)}
                        else{ 
                                if(Ativos!==''){Corlor ? Rmv_C(tr) : Add(tr,`n${x}`)}
                                if(Rtivos!==''){Corlor ? Rmv_F(tr) : Rmv(tr,`n${x}`)}
                            }
                    }
                })
            }
            Rfresh_Foot(Typ)
        }

        function F_Rndn(Eu,Qry,Clik){            // ‚úîÔ∏è Randomiza
            const QRY = Qry.replace('` n`','" n"')
            const ObbjClnt=()=>$$(QRY).map(e=>Inn(e))
            let NewObj = {}
            const QntCores = Uniq(ObbjClnt()).length
            const CoresEtr = ObjEtr(ContRepete(ObbjClnt())).sort((a,b)=>b[1]-a[1]).forEach(([k,v])=>{
                if(true){NewObj[k]=RandoCor()}  // cor Randon
                else{NewObj[k]=v}               // do maior pra o menor
                                                // corsin Cor N√£o
            })
            $$(QRY).forEach(e=>{_tr(e).style.background = NewObj[Inn(e)]})
        }
        
        function F_Clen(Typ){                    // ‚úîÔ∏è Limpa todos os Filtros
            TRs(Typ).forEach(e=>{For(20).forEach(E=>Rmv(e,`n${E}`)) ; e.style.background = ''}) // Exibe todas as Linhas e Limpa o Random
            $$('.ThFilt b'  ).forEach(e=>None(e)) // Limpa Notifi dos Filter
            const Class = ['ThFilt_Atv','ThFilt_Rtv','filtTrue','filtFals','SelectSoma']
            Class.forEach(e=>{$$(`.${e}`).forEach(E=>{Rmv(E,e)})})
            Rfresh_Foot(Typ)
        }

        function OpcyFilt(Typ){                  // ‚ùå Ativar Desativa opacy do Icon do F_Filt() //SIMPLIFICAR//
            const Valid = $$(`#${Typ} .ThFilt b`).some(e=>e.innerText!=0)
            const Icon1 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(1)`)
            const Icon2 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(2)`)
            const Icon3 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(4)`)
            const Icon4 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(5)`)
            if(Valid){
                  Icon2.forEach(e=>e.style.opacity = 1)
            }else{Icon2.forEach(e=>e.style.opacity = 0.4)}
            // Precisa evitar o Click, tem q dar Return quando isso tiver Ativo!
        }

        function ShowDate(Eu,Typ,Col){           // ‚úîÔ∏è Oculta e Exibe a Bandeija de Range Data
            if(Col=='Data'){Tog($$(`.D-Inn,.D-Out`,_th(Eu)),'none')}
        }

        function RangeDate(Eu,Typ,col){          // ‚úîÔ∏è Seleciona o Intervalo de Data
            const inn   =  $(`.D-Inn`).value
            const out   =  $(`.D-Out`).value || inn
            $$('.THSugg > div',_th(Eu)).forEach(e=>{const D = $('p',e) // D √© Data
                if(Inn(D)>=inn && Inn(D)<=out){Add(D,'ThFilt_Atv')}
                else{Rmv(D,'ThFilt_Atv')}
            })
            Ex_Filt(Typ,col)
            // Depois Evoluir pra Criar minha Pr√≥prio Calend√°rio, pra eu poder fazer aquele Range de faixa
            // Adicionar Bot√£o de Todo Per√≠odo (oq seria Remover todos os Filtros)
        }
        
        function Orden(e,x,Cntd=null,order=null){// ‚úîÔ∏è se tiver 'Cntd' √© conteudo, √© por que o texto a ser coletado esta dentro de alguma tag especifica dentro do td, se n√£o tiver ta no pr√≥prio td
            function AtualizaSetas(e,asc){
                $$('th',e.closest('table')).forEach(th=>{const seta = $('i',th);if(seta){seta.style.opacity=0.5;seta.textContent='‚ñº'}})
                const Atual = SibQSl(e,'i') ; if(Atual){Atual.style.opacity=1;Atual.textContent=asc?'‚ñº':'‚ñ≤'}
            }
            const table = e.closest('table')
            const cOl = $('p',_th(e))
            const tbody = $('tbody',table)
            const asc = order ? order === 'asc' : table.dataset.sortOrder !== "asc"
            const Get=e=> Cntd ? $(Cntd,e.children[x]) : e.children[x]

            const Ordn = [...tbody.rows].sort((a,b)=>{
                if(cOl=='Data'){
                    // üìÖ Se ambos forem datas v√°lidas (ex: "2024-12-03")
                        const dateA = new Date(VAL(Get(a)).trim() || '2000-01-01')
                        const dateB = new Date(VAL(Get(b)).trim() || '2000-01-01')           
                        if(!isNaN(dateA) && !isNaN(dateB)){return asc ? dateA-dateB : dateB-dateA}
                }
                // Ordena se for Numeros
                    const valA = parseFloat(Txt(Get(a)).replace('R$',''))
                    const valB = parseFloat(Txt(Get(b)).replace('R$',''))
                    if(!isNaN(valA) && !isNaN(valB)){return asc ? valA-valB : valB-valA}
                    
                // Ordena como texto se n√£o forem n√∫meros
                    const txtA = `${VAL(Get(a))}`.replace('R$','')
                    const txtB = `${VAL(Get(b))}`.replace('R$','')
                    return asc ? txtA.localeCompare(txtB) : txtB.localeCompare(txtA)
            })
            table.dataset.sortOrder = asc ? "asc" : "desc"
            Ordn.forEach(r=>tbody.appendChild(r))
            AtualizaSetas(e,asc)
        }
    </script>

    <script> // RECOLOR  - ‚≠ê‚≠ê_ _ _
        const NoVazi=v=>v!=='' && v!==false && v!==undefined // isso pode virar Biblioteca
        const MinMax=(Atual,Lista)=>Math.min(Math.max(Atual/Lista,0),1) // Entre 0 e 1 
        const OB = { // Criterio 1 √© Obriga√≥rio
            SERV:['Serv','Tipo','Dsng','Forn','OK','Entg','Detg','Grad']
        }
        const OC = { // mas tbm ter√° outro crit√©rio de Compara√ß√£o
            SERV:['Forn==Grad']
        }

        // Degrader de 2 cores formato de Matiz, do vermelho ao Verde
        const R_Cor=(e,opacy,Cor)=>{
            e.style.background   = `rgba(${Cor},${(opacy).toFixed(2)})`             // Colore o Fundo
            e.style.color        = `rgb(${Cor.split(',').map(e=>e/2).join(',')})`   // Colore o Fundo
            e.style.borderBottom = `1px solid rgba(${Cor},${(opacy).toFixed(2)})`   // Colore a Borda
            $$('select',e).forEach(E=>E.style.background = '#00000000')
        }

        function Re_colrAll(Typ){                // ‚úîÔ∏è Muda a cor de Todas 
            TRs(Typ).forEach(tr=>{R_Color(tr,Typ)})
            // Depois fazer Apenas para as Visiveis
            // Tamb√©m seria bom Limpar tudo antes de Recolorir
        } 

        function R_Color(tr,Typ){ // Muda a cor apenas de 1 linha tr
            if(Typ==='SERV'){
                const Arr    = $$(':scope > td',tr).map(td=>VAL(td)||'')
                const newobj = zipObj(OjKy(Typ),Arr)
                const Atual  = OB[Typ].filter(k=>NoVazi(newobj[k]))
                const opacy  = MinMax(Atual.length,OB[Typ].length)
                const Coclui = Atual.length === OB[Typ].length
                const Cor    = $(`#${Typ}_Color`).value
                const [Atv1,Atv2] = [$(`#${Typ}_tdCor`).checked,$(`#${Typ}_trCor`).checked]
                //Op√ß√£o de Permitir isso ou n√£o (pq fica parecendo um Xadrez)
                Atual.map(e=>$(Rx2([Typ,e]),tr)).forEach(td=>{
                    td.style.background = ''                      // Zera Fundo
                    td.style.border = ''                          // Zera Brorder
                    if(Atv1){R_Cor(td,opacy/2,hexToRGB2(Cor))}
                    if(Coclui){R_Cor(td,opacy,hexToRGB2(Cor))}
                })
                    tr.style.background = ''                      // Zera Fundo
                    $$('td',tr).forEach(e=>e.style.border = '')   // Zera Borda
                    if(Atv2){R_Cor(tr,opacy/2,hexToRGB2(Cor))}
                    if(Coclui){R_Cor(tr,opacy,hexToRGB2(Cor))}
            }
            // Poder escolher a Cor do RGB por alguns crit√©rios, q seria usar a cor do Random
            // ou usar uma cor predefinida q seria (Stock: Azul e Grads Verde) (Permitir poder escolher isso Livremente)
        }
    </script>
    
    <script> // AUTOCOMP - ‚≠ê‚≠ê_ _ _
        function RfreshJson(Typ){const IN = performance.now()

            // Virar Biblioteca
                const Dbbrev = {T:'Tatiane',G:'Grafit',B:'BPrint',I:'Inov√°'}    
                const Includ=(e,arr)=>arr.some(v=>e.includes(v)) // como usar Includ(e,['BPrint','Grafit'])

            const arrayss = {
                GRAD:['Id'  ,'Data','Forn','Grad','Cont'],
                SERV:['Forn','Abcd','OS','Gimg'],
                ABCD:['Valr']
            }
            const SplitNome=e=>(e.match(/(\d+,\d+)\s*x\s*(\d+,\d+)/) || []).slice(1)
            const LocIten=(Serv,Tipo)=>Prod[Serv]?.Variantes[Tipo]?.Grad || ""
            const extrairNomeSigla = e => (e.match(/-\s*([^\s]+\([^)]+\))/) || [])[1] || "";


            const Func = {
                 G_Id  :e=>(e.Emal.match(/(\d{3})¬∞\s+(\w)/)||[]).slice(1,3).reverse().map((v,i)=>i?v:v.toUpperCase()).join('_')
                ,G_Data:e=>YMD(`${e.Emal.match(/(\d{2})(\d{2})$/)?.slice(1).join('/')||""}/${LocAno(e.Emal)}`)
                ,G_Forn:e=>e.Emal.match(/\d+¬∞\s*(.*?)\s*-\s*\d+/)?.[1] || ""
                ,G_Grad:e=>`${e.Emal}.webp`
                ,G_Cont:e=>`${e.ABCD.length}`
                ,GA_Valr:a=>{const [v1,v2]=SplitNome(a.Nome) ; return v1&&v2 ? Num(v1)*Num(v2)*20 : 0 } // Melhorar pra (Banner, Adesivo, Transp)
                ,S_Forn:e=>{
                    const buxu = Prod[e.Serv]?.Forn ?? []
                    return e.Grad ? Dbbrev[e.Grad.split('_')[0]]||'' : buxu.length == 1 ?  buxu[0] : '' }
                ,S_Abcd:e=>{
                    if(!e.Grad){return ''} // se n tem dados return Vazio
                    else{ // tamb√©m conferir o valor que j√° tem antes!
                        const ItenSERV = LocIten(e.Serv,e.Tipo)
                        const LinGrad = J.GRAD?.find(x=>x.Id==e.Grad)?.ABCD||'' // Consulta
                        if(isArr(LinGrad)){
                            const Linfilt = LinGrad.filter(G=>G.Nome!=="")
                                const Filtrado = Linfilt.filter(G=>ItenSERV == extrairNomeSigla(G.Nome))
                                if(Linfilt.length==1){return 'A'}
                                if(Linfilt.length==0){return 'Falta Nome'}
                                else if(Filtrado.length==1){return Filtrado[0].Id}
                                else{ return `${Linfilt.length}...`}
                                return ItenSERV
                        //    }
                        }else{return 'sem ID'}

                    } // Levar a Imagem da Grad pra dentro da Tabela de SERV
                }             
                ,S_OS  :e=>J.GRAD?.find(x=>x.Id==e.Grad)?.OS||'' // Consulta
                ,S_Gimg:e=>`${J.GRAD?.find(x=>x.Id==e.Grad)?.Emal||''}.webp`
            }

            function Exec2(e,c,tr,Tag){ // 'c' de Col // neste exec2 os dados s√£o editados l√° na const principal J[typ]
                const A = e[c] ; e[c] = Func[`${Tag}_${c}`](e)
                const Cor = A==""&&e[c]!==''?["Blu",'']:A==e[c]?['Grn','']:['Red',A]
                if(A=="" && e[c]==""){return}
                DarVAL($(Rx2([c]),tr),e[c],Cor)
            }

            function Exec(e,c,tr,Tag){ // 'c' de Col
                const A = e[c] ; const v = Func[`${Tag}_${c}`](e)
                const Cor = A==""&&v!==''?["Blu",'']:A==v?['Grn','']:['Red',A]
                if(A=="" && v==""){return}
                DarVAL($(Rx2([c]),tr),v,Cor)
            }

            // Separar a fun√ß√£o que chama o Exec ajuda a reutilizar em v√°rias tabelas e camadas
            // O Pre-AutoComplete √© necess√°rio para autocompletar tabelas que consultam outras (Mas antes, √© preciso garantir que ele armazene o valor anterior)

            if(Typ=='GRAD'){
                TRs(Typ).forEach(tr=>{ // Camada1
                    const e = J[Typ][tr_X(tr)] // Encontrar pelo Idx
                        arrayss[Typ].forEach(c=>Exec(e,c,tr,Typ[0]))
                        $$('.Bdj_ABCD > tbody > tr',tr).forEach(tr2=>{ // Camada2
                            const a = e['ABCD'][tr_X(tr2)] // Encontrar pelo Idx
                            arrayss['ABCD'].forEach(c=>Exec(a,c,tr2,'GA'))
                    })
                })
                Re_color(Typ)
            }

            if(Typ=='SERV'){
                TRs(Typ).forEach(tr=>{
                    const e = J[Typ][tr_X(tr)] // Encontrar pelo Idx
                        arrayss[Typ].forEach(c=>Exec(e,c,tr,Typ[0]))
                        // Camada 2
                            // camada 2
                            // camada 1
                })

                $$(Rx(['SERV','Serv','Slct'])).forEach(e=>{ // sele√ß√£o autom√°tica do forn baseada no serv select
                    if(Pai(_tr(e)).tagName=='TFOOT'){return} ; if(VAL(e)==''){return} // se for Tfoot ou tiver vazio n faz nada
                    // A√ß√£o para o Forn
                        const Forn = $(Rx(['Forn','Slct']),_tr(e))
                        if(AllForn[VAL(e)].length==1){$('select',Forn).value = AllForn[VAL(e)][0]} // mudar pra o Unico q tem, se tiver
                        $$('option',Forn).forEach(o=>{Add_N(o);if(AllForn[VAL(e)].includes(o.value)){Rmv_N(o)}}) // Ocultar os Options
                    // A√ß√£o para o Tipo
                        const Tipo = $(Rx(['Tipo','Slct']),_tr(e))
                        if(Vari(VAL(e)).length==1){$('select',Forn).value = Vari(VAL(e))[0]} // mudar pra o Unico q tem, se tiver
                        $$('option',Tipo).forEach(o=>{Add_N(o);if(Vari(VAL(e)).includes(o.value)){Rmv_N(o)}}) // Ocultar os Options
                })
            }           

            // Escolher para Todos ou Apenas 1 unica Linha! (Aplica na Linha ao Editar uma C√©lula)
            // Escolher a cor livremente por Fora!
            // Se Tiver Entregue Preenche OK Automatico

            // Fazer o Calculo autom√°tico da medida
            // Fazer a Soma dos Serv na tabela de Pedido (esse aqui j√° est√° dentro do Tm_Tm() mas se p√° traz pra c√° q √© mais certo!) (pois ele tem q ser dinamico e mudar conforme altero valor)
            // se Pagamento √© == ao Valor
            // atualiza o Finc pra Mostrar o Lucro
            // Atualiza o Status completo da Linha
            // Depois q terminar fazer isso atualizar a Const (se poss√≠vel)
            // Cor e Intensidade de Serv (Forn, OK, Entregue, DataEntreg,  Grad, OS, Uber) de 0 √° 7   |   no data-set a cor vai ser um concat de cor com Opacidade 'Blue-7'
            
            const FIM = performance.now() ; console.log(`‚è±Ô∏è Autocompletation(): ${(FIM-IN).toFixed(2)}ms`)
        }
    </script>

    <script> // REALTIME - ‚≠ê‚≠ê_ _ _
        function Load_Table(Typ){ //acho q serve pra evitar q carregue novamente  // Da um jeito de Remover daqui e Fundir dentro da Propria fun√ß√£o
            if(PreTable[Typ]==true){return}  ; PreTable[Typ]=true // ; console.log(PreTable)
            Inn($(`#H_${Typ} > tbody`),Tm_Table(Typ,J[Typ])) // quando tem 2 Tabelas dentro da mesma Pagina
            RealTime(Typ)
        }

        function Load_ThFilt(Eu,Typ,Col){ //acho q serve pra evitar q carregue novamente // Da um jeito de Remover daqui e Fundir dentro da Propria fun√ß√£o
            if(BS[Typ][Col][1]==true){return} ; BS[Typ][Col][1]=true // ; console.log(BS[Typ])
            Tm_Filt(Eu,Typ,Col)
        }

        function SOMAPgmt(Arr){
            const Tm_PixAv=(Pix,Av)=>`<div class="Ct Ev"><div class="Ct">${Tm_RS(SOMA(Pix))}Pix</div> <div class="Ct">${Tm_RS(SOMA(Av))}Av</div></div>`
            let ArrPix = [] ; let ArrAv = []
            Arr.forEach(e=>{Inn(e).split('|').forEach(I=>{if(I===''){return}
                    if      (RgxPixAV(I)[2]==='Pix'){ArrPix.push(Num(RgxPixAV(I)[1]))}
                    else if (RgxPixAV(I)[2]==='Av' ){ ArrAv.push(Num(RgxPixAV(I)[1]))} }) })
            return Tm_PixAv(ArrPix,ArrAv)
        }

        function Rfresh_Foot(typ){  // Deixei ASYNC
            setTimeout(() => {
                let IN = performance.now()
                const IIN = performance.now()
                // Tentar usar esses Obj em Filter tamb√©m pra carregar apenas 1 Vez
                    const objClnt = Colls(typ,'Clnt',true).map(e=>Inn(e)) // Contar o Cliente Pelo ID
                    const objServ = typ=="PDDS" ?
                        Colls(typ,'Serv',true).map(e=>_td(e)).flatMap(f=>$$(Rx2(['Serv','Slct']),f).map(t=>$('select',t).value))
                        : Colls(typ,'Serv',true).map(e=>VAL(e))

                //console.log(`‚è±Ô∏è Rfresh_Foot:(OBJ): ${(performance.now()-IN).toFixed(2)}ms`) ; IN = performance.now() // manter em quanto Melhora

                IN = performance.now()
                // corrigir as condi√ß√µes para quando n√£o existe deternimado foot no Typ ('ORC' n√£o te nenhum) ('SERV' n√£o tem 'Cust')
                $(Rx2([typ,'Foot','Id'  ])).innerHTML = `<div onclick="Tog_N($('.footbndjj',Pai(this)))">${      objClnt.length}         </div>`
                $(Rx2([typ,'Foot','Clnt'])).innerHTML = `<div onclick="Tog_N($('.footbndjj',Pai(this)))">${Uniq(objClnt).length} Clientes</div> <div class="Abslt none Cl footbndjj ShodShod BNdj">${ObjEtr(ContRepete(objClnt)).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<span>${k}: ${v}</span>`).join('')}<div class="confFoot w100 Ct">${Uniq(objClnt).length} Clientes</div></div>` // o Sort √© s√≥ pra reordenar
                $(Rx2([typ,'Foot','Serv'])).innerHTML = `<div onclick="Tog_N($('.footbndjj',Pai(this)))">${      objServ.length} Servi√ßos</div> <div class="Abslt none Cl footbndjj ShodShod BNdj">${ObjEtr(ContRepete(objServ)).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<span>${k}: ${v}</span>`).join('')}<div class="confFoot w100 Ct">${      objServ.length} Clientes</div></div>` // o Sort √© s√≥ pra reordenar
                Array.of($(Rx2([typ,'Foot','Valr']))).forEach(e=>{const[Typ,x,Col,Cry]=D_Rastr(e) ; e.innerHTML = `<div>Total: R$ ${Cm(SOMA(Colls(Typ,Col,true),s=>Num(Inn(s))))}</div><div id="Sommma">Soma: 00,00</div>`})
                Array.of($(Rx2([typ,'Foot','Pgmt']))).forEach(e=>{const[Typ,x,Col,Cry]=D_Rastr(e) ; e.innerHTML = `${SOMAPgmt(Colls(Typ,Col,true))}`})
                Array.of($(Rx2([typ,'Foot','Cust']))).forEach(e=>{const[Typ,x,Col,Cry]=D_Rastr(e) ; e.innerHTML = `Custo: R$ ${Cm(SOMA(Colls(Typ,Col,true),s=>Num(Inn(s))))}`})
                Array.of($(Rx2([typ,'Foot','Finc']))).forEach(e=>{const[Typ,x,Col,Cry]=D_Rastr(e) ; e.innerHTML = `Lucro: R$ ${Cm(SOMA(Colls(Typ,Col,true),s=>Num(Inn(s))))}`})

                //console.log(`‚è±Ô∏è Rfresh_Foot:(ATRIBUI): ${(performance.now()-IN ).toFixed(2)}ms`) // manter em quanto Melhora
                console.log(`‚è±Ô∏è Rfresh_Foot:(FINAL):   ${(performance.now()-IIN).toFixed(2)}ms`)
            },0)
        }

        function MudarFormatBndj1(Typ){
            const Div = $$(`${Rx(['ABCD','Bndj'])} .BndjTBL` )
            const Btn = $$(`${Rx(['ABCD','Bndj'])} .BtnMini`)
            const p   = $$(`${Rx(['ABCD','Bndj'])} > div > .P-P`)

            Div.forEach(e=>{
                e.classList.remove('BndjTBL','BNdj','Abslt','Shdw','rd','Cl','none')
                Add(e,'bnDJ') ; Add_N($('a',e)) ; Add_N($('thead',e))
            })
            Btn.forEach(e=>Add_N(e))
            p.forEach(e=>Add_N(Pai(e)))
        }

        function MudarFormatBndj2(Typ){
            const Div = $$(`${Rx(['ABCD','Bndj'])} .bnDJ` )
            const Btn = $$(`${Rx(['ABCD','Bndj'])} .BtnMini`)
            const p   = $$(`${Rx(['ABCD','Bndj'])} > div > .P-P`)

            Div.forEach(e=>{
                e.classList.add('BndjTBL','BNdj','Abslt','Shdw','rd','Cl','none')
                Rmv(e,'bnDJ') ; Rmv_N($('a',e)) ; Rmv_N($('thead',e))
            })
            Btn.forEach(e=>Rmv_N(e))
            p.forEach(e=>Rmv_N(Pai(e)))
        }

        function RealTime(Typ){
            Rfresh_Foot(Typ)
            // Rfresh_Color()
        } // aqui fica todos os refresh q n√£o afetam a tabela, s√£o s√≥ coisas visuais // tentar tornar esse realtime mais rapido
    </script>

    <script> // SUGGLINK (Voltar a Analizar ela!)
        function SuggLink(Eu,R){ // ser√° Exibido no Span todas as Linhas de uma determinada tabela
            const [aa,Tbl,cc,Typ,dd]=D_Rastr2(R)

            const Fillt=e=>{
                return  Typ=='Serv' ? e.Grad=='' && !['Stock','Arte','-'].includes(e.Forn) :
                        Typ=='Pgmt' ? e.Mpag=='' && e.Form!='Av' :
                        Typ=='Grad' ? Dat(e.Data) <= Dat(VAL($(`${Col('UBER','Data')}`,_tr(Eu)))) && VAL($(`${Col('UBER','Prds')}`,_tr(Eu))).split(',').includes(e.Forn) :
                        true
            }
            const Tm_Exib = { // Isso Provavelmente vai ficar Fora daqui, pois vai ser usado naquela id√©ia q sujerir de Exibi√ß√µes de Bandeijas diferente e esta ser√° uam vers√£o abreviada do Modo Lista
                 Mpag:(e)=> `${e.ID} - ${e.Clnt}, ${e.Valr} ${e.Form}`
                ,Pgmt:(e)=> `${e.ID} - ${FindClnt(e)} - R$ ${e.Valr} (${e.Form}) ${e.Data}`
                ,Serv:(e)=> `${e.ID} - ${SERV_Find_CLNT(e)} ${e.Serv} ${e.Desc}`
            }

            if(Typ=='Mpag'){
                // console.log(Eu,Typ)
                // console.log(J[Typ.toUpperCase()].filter(e=>Fillt(e)))
                $('span',Pai(Eu)).innerHTML = J[Typ.toUpperCase()].filter(e=>Fillt(e)).map(e=>`<div><a onclick="Tog(this,'Sugg_Atv')">${
                    Typ=='Mpag' ? Tm_Exib[Typ](e) :``
                }</a></div>`).join('')
                // deixar disponivel os que eu Permito selecionar mais de 1
            }
        }

        function Linkar(Eu){
            if(_table(Eu).id == 'H_MPAG'){EditCell(Eu,$$('.Sugg_Atv',Pai(Eu)).map(e=>Inn(e).split('-')[0].trim()))}
            if(_table(Eu).id == 'H_GRAD'){
                const ArryAntg = Inn($('p',Eu.closest('td'))).split(',')
                const NovoArry = $$('.Sugg_Atv',Pai(Eu)).map(e=>Inn(e).split('-')[0].trim())
                if(Inn($('p',Eu.closest('td')))=='-'){
                    EditCell(Eu,NovoArry)
                }else{EditCell(Eu,[...ArryAntg,...NovoArry])} 
            }else{console.log($('span',Pai(Eu)))}
        }
    </script>

    <script> // Previews

        function IMGENS(){ // fun√ß√£o q filtra linhas se existir imagem
            $$(`#H_PDDS > tbody > tr`).forEach(tr=>{ //TRs(Typ)
                const TD=(stg)=>$(`:scope > ${Col('PDDS',stg)}`,tr)
                const ArryImg = $$(':scope > div > img',TD('Serv'))
                const tem1 = ArryImg.some(e=>isImageLoaded(e))
                if(tem1){Rmv_N(tr )}else{Add_N(tr)}
            })
        }

        function AbrirImg(img){MdalShow('#FormIMG')
            Inn($('#FormIMG'),`<div class="Ubuiaxik Ct"><img class="h100" src="${img.src}"><span>aquificara fica Os<span><div>`)
        }

        function AbrirSVG(img,Nome){MdalShow('#FormIMG')
            $('#FormIMG').innerHTML = `<div class="Ubuiaxik Ct"><img class="h100" src="${img.src}">
                <span>Nome: ${Nome}<span>
                <button onclick="LimparNomeSVG('${_td(img).className.trim()}')">Limpar</button>
            <div>`
        }

        function LimparNomeSVG(Clss){
            const Edit=e=>`<p class="Ct" ${Edi} onfocus="Add(Pai(this),'Foco')" name="${Inn(e)}" onkeydown="EnterBlur(this)" onblur="Rmv(Pai(this),'Foco');EditCell(this)">${Inn(e)}</p>`
            const td = $(`td[class="${Clss}"]`)
            EditCell(td,'')
        }

    </script>
</div>

<body class="Dark Body1 CSS2 Ct" onclick="NoneBndj()">

    <header class="Bt"> <!--HEADER-->
        <style>
            /*Fixos*/
                header{padding:0px ; z-index:999 ; color: white ; transition: width ease-in-out 0.2s}
                #PAGES{transition: width ease-in-out 0.2s}
                #Login-Top      , header nav div      {filter:drop-shadow(0px 0px 8px #3a002b)}
                #Login-Top:hover, header nav div:hover{filter:drop-shadow(0px 0px 5px #f030c0)}
            /*Body1*/
                .Body1{justify-content: flex-start}
                .Body1 > header{height:8vh  ; width:100vw ; background:url(./SVG/Fundo.png); background-size:cover ; position:sticky; top:0}
                .Body1 > #PAGES{height:92vh ; width:100vw }
                .Body1 > #PAGES > div{height:100% ; overflow-y:scroll} /*Aqui s√£o as P√°ginas de Fato*/
                        .Body1 > header #Title      {margin-left:15px}                @media(max-width:500px){.Body1 > header #Title    {margin-left:3px}}
                        .Body1 > header #Title #Logo{margin:5px; height:30px}         
                        .Body1 > header #Title h1   {font-size:3vw}                   @media(max-width:500px){.Body1 > header #Title h1 {display:none}}   
                        .Body1 > header #recolhe    {display:none}
                    .Body1 > header nav     {margin:0px 10px}                         @media(max-width:700px){.Body1 > header nav       {display:none}}
                    .Body1 > header nav img {height:22px; margin:3px 3px}
                    .Body1 > header nav p   {display:none}
                    .Body1 > header nav div {border-radius:5px ; margin: 0px 2px;}
                    .Body1 #NavPerf         {flex-direction:row}
                    .Body1 #Login-Top       {display:none}
            /*Body2*/
                .Body2{justify-content: flex-start}
                .Body2 > header{height:100vh ; width:18% ; background:url(./SVG/Fundo.png);background-size:cover ; display:flex ; flex-direction: column}
                .Body2 > #PAGES{height:100vh ; width:82% ; overflow-y:scroll}
                .Body2.recolhe > header{width:5% }
                .Body2.recolhe > #PAGES{width:95%}
                .Body2.recolhe #Logo   {display: none}
                        .Body2 > header #Title      {width: 90%; justify-content: space-between}
                        .Body2 > header #Title #Logo{margin:5px; height:30px}
                        .Body2 > header #Title h1   {font-size:50% ; display:none}
                        .Body2 > header #recolhe    {height: 18px}
                    .Body2 > header nav     {margin:10px 0px; flex-direction:column; width: 100%}
                    .Body2 > header nav img {height:22px; margin:5px 0px ; margin-right: 9px}                            .Body2.recolhe > header nav img {margin-right: 0px}
                    .Body2 > header nav p   {display:block ; font-size: 14px}                                            .Body2.recolhe > header nav p   {display:none}
                    .Body2 > header nav div {width: 90% ; justify-content: start; margin: 3px 0px ; border-radius: 8px}  .Body2.recolhe > header nav div {justify-content:center}
                    .Body2 > header nav div:hover     {background: #ffffff15}
                    .Body2 > header nav #HNVDv_LIN img{display: none}
                    .Body2 > header nav #HNVDv_LIN    {border-bottom:1px solid #ffffff;opacity: 0.3}
                    .Body2 #NavPerf         {flex-direction:column; width: 90%}
                    .Body2 #Div-Pesq        {display:none}
                    .Body2 #DivNav          {width:90%}
                    .Body2 #BdjLogin        {width: 100% ; justify-content: flex-end; background: #38003fa6}
                    .Body2 #Login-Top       {display: flex; margin-right: 7px; font-size: 14px;}
                    .NavAtv                 {background: #da00aa}
                    .NavAtv:hover           {background: #ff00c8 !important; filter:drop-shadow(0px 0px 5px #f030c0) !important}

            #ALERT{right:0px;top:0px;margin:10px;padding:10px;background:#696969}

            /*.TBLAA tbody > tr       {background:transparent;transition:background 0.5s ease-out} /*  Sa√≠da lenta   */
            /*.TBLAA tbody > tr:hover {background:#8000a0a6;transition:background 0.02s ease-in} /* Entrada r√°pida */
            
            .TBLAA tbody > tr:hover    {background:#8000a0a6 !important} /* Entrada r√°pida */
            .TBLAA tbody > tr td:hover {background:#dd56ffea !important} /* Entrada r√°pida */
        </style>
        <script>
            const OFF =()=> 'OFF'
            const    ArryMais=()=> OFF() ? ['Cnfg','Help','LOff','Term'] : ['Troc','Edit','Cnfg','Help','LOff','Term'] // fazer isso simplesmente s√≥ ocultar e mostrar oq tem abaixo do mais
            function ExieMais2(E,Off){event.preventDefault();if(false/*Off*/){MdalShow('#ModalLogin')}else{TogShow('#H_Mais')}}
            function AbreLogin(){MdalShow('#ModalLogin');Inn('#Span-Login','');Foco('#Inpt-Senha')}
        </script>

        <div id="Title" class="Ct"> <!--Titulo-->
            <img id="Logo"  draggable="false" src="./Img/Logo.png" onclick="TrocaBody()">
            <h1 class="noslt ppt" onclick="TrocaBody()">InfinityAPP 7.5</h1>
            <img id="recolhe" src="./SVG/Recolhe.svg" onclick="Recolher()">
            <script>
                function TrocaBody() {
                    if(window.innerWidth>500){TrcTog($('body'),'Body1','Body2')
                    }else{
                        console.log("Tela pequena")
                    }
                }
                function Recolher(){Tog($('body'),'recolhe')}
            </script>
        </div>

        <div class="w30"> <!--Pesquisa-->
            <style> /*Input de Pesquisa*/
                #Div-Pesq .H_Pesq{background:#00000018; color:#ffffff;border: 1px solid #ef3aff}
                #Div-Pesq .H_Pesq::placeholder{color: #ffffff;opacity:0.5}
                #Lupa{top:8px; right:6px; width:17px; opacity:0.5}
                #Lupa:hover{opacity:1}
                .Pesq-Aa{top:8px; right:50px ; color:#ffffff} .Pesq-Aa.Atv{color:#00ff0d !important}
                .Pesq-A_{top:8px; right:30px ; color:#ffffff} .Pesq-A_.Atv{color:#00ff0d !important}
                .Pesq-Bj{top:8px; right:70px ; color:#ffffff} .Pesq-Bj.Atv{color:#00ff0d !important}
                @media(max-width:500px){#Div-Pesq{width:50%}}
            </style>
            <div id="Div-Pesq" class="Rltv w100 hov"></div><!--Pesquisa-->
            <script>
                function Load_Pesq(Typ){
                    return `<div class="pPesq Pesq_${Typ}" class="none">
                        <input class="w100 H_Pesq" placeholder="Pesquisar em ${N_Brev[Typ]}..." oninput="Pesq(this,'${Typ}')">
                        <a class="Abslt HOV Pesq-Aa" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">Aa</a>
                        <a class="Abslt HOV Pesq-A_" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">A]</a>
                        <a class="Abslt HOV Pesq-Bj" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">Bj</a>
                        <img id="Lupa" class="Abslt HOV" src="./SVG/Icon_Lupa.svg">
                    </div>`
                }
                Inn('#Div-Pesq',NavImg.map(Typ=>Load_Pesq(Typ)).join(''))
            </script>
        </div>

        <div id="DivNav"> <!--Nav-->
            <nav id="H_Nav" class="Ct"></nav>
            <script>
            function NAVPAG(e,Eu){ // Tudo que Acontece ao Navegar entre as P√°ginas
                NavPag(`#Pag_${e}`,Eu)
                Atual['Pag']=`#Pag_${e}`
                Rmv($$('.NavAtv',Pai(Eu)),'NavAtv') ; Add(Eu,'NavAtv')
                NavPesq(`.Pesq_${e}`)
                Load_Table(`${e}`)
            }
            Inn('#H_Nav',NavImg.map(e=>`<div id="HNVDv_${e}" class="Ct ppt HOV" onclick="NAVPAG('${e}',this)"><img draggable="false" src="./SVG/${e}.svg"><p>${N_Brev[e]}</p></div>`).join(''))</script>
        </div>  

        <div id="BdjLogin" class="Ct"> <!--Perfil-->
            <style>#Img-Perfil,#IMG-PerfiL{width:42px; height:42px; margin:4px 4px; top:3px}</style>
            <div id="Login-Top"  class="Ct LgTp2 none"  onclick="AbreLogin()"> Login </div>
            <div class="Rltv">
                <img id="LoginVazio" draggable="false" src="./Img/FundoLogo.png" class="ppt NObj" height="56px" top="0px"  onclick="AbreLogin()">
                <img id="IMG-PerfiL" draggable="false" src="./Img/LogOff.png"    class="Abslt NObj none"           onclick="AbreLogin()" oncontextmenu="ExieMais2($('#MAIS'),true)">
                <img id="Img-Perfil" draggable="false"                           class="ImgPerfil Abslt NObj none" onclick="ExieMais2($('#MAIS'),true)">
            </div>

            <style>
                .Body1 #H_Mais{top:55px; right:0px}
                .Body2 #H_Mais{bottom: 0%; left:170px}
                #MAIS{background:#4e4e4e; width:250px ; color:white}
                #MAIS div{padding:10px;cursor:pointer;font-size:15px; width:100%}
                #MAIS div:not(:last-child):hover{background:gray;color:var(--Txt-Wit-Hover)}
                #MAIS div:last-child{padding:10px}
                #MAIS img{height:25px;margin-right:10px}
                #MAIS p,#MAIS p a{font-size:10px}
            </style>

            <div id="H_Mais" class="Abslt none bndj">
                <div id="MAIS" class="Ct Pose">
                    <div class="Start" onclick="AbreLogin()">               <img draggable="false" src="./SVG/Mais_Troc.svg"><a> Trocar de Conta  </a></div>
                    <div class="Start" onclick="MdalShow('#EditarPerfil')"> <img draggable="false" src="./SVG/Mais_Edit.svg"><a> Editar Perfil    </a></div>
                    <div class="Start" onclick="MdalShow('#ConfigPag')">    <img draggable="false" src="./SVG/Mais_Cnfg.svg"><a> Configura√ß√µes    </a></div>
                    <div class="Start" onclick="MdalShow('#PagSUPORTE')">   <img draggable="false" src="./SVG/Mais_Help.svg"><a> Central de Ajuda </a></div>
                    <div class="Start" onclick="LogOff()">                  <img draggable="false" src="./SVG/Mais_LOff.svg"><a> Sair             </a></div>
                    <div><p>Confira os <a class="Link">Termos de Servi√ßo</a> e as <a class="Link">Pol√≠tica de Privacidade</a></p></div>
                </div>
            </div>
        </div>
        
        <div id="ALERT" class="Abslt rd none">
            <div class="Ct"><img draggable="false" src="./SVG/Plan.png" height="30px"><p style="margin-left: 5px;">Salvo com Sucesso</p></div>
            <span class="w100 Ct" style="height: 30px"></span>
        </div>
    </header>

    <div id="PAGES">
        <div id="Pag_PDDS" class="TBLAA none Cl">
            <div class="DivConf Ct Bt Stky">
                <button onclick="NovoPedido()">+ Novo Pedido</button>
                <button onclick="RfreshJson('PDDS')">Recolor</button>
                <h1>Tabela de Pedidos</h1>
                <div id="PagPesq_PDDS" class="Rltv PagPEsq" onload="Inn(this,Load_Pesq('PDDS'))"></div>
                <button onclick="IMGENS()">FiltSoIMG</button>
                <textarea style="background:gray" class="ppt rd h100"  onclick="Copy(this,`const DadosPDDS = ${JSON.stringify(J['PDDS'],null,2)}`)" readonly></textarea>
                <script>
                    const LrOrden=Typ=>Math.floor(MaxNum($$(H_Col_p(Typ,'Stts')).map(e=>Inn(e)))+1)
                    function NovoPedido(){AddROW('PDDS',{RG:AGORA(),OFF:1,Clnt:0,Data:'-',Stts:`${LrOrden('PDDS')}`}) /* AddROW('SERV',{ID:`${D.PDDS}|1`}) */ }
                </script>
                <button onclick="F_Clen('PDDS')">Limpar Filtro</button>
            </div>
            <style>#H_PDDS > tbody > tr > td:nth-child(1){width:0%;color:#4b4b4b}</style>
            <table id="H_PDDS" class="hMin">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PDDS),'PDDS'))"></tr></thead>
                <tbody></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.PDDS)[2],'PDDS'))"></tr></tfoot>
            </table>
        </div>

        <div id="Pag_SERV" class="TBLAA none Cl">
            <div class="DivConf Ct Bt Stky">
                <button onclick="RfreshJson('SERV')">Rfresh </button>

                <div onchange="Re_colrAll('SERV')">
                    <input id="SERV_Color" type="color">
                    <input id="SERV_tdCor" type="checkbox">
                    <input id="SERV_trCor" type="checkbox">
                </div>
                
                <div><!--Exibir cor coluna automaica-->
                    <input type="checkbox" checked onchange="Tog($$('#H_SERV .AutoComp'),'Cor')"><label>Auto</label>
                </div>
                <h1>Tabela de Servi√ßo</h1>
                <div id="PagPesq_SERV" class="Rltv PagPEsq" onload="Inn(this,Load_Pesq('SERV'))"></div>
                <div id="COnf_SERV" class="Configs Ct"></div><script>Inn($('#COnf_SERV'),Tm_Config('SERV'))</script>
                <button onclick="F_Clen('SERV')">Limpar Filtro</button>
            </div>
            <table id="H_SERV" class="hMin">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.SERV),'SERV'))"></tr></thead>
                <tbody></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.SERV)[2],'SERV'))"></tr></tfoot>
            </table>
        </div>

        <div id="Pag_PGMT" class="TBLAA none Cl">
            <div class="DivConf Ct Bt Stky">
                <button onclick="AddROW('PGMT')">Nova Linha +</button>
                <h1>Tabela de Pagamentos</h1>
                <div id="PagPesq_PGMT" class="Rltv PagPEsq" onload="Inn(this,Load_Pesq('PGMT'))"></div>
                <div id="COnf_PGMT" class="Configs Ct"></div><script>Inn($('#COnf_PGMT'),Tm_Config('PGMT'))</script>
                <button onclick="F_Clen('PGMT')">Limpar Filtro</button>
            </div>
            <table id="H_PGMT" class="hMin">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PGMT),'PGMT'))"></tr></thead>
                <tbody></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.PGMT)[2],'PGMT'))"></tr></tfoot>
            </table>

            <div class="Ct Bt">
            <div id="COnf_MPAG" class="Configs Ct"></div><script>Inn($('#COnf_MPAG'),Tm_Config('MPAG'))</script>
            <button onclick="F_Clen('MPAG')">Limpar Filtro</button>
            </div>
            <table id="H_MPAG" class="w100 hMax">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.MPAG),'MPAG'))"></tr></thead>
                <tbody></tbody>
            </table>

        </div>

        <div id="Pag_GRAD" class="TBLAA none Cl">

            <div class="DivConf Ct Bt Stky">
                <button onclick="RfreshJson('GRAD')">Rfresh</button>
                <button onclick="AddROW('GRAD')">Grad +</button>
                <button onclick="AddROW('OOSS')">OS +</button>
                <button onclick="AddROW('UBER')">Uber +</button>
                <div id="COnf_GRAD" class="Configs Ct"></div><script>Inn($('#COnf_GRAD'),Tm_Config('GRAD'))</script>
                <div id="COnf_OOSS" class="Configs Ct"></div><script>Inn($('#COnf_OOSS'),Tm_Config('OOSS'))</script>
                <div id="COnf_UBER" class="Configs Ct"></div><script>Inn($('#COnf_UBER'),Tm_Config('UBER'))</script>
                <button onclick="MudarFormatBndj1('GRAD')">Bndj1</button>
                <button onclick="MudarFormatBndj2('GRAD')">Bndj2</button>
            </div>
            <table id="H_GRAD" class="w100 hMax">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.GRAD),'GRAD'))"></tr></thead>
                <tbody></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.GRAD)[2],'GRAD'))"></tr></tfoot>
            </table>
            <table id="H_OOSS" class="w100 hMax">
                <thead class="Stky" style="top: 60px;z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.OOSS),'OOSS'))"></tr></thead>
                <tbody></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.OOSS)[2],'OOSS'))"></tr></tfoot>
            </table>
            <table id="H_UBER" class="w100 hMax">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.UBER),'UBER'))"></tr></thead>
                <tbody></tbody>
                <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ExtObj(BS.UBER)[2],'UBER'))"></tr></tfoot>
            </table>
            
        </div>

        <div id="Pag_CLNT" class="TBLAA none Cl">
            <div class="DivConf Ct Bt Stky">
                <button onclick="AddROW('CLNT')">+ Nova Linha</button>
                <h1>Tabela de Pagamentos</h1>
                <div id="PagPesq_CLNT" class="Rltv PagPEsq" onload="Inn(this,Load_Pesq('CLNT'))"></div>
                <button onclick="F_Clen('CLNT')">Limpar Filtro</button>
            </div>
            <table id="H_CLNT" class="hMin">
                <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.CLNT)))"></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <div id="Pag_LOJA" class=" none Cl">
            <style>
                #Pag_LOJA img {width: 50%;margin: 15px}
            </style>
            <!--
            <img src="./Fotos/001_Camisa.webp">
            <img src="./Fotos/002_Cal√£o.webp">
            <img src="./Fotos/003_WindFlag.webp">
            <img src="./Fotos/004_Cart√£o.webp">
            <img src="./Fotos/005_Panfleto.webp">
            <img src="./Fotos/005_Panfleto.webp">
            <img src="./Fotos/006_Tal√£o 2.webp"> -->

            <div id="DivListaKits"></div>
            <script>
                $('#DivListaKits')
            </script>

            <input type="file" id="svgInput" accept=".svg">
            <input id="SVGLarg" type="text" placeholder="Largura"><input id="SvgAlt" type="text" placeholder="Altura"><input id="SvgQnt" type="text" placeholder="Qnt">
            <div id="RsultsImgSvg"></div>
            <p id="resultadoSVG"></p>

            <script> // Render SVG

                function contarNos(d) {
                const comandos = d.match(/[a-zA-Z]|-?\d*\.?\d+/g);
                if (!comandos) return 0;

                let totalNos = 0;
                let i = 0;

                while (i < comandos.length) {
                    const cmd = comandos[i++].toUpperCase();

                    switch (cmd) {
                    case 'M':
                    case 'L':
                    case 'T':
                        while (i + 1 < comandos.length && !isNaN(Number(comandos[i])) && !isNaN(Number(comandos[i + 1]))) {
                        totalNos++;
                        i += 2;
                        }
                        break;

                    case 'H':
                    case 'V':
                        while (i < comandos.length && !isNaN(Number(comandos[i]))) {
                        totalNos++;
                        i++;
                        }
                        break;

                    case 'C':
                        while (i + 5 < comandos.length) {
                        totalNos++; // conta s√≥ o ponto final
                        i += 6;
                        }
                        break;

                    case 'S':
                    case 'Q':
                        while (i + 3 < comandos.length) {
                        totalNos++;
                        i += 4;
                        }
                        break;

                    case 'A':
                        while (i + 6 < comandos.length) {
                        totalNos++;
                        i += 7;
                        }
                        break;

                    case 'Z':
                        // n√£o conta n√≥
                        break;

                    default:
                        if (!isNaN(Number(cmd))) {
                        i++;
                        }
                    }
                }

                return totalNos;
                }


                const ContPoly=p=>p?Math.floor(p.trim().split(/[\s,]+/).length/2):0

                $('#svgInput').addEventListener('change',function(event){
                  const file = event.target.files[0]
                  if (!file) {return}

                  const reader = new FileReader()
                  reader.onload = function (e) {
                    const svgText = e.target.result
                    const parser = new DOMParser()
                    const svgDoc = parser.parseFromString(svgText, "image/svg+xml")

                    let totalNosPath = 0 ; let totalNosPoly = 0
                    $$('path'   ,svgDoc).forEach(path=>{totalNosPath += contarNos(path.getAttribute('d'     )||'')}) // Conta <path>
                    $$('polygon',svgDoc).forEach(poly=>{totalNosPoly += ContPoly( poly.getAttribute('points')||'')}) // Conta <polygon>

                    const Qnt = svgText.length
                    const qtdVirgulas = (svgText.match(/,/g) || []).length;
                    const valor = Num($('#SVGLarg').value) * Num($('#SvgAlt').value) * Num($('#SvgQnt').value) * 100
                    const TotalNos = totalNosPath+totalNosPoly
                    const Porcent = (TotalNos/100)*1.7
                    $('#resultadoSVG').textContent = `${TotalNos} N√≥s, R$ ${Cm(valor+(valor*Porcent))} - Porcent ${valor*Porcent}`
                    $('#RsultsImgSvg').innerHTML = svgText
                  }

                  reader.readAsText(file)
                })
            </script>
        </div>

        <div id="Pag_GBRT" class=" none Ct" style="overflow: hidden">
            <!--
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
            -->
            <style> /*CSS da Aba de Config*/
                #Config svg {cursor: pointer}
                #Config .fil0{fill: #ff7300; width: 20px; margin: 5px; height: 20px}
                #Config .fil0:hover {transform: scale(1.1)}
                #Config .fil0:active{transform: scale(1.05)}
                #Config .fil1{fill:#ff000000; width: 25px;height: 25px}
                #Config .Cor1{fill: #ff4800}
                #Config .Cor2{fill: purple}

                #DivCnvs{width:75% ; height:100% ; overflow-y:auto ; padding-top: 70px;}
                #Config {width:25% ; height:100% ; overflow-y:auto}
                #Config > div {background:#50505025; border-radius:15px; margin:3px; width:97%; padding:20px}
                #Config input[type="range"]{width:50%}
                #IconsCofng{top:-10px; right:-10px}
                #CropedID{top:5px; right:5px}
                .Close{border-radius:5px; background:#ff3232; padding:1px; width:16px; height:16px; opacity: 0;top: 0; right: 0}
                .Moldura{padding: 2px;border: 1px solid #ff480000}
                .ConfigTxt canvas{margin:3px}
                .ConfigTxt label {margin:2px}
            </style>

            <script> // Const Apenas para GABARITO
                const OBJOBJ=[
                    [{id:'C_PP'  ,W:'1333',H:'1956'},{id:'F_PP'  ,W:'1333',H:'1899'},],
                    [{id:'C_P'   ,W:'1503',H:'2211'},{id:'F_P'   ,W:'1503',H:'2154'},],
                    [{id:'C_M'   ,W:'1559',H:'2353'},{id:'F_M'   ,W:'1559',H:'2296'},],
                    [{id:'C_G'   ,W:'1701',H:'2466'},{id:'F_G'   ,W:'1701',H:'2381'},],
                    [{id:'C_GG'  ,W:'1815',H:'2504'},{id:'F_GG'  ,W:'1815',H:'2468'},],
                    [{id:'C_XG'  ,W:'2041',H:'2565'},{id:'F_XG'  ,W:'2041',H:'2560'},],
                    [{id:'C_XXGG',W:'2239',H:'2749'},{id:'F_XXGG',W:'2239',H:'2743'},],
                ]

                let ObjCanvs = []
                const ObjFundo = {F:'',V:''}
            </script>

            <script>
            // Biblioteca dos GBRT
                const PrcAryObj=(e,Stg)=>e.find(E=>E.tamn===Stg)?.qnt || 'nada'
                function Centlizar(e){e.value = 50}
                const SplitFundo =e=>/costa|c\b/i.test(e)?'C':'F'
            // Fun√ß√µes Pequenas GABARITO
                function Mdal_Area(e){ShowModal($(FMdal),'#Mdal-Area') ;  $(e).value = '' ; Foco(e)}
                function Limpar(){$$('#Lista-001 tbody tr:not(:first-child)').forEach(e=>e.remove()) ; Clen_Alls($('#Lista-001 tbody tr:first-child'))}
                function LimpObj(){ObjCanvs = []}
                function AddRoW(){const newRow = $('#Lista-001 tbody tr:last-child').cloneNode(true) ; Clen_Alls(newRow) ; $('#Lista-001 tbody').appendChild(newRow)}
            // Fun√ß√µes Grandes GABARITO
                function Upload(div,srcList){ // depois mudar de inner pra append pois inner ta subistituindo
                    const btnX = `<div class="Ct Abslt Close Opacy" onclick="Pai(this).remove();Read_Obj_Img()">X</div>`
                    $(div).innerHTML = srcList.map((src,x)=>`<div id="ImgDrop${x}" class="DivImgRsut Ct Rltv">${btnX}<img src="${src}" ondragstart="Drag2()"></div>`).join('')
                    $$(`${div} img`).forEach(img=>{img.onload=()=>{if(img.naturalWidth>img.naturalHeight){Add(img,'Larg')}else{Add(img,'Alt')}}})
                    Read_Obj_Img()
                }  
                async function ColarTudo(inpt){
                    const valor = await navigator.clipboard.readText()
                    if(!valor.match(/\n/g)&& valor.match(/\t/g)){Read_Ipt_Lin(inpt,valor) ; return}
                    if(!valor.match(/\n/g)&&!valor.match(/\t/g)){return}
                    $('#Area').value = valor ; Read_Obj_Area('#Area',inpt)
                }
            </script>

            <script> // Read OBJ area img inpt
                function Read_Obj_Area(Area,inpt){ // Atualiza Objeto Baseado na Area     // Depois tentar para Sincronizar
                    ObjCanvs.splice(IdxDe(Avo(inpt)))
                    $(Area).value.split('\n').map(match=>{
                    const {Nome,Tamn,Qnt} = SplitAvanc(match)
                    ObjCanvs.push({qnt:Qnt, tamn:Tamn, nome:Nome,src:'',Orgn:''})
                    })
                    Read_Ipt_Obj()
                }

                function Read_Obj_Img(imgs){       // Atualiza Objetos Baseado nas Imagens (Fundo e Nomes) // Depois tentar Sincronizar
                    ObjFundo['F'] = $('#DropsF img')?.src || ''
                    ObjFundo['V'] = $('#DropsV img')?.src || ''
                    
                    console.log('OBJ_IMG',ObjFundo)
                    /*
                    if(Imgss.length==0){Imgss.map(e=>{
                            const {Nome,Qnt,Tamn} = SplitAvanc(e.name)
                            ObjCanvs.push({qnt:Qnt,tamn:Tamn,nome:Nome,Orgn:'Imgs',src:e.src})});Read_Ipt_Obj()
                    }
                    */
                }
                
                function Read_Ipt_Obj(){           // Atualiza Inputs Baseado no Objeto
                    None(FMdal)
                    Limpar()
                    ObjCanvs.forEach((i,x)=>{
                        if(x>0){AddRoW()}
                        const lastRow = $('#Lista-001 tbody tr:last-child')
                        $('.qnt',lastRow).value = i.qnt
                        $('.tamn',lastRow).value = i.tamn
                        $('.nome',lastRow).value = i.nome
                        $('.td-Src',lastRow).innerHTML = i.src
                        $('.td-Org',lastRow).innerHTML = i.Orgn
                    })
                }
                
                function Read_Ipt_Lin(inpt,obj){   // Atualiza Inputs Baseado no CntrlV Unico
                    const {Nome,Tamn,Qnt} = SplitAvanc(obj)
                    const RowAtual = $('#Lista-001').rows[IdxDe(Avo(inpt))+1]
                    $('.qnt',RowAtual).value = Qnt
                    $('.tamn',RowAtual).value = Tamn
                    $('.nome',RowAtual).value = Nome
                    $('.td-Src',RowAtual).innerHTML = ''
                    $('.td-Org',RowAtual).innerHTML = ''
                    
                }

                function Read_Obj_Ipt(){           // Atualiza Objeto Baseado no Inputs
                    ObjCanvs = []
                    $$('#Lista-001 tbody tr').map(e=>{
                        const qnt  = $('.qnt',e).value
                        const tamn = $('.tamn',e).value
                        const nome = $('.nome',e).value
                        const src  = $('.td-Src',e).innerHTML
                        const org  = $('.td-Org',e).innerHTML

                        ObjCanvs.push({qnt:Number(qnt),tamn,nome,src,org})

                    //if(qnt&&tamn&&nome){console.log('tem tudo');}else{}
                    })
                    console.log('Objeto Atualizado',ObjCanvs)
                }
            </script>

            <div id="Config" class="Cl"> <!--CONFIGURA√á√ïES-->
                <div class="Ct">           <!--NOME DO PEDIDO-->
                    <div><input id="NomeCliente" type="text" placeholder="Nome do Pedido"></div>
                </div>

                <div class="Ct Rltv">      <!--CONFIGURA√á√ïES DE TAMANHO-->
                    <div id="CropedID" class="Ct DivCrop Abslt"> <!--Da pra Simplificar isso pra um Unico SVG-->
                        <div onclick="$('#Crop').click()" id="CropSvg" onload="Inn(this,IcoCrop('fil0','Opacy'))"></div>
                        <input id="Crop" type="checkbox" class="none" onchange="Tog('.Croped','Opacy');Read_Canvs()">
                    </div>
      
                    <div class="w100"> <!--Aqui √© o Controlador de Posi√ß√µes-->
                        <img src="./Testes/Tudi.jpg" height="150px">                          
                    </div> 
                    
                    <div class="controls">
                        <div class="w100">
                            <div class="Ct"><label>Tamanho</label><input type="range" id="size" min="0" max="150" value="50" oninput="Read_Canvs()"></div>
                            <div class="Ct"><label>Largura</label><input type="range" id="left" min="0" max="150" value="50" oninput="Read_Canvs()"><Button class="btnX" onclick="Centlizar($('#left'));Read_Canvs()">X</Button></div>
                            <div class="Ct"><label>Alturaa</label><input type="range" id="top"  min="0" max="150" value="50" oninput="Read_Canvs()"><Button class="btnY" onclick="Centlizar($('#top' ));Read_Canvs()">Y</Button></div>
                        </div>
                    </div>
                </div>

                <div class="ConfigTxt Ct"> <!--CONFIGURA√á√ïES DE TEXTO-->
                    <div class="Ct w100"><label>Sombra:   </label><input class="w30" id="shadowColor"   type="color" value="#000000"> <input class="w30" id="shadowBlur"   type="number" value="10" oninput="Read_Canvs()"></div>
                    <hr class="w100">
                    <div class="Ct w100"><label>Contorno: </label><input class="w20" id="outlineColor"  type="color" value="#FFFFFF"> <input id="outlineWidth" type="range" value="2" min="1" max="10" step="0.2" oninput="Read_Canvs()"></div>
                    <hr class="w100">
                    <div class="Ct w100">
                        <div class="Ct"><label class="ppt" id="TypeColor" onclick="InnTogg(this,'Cor:','Degrad√™:');Tog($$('.inptcolor1,.inptcolor2'),'none')">Degrad√™:</label></div>
                        <div class="Ct w30 none inptcolor1">
                            <input id="FontColor" type="color" value="#000000" oninput="Read_Canvs()">
                        </div>
                        <div class="Ct inptcolor2">
                            <canvas id="controlCanvas" class="Rd Moldura ClickCanv FOC" width="70" height="70"></canvas>
                            <input class="Opacy noClk" type="color" id="colorPicker1" style="display: none;">
                            <input class="Opacy noClk" type="color" id="colorPicker2" style="display: none;">
                            <div class="Cl">
                                <div class="ClickCanv" id="alignX" onload="Inn(this,IconAling('fil1'    ,'white','white'))">X</div>
                                <div class="ClickCanv" id="alignY" onload="Inn(this,IconAling('fil1 g90','white','white'))">Y</div>
                            </div>
                        </div>
                    </div>
                    <hr class="w100">
                    <div class="Ct w100"><label>Fonte:</label><select class="w50" id="fontFamily" onchange="CssFont('#fontFamily',this.value);Read_Canvs()"></select><script>load_OptsFnt($('#fontFamily'),KitFonts)</script></div>
                </div>

                <div class="Ct">           <!--ABA DE LISTAS-->
                    <div class="Cl Rltv">
                        <button onclick="Mdal_Area('#Area')">Editar Inputs</button>

                        <div id="IconsCofng" class="Ct Abslt">
                            <div onload="Inn(this,IcoMais('fil0'))" onclick="AddRoW()"          ></div>
                            <div onload="Inn(this,IcoClen('fil0'))" onclick="Limpar();LimpObj()"></div>
                        </div>

                        <table id="Lista-001">
                            <thead><tr><th class="w60">Nome</th><th class="w20">Tamnh</th><th class="w20">Qnt</th></tr></thead>
                            <tbody>
                                <tr>
                                    <td class="w60"><input  class="w90 nome" type="text"   placeholder="Nome" oninput="Rmv(this,'Error')" onchange="Read_Obj_Ipt()" onpaste="ColarTudo(this)" autocomplete="off"></td>
                                    <td class="w20"><select class="w90 tamn" onchange="Read_Obj_Ipt()"></select><script>load_Opts($('#Lista-001 .tamn'),O['Cams'])</script></td>
                                    <td class="w20"><input  class="w90 qnt"  type="number" placeholder="Qnt"  oninput="Rmv(this,'Error')" onchange="Read_Obj_Ipt()" autocomplete="off"></td>
                                    <td><div class="td-Src none"></div></td>
                                    <td><div class="td-Org none"></div></td>
                                </tr>
                            </tbody>
                        </table>


                    </div>
                </div>
            </div>

            <div id="DivCnvs" class="Ct"> <!--√ÅREA DE EXIBI√á√ÉO CANVAS-->
                <style>
                    .DropZone{background:#50505023; padding:10px; border-radius:15px}
                    .DropZone .DivImgRsut{cursor: move; border:1px solid #ffffff2a; padding:2px; width:50px; height:50px}
                    .DropZone img.Larg{width:100%; height:auto}
                    .DropZone img.Alt {width:auto; height:100%}
                    .DivImgRsut:hover .Close{opacity:1}

                    .CanvBox{width: 380px;height: 350px; margin-top: 10px}
                    .CanvBox canvas {background:#505050;margin:5px}
                    .CanvBox canvas{width: 40%}
                </style>
                <div class="w100" onload="Inn(this,IptFile('#DropIMG'))"></div>
                <div class="Ct w100" style="margin-top:30px">
                    <div class="Cl"><label>Drop  </label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropIMG"></div></div>
                    <div class="Cl"><label>Frente</label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsF"></div></div>
                    <div class="Cl"><label>Costas</label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsV"></div></div>
                    <div class="Cl"><label>Manga </label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsM"></div></div>
                    <div class="Cl"><label>Nomes </label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsN"></div></div>
                </div>                   
                <div id="AllCanvas" class="Ct"></div>
                <canvas id="gradientCanvas" width="400" height="400"></canvas>
                <div id="Rodape" class="w100"></div>
            </div>

            <div id="FinaisCnvs" class="Ct Fx"> <!--CONFIRMA√á√ïES FINAIS-->
                <style>
                    #FinaisCnvs{left:45%; top:83vh; background:#1f1824f1; height:100px; width:500px; -webkit-backdrop-filter:blur(5px) ; backdrop-filter:blur(5px); border-radius: 255px}
                    #FinaisCnvs{border: 2px solid #2e2e2e96}
                </style>
                <button onclick="Load_Cnvs('#AllCanvas')">Carregar Canvas</button>
            </div>

            <script>     
                LoadDegade($('#controlCanvas'))   
                const FMdal = $('#FModal')

                document.addEventListener('click',e=>{const Div = e.target
                    Rmv('.Moldura','Atv')
                    if(S(Div).Coten('ClickCanv')||Div.closest('.ClickCanv')){ATV('.Moldura.ClickCanv')}
                    else{DTV('.Moldura.ClickCanv')}
                })
                // Atalhos C e E
                document.addEventListener('keydown',e=>{
                    if($('.Moldura.ClickCanv.Atv')){
                        if(e.key==='c'){$('#alignX').click()}
                        if(e.key==='e'){$('#alignY').click()}
                    }
                })    
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________________________________________________________
            </script>
        </div>

        <div id="Pag_ORC" class="none Cl">
            <script>
                const INgeral = performance.now()
            </script>
            <div> 
                <input id="PesqPROD" type="text" oninput="Pesq(this,'ORC')" placeholder="Pesquisar Produto..."> <!--Pesquisa PROD-->
            </div>

            <div class="Ct w90"> <!--IMAGENS dos PRODUTOS-->
                <style>
                    #Div-Prod          {margin-bottom:30px; overflow-x:scroll; flex-wrap:nowrap;height: 360px; width: 100%;}
                    #Div-Prod > div    {margin:9px 4px; display:flex; flex-direction:column}
                    #Div-Prod span     {margin-left:10px; margin-bottom:10px}
                    #Div-Prod span p   {margin:0px; font-size:9px}
                    #Div-Prod span p strong  {font-size:9px}
                    #Div-Prod span img {margin:5px; height:30px; width:30px}
                    #Div-Prod span h3, #Div-Prod span h3 strong  {font-size:19px}
                    #Div-Prod .DivVrnts{margin-top:20px}

                    #Div-Prod .Opts               {top:45px; width:100%; height:30px; left:4px}
                    #Div-Prod .Opts img           {height:23px; width:23px; margin:3px 7px}
                    #Div-Prod .Opts div           {bottom:0; height:30px; width:50%; transition:all 0.1s ease-in-out; color: #000000;}
                        #Div-Prod .Opts div.Pre   {border-radius: 20px 0px 0 0 !important ; background:linear-gradient(to left,#bdb5be,#ffffff)}
                        #Div-Prod .Opts div.Pos   {border-radius: 0px 20px 0 0 !important ; background:linear-gradient(to right, #bdb5be,#ffffff)}
                        #Div-Prod .Opts div:hover {height: 35px ; border-radius: 20px 20px 0 0 !important}
                        #Div-Prod .Opts div.Atv   {z-index: 99 !important; border-radius: 20px 20px 0 0 !important ; box-shadow: -5px 0 10px #3c363f59, 5px 0 10px #3c363f59 ;  background:linear-gradient(to right,#ffffff,#ffffff)} /*background:white;  era pra ter background mas ele ta fazendo Piscar, ai tirei*/ 

                    #Div-Prod .Conteudo{padding-top:10px; z-index:999}
                    #Div-Prod .Conteudo,.offf{height:240px ; width:200px; margin:4px ; padding-bottom:15px; border-radius: 0px 0px 20px 20px ;background:linear-gradient(to top,#b3b3b3,#ffffff); color:#575757;}
                    .offf{ top: 40px; background: #808080d7; color: #ffffff;font-size: 20px;}
                    #Div-Prod .Conteudo .fotO{height:160px; width:150px}
                    .tec2 { z-index: 999; top: 310px; left: 20%; width: 60%; }
                </style>
                <div id="Div-Prod" class="Start"></div>
                <script>
                    function ShowVrnts(e){$$('.DivVrnts > div',Avo(e)).forEach((E,x)=>{
                        $$('div',Pai(e)).forEach((B,x,l)=>{
                            Rmv(B,'Atv')

                            if(x < IdxDe(e)){
                                Add(B,'Pre');Rmv(B,'Pos')
                                B.style.zIndex = (l.length+x) - IdxDe(e)+10
                            }else{
                                Add(B,'Pos');Rmv(B,'Pre')
                                B.style.zIndex = (l.length-x) + IdxDe(e)+10
                            }
                        })
                        Add(e,'Atv')
                        if(x===IdxDe(e)){Show(E)}else{None(E)}
                    })}

                    function tmplt_Prod(e){ //GRANDE
                        const Fora = ListaFora.includes(e)
                        return `<div class="Rltv Start2">
                            <span class="Start"><img src="${Fora?'./SVG/placeholder.svg':`./Prod/IconProd/${e}.svg`}"><div class="Start2"><h3 class="rgx">${e}</h3><p class="rgx">${Prod[e].Desc}</p></div></span>
                            <div class="KeyInn none">...</div>

                                <div class="Ct w100 Opts Abslt">${
                                    Vari(e).map((vv,x,l)=>{
                                        const pose = `left:${(x*(200/l.length))-(x===0?0:15)}px;`
                                        const Larg = `width:${(200/l.length)+15}px;`
                                        const Zidx = `z-index:${(l.length-x)+10};`
                                        return `<div style="${pose+Larg+Zidx}" onclick="ShowVrnts(this)" class="Ct Abslt ppt Pos ${x===0?'Atv':''}"><a class="none rgx">${vv}</a> <img name="${vv}" src="${Fora?'./SVG/placeholder.svg':`./Prod/IconProd/${e}_${vv}.svg`}"></div>`
                                }).join('')}</div>

                            <div class="Ct DivVrnts">
                            ${Vari(e).map((V,x)=>{ const OBJ = Prod[e].Variantes[V]
                                return `<div class="Conteudo Cl ${x===0?'':'none'}">
                                            ${Prod[e].Stts==="Offff"?`<div class="Ct Abslt offf">Indispon√≠vel no momento...</div>`:''}
                                            <div class="KeyVariants rgx">${V}</div>
                                            <img class="fotO" src="${Fora?'./SVG/placeholder.svg':`./Prod/${e}_${V}.webp`}" onclick="MdalShow('#Mdal-Prod')">
                                            <div class="Ct w100 ${OBJ.Calc==="QNT" || OBJ.Calc==="OFS"?'none':''}">${''}</div>
                                            <div class="Ct">${RS_HTML(OBJ.Valr)}</div>
                                            <div class="rgx none">${(HotKy[e] || []).map(e => e).join(',')}</div>
                                            <div class="RsutProduto w100 Ev">${/*OBJ.Valr.map((e,idx)=>{return tmplt_VlrTtl(OBJ.Valor[idx],e)}).join('')*/''}</div>
                                            <img class="Abslt tec2 HOV" onclick="Carrinho('${e}','${V}')" src="./SVG/Adicionar.svg">
                                </div>`
                            }).join('')}
                            </div>
                        </div>`
                    }

                    function ReOrdenar(){ //  GRANDE
                        $('#Div-Prod').innerHTML = ''
                        AllProd.forEach(e=>{$('#Div-Prod').innerHTML+=tmplt_Prod(e)})
                    }ReOrdenar()

                    function Carrinho(serv,tipo){
                        const ult = $$('#ORC .OrcAdd').slice(-1)[0]
                        DispClick(ult)
                        SERV = $$('#ORC .OrcServ').slice(-1)[0]
                        SERV.value = serv
                        SERVChang(SERV)
                        // Delay(0.2)
                        TIPO = $$('#ORC .OrcTipo').slice(-1)[0]
                        TIPO.value = tipo
                        TIPOChang(TIPO)
                    }
                                    
                </script>
            </div>
            
            <div id="NovoForm" class="Cl w90 Rltv Rd" style="background:#ffffff0a;padding:10px">

                <div id="CONFIG" class="Abslt" style="right:10px;top:10px"> <!--CONFIGURA√á√ïES-->
                    <img draggable="false" src="./SVG/CONFIG.svg" class="NObj" style="width:20px;opacity:0.2" onclick="TogShow($('#CONFIG_Bdj'))">
                    <script>
                        function Hdd_Cblh(Valid){if(Valid){Add($$(`#ORC thead`),'none')}else{Rmv($$(`#ORC thead`),'none')}}
                        function Hdd_Cust(){Tog($$(`[class^="ORC_CUST_"]`),'none')}
                        function Hdd_Crct(){Tog($$(`[class^="ORC_CRCT_"]`),'none')}
                        document.addEventListener("keydown",function(e){if(e.key==="'"){e.preventDefault();Hdd_Cust()}})
                    </script>
                    <style>#CONFIG_Bdj{width: 150px; right: 0px; background: #363636; padding: 10px}</style>
                    <div id="CONFIG_Bdj" class="Abslt none Start2 bndj">
                        <div class="Ct"><input id="Hdd-Cbclh" class="GETConfig" type="checkbox" onchange="Hdd_Cblh(this.checked)" onclick="SaveConfig(this)"><label>Exibir Cabe√ßalho</label></div>
                        <div class="Ct"><input type="checkbox" onchange="Hdd_Cust()"><label>Exibir Custo</label></div>
                        <div class="Ct"><input type="checkbox" onchange="Hdd_Crct()"><label>Exibir Crescente</label></div>
                    </div>
                </div>

                <script> // Templates e A√ß√µes para Tabela de Or√ßamento
                    // Biblioteca
                        const cla = `[class^="ORC_CUST_"],[class^="ORC_CRCT_"],[class^="ORC_RSUT_"]`
                        const AddTrue=(e,Clss,True)=>$$(cla).forEach(e=>{if(True(e)){Add(e,Clss)}else{Rmv(e,Clss)}})
                        const InNa_RS=(e,val)=>{Inn(e,Tm_RS(val)) ; Nm(e,val)}
                        const ClrSlct=(arry)=>arry.forEach(e=>e.selectedIndex=0) // Deixar Junto com o Clear e Levar pra Biblioteca const Clear = e=>[e].flat().forEach(el=>$(el).value='')
                        
                    // Templates
                        const Tm_ORC_Th=ary=>ary.map(e=>`<th class="${e==''?'':'O_Tx'}">${e==''?'':`<a>${e}</a><p>${D_brev[e]}</p>`}</th>`).join('')
                        const Tm_RmvAll=()=>Inn($('#ORC thead th:nth-child(1 )'),`<div class="ppt HOV O_All" onclick="RmvAll()">‚ùå</div>`)
                        const Tm_ClrAll=()=>Inn($('#ORC thead th:nth-child(10)'),`<div class="ppt HOV O_All" onclick="ClrAll()">üßπ</div>`)
                        const Tm_Total=E=>[`CUST_${E} none`,`CRCT_${E} none`,`RSUT_${E}`].map(e=>`<div class="ORC_${e}" name="0">${Tm_RS(0)}</div>`).join('')
                    // A√ß√µes
                        function Check_W_Pag(){
                            if(window.innerWidth<=650){$$('#ORC .O_Tx').forEach(th=>Show($('a',th),$('p',th)))}
                            if(window.innerWidth> 650){$$('#ORC .O_Tx').forEach(th=>Show($('p',th),$('a',th)))}
                        }
                        const RecolorVlr=()=>AddTrue($$(cla),'Branc',(e)=>Nm(e)==0)
                        const Zerar=tr=>$$(cla,tr).forEach(e=>InNa_RS(e,0))
                        const AddRow=tr=>{const a = tr.cloneNode(true) ; $$('input',a).forEach(e=>e.value='') ; Zerar(a) ; Insert(Pai(tr)).After(a,tr)}
                    // Clean e Remove
                        const RmvAll=()=>{$$(`#ORC tbody td:nth-child(1 ) > div`).forEach((E,X)=>{if(X==0){return}else{DispClick(E)}}) ; ReloadTotal()}
                        const ClrAll=()=>{$$(`#ORC tbody td:nth-child(10) > div`).forEach(E=>DispClick(E)) ; ReloadTotal()}
                        const ClrRow=tr=>{Clear($$('input',tr)) ; ClrSlct($$('select',tr)) ; Zerar(tr)}
                        const RmvRow=tr=>tr.remove()
                    
                    // Objetivo aqui √© remover o Tamanho dessas Strings (Principalmente os Querys)
                </script>
                <style>  /*CSS da Tabela de Or√ßamento*/
                    #ORC input,#ORC select{width:100% !important ; margin:0}
                    #ORC .RS{font-size:7px}
                    #ORC td{padding: 1px}
                    #ORC th a,#ORC th p{display: flex;align-items: center;justify-content: center;}
                    .Branc{color: #ffffff5d !important}
                    .imita{height: 30px !important; background: #ffffff11}
                    .Final a{font-size:20px ; font-family:var(--Medi)}
                    .Final .RS{margin-right:3px}
                    .sOFF{opacity:0.3}
                    [class^="ORC_CUST_"]{color:#ff6565}
                    [class^="ORC_CRCT_"]{color:#65b5ff}
                    [class^="ORC_RSUT_"]{color:#48ff00}
                </style>

                <table id="ORC" class="w90" onkeydown="HandArrow(this,event)">
                    <thead class="none"><tr onload="Inn(this,Tm_ORC_Th(['','','Serv','Tipo','Lrg','Alt','Qnt','Und','SbTt','']));Tm_RmvAll();Tm_ClrAll()"></tr></thead>
                    <tbody>
                        <tr class="TrRow" oninput="ORC_Calc(this);RecolorVlr()" onchange="ValidOpts()">
                            <td width="15px" style="fill:#ff0000"><div class="ppt OrcRmv" onclick="RmvRow(_tr(this));Rload_Tbl('#ORC');ReloadTotal()" onload="Inn(this,SVG.Fexa)"></div></td><!--‚ùå-->
                            <td width="15px" style="fill:#ffa500"><div class="ppt OrcAdd" onclick="AddRow(_tr(this));Rload_Tbl('#ORC');ReloadTotal()" onload="Inn(this,SVG.Mais)"></div></td><!--‚ûï-->
                            <td><select class="OrcServ" onchange="SERVChang(this)" onload="Inn(this,Tm_OptsGraff(['Servi√ßos',...AllProd]))"></select></td>
                            <td><select class="OrcTipo" onchange="TIPOChang(this)" onload="Inn(this,Tm_Opts(['Tipo']))"></select></td>
                            <td width="10%">
                                <select class="OrcCbmt none" onchange="CBMTChang(this)" onload="Inn(this,Tm_Opts(['Acabamento']))"></select>
                                <input class="ORC_INPT_Lrg" placeholder="Largura" oninput="MaskNum(this)">
                            </td>
                            <td width="10%">
                                <select class="OrcGram none" onchange="GRAMChang(this)" onload="Inn(this,Tm_Opts(['Gramatura']))"></select>
                                <input class="ORC_INPT_Alt" placeholder="Altura" oninput="MaskNum(this)">
                            </td>
                            <td width="10%">
                                <select class="OrcQntt none" onchange="QNTTChang(this)" onload="Inn(this,Tm_Opts(['Qnt']))"></select>
                                <input class="ORC_INPT_Qnt" placeholder="Quantidade">
                            </td>
                            <td width="10%"  onload="Inn(this,Tm_Total('Vund' ))" class="imita RD"></td>
                            <td width="10%"  onload="Inn(this,Tm_Total('SbTt' ))" class="imita RD"></td>
                            <td width="15px" style="fill:#ffa500"><div class="ppt OrcClr" onclick="ClrRow(_tr(this));Rload_Tbl('#ORC');ReloadTotal()" onload="Inn(this,SVG.Cler)"></div></td><!--üßπ-->
                        </tr>
                    </tbody>
                </table>

                <script> // Fun√ß√µes do Tbody
                    function SERVChang(e){const Lista = ObjKey(Prod[e.value].Variantes);Inn($('.OrcTipo',_tr(e)),Tm_Opts(['Tipo',...Lista])) ; Tog_M2_OFS_UND(e)}
                    function TIPOChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;Inn($('.OrcCbmt',_tr(e)),Tm_Opts(['Acabamento',...Uniq(Lista.map(e=>e[0]))]))}
                    function CBMTChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;Inn($('.OrcGram',_tr(e)),Tm_Opts(['Acabamento',...Uniq(Lista.map(e=>e[1]))]))}
                    function GRAMChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;Inn($('.OrcQntt',_tr(e)),Tm_Opts(['Acabamento',...Uniq(Lista.map(e=>e[2])[0].map(e=>e[0]))]))}
                    function QNTTChang(e){const Lista = Prod[$('.OrcServ',_tr(e)).value].Variantes[$('.OrcTipo',_tr(e)).value].Table;ORC_Calc(_tr(e),Lista)}

                    function ORC_Calc(tr,Lista=null){
                        const TotalCress=(Valr,e)=>Math.round(e*(Valr+Valr*Crecent(e)))

                        const Serv = $('.OrcServ',tr).value
                        const Tipo = $('.OrcTipo',tr).value
                        const Cbmt = $('.OrcCbmt',tr).value
                        const Gram = $('.OrcGram',tr).value
                        const Qntt = $('.OrcQntt',tr).value
                        const Lrg = Num($('.ORC_INPT_Lrg',tr).value)
                        const Alt = Num($('.ORC_INPT_Alt',tr).value)
                        const Qnt = Num($('.ORC_INPT_Qnt',tr).value)

                        const Calc = Prod[Serv].Calc
                        const M2 = Prod[Serv]['Variantes'][Tipo]
                        const QNT = Num(Qntt.replace('.',''))

                        let F_Cust = 0
                        let F_Valr = 0
                        // S√≥ pra OFS
                        if(Calc=='OFS'){
                            const filt   = Lista.filter(e=>e[0]===Cbmt && e[1]===Gram)
                            const filt2  = filt [0][2].filter(e=>e[0]===Qntt)
                            F_Cust = filt2[0][2]
                            F_Valr = filt2[0][1]
                        }

                        const Adicional = Serv=='Trofeu' ? 1*Qnt : 0

                        const oMetro  = Lrg*Alt*Qnt
                        const DESCt   = oMetro <= 5 ? 0 : oMetro >= 15 ? 0.15 : oMetro/100  // Melhorar Progressivo
                        const DescQtn = (oMetro <= 1 ? 0 : (Qnt/100))/2

                        const Cust = M2?.Cust ?? 0
                        const Valr = M2?.Valr ?? 0
                        const CUSTO = Calc=='M2' ? Cust*Lrg*Alt*Qnt                       : F_Cust
                        const CRCT  = Calc=='M2' ? Valr*Lrg*Alt*Qnt+Adicional             : F_Cust
                        const VALOR = Calc=='M2' ? TotalCress(Valr,Lrg*Alt*Qnt)+Adicional : F_Valr
                        
                        const VALOR_D = Math.floor(VALOR-(VALOR*(DESCt-(DescQtn))))
                        
                        console.log(`${oMetro}m¬≤ - `,'Desc1:',DESCt,' - Desc2:',DescQtn)

                        InNa_RS($('.ORC_CUST_Vund',tr),CUSTO/Qnt)
                        InNa_RS($('.ORC_CUST_SbTt',tr),CUSTO)
                        InNa_RS($('.ORC_CRCT_Vund',tr),CRCT/Qnt)
                        InNa_RS($('.ORC_CRCT_SbTt',tr),CRCT)
                        InNa_RS($('.ORC_RSUT_Vund',tr),VALOR_D/Qnt)
                        InNa_RS($('.ORC_RSUT_SbTt',tr),VALOR_D)

                        ReloadTotal()
                    }
                    
                    function Tog_M2_OFS_UND(e){
                        if(Prod[e.value].Calc === 'M2'){console.log('M2')
                            None($$('.OrcCbmt,.OrcGram,.OrcQntt',_tr(e)))
                            Show($$('.ORC_INPT_Lrg,.ORC_INPT_Alt,.ORC_INPT_Qnt',_tr(e)))
                        }
                        if(Prod[e.value].Calc === 'OFS'){console.log('OFS')
                            Show($$('.OrcCbmt,.OrcGram,.OrcQntt',_tr(e)))
                            None($$('.ORC_INPT_Lrg,.ORC_INPT_Alt,.ORC_INPT_Qnt',_tr(e)))
                        }
                        if(Prod[e.value].Calc === 'UND'){console.log('UND')
                            None($$('.OrcCbmt,.OrcGram',_tr(e)))
                            Show($$('.ORC_INPT_Qnt',_tr(e)))
                        }
                    }

                    function ValidOpts(){$$('#ORC select').forEach(e=>$$('option',e).length==1 ? Add(e,'sOFF') : Rmv(e,'sOFF'))}

                    function Tm_OptsGraff(Ary,Stg=null){ //  Fun√ß√£o que Carrega os Servi√ßos dentro dos Grupos
                        const GpIt={}, GpOF={}
                        ObjEtr(Prod).forEach(([k,v])=>{GpIt[k] = v.Calc ; GpOF[k] = v.Stts})

                        return `<option value="" disabled selected>${Ary[0]}</option>
                            ${Object.entries(Ary.slice(1).reduce((a,e)=>{
                                (a[GpIt[e]]||=[]).push(`<option value=\"${e}\" ${Stg === e ? 'selected' : ''} ${GpOF[e] === 'Offf' ? 'style=\"color:red;\"' : ''}>${e}</option>`);return a
                            },{})).map(([g,o]) => `<optgroup label=\"${g}\">${o.join('')}</optgroup>`).join('')}
                        `}
                </script>

                <div> <!--Valores TOTAL-->
                    <p>Total</p>
                    <div class="ORC_CUST_FINAL Final none"></div>
                    <div class="ORC_CRCT_FINAL Final none"></div>
                    <div class="ORC_RSUT_FINAL Final"     ></div>
                    <script>
                        function ReloadTotal(){
                            Inn($('.ORC_CUST_FINAL'),Tm_RS(SOMA($$('.ORC_CUST_SbTt').map(e=>Nm(e)))))
                            Inn($('.ORC_CRCT_FINAL'),Tm_RS(SOMA($$('.ORC_CRCT_SbTt').map(e=>Nm(e)))))
                            Inn($('.ORC_RSUT_FINAL'),Tm_RS(SOMA($$('.ORC_RSUT_SbTt').map(e=>Nm(e)))))}
                    </script>
                </div>

                <script> // Fun√ß√µes Dedicadas a Tabelas de OR√áAMENTO
                    function Rload_Tbl(Tbl){Upp_Tabela(Tbl) ; Upp_RowCol(Tbl) ; RecolorVlr(Tbl) ; RecolorVlr()} ; Rload_Tbl('#ORC')
                    function Upp_Tabela(Tbl){
                        $$(`${Tbl} tbody tr`).length == 1 ? None($$('.OrcRmv',$(Tbl))) : Show($$('.OrcRmv',$(Tbl))) // Remover o X
                        $$(`${Tbl} tbody tr`).length == 1 ? None($$('.O_All')) : Show($$('.O_All'))
                        // aqui pode ter mais coisas pra Atualizar a Tabela
                    }
                    function Upp_RowCol(Tbl){
                        const Lmt = $$(`${Tbl} tr:nth-child(1) input`).length
                        $$(`${Tbl} input`).forEach((I,x)=>{
                            I.dataset.row = Math.floor(x/Lmt)
                            I.dataset.col = x % Lmt})
                    }
                    function HandArrow(Tbl,e){
                        if (e.key === "Enter"){
                            const Inpts = $$(`input`,Tbl)
                            const Elemt = $(':focus')
                            const Next = Inpts[Array.from(Inpts).indexOf(Elemt)+1]
                            if(Next){Next.focus() ; Next.select() }}
                        let act = document.activeElement
                        if (act.tagName !== "INPUT") return
                        let r = +act.dataset.row, c = +act.dataset.col, nxt
                        if (e.key === "ArrowRight") nxt = `[data-row='${ r }'][data-col='${c+1}']`
                        if (e.key === "ArrowLeft")  nxt = `[data-row='${ r }'][data-col='${c-1}']`
                        if (e.key === "ArrowDown")  nxt = `[data-row='${r+1}'][data-col='${ c }']`
                        if (e.key === "ArrowUp")    nxt = `[data-row='${r-1}'][data-col='${ c }']`
                        if (nxt){$(nxt)?.focus() ; setTimeout(()=>$(nxt)?.select(),0)}
                    }

                    window.addEventListener("resize",Check_W_Pag)
                    Check_W_Pag()
                    ValidOpts()
                </script>

                <div class="w100 Ct" style="margin-top: 80px"> <!--Informa√ß√µes Extras-->
                    <div class="Cl"><label>Nome</label><input placeholder="Nome"></div>
                    <div class="Cl"><label>Contato</label><input placeholder="Contato"></div>
                    <div class="Cl"><label>Endere√ßo</label><input placeholder="Endere√ßo"></div>
                    <div class="Cl"><label>Coment√°rio</label><input placeholder="Coment√°rio"></div>
                </div>
                <button onclick="VerNota()">Ver Nota</button>
                </form>
            </div>

            <div><!--Arte-->
                <style>
                    .container {
                        max-width: 300px;
                        margin: auto;
                        padding: 20px;
                        border: 1px solid #ccc;
                        border-radius: 10px;
                        box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
                    }
                    .tootal, .tootal span {
                        font-size: 18px;
                        font-weight: bold;
                        color: #00df00;
                    }
                    .Pcntalmt{
                        margin-top: 15px;
                        color: gray;
                    }
                </style>

                <div class="container" style="margin-bottom: 150px;margin-top: 50px;">
                    <h3>Or√ßamento de Arte:</h3>

                    <select id="designOptions" onchange="EscolheARTE()" class="w100">
                        <option value="20" data-extra="0">Post Digital - R$ 20,00</option>
                        <option value="20" data-extra="4">Carrossel - R$ 20,00 (+R$ 4,00 por unidade)</option>
                        <option value="25" data-extra="0">Banner Digital - R$ 25,00</option>
                        <option value="25" data-extra="0">Cart√£o de Visita - R$ 25,00</option>
                        <option value="50" data-extra="0">Flyer - R$ 50,00</option>
                        <option value="30" data-extra="0">Panfleto - R$ 30,00</option>
                        <option value="20" data-extra="0">Wing Banner - R$ 20,00</option>
                        <option value="50" data-extra="10">Card√°pio - R$ 50,00 (+R$ 10,00 por p√°gina)</option>
                        <option value="25" data-extra="3">Backdrop Simples - R$ 25,00 (+R$ 3,00 por patrocinador)</option>
                        <option value="100" data-extra="0">Logo - R$ 100,00</option>
                        <option value="400" data-extra="0">Identidade - R$ 400,00</option>
                        <option value="40" data-extra="0">Manipula√ß√£o/Tratamento - R$ 40,00</option>
                        <option value="25" data-extra="0">Vetoriza√ß√£o - R$ 25,00</option>
                        <option value="5" data-extra="0">Banner Simples Texto - R$ 5,00</option>
                        <option value="30" data-extra="3">Arte para Camisa - R$ 30,00 (+R$ 3,00 por varia√ß√£o)</option>
                    </select>
                    
                    <label for="quantidade">Quantidade:</label><input type="number" id="quantidade" value="1" min="1" oninput="EscolheARTE()">

                    </select>
                    <div id="Bruxos">
                        <label><input type="checkbox" value="20" onchange="EscolheARTE()"> Identidade Visual (20%)</label><br>
                        <label><input type="checkbox" value="15" onchange="EscolheARTE()"> Roteirizar (15%)</label><br>
                        <label><input type="checkbox" value="25" onchange="EscolheARTE()"> Criar Logomarca (25%)</label><br>
                        <label><input type="checkbox" value="8"  onchange="EscolheARTE()"> Digita√ß√£o (8%)</label><br>
                        <label><input type="checkbox" value="7"  onchange="EscolheARTE()"> Escolha de Imagens (7%)</label><br>
                        <label><input type="checkbox" value="5"  onchange="EscolheARTE()"> Montagem (5%)</label><br>
                    </div>

                    <div class="Pcntalmt"></div>
                    <div class="tootal">Total: R$ <span id="total">0.00</span></div>
                </div>

                <script>
                    function EscolheARTE(){
                        const Slt = $("#designOptions")
                        const Qnt = $("#quantidade").value
                        const Val = parseFloat(Slt.value)
                        const Ext = parseFloat(Slt.options[Slt.selectedIndex].getAttribute("data-extra")) || 0
                        let Porcent = 0
                        $$('#Bruxos input[type="checkbox"]:checked').forEach(e=>{console.log(e) ; Porcent += parseFloat(e.value)})
                        const Pcnt = Porcent.toFixed(2)/100
                        const Total = Val+(Ext*(Qnt-1))
                        const Total2 = Total+(Total*Pcnt)

                        $(".Pcntalmt").innerHTML = `Porcentagem: R$ ${parseFloat(Pcnt)*100}%`
                        $(".tootal").innerHTML = `R$ ${Total2.toFixed(2).replace('.', ',')}`
                    }

                </script>
            </div>
            <button onclick="console.log($$('button>img, .button>img, input>img, select>img'))">sOKA</button>
        </div>

        <script>
            const FIMGeral = performance.now() ; console.log(`‚è±Ô∏è OR√ßamento(): ${(FIMGeral-INgeral).toFixed(2)}ms`)
        </script>
    </div>

    <style> /*CSS dos Modais*/
        .Dark #FModal>div{background:#1b1b1b}
        .Lite #FModal>div{background:#ffffff}
        .Dark #FModal > #ModalNota{background:#ffffff;color:black}
              #FModal h1{font-size:25px}

        #ModalLogin{width:300px;height:400px}
        #ModalCadastro{width:70%}
        #Modal-Item .Feed{width:400px;height:400px}
        #Modal-Item .Stry{width:250px;height:440px}
        #Modal-Info1,#Modal-Info2{padding:30px}
        #InnerVazio input{position:absolute;width:200px}

        #ModalNota>div{padding:5px 0px}
        #Nota-Clnt>div>div>div{margin:0px 5px}
        #ModalNota img{width:50px;height:50px}
        .Start2 p{margin:1px 5px}
        #LugarFotoNotta{margin-right:3px}

        #TabelaNotinha{text-align: center;border-collapse: collapse;border: #d8d8d8 solid 1px;}
        #TabelaNotinha tr{background: #5F009E;color: white;font-size: 13px;}
        #TabelaNotinha td{background: #ffffff;color: black; padding: 3px;font-size: 13px;}
        #TabelaNotinha tfoot > tr > th {background: #575757}
        #TabelaNotinha td:nth-child(5){font-size: 13px;color:#4f4f4f;}
        #TabelaNotinha td:nth-child(6){font-weight: bold}
    </style>

    <div id="FModal" class="Ct">
        <script>function SairMdal(){None('#FModal')} </script>

        <div id="Mdal-Area">
            <textarea id="Area" placeholder="Digite aqui..." oninput="ResizeArea(this)" onkeydown="KeyEntr(()=>Read_Obj_Area('#Area'))"></textarea>
        </div>

        <div id="ModalLogin" class="Ct Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div class="Bt Loginn">Login</div>
              <div class="Ct Start">
                <label for="Senha">Senha</label>
                <input id="Inpt-Senha" class="Inputss" type="password" onkeyup="TestSenha(event,this)">
              </div>
              <span id="Span-Login" class="erro"></span>
              <div class="Bt">
                <button class="Ct w40" onclick="TestSenha('','#Inpt-Senha')">Logar</button>
                <button class="Ct w40" onclick="Deslogar();SairMdal()">Sair</button>
              </div>
        </div>

        <div id="FormIMG"></div>

        <div id="Mdal-Prod">
            fotrinhas
        </div>
    
        <div id="ModalNota" class="Cl Rltv Rd media30">
        <div class="Close Ct" onclick="SairMdal()">X</div>
        <div id="Titulo-Nota" class="w100 Bt Hr"></div>
            <div id="Nota-Empresa" class="Ct Row Hr Bt w100">
                <div class="Ct">
                <div id="LugarFotoNotta"><img src="Img/Logo2.png"></div>
                <div>
                    <h2>INFINITY GRAFF</h2>
                    <h2>IMPRESS√ÉO DIGITAL</h2>
                </div>
                </div>
        
                <div class="Start2">
                    <div class="FtBd Ct">Endere√ßo: <p>Estrada do Tip, N¬∞ 54A</p></div>
                    <div class="FtBd Ct">Cidade: <p>S√ÉO LOUREN√áO DA MATA</p></div>
                    <div class="FtBd Ct">Email: <p>infinitygraff@outlook.com</p></div>
                    <div class="FtBd Ct">Contato: <p class="B">(81) 98726.5401</p></div>
                </div>
            </div>
        
            <div class="Ct Cl Hr">
                <h2>CUPOM FISCAL</h2>
                <div id="DataNota"></div>
            </div>
        
            <div class="Start2 Hr">
                <div class="Ct"><p class="FtBd">ORDEM DE SERVI√áO:<p><p>${id}</p></div>
                <div class="Ct"><p class="FtBd">Data:</p><p>00/00/2023</p></div>
            </div>
        
            <div id="Nota-Clnt" class="Row w100 Ev">
                <div>
                <div class="Ct FtLt">Nome:     <div data="Clnt"></div> </div>
                <div class="Ct FtLt">Fone:     <div data="Cntt"></div> </div>
                </div>
                <div>
                <div class="Ct FtLt">Endere√ßo: <div data="Local"></div></div>
                <div class="Ct FtLt">Cidade:   <div data="City"></div> </div>
                </div>
                <div>
                <div class="Ct FtLt">CPF/CNPJ: <div data="CNPJ"></div> </div>
                </div>
            </div>
        
            <div id="ConteudoNota" class="w100">
                <table id="TabelaNotinha" class="w100"><thead><tr><th style="color: white">Servi√ßos</th></tr></thead></table>
                <div id="DescrNota" class="Ct Cl"></div>
                <h2 id="TotalNotta" class="Hr Ct"></h2>
            </div>
        
            <div class="w100 Ct">
            <button id="trocatroca" class="BTNota Ct RD magem" onclick="troctroc()">Troca-Troca</button>
            <button class="BTNota Ct RD magem" onclick="SairMdal()">Cancelar</button>
            <button class="BTNota Ct RD magem" onclick="NewPDF()">Imprimir<div id="imgnotta" class="Ct"></div></button>
            </div>
        </div>

        <div id="EditarPerfil" class="Cl Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div>Foto</div>
            <img src="./Img/Perfil_Allan.png" width="100">
            <div>Nome do Usu√°rio</div>
            <input type="text" placeholder="Senha Atual">
            <input type="text" placeholder="Nova Senha">
            <input type="text" placeholder="Repetir Senha">
        </div>

        <div id="ConfigPag" class="Cl Rltv Rd">
            <div class="Ct Close" onclick="SairMdal()">X</div>
            <div><input id="DarkLite" type="checkbox" class="GETConfig" onchange="DarkLite2('body',this.checked)" onclick="SaveConfig(this)"> <label>Modo Escuro</label></div>
            <div><input id="TamFonte" type="range"> <label>Tamanho de Fonte</label></div>
        </div>

        <div id="PagSUPORTE" class="Cl Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div>informa√ß√µes de Suporte</div>
            <div>dicas de como usar o APP, principalmente pra mim</div>
        </div>
    </div>
</body>

<script> // Fun√ß√µes de Login
    let LgTp = {'Nome':'','Cod':'','Img':''} ; function SemLogin(){return LgTp.Cod===''}
    function TestSenha(e,ipt=null){

        function CrypPass(senha){
            const Cryp = senha.split('').map((c,idx)=>{
                if(/[0-9]/.test(c)){let N=parseInt(c)
                N=N===9?0:N+(idx%2===1?4:1);return N.toString()}
                else if(/[A-Za-z]/.test(c)){
                let L=c.charCodeAt(0)+(idx%2===1?5:1)
                if(L>90&&L<97)L-=26
                else if(L>122)L-=26
                return String.fromCharCode(L)}else{return c}})
            var par = [] ; var imp = []
            Cryp.forEach((e,idx)=>{idx%2===0?par.push(e):imp.push(e)})
            const Par=par.reverse().flatMap(C=>[`3${C}$`,`r${C}-`,`3${C}&`])
            const Imp=imp.reverse().flatMap(C=>[`-${C}e`,`V${C}9`,`@${C}K`])
            return Par.concat(Imp).join('')
        }
        
        const User={
            '31$r1-31&-4eV49@4K':['(Baby)','Baby Massia'   ,'Img/Perfil_Baby.png'   ],
            '32$r2-32&-6eV69@6K':['(Alan)','Allan MacLovin','Img/Perfil_Allan.png'  ],
            '34$r4-34&-7eV79@7K':['(Lisa)','Lisa Caramelo' ,'Img/Perfil_Lisa.png'   ],
            '36$r6-36&-9eV99@9K':['(Segu)','Segunda Hippie','Img/Perfil_Segunda.png']
        }

        if(e==='Deslog'){
            Nm($('#Login-Top'),'')
            Inn('.LgTp2',IconLogin)
            Show('.LgTp')
            None('.ImgPerfil')
            $('.ImgPerfil').src=''
        
        }else if(e==='Storage'){ if(User[ipt] === undefined || User[ipt] === null){return}
            else{
                // localStorage.removeItem('SenhaCryp')
                // localStorage.setItem('SenhaCryp',input)
                Nm($('#Login-Top'),'Logado')
                Inn('.LgTp2',User[ipt][1])
                Show('.ImgPerfil')
                $('.ImgPerfil').src=User[ipt][2]
            }
        }
        else{
            let inpt=e==='' ? $(ipt) : ipt
            if(KeyEnter(e)||e===''){
                const Cryp = CrypPass(inpt.value)
                if(User[Cryp]){

                    None($('#IMG-PerfiL'))
                    SairMdal()
                    localStorage.removeItem('SenhaCryp')
                    localStorage.setItem('SenhaCryp',Cryp)
                    Nm($('#Login-Top'),"Logado")
                    Inn('.LgTp2',User[Cryp][1])
                    Show('.ImgPerfil')
                    Show('.ImgPerfil2')
                    $('.ImgPerfil').src=User[Cryp][2]

                }else{Inn('#Span-Login','Senha Inv√°lida') ; inpt.placeholder='Senha Inv√°lida'}
                inpt.value='';inpt.focus()
                console.log('Logou')
            }
        }
    }
    
    function LoginStorage(){const Pass = localStorage.getItem('SenhaCryp');if(Pass===null){return};TestSenha('Storage',Pass)}
    function Deslogar()    {localStorage.removeItem('SenhaCryp');TestSenha('Deslog','')}
    LoginStorage()
    /*
    id√©ias pra o Login
        Login com LocalStorage
        deixar o CryPass() na BaseDados da Biblioteca
        criar um Objeto no inicio com Nome User q vai passar todos os Dados do Usu√°rio
        e √© atrav√©z desses dados que toda a interface vai carregar de acordo com o usu√°rio
        suas configura√ß√µes e personalzia√ß√µes, suas informa√ß√µes e suas Listas de Pedidos
    */
</script>

<script> // Coisas da NOTA
    function estaOculta(e) {return getComputedStyle(e).display === "none"}

    function VerNota(){
        MdalShow('#ModalNota')
        // Aqui em Baixo coletar tudo q ta no or√ßamento e Jogar pra c√°!
        // deixar uma Op√ß√£o pra Copiar o Texto
        const dados = $$('#ORC tbody tr').map(tr=>$$('td input, td select',tr).map(e=>{if(estaOculta(e)){return}else{return e.value}}))
        console.log(dados)
    }
</script>

<script> // Controla a Base de Dados
    function Rfresh(){(async()=>{await GetJSON()})()}
    async function GetJSON(){ // por enquanto n√£o ta sendo usado
        console.log('N√£o Est√° Rodando')
        async function UparClnt(){FetchPOST(Link+'/postUpar_Clnt_Data',[''])}
        async function UparLink(){FetchPOST(Link+'/postUparLink',[''])}
        async function UparLinkMPAG(){FetchPOST(Link+'/postUparLinkMPAG',[''])}
        async function Get_Json(End){return new Promise(r=>{FetchGET(`${Link}/getJSON/${End}`,e=>{D[End]=MAX(e,'ID')+1;J[End]=e;r()})})}
        await UparClnt() ; await UparLink() ; await UparLinkMPAG()
        for(let end of ['CLNT','SERV','PGMT','UBER','GRAD','OOSS','PDDS','MPAG']){await Get_Json(end)}
        PosGet()
    }

    function PosGet(){
        Onloads('body')
        NavPag(Atual['Pag']);NavPesq(Atual['Pag'].replace('#Pag_','.Pesq_'))
        Format_Bndj_Clnt()
        RealTime(Atual['Pag'].replace('#Pag_',''))
        console.log('‚úÖ Concluido')
    }

    // o Importante √© saber, se estou Editando a Primeira Camada, Segunda Camada ou Terceira (por enquanto s√≥ essas 3)
    const Camada = {PDDS:1,CLNT:1,MPAG:1,OOSS:1,UBER:1,
                    SERV:'PDDS',PGMT:'PDDS',CUST:'PDDS',FINC:'PDDS'}

    function EditCell(e,vall=null){ // Permitir q Funcione em Todas as Tabelas
        const[Typ,Lin2,col,Cry]=D_Rastr(_td(e))
        R_Color(_tr(e),Typ)
        const Val = vall===""?"":VAL(e)
        if(Val===Nm(e)){console.log('N√£o foi Alterado...') ; return}
        const IsBdj  = isBdj(e) // !!e.closest('.BndjTBL') // antes tava isso
        const Lin    = IsBdj ? tr_ID(Pai(_td(Pai(_td(e))))) : Typ=='SERV' ? Lin2.split('_')[0] : Typ=='PGMT' ? VAL($(`${Rx2(['Link'])}`,_tr(e))) : Lin2
        const NewVal = vall===""?"":vall?vall:Val
        const Antg   = Nm(e)
        const Arr    = [Typ,Lin,col,NewVal,Antg,Lin2] // [Tabela, Linha, Coluna, NovoValor, ValorAntigo, LinhaDentro]
        Nm(e,e.textContent.trim()) // Mudar o Name
        
        // console.log('NovoArray:',Arr)

        // de fato o Ato de Editar
        if(Camada[Typ]==1){J[Typ][col] = NewVal} // Apenas Trocar o Valor Simples!
        else{
            const Idx    = J[Camada[Typ]].findIndex(obj=>obj['Id']==Lin) // Achar o Index da tabela de pedidos
            const Idxbdj = J[Camada[Typ]][Idx][minuscule(Typ)].findIndex(obj=>obj['Id']==Lin2) // Achar o Index da Bandeija 
            J[Camada[Typ]][Idx][minuscule(Typ)][Idxbdj][col] = NewVal
            //console.log(J[Camada[Typ]].find(obj=>obj['Id']==Lin))
        }
        console.log(0,Typ,Lin,col,Lin2,`Atualizado: ${Antg} >> ${NewVal}`)
    }

    const TesteClnt=(e,td=null)=>{
        if($('#ConfirCliente').checked){console.log('Perguntar')}
            if(confirm(`Tem Certeza que quer salvar: ${e.value} como Cliente?`)){
                if(Nmame(e)){return Nmame(e)}else{AddROW('CLNT',{Clnt:e.value});if(td){EditCell(td,D['CLNT'])} ; return D['CLNT']}}
    }
</script>

<script> // Controladores antigos pra confiscar
    function EditCellFake(eu){ // Usado apenas no Format_Bndj_Clnt()   // assim q eu eliminar l√°, poderei apagar isso aqui!
        const val = Nm($('input',Pai(eu)))
        const R = D_Rastr(Avo(eu.closest('.BNdj')))
        const arrays = (['PDDS',R[1],'Clnt',val]) // [Tabela,Linha,Coluna,NovoValor]
        console.log(arrays)
        EditJSON(arrays)
    }
    const EditCellFake2=(e)=>{ // Usado apenas no Format_Bndj_Clnt() // √© a mesma coisa, tem q ver l√° tbm
        const R = D_Rastr(_td(e))
        e.value.split('|').forEach(E=>{
            // isso ta rodando 2 vezes mesmo quando s√≥ tem 1 no caso quando eu n√£o digioto o | // talvez seja pq ta rodando 2 vezes, uma no Enter, e outra no Onblur
            AddROW('PGMT',{Link:R[1],Valr:RgxPixAV(E)[1],Form:RgxPixAV(E)[2]})
        })
    }

    function add_PDDS(e,nome){
        const TestePgmt=()=>{if(e[5]){AddROW('PGMT',{Desc:e[5]});return D['PGMT']}else{return '.'}}
        const TesteServ=()=>{AddROW('SERV',{ID:`${D['PDDS']}|1`,Serv:e[2],Desc:e[3],Valr:Num(e[4]),Forn:e[6],OK:false});return 1}
        AddROW('PDDS',{RG:AGORA(),OFF:1,Data:DMY(e[0]),Serv:TesteServ(),Clnt:TesteClnt(nome),Pgmt:TestePgmt()}) 
        Clear($$('#FormPDDS input, #FormPDDS select'))
        // neste Add_PDDS: quando salvar Pgmnt tem que Linkar o ID do Pedido
    }

    function NovaLinhaBDj(Eu){ // isso talvez deva ir la pra baixo
        const R = D_Rastr(_td(Eu))
        const Sv = $$('tbody tr',_td(Eu))
        if(R[2]=='Pgmt'){ AddROW(R[2].toUpperCase(),{Link:`${R[1]}`}) }
        if(R[2]=='Serv'){ AddROW(R[2].toUpperCase(),{ID:`${R[1]}|${Sv.length}`}) }
    }

    // Edit e Delet ta Funcionando
        // os que execulta antes de atualizar o Json "//FAST//"
        function AddROW(Pln,obj=null){/*AddRowPratica(Pln,obj,'<')*/ ; AddROWConst(Pln,obj) ; /* FetchPOST(Link+'/postLINHA',[Pln,obj],(e)=>{ALERT(e)}) */ }

        function AddRowPratica(Pln,obj,Pose){
            let tbody =  $(`#H_${Pln} > tbody`)
            let Colll = $$(`#H_${Pln} > thead th p`).map(p=>Inn(p))
            let Clone =  $('tr',tbody).cloneNode(true)
            $$(':scope > td',Clone).forEach((td,x)=>{if($('p',td)){Inn($('p',td),obj[Colll[x]]??'')}}) // Atualizar (este if ta aqui s√≥ por que a Lixeira n√£o tem uma Tag <p> dai ela retorna Null) Atualizar de Forma Gen√©rica (q Funcione com td Input, Edit, CheckBox tudo!)
            Pose === "<" ? tbody.prepend(Clone) : tbody.appendChild(Clone)
            // o Clone n√£o ta Exibindo Bandeja corretamente talvez por causa da exibi√ß√£o de bandeija depende do ID, e n√£o ta sendo passado corretamente na hora do clone
        }

        function RmvROW(Typ,id,eu){eu.closest('tr').remove() ; FetchPOST(Link+'/postDELETE' ,[Typ,id],(e)=>{ALERT(e)})}
        function ExcROW(Typ,id,eu){eu.closest('tr').remove() ; FetchPOST(Link+'/postEXCLUIR',[Typ,id],(e)=>{ALERT(e)})}
        function EditJSON(arry){FetchPOST(Link+'/postEDIT',arry,(e)=>{ALERT(e);return e})}

        function AddROWConst(Typ,obj=null){ // ESTE √â BEM MELHOR que o AddRowPratica() NA TORA (depois mudar pra inserir no Inicio ou no Final)
            const LastRow=(obj,id)=>obj.reduce((max,e)=>Math.max(max,e[id]),0)
            const Arq = J[Typ]
            const Novo = {...Arq[Arq.length-1]}                    // Clona Nova Linha
            ObjKey(Novo).forEach(k=>(Novo[k]=''))                  // Limpa tudo
            Novo['ID'] = LastRow(Arq,'ID') + 1                     // Muda Id para um Novo
            if(obj){ObjEtr(obj).forEach((K)=>{Novo[K[0]] = K[1]})} // Atualizar o Restante dos Dados
            J[Typ].push(Novo)
            console.log(Novo)
            PosGet()
        }
    PosGet()    
</script>

<script> // Storage Salva Configura√ß√µes
    function AtivaEventos(){window.addEventListener("scroll",()=>{scrollPosition=[window.scrollX,window.scrollY]})}
    // AtivaEventos()
    function Disparos(e){/*console.log('Dispoaro >')*/ ; e.dispatchEvent(new Event('change')); /* console.log('< Dispoaro') */}
    function SaveConfig(e){StogeSet(e.id,Vll(e)) ; /* console.log('Save',e.id,Vll(e)) */ }
    function GetConfig(){$$('.GETConfig').forEach(e=>{
        const Valor = StogeGet(e.id)
        if(Valor){ llv(e,Valor);Disparos(e)  }})}
    window.onload = () => {GetConfig()}
    // function GetConfigOrdem(){OrdenarRows($(`#H_PDDS thead tr th:nth-child(${8}) a`),7,'p','desc')}
    // function savecoifigTABLE(){StogeSet('Orden',x)}
    // Save para MenuNav
</script>

<script> // coment√°rios
    // Mostrar o Valor por M2 ao Lado do Option
    // Permitir Drag nas Linhas
    // imitar Bureal no Futuro (deixando todas bandeijas aberta)
    // no Select se oq est√° atualmente selecionado, existir no option da pr√≥xima rodada, ent√£o mantem ele
    // selecionar option automaticamente caso tenha apeans 1
    // Proibir Drag em Imagens
    // a soma de metros de produtos do mesmo tipo tem q resultar na Diminui√ß√£o da Crescente
    // o Valor Crescente deve ficar verde, se ele for igual ao valor Final
    // qual foi o PC q deu a entrada, precisa registrar tbm, Adicionar RG tbm em Pedidos, e em Clientes e Pagamento
    // Poder Diferenciar oq foi preenchido Automatico, e o q foi preenchido Manualmente

    // um click abre a imagem, click duplo Adiciona ela em baixo
    // deixar maior os bot√µes de Limpar tudo, e excluir tudo (CSS mobile)
    // Adicionar um Bot√£o pra Limpar os ta imcompleto, deixando apenas os or√ßamentos Certinhos
    // quero criar meu pr√≥prio Teclado Numerico, com Op√ß√µes de cm, m, e mm (Oculpando espa√ßo nesses√°rio na Tela, sem mover o Scroll)
    // como impedir q a p√°gina d√™ zoom, pelo celular

    //missrand.e bixinha da musica Rendow - Damn Fly

    // Dica pra mover Linha igual Movimenta as Linhas na Planilha, aparece s√≥ o contorno e o grad bem simplifciado
    // ao exibir o SVG grande, mostra o tamanho das coisas

    // https://www.erome.com/a/wcmxSNOS
    // https://www.erome.com/a/VkT1uhYg
    // https://www.erome.com/a/PWY4fkMD
    // https://www.erome.com/a/Vk99UZ8L
    // https://www.erome.com/a/K0hAD4GJ

        // remover Abrevia√ß√£o dos Thead se precisar
        // se a bandeijinha quebrar Linha ent√£o aumenta ela se n√£o fica tamanho da Div

        // Modos de Preview da Tabela (Pra Variar)
        // bandeja{
        //     Modo1 = Bandeija Flutiante, o modelo q j√° tem
        //     Modo2 = Bandeija Dentro da tabela Misturada
        // }
        // conte√∫do{
        //     Modo1 = Formato de Tabela, (com ou sem Cabe√ßalho)
        //     Modo2 = Formato de Lista , igual oq j√° tem no Sugg
        //     Modo3 = Formato de Card  , ficar√° dentro ser√° v√°rias tags montando com tudo junto
        // }

        // O Filtro de Data quero fazer ordenar correto invertido
        // No filtro de data mostrar um input Type="Date" (pra selecionar intervalo e Datas)
        // Adicionar uma pesquisa dentro do Filtro (Pra pesquisar a lista q aparece no Filtro)
        // No Recorte preencher a Grade com "-"
        // Procurar todo mundo de camisa pra tentar fazer finalmente o relat√≥rio completo, no filtro Inova e vazio
        // Fazer tanto o Filtro quanto o Footer localizar o Cliente Baseado no seu ID e dar Unique no ID e n√£o no nome
        // Mostrar a Soma do valor na Barra de Config



        // Orden n pega em Selcts e parece q tbm n ta pegando Numero!
        // fica ruim pra clicar na c√©lula quando n tem Nada
        // do Jeito q o Recolor acontece idivudual o Rfresh poderia tbm
        // adicionar Crach√° a Lista
        // poder trocar o nome dos Caras
        // Selecionar V√°rias C√©lulas e Colar uma coisa s√≥
        // o Hover precisa ta por cima das cores verde
        // Op√ß√£o de mais de 1 Designer
        // adicionar carteira

</script>

<script> // Templates pra iserir mais pra frente ‚è≥ ‚ùå ‚úîÔ∏è
    const tmplt_Cores=e=>`<li class="Ct Rd ppt" style="background:${e}" onclick="mudarCor(this,'${e}');VariasCor(this,'${e}')"></li>`
</script>

</html>
<!DOCTYPE html>
<html lang='pt-BR'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orcamento</title>
    <link rel="icon" type="image/x-icon" href="Img/FavG_32.png">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<!--
    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/fontes.css"        rel="stylesheet">
    <link  href="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/CSSBiblioteca.css" rel="stylesheet">
    <script src="https://raw.githack.com/InfinityGraff/MyBiblioteca/main/PreScript.js"      ></script>

    <link  href="../MyBiblioteca/fontes.css"        rel="stylesheet">
    <link  href="../MyBiblioteca/CSSBiblioteca.css" rel="stylesheet">
    <script src="../MyBiblioteca/PreScript.js"      ></script>
    --> 
    <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/fontes.css"        rel="stylesheet">
    <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/CSSBiblioteca.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/PreScript.js"      ></script>

    <link  href="./CssGRAFF.css" rel="stylesheet">
    <script src="./BaseGRAFF.js"></script>
    <script src="./BiblGRAFF.js"></script>
    <script src="./AchaMdd.js"></script>
    <script src="./Gera3D.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script> -->
    <!--<script src="https://threejs.org/build/three.js"></script>-->
</head>

<script> // Base de Dados

    const USER = { // isso vai FICAR no SupaBase
        '32$r2-32&-6eV69@6K'                                    :{Nome:'Allan',Foto:'./Img/Perfil_Allan.png' ,cgo:'Admn', body:['Dark','Body1','CSS1'], Limt:{INN:951,OUT:8000 }, Fone:"81 98726.5401",Emal:"allanmaclovin@gmail.com",Lcal:"São Lourenço da Mata"},
        '31$r1-31&-4eV49@4K'                                    :{Nome:'Baby' ,Foto:'./Img/Perfil_Baby.png'  ,cgo:'Grnt', body:['Lite','Body1','CSS3'], Limt:{INN:1220,OUT:8000}, Fone:"81 00000.0000",Emal:"babydocegosto@gmail.com",Lcal:"São Lourenço da Mata"},
        '33$r3-33&3d$rd-3d&3p$rp-3p&-4eV49@4K-feVf9@fK-weVw9@wK':{Nome:'Karol',Foto:'./Img/Perfil_Karol.png' ,cgo:'Atnd', body:['Dark','Body1','CSS1'], Limt:{INN:1220,OUT:8000}, Fone:"81 00000.0000",Emal:"karolinelllll@gmail.com",Lcal:"São Lourenço da Mata"},
        '3l$rl-3l&3s$rs-3s&3F$rF-3F&-deVd9@dK-zeVz9@zK'         :{Nome:'Euryk',Foto:'./Img/Perfil_Euryk.webp',cgo:'DSgn', body:['Dark','Body1','CSS1'], Limt:{INN:1220,OUT:8000}, Fone:""             ,Emal:""                       ,Lcal:""},
        'Login'                                                 :{Nome:'Login',Foto:'./Img/LogOff.png'       ,cgo:'Clnt', body:['Dark','Body1','CSS1'], Limt:{INN:1220,OUT:8000}, Fone:""             ,Emal:""                       ,Lcal:""}
    }

    const Cgo  = { // Cargo
        Admn: { nav :['HOME','|','ORC','LOJA','GBRT','BBTC','|','PDDS','|','PGMT','GRAD','CLNT','|','CONF'],
                orc :[],
                PDDS:[],
                PGMT:[],
                SERV:['Detg']},

        Grnt: { nav :['HOME','|','ORC','|','PDDS','|','PGMT','GRAD','CLNT','|','CONF'],
                orc :[],
                PDDS:[],
                PGMT:[],
                SERV:['Data','Detg']},

        DSgn: { nav:['HOME','|','ORC','|','PDDS','|','PGMT','|','CONF'] ,
                orc:['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo Bolo','Vendas','Placa','Sinalização','Cartela','Plotagem','Crachá','Carteira','Plaqueta'],
                PDDS:['Id','Cust','Lcro'],
                PGMT:['Id','Stts','Link','Mpag'],
                SERV:['Id','Forn','Detg','Grad','Gimg','OS','Uber','Cbmt','VCbt','Cmnt',"Oimg"]},

        Atnd: { nav:['HOME','|','ORC','|','PDDS','|','PGMT','|','CONF'] ,
                orc:['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo Bolo','Vendas','Placa','Sinalização','Cartela','Plotagem','Crachá','Carteira','Plaqueta'],
                PDDS:['Id','Cust','Lcro'],
                PGMT:['Id','Stts','Link','Mpag'],
                SERV:['Id','Forn','Detg','Grad','Gimg','OS','Uber','Cbmt','VCbt','Cmnt',"CArt","Oimg"]},

        Clnt: { nav:['HOME','|','ORC','|','CONF'],
                orc:['Arte','Router','Envelopamento','Serigrafia','Figurinha','Topo Bolo','Vendas','Placa','Sinalização','Cartela','Plotagem','Crachá','Carteira','Plaqueta'],
                PDDS:[],
                PGMT:[],
                SERV:[]}
    }
    const tipBS = {}
    
    const Atual    = {Pag:'ORC'}

    let U = {} ; let UCgo = {} ; let Passs = ''
    
    const J        = {PDDS:[],SERV:[],PGMT:[],GRAD:[],MPAG:[],OOSS:[],UBER:[],CLNT:[]}
    const JJ       = {PDDS:[],SERV:[],PGMT:[],GRAD:[],MPAG:[],OOSS:[],UBER:[],CLNT:[]}
    const PreTable = {PDDS:'',SERV:'',PGMT:'',GRAD:'',CLNT:''}
    let todoTitle  = {Serv:[],Cust:[],Soma:[],Sum_Valr:[],Sum_Cust:[]}
    const Secund   = {SERV:'PDDS',PGMT:'PDDS'}
    const ALL      = {CLNT:[]}
    let SlideTable = {PDDS:0,SERV:0,CLNT:0,PGMT:0,GRAD:0,OOSS:0,UBER:0,MPAG:0}
    const D        = {PDDS:0,SERV:0,CLNT:0,PGMT:0,GRAD:0,OOSS:0,UBER:0,MPAG:0}
    const Primary  = {PDDS:'Id',SERV:'Id',PGMT:'Id',CLNT:'Id',GRAD:'Grad',OOSS:'OS',UBER:'Id',MPAG:'Id'}
    let   ListIMG  = []
    let  ContGrad  = {}
    let  ContCLNT  = {}
    
    const Prod = { // Adicionar pra todos eles a proporção do Desconto pela quantidade // adicionar também o comporta das cores
        // Por M2
        'Adesivo'  :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Adesivo Impresso'     , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Cbmt','Aplic']  , Extra:[]             , HotKey:["colar", "adesivar", "autocolante"       ] ,
                        Variantes:{
                            'Brilho'          :{item:'1',Grad:'Ads(Blh)',Tipo:'',Valr:60 ,Cust:20},
                            'Fosco'           :{item:'2',Grad:'Ads(Fos)',Tipo:'',Valr:60 ,Cust:20},
                            'Blackout'        :{item:'3',Grad:'Ads(Blk)',Tipo:'',Valr:70 ,Cust:25},
                            'Transparente'    :{item:'4',Grad:'Ads(Trp)',Tipo:'',Valr:70 ,Cust:25},
                            'Laminado'        :{item:'6',Grad:'Ads(Blh)',Tipo:'',Valr:70 ,Cust:20},
                            'Espelhado'       :{item:'7',Grad:'Ads(Trp)',Tipo:'',Valr:80 ,Cust:20},
                            'Perfurado'       :{item:'5',Grad:'Ads(Prf)',Tipo:'',Valr:100,Cust:35},
            }},
        'Etiqueta' :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Impressão + Recorte'  , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Corte']         , Extra:[]             , HotKey:["rótulo", "identificação", "label", "tag"] ,
                        Variantes:{
                            'Todos'           :{},
                            'Refilada'        :{item:'6',Grad:'Ads(Blh)',Tipo:'',Valr:70 ,Cust:20},
                            'Redonda'         :{item:'7',Grad:'Ads(Rct)',Tipo:'',Valr:75 ,Cust:30},
                            'Personalizada'   :{item:'7',Grad:'Ads(Rct)',Tipo:'',Valr:80 ,Cust:30},
            }},
        'Lona'     :{Calc:'M2' , Stts:'Disp' , Prvw:''        , Desc:'Banner, Faixa, ilhós' , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Instal']        , Extra:[]             , HotKey:["painel"                                 ] ,
                        Variantes:{
                            'Todos'           :{},
                            'Banner'          :{item:'8' ,Grad:'Lon(Bnn)',Tipo:''                              ,Valr:70,Cust:22 , Limit:{Max:{L:1.20,A:0},Min:{L:0.40,A:0.60}} , Mdds:['0,50 x 0,70' , '0,80 x 1,20' , '2,00 x 1,00']}, 
                            'Faixa'           :{item:'9' ,Grad:'Lon(Fax)',Tipo:['Só Madeira','Madeira e ilhós'],Valr:70,Cust:22 , Limit:{Max:{L:0,A:1.20},Min:{L:0.60,A:0.40}} , Mdds:['2,00 x 0,50']}, 
                            'com ilhós'       :{item:'11',Grad:'Lon(Ilh)',Tipo:['Completo'  ,     'nas Pontas'],Valr:70,Cust:22 , Limit:{Max:{x:3.20,X:0},Min:{L:0.40,A:0.40}} , Mdds:['1,00 x 1,00']},
                            'Sem Acabamento'  :{item:'13',Grad:'Lon(Sem)',Tipo:''                              ,Valr:60,Cust:20 , Limit:{Max:{x:3.20,X:0},Min:{L:0.30,A:0.30}} , Mdds:[]},
            }},
        'Quadro'   :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Quadro sem Moldura'   , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Aplic','Cbmt']  , Extra:['PVC','Fita'] , HotKey:["moldura", "pôster", "cartaz"            ] ,
                        Variantes:{  
                            'PS 1mm'          :{item:'17',Grad:'Ads(Blh)',Tipo:'',Valr:100,Cust:21.25 + 20, Limit:{Max:{x:2.00,X:1.00}} , Mdds:['0,30 x 0,20']}, // Folha de PVC com (2,00 x 1,00) R$ 42,50
                            'PS 2mm'          :{item:'18',Grad:'Ads(Blh)',Tipo:'',Valr:130,Cust:'        ', Limit:{Max:{x:2.00,X:1.00}} , Mdds:['0,30 x 0,20']},  
                            'PVC 2mm'         :{item:'14',Grad:'Ads(Blh)',Tipo:'',Valr:150,Cust:'        ', Limit:{Max:{x:2.44,X:1.22}} , Mdds:['0,30 x 0,20']},
                            'PVC 3mm'         :{item:'15',Grad:'Ads(Blh)',Tipo:'',Valr:170,Cust:43.00 + 20, Limit:{Max:{x:2.44,X:1.22}} , Mdds:['0,30 x 0,20']}, // Folha de PVC com (2,44 x 1,22) R$ 86,00
                            'PVC 5mm'         :{item:'16',Grad:'Ads(Blh)',Tipo:'',Valr:' ',Cust:'        ', Limit:{Max:{x:2.44,X:1.22}} , Mdds:['0,30 x 0,20']},
            }},
        'ímã'      :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Geladeira ou Carro'   , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Aplic','Cbmt']  , Extra:['Manta']      , HotKey:["magneto", 'manta magnética'             ] ,
                        Variantes:{ // Adicional de Calendário (Acima de 500 UND)
                            '03 Geladeira' :{item:'19',Grad:'Ads(Blh)',Tipo:'',Valr: 70.00+60,Cust:35.00 , Limit:{Max:{x:0.60,X:0}} , Mdds:['0,05 x 0,06']}, // 0.3 - R$ 21,00 (0,60 x 1,00) || o Metro fica: 
                            '04 Geladeira' :{item:'20',Grad:'Ads(Blh)',Tipo:'',Valr: 95.00+60,Cust:48.33 , Limit:{Max:{x:0.60,X:0}} , Mdds:['0,05 x 0,06']}, // 0.4 - R$ 29,00 (0,60 x 1,00) || o Metro fica: 
                            '08 Carro'     :{item:'21',Grad:'Ads(Blh)',Tipo:'',Valr:180.00+60,Cust:98.33 , Limit:{Max:{x:0.60,X:0}} , Mdds:['0,60 x 0,30']}, // 0.8 - R$ 59,00 (0,60 x 1,00) || o Metro fica: 
            }},
        // Offset
        'Cartão'   :{Calc:'OFS', Stts:'Disp' , Prvw:'Fotinha' , Desc:'Medida: 9cm x 5cn'    , Forn:['BPrint','Bureal']           , Etpa:['Arte','Print','Cbmt']          , Extra:[]             , HotKey:["cartão de visita", "business card", "papel", "folha"] , 
                        Variantes:{
                    'Brilho'      :{Table:[
                        ['Frente' ,'250g',[['500', 90,31,'left:7.6% ;top:33.4%'],['1.000',135,45,'left:26.8%;top:33.4%']]],
                        ['F.Verso','250g',[['500',115,42,'left:52.4%;top:33.4%'],['1.000',150,54,'left:72.2%;top:33.4%']]], 
                        ['Frente' ,'300g',[['500',130,49,'left:0%   ;top:0%   '],['1.000',145,56,'left:0%   ;top:0%   ']]], 
                        ['F.Verso','300g',[['500',150,58,'left:0%   ;top:0%   '],['1.000',165,65,'left:0%   ;top:0%   ']]],]},
                    'Brilho Local':{Table:[
                        ['Frente' ,'300g',[['500',155,62,'left:7.6% ;top:66%  '],['1.000',190,78,'left:26.8%;top:66%  ']]],
                        ['F.Verso','300g',[['500',190,80,'left:52.4%;top:66%  '],['1.000',230,99,'left:72.2%;top:66%  ']]],]},
                    }},
        'Panfleto' :{Calc:'OFS', Stts:'Disp' , Prvw:'Fotinha' , Desc:'Gramatura: 90g'       , Forn:['BPrint','Bureal']           , Etpa:['Arte','Print','Cbmt']          , Extra:[]             , HotKey:["folheto", "papel", "informativo",'folha'] , 
                        Variantes:{
                    '10 x 15':{Table:[
                        ['Frente' ,'90g',[['1.000',130, 67,'left:25.2%;top:25.2%'],['2.500',180, 85,'left:25.2%;top:34.4%'],['5.000',270,170],['10.000',650,340 ]]],
                        ['F.Verso','90g',                                         [['2.500',280,135,'left:69.4%;top:34.4%'],['5.000',320,220],['10.000',720,392 ]]],]},
                    '15 x 20':{Table:[
                        ['Frente' ,'90g',[['1.000',190,127,'left:25.2%;top:56.4%'],['2.500',340,170,'left:25.2%;top:65.8%'],['5.000',650,340],['10.000',900,600 ]]],
                        ['F.Verso','90g',                                         [['2.500',500,270,'left:69.4%;top:65.8%'],['5.000',700,440],['10.000',1200,800]]],]},
                    }},
        'Talão'    :{Calc:'OFS', Stts:'Disp' , Prvw:'Fotinha' , Desc:'Gramatura: 90g'       , Forn:['JLTal']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:[] , 
                        Variantes:{
                    '10 x 15':{Table:[
                        ['Preto e Branco','1 Via',[['4',60,30,'left:22.2%;top:26.8%'],['8', 90,45],['12',130,65],['20',170, 85,'left:22.2%;top:36.8%']]],
                        ['Colorido'      ,'1 Via',[['4',80,40,'left:60.6%;top:26.8%'],['8',110,55],['12',150,75],['20',200,100,'left:60.6%;top:36.8%']]],
                        ['Preto e Branco','2 Via',[['4',75,35],['8',105,55],['12',145,70],['20',185, 80]]],
                        ['Colorido'      ,'2 Via',[['4',95,45],['8',125,65],['12',165,85],['20',215,110]]],
                    ]},
                    '15 x 20':{Table:[
                        ['Preto e Branco','1 Via',[['2',60,30,'left:22.2%;top:58.8%'],['4', 90,45],['10',170, 85],['20',300,150,'left:22.2%;top:69.2%']]],
                        ['Colorido'      ,'1 Via',[['2',80,40,'left:60.6%;top:58.8%'],['4',110,55],['10',200,100],['20',350,175,'left:60.6%;top:69.2%']]],
                        ['Preto e Branco','2 Via',[['2',75,35],['4',105,55],['10',185, 90],['20',315,165]]],
                        ['Colorido'      ,'2 Via',[['2',95,45],['4',125,65],['10',215,110],['20',365,195]]],
                    ]},
                    '9 x 21' :{Table:[
                        ['Preto e Branco','1 Via',[['3',60,30],['6', 90,45],['9',130,65],['12',150, 75]]],
                        ['Colorido'      ,'1 Via',[['3',80,40],['6',110,55],['9',170,85],['12',190, 95]]],
                        ['Preto e Branco','2 Via',[['3',75,35],['6',105,55],['9',145,70],['12',165, 80]]],
                        ['Colorido'      ,'2 Via',[['3',95,45],['6',125,65],['9',185,85],['12',205,100]]],
                    ]},
        }},
        'Tag'      :{Calc:'OFS', Stts:'Disp' , Prvw:'Fotinha' , Desc:'Gramatura: 90g'       , Forn:['Bureal']                    , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["etiqueta", "rótulo", "marcador",'furo'  ] , 
                        Variantes:{
                    '4 x 5':{Table:[
                        ['Reto' ,'250g',[['1.000',130,73,'left:26.8%;top:31%' ]]],
                        ['Curva','250g',[['1.000',150,85,'left:69.2%;top:31%' ]]]
                    ]},
                    '5 x 9':{Table:[
                        ['Reto' ,'250g',[['500',100,57,'left:26.8%;top:54%'  ],['1.000',140,69,'left:26.8%;top:64.4%']]],
                        ['Curva','250g',[['500',120,67,'left:69.2%;top:54%'  ],['1.000',150,79,'left:69.2%;top:64.4%']]]
                    ]},
            }},
        'Cardápio' :{Calc:'OFS', Stts:'Disp' , Prvw:'Fotinha' , Desc:'LAZER, Plastificado'  , Forn:['BPrint']                    , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["menu", "lista de pratos", "menu de restaurante", "opções de comida", "restaurante", "cozinha"] ,
                        Variantes:{
                'A4':{Table:[
                    ['Frente' ,'170g',[['1',15,6.90,'left:23% ;top:26.2%']]],
                    ['F.Verso','170g',[['1',20,8.80,'left:68.6%;top:26.2%']]],
                ]},
                'A3':{Table:[
                    ['Frente' ,'170g',[['1',30,13.75,'left:23% ;top:36.2%']]],
                    ['F.Verso','170g',[['1',35,17.50,'left:68.6%;top:36.2%']]],
                ]},
        }},
        'Topo Bolo':{Calc:'OFS', Stts:'Offf' , Prvw:'Fotinha' , Desc:'Folha 300g Cortado'   , Forn:['BPrint']                    , Etpa:['Arte','Print','Cbmt']          , Extra:[]             , HotKey:[] , img:'Place',
                        Variantes:{
                            'Topo de Bolo' :{}}
        },
        'Crachá'   :{Calc:'OFS', Stts:'Offf' , Prvw:'Fotinha' , Desc:'Tamanho Padrão 9x5'   , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Cbmt']          , Extra:['Acrilico']   , HotKey:[] , img:'Place',
                        Variantes:{
                            'Crachá' :{}}
        },
        'Carteira' :{Calc:'OFS', Stts:'Offf' , Prvw:'Fotinha' , Desc:'Tamanho Padrão 9x5'   , Forn:['BPrint']                    , Etpa:['Arte','Print','Cbmt']          , Extra:['PVC']        , HotKey:[] , img:'Place',
                    Variantes:{
                            'Carteira' :{}}
        },
        'Folha'    :{Calc:'OFS', Stts:'Offf' , Prvw:'Fotinha' , Desc:'Tamanho Padrão 9x5'   , Forn:['BPrint']                    , Etpa:['Arte','Print','Cbmt']          , Extra:['PVC']        , HotKey:[] , img:'Place',
                        Variantes:{
                            'Colchê  300g' :{},
                            'Triplex 300g' :{},
                        }
        },
        // Tecido
        'Camisa'   :{Calc:'QNT', Stts:'Disp' , Prvw:'PrevCAM' , Desc:'Sublimação Total'     , Forn:['Inová']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:["blusa", "camiseta", "roupa", "estampa", "moda", "vestuário","Pano","Tecido"] ,
                        Variantes:{
                            'M.Curta'  :{Tipo:['Helanquinha','Dry Furado'],Tamn:['PP','P','M','G','GG'],Valr:{'1':50,'10':39},Cust:{'1':25}},
                            'Regata'   :{Tipo:['Helanquinha','Dry Furado'],Tamn:['PP','P','M','G','GG'],Valr:{'1':40,'10':29},Cust:{'1':25}},
                            'Polo'     :{Tipo:['Manchaster'              ],Tamn:['PP','P','M','G','GG'],Valr:{'1':80,'10':69},Cust:{'1':25}},
                            'M.Longa'  :{Tipo:['Helanquinha','Dry Furado'],Tamn:['PP','P','M','G','GG'],Valr:{'1':60,'10':49},Cust:{'1':25}},
        }},
        'Calção'   :{Calc:'QNT', Stts:'Disp' , Prvw:'PrevCAM' , Desc:'Sublimação Total'     , Forn:['Inová']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:['Short','Sublimação','roupa','pano'] ,
                        Variantes:{
                            'Bermuda' :{},
                            'Short'   :{},
        }},  
        'WindFlag' :{Calc:'QNT', Stts:'Disp' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['Inová','NovaImp']           , Etpa:['Arte','Print']                 , Extra:['Base']       , HotKey:['Sublimação',"Pano","Tecido",'BigFlag','WindBanner','Bandeira do Vento'] ,
                        Variantes:{
                            Faca :{Tipo:['P','M','G'],Valr:0,Cust:0},
                            Vela :{Tipo:['P','M','G'],Valr:0,Cust:0},
                            Pena :{Tipo:['P','M','G'],Valr:0,Cust:0},
                            Gota :{Tipo:['P','M','G'],Valr:0,Cust:0},
            }},
        'BigBall'  :{Calc:'QNT', Stts:'Offf' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['Inová','NovaImp']           , Etpa:['Arte','Print']                 , Extra:['Base']       , HotKey:['Sublimação',"Pano","Tecido"] ,
                        Variantes:{
                            P  :{Tipo:[''],Valr:0,Cust:0},
                            M  :{Tipo:[''],Valr:0,Cust:0},
                            G  :{Tipo:[''],Valr:0,Cust:0},
            }},   
        'Bandeira' :{Calc:'M2' , Stts:'Disp' , Prvw:''        , Desc:'Tecido: Oxford'       , Forn:['Inová']                     , Etpa:['Arte','Print']                 , Extra:[]             , HotKey:['Sublimação',"Pano","Tecido"] ,
                        Variantes:{
                            'Oxford' :{Tipo:'',Valr:75,Cust:0},
                            'Cettin' :{Tipo:'',Valr:75,Cust:0},
        }},    
        // Cortes
        'Router'   :{Calc:'M2v', Stts:'Offf' , Prvw:'CnvEcut' , Desc:'Cortes em PVC 10mm'   , Forn:['Barraca','Jailson']         , Etpa:['Arte','Corte','Cbmt']          , Extra:[]             , HotKey:[]          , img:'Place',
                        Variantes:{
                            'PVC'      :{},
                            'Acrilico' :{}}
        },
        'Recorte'  :{Calc:'M2v', Stts:'Offf' , Prvw:'CnvEcut' , Desc:'Adesivo Recortado'    , Forn:['Stock']                     , Etpa:['Arte','Corte','Cbmt','Aplic']  , Extra:[]             , HotKey:["Ploter",'Lamina','Siluet','Vetor'] ,
                        Variantes:{
                            'Preto'           :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Branco'          :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Prata'           :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Vermelho'        :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Azul'            :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Verde'           :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Amarelo'         :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Laranja'         :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Rosa'            :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Roxo'            :{item:'22',Calc:'M2',Tipo:'',Valr:150,Valor:70  , Limit:[] , Mdds:[]},
                            'Holografico'     :{item:'23',Calc:'M2',Tipo:'',Valr:200,Valor:100 , Limit:[] , Mdds:[]},
        }},
      'Sinalização':{Calc:'M2v', Stts:'Offf' , Prvw:''        , Desc:'Chapa de PVC ou Zinco', Forn:['Stock']                     , Etpa:['Arte','Corte','Aplic','Cbmt']  , Extra:['PVC']        , HotKey:[]           , img:'Place',
                        Variantes:{
                            'Sinalização' :{}}
        },
        'Trofeu'   :{Calc:'M2' , Stts:'Disp' , Prvw:'CanvMdd' , Desc:'Acrilico Cristal 2mm' , Forn:['Grafit','BPrint','Tatiane'] , Etpa:['Arte','Print','Corte']         , Extra:['Acrilico']   , HotKey:['acrilico'] ,
                        Variantes:{
                            'Virado'          :{Grad:'Ads(Trp)',Valr:60+30+180+100+17, Cust:20+15+90+60}, // Adesivo, Vinil, Acrilico, Corte (ultimos 15 é estouro)
                            'Colado'          :{Grad:'Ads(Trp)',Valr:60+30+180+100+35, Cust:20+15+90+60}, // Adesivo, Vinil, Acrilico, Corte (ultimos 15 é estouro)
        }},
        // Serviços
        'Arte'     :{Calc:'UND', Stts:'Offf' , Prvw:'MdalArt' , Desc:'Criação e Recriação'  , Forn:['Arte']                      , Etpa:['Arte']                         , Extra:[]             , HotKey:[]           , img:'Place',
                        Variantes:{
                    'Arte' :{}}
        },
        'Plotagem' :{Calc:'M2v', Stts:'Offf' , Prvw:''        , Desc:'Aplciação de Adesivo' , Forn:['Stock','WM']                , Etpa:['Aplic']                        , Extra:[]             , HotKey:['Plotagem'] , img:'Place',
                        Variantes:{
                    'Plotagem' :{}}
        },
        // Produtos
        'Figurinha':{Calc:'UND', Stts:'Offf' , Prvw:''        , Desc:'Adesivos Pequenos'    , Forn:['Stock']                     , Etpa:['']                             , Extra:[]             , img:'Place'      ,
                        Variantes:{
                            'Figurinha' :{}}
        },
        'Vendas'   :{Calc:'UND', Stts:'Offf' , Prvw:''        , Desc:'Produtos do Painel'   , Forn:['Stock']                     , Etpa:['']                             , Extra:[]             , img:'Place'      ,
                        Variantes:{
                            'Tanque'   :{},
                            'Quadros'  :{},
                            'Acrilico' :{},
                            'Figurinha':{},
                            'Recorte'  :{},
                            'Cartela'  :{},
                            'Rodagem'  :{},
                        }
        },
        'Cartela'  :{Calc:'UND', Stts:'Offf' , Prvw:''        , Desc:'Cartelas de Adesivo'  , Forn:['Stock']                     , Etpa:['']                             , Extra:[]             , img:'Place'      ,
                        Variantes:{
                            'Cartela' :{}}
        },
        // Ferragem
        'Placa'    :{Calc:'UND', Stts:'Offf' , Prvw:'Canva3D' , Desc:'Fachada de Lojas'     , Forn:['Jailson']                   , Etpa:['']                             , Extra:[]             , img:'Place'      ,
                    Variantes:{
                        'Placa' :{}}
        }, 
       'Serigrafia':{Calc:'UND', Stts:'Offf' , Prvw:''        , Desc:'Estampa de Camisa'    , Forn:['Stock']                     , Etpa:['']                             , Extra:[]             , img:'Place'      ,
                        Variantes:{
                            'Serigrafia' :{}}
        },
        }

    // Const Importante pra Compilar a Tabela de produtos pra deixa o Load Mais Rápido
    const EtrProd = ObjEtr(Prod)
    const AllProd = [...ObjEtr(Prod).filter(([,v])=>v.Stts=="Disp"), ...ObjEtr(Prod).filter(([,v])=>v.Stts=="Offf")].map(([k])=>k) // Antes tava : ObjKey(Prod) // agora ta isso tudo pq agora ta reordenando
    const HotKy   = Object.fromEntries(EtrProd.map(([k,v])=>[k,v.HotKey||[]]))
    const AllAll=stg=>Object.fromEntries(EtrProd.map(([k,v])=>[k,v[stg] || []]))
    const Vari=e=>Prod[e] ? ObjKey(Prod[e].Variantes) : ''

    const ValForn = {
        Grafit:{
            'Adesivo'     :[{val: 20.00, data:"2025-01-01"}],
            'Transparente':[{val: 25.00, data:"2025-01-01"}],
            'Blackout'    :[{val: 25.00, data:"2025-01-01"}],
            'Perfurado'   :[{val: 35.00, data:"2025-01-01"}],
            'Recorte'     :[{val: 32.00, data:"2025-01-01"}],
            'Banner'      :[{val: 22.00, data:"2025-01-01"}],
            'Faixa'       :[{val: 22.00, data:"2025-01-01"}],
            'L.ilhos'     :[{val: 22.50, data:"2025-01-01"}],
            'Lona'        :[{val: 22.00, data:"2025-02-05"}],
        },BPrint:{
            'Adesivo'     :[{val: 20.00, data:"2025-01-01"}],
            'Transparente':[{val: 25.00, data:"2025-01-01"}],
            'Blackout'    :[{val: 25.00, data:"2025-01-01"}],
            'Perfurado'   :[{val: 33.00, data:"2025-01-01"}],
            'Recorte'     :[{val: 32.00, data:"2025-01-01"}],
            'Banner'      :[{val: 24.00, data:"2025-02-01"}],
            'Faixa'       :[{val: 24.00, data:"2025-01-15"}],
            'L.ilhos'     :[{val: 24.00, data:"2025-02-05"}],
            'Lona'        :[{val: 22.00, data:"2025-02-05"}],
        },'Inová':{
            'Camisa'   :[{val: 25.00, data:"2025-02-05"}],
        },Bureal:{
            'Cartão'   :[{val: 20.00}]
        }
    }

    const O = {
        Forn:['','Grafit','BPrint','Tatiane','Inová','Bureal','Stock','Arte','JLTal','Varyus','NovaImp','Barraca','Jailson','--'], // 'WM SilkSing','Casas leo'
        Serv:['',...AllProd],
        SrvF:['',...new Set(Object.values(ValForn).flatMap(Object.keys))],
        Tipo:['','Recorte',...Uniq(AllProd.flatMap(e=>Vari(e)))],
        Form:['','Pix','Av','Card'],
        Pgmt:['','Pix','Av','Card'],
        Dstn:['','Serv1','Serv2'],
        Stts:['','Orçamento','Arte','Analise Art','Impressão','Grad Uber','Falta Uber','Acabamento','Pronto','Entregue','Devendo','Concluído'],
        Cams:['','PP (Inf)','P (Inf)','M (Inf)','G (Inf)','PP','P','M','G','GG','XG','XXG'],
        TArt:['','Criação','Recriação','Vetorização','Digitação','Modificação','Adaptação',,'Restauração','Imagem','do Cliente','Ja Tinha','n Precisa'],
        Dsng:['','Allan','Baby','Fexta','Italo','Euryk','Eurik','Canva','Karol','--'], // Interessante cada um só poder botar a Si mesmo!
    }

    const AllList= ObjKey(O)
    const BrevSrc= {Grad:'Grad',Gimg:'Grad',ImgU:'Grad',ImgG:'Grad',Oimg:'OS'} // Usar Depois pra Separar Imagens por Pastas
    const Dbbrev = {T:'Tatiane',G:'Grafit',B:'BPrint',I:'Inová',U:'Bureal','-':'--'}
    const D_Brev = {HOME:'Principal',ORC:'Orçamento',LOJA:'Loja',GBRT:'Gabaritos',BBTC:'Biblioteca','|':'',PDDS:'Pedidos',SERV:'Serviços',PGMT:'Pagamentos',GRAD:'DashBoard',CLNT:'Clientes',CONF:'Configurações',CUST:'Custos',Tipo:'Tipo',Serv:'Serviço',Lrg:'Largura',Alt:'Altura',Cmp:'Comprimento',Cbmt:'Acabamento',Gram:'Gramatura',Qnt:'QNT',Und:'Valor UND',SbTt:'SubTotal',Aplic:'Aplicação',Vund:'Valor UND',_:'',X:''}
    const dbCol  = {Id:"Id",Lin:"Lin",Data:"Data",Clnt:"Clientes",Serv:"Serviços",Valr:"Valor",Pgmt:"Pagamentos",Cust:"Custos",Lcro:"Lucros",Stts:"Etapa",Lixo:"",Tipo:"Tipo",Desc:"Descrição",Dsng:"Design",Arte:"Arte",Forn:"Fornecedor",OK:"OK",Entg:"Entregue",Detg:"Detg",Grad:"Grad",Gimg:"Gimg",OS:"OS",Uber:"Uber",Cmnt:"Comentário",SStts:"Status",Form:"Forma",Link:"Link",Mpag:"Mpag",Item:"Item",Dstn:"Destino",Pcnt:"Porcentagem",Cmpt:"Complemento",Cntt:"Contato",Lcal:"Local",Loja:"Loja",CtLj:"Ctt Loja",Cat:"Categoria",Emal:"Email",Cont:"Cont",Nome:"Nome",QntS:"Qnt",VUbr:"Valor Uber",AsStts:"Stts",Dest:"Destino",Hora:"Hora",Dirc:"Direção",Prds:"Paradas",Cpvt:"Comprovante",User:"Usuário",Qnt:"Qnt",Lag:"Lag",Alt:'Alt',TArt:'TArt',ImgU:"ImgU",ImgG:'ImgG',Oimg:'Oimg',SrvF:'Produto',VlrO:'VlrO',Cnt2:'Cnt2',Summ:'Summ',Manu:'Manu',Medi:'Media',Img:'Img',Deve:'Resta'}
    const CRYCLS = {A:'AutoComp',I:'CorID'}
    const CRYPP  = {F:'Fixo',E:'Edit',D:'Data',V:'Valr',S:'Slct',C:'Chek',M:'Imgs',Z:'Mdds',B:'Bndj',    A:'Auto',O:'Soma',X:'Lixo',W:'Ssvg',Y:'Sync',G:'Sugg',K:'Link'}

    // Algumas dessas ficam aqui mesmo, elas não guardam valor no Supabase!
    const BS = { // ['1º é Forma de Carregar', '2º são as Classes CSS // Pode ter um Terceiro q deva ter algo aver com AutoComp
        PDDS:{Id:['F','I'],Data:['D','' ],Clnt:['B','' ],Serv:['B','' ],Valr:['A','' ],Pgmt:['B','' ],Deve:['A','' ],Cust:['A','' ],Lcro:['A','' ],Stts:['W','' ],Lixo:['X','' ]}, /*Valr - Cust - Lcro - Stts*/
        SERV:{Id:['F','I'],Data:['D','A'],Clnt:['B','A'],Serv:['S','' ],Tipo:['S','' ],Qnt :['E','' ],Lag :['Z','' ],Alt :['Z','' ],Desc:['E','' ],Surg:['A','' ],Valr:['V','A'],TArt:['S',''],Dsng:['S',''],Arte:['M','' ],CArt:['V',''],Grad:['E','']/*Tava 'K'*/,Gimg:['M','A'],Forn:['S','A'],OS:['Y','A'],Uber:['Y','A'],Cbmt:['E',''],VCbt:['V',''],OK:['C',''],Entg:['C',''],Detg:['E',''],Cmnt:['E',''],SStts:['W','A'],Lixo:['X','']}, // Arte, Gimg, OS, Uber, SStts
        PGMT:{Id:['F','I'],Data:['D','' ],Clnt:['B','' ],Valr:['V','' ],Form:['S','' ],Desc:['E','' ],Mpag:['G','' ],Lixo:['X','' ]},
        CLNT:{Id:['F','I'],Clnt:['E','' ],Cmpt:['E','' ],Cntt:['E','' ],Lcal:['E','' ],Loja:['E','' ],CtLj:['E','' ], Cat:['E','' ],Stts:['E','' ],Link:['E','' ],Lcro:['E','' ],Medi:['E',''],Lixo:['X','']},
        
        GRAD:{Id:['F','I'],Grad:['E','' ],Data:['D','' ],ImgU:['M','A'],ImgG:['M','A'],Forn:['S','A'],SrvF:['S','' ], Qnt:['E','' ], Lag:['Z','' ], Alt:['Z','' ],Valr:['Y','A'],Cont:['E',''],Cnt2:['F','A'],OS:['E',''],VlrO:['Y','A'],Summ:['Y','A'],Oimg:['M','A'],Uber:['E',''],VUbr:['Y','A'],Lixo:['X','']},
        OOSS:{Id:['F','I'],OS  :['E','' ],Valr:['V','' ],Oimg:['M','A'],Cont:['E','' ],Cnt2:['A','A'],Desc:['E','' ],Lixo:['X','' ]},
        UBER:{Id:['F','I'],Uber:['E','' ],Data:['D','' ], Img:['M','A'],Dest:['E','' ],Hora:['E','' ],Valr:['E','' ],Dirc:['E','' ],Prds:['E','' ],Desc:['E',''],Grad:['E',''],Link: ['G',''],Lixo:['X','']},
        
        MPAG:{Id:['F','I'],Cpvt:['E','' ],Data:['E',''],Clnt:['E','' ],Valr:['E','' ],Hora:['E',''],Form:['E','' ],User:['E','' ],Link:['G',''],Lixo:['X','']}, // Removi 'Cpvt'
    }

    // Configuração do SupaBase
    const SUPABASE_URL      = "https://adxigvfxtafvlmpvwwvb.supabase.co"
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkeGlndmZ4dGFmdmxtcHZ3d3ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1Njc1NTEsImV4cCI6MjA2NzE0MzU1MX0.wc90qDuSNhtolJBd4qLEux3xCwJwPuTTFb3gZMKUBYU"
    const supabase          = window.supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY)
    const BASE_URL          = `https://adxigvfxtafvlmpvwwvb.supabase.co/storage/v1/object/public/uploads/`
</script>

<script> // Bibliotecas
    // Epecíficas (as q Retorna)
        const OjKy    =Typ=>ObjKey(BS[Typ]) // o nome pode mudar pra algo mais Intuitivo
        const Colx    =(Typ,col)=>FIdx(OjKy(Typ),col)+1
        const daClass =R=>{const bs = BS[R.Typ][R.Col][1] ; return (bs==true?'':bs).split('').map(e=>CRYCLS[e]).join(' ') || ''} // Aplica as Casses q estão no 'bs'
        const tr_ID   =tr =>getClss(tr,'tr-').split('-')[1]
        const tr_X    =tr =>getClss(tr,'tr-').split('-')[2]
        const TRs     =Typ=>$$(`#H_${Typ} > tbody > tr`)
        const Rx2     =arry=>Rx(['Rastr',...arry])
        const D_Rastr =e=>getClssIN(e,'Rastr-').split('-')
        const D_R     =R=>{const v = (typeof R === "string" ? R : getClssIN(R,'Rastr-')).split('-') ; return {r:v[0],Typ:v[1],Row:v[2],Col:v[3],Tm:v[4],ColX:v[5]}}
        const D_P     =R=>{const v = (typeof R === "string" ? R : getClssIN(R,'Rpai-' )).split('-') ; return {r:v[0],Typ:v[1],Row:v[2],Col:v[3],Tm:v[4],ColX:v[5]}}
        const DrPai   =R=>R.replace('Rastr','Rpai')
        const Coll    =x=>`td:nth-child(${x})`
        const Col     =(Typ,col)=>`td:nth-child(${Colx(Typ,col)})`
        const Colls   =(Typ,col,n=null)=>$$(`#H_${Typ} > tbody > tr${n?':not([class*=" n"])':''} > ${Col(Typ,col)} > div > .P-P`)
        const H_Col_p =(Typ,col)=>`#H_${Typ} > tbody > tr > ${Col(Typ,col)} p` // analisar se é realmente nessesário
        const TDd=(tr,col)=>    $(`:scope > ${Rx2([col])}`,tr)
        const TDd2=(tr,col)=>   col=="Serv" ? $(`:scope > ${Rx2([`${col}-Slct`])}`,tr) : TDd(tr,col) // exessão apenas para o Serv de SERV
        const TDv=(tr,col)=>VAL($(`:scope > ${Rx2([col])}`,tr))
        const TDp=(tr,col)=>    $(`:scope > ${Rx2([col])} .P-P`,tr)
        const FiM=(arr)=>arr.slice(0,-1)
        const TH      =(Typ,col)=>$(`#H_${Typ} > thead > tr ${Col(Typ,col).replace('td:','th:')}`)
        const RgxPixAV=e=>e.trim().match(/(\d+[\.,]?\d*)([a-zA-Z]+)/) || []
        const SunPix  =Stg=>Stg.split('|').map(p=>parseFloat(p.replace(/[^\d.,]/g,'').replace(',','.'))||0).reduce((sum,n)=>sum+n,0)
        const isBdj   =e=>!!e.closest('.BndjTBL')
        const AllI    =(table,Atv=null)=>$$(`:scope > thead > tr > th ${Atv=='Atv'?'i.Atv':'i'}`,table)
        const Listagem=(Typ,col)=>ALL[Typ] = Uniq(J[Typ].map(e=>e[col])) // pegar todos itens de uma determinada coluna no Json e botar na const ALL
        const NoneCol=(Typ,col)=>Cgo[U?.cgo]?.[Typ]?.includes(col) ? `display:none` : ''
        const ExtnArt=e=>ListIMG.find(l=>l.split(".")[0]===e) || null // isso é um LOOP q ta sendo Chamado Várias vezes, não Pode!
        function slideTo(i,Typ){SlideTable[Typ] = Math.max(0,Math.min(2,i));$(`#Slide_${Typ}`).style.transform = `translateX(-${SlideTable[Typ] * 100}%)`}

        const ReszH=(Typ)=>{TrcTog($(`#H_${Typ}`),'hMin','hMax')                     ;SaveConfig('a')}
        const ReszW=(Typ)=>{Tog($(`#H_${Typ}`),'w100');Tog($(`.Confy_${Typ}`),'w100');SaveConfig('a')}

        // provavelmente vou tiar tudo isso daqui (Tornarão-se inutil, quando eu trouxer o novo Drag)
            const ALERT=Stg=>{Inn('#ALERT span',Stg);ShowTime2('#ALERT',5)}
            function Drag() {event.dataTransfer.setData("text",    event.target.id)}
            function Drag2(){event.dataTransfer.setData("text",Pai(event.target).id)}
            function Drop() {Prvn();event.target.appendChild($(`#${event.dataTransfer.getData("text")}`))}
            const DarkLite2=(e,Chk)=>{if(Chk){Trc2(e,'Dark','Lite')}else{Trc2(e,'Lite','Dark')} ; LOG('Chamou DarkLite',e,Chk)} // conferir se essa é realmente nessesária
        
        //Evento de Click na Página inteira, com a intenção de Ocultar tudo que for Bandeijas
        function NoneBndj(){if(event.target.closest('.bndj')||event.target.classList.contains('NObj')){return}else{None($$('.bndj'))}}
</script>

<div> <!--JS e CSS das Tabelas-->
    <div>   <!--TABELAS  - ⭐⭐⭐_ _ -->
        <style> /*CSS apenas da Tabela*/
            /*essa bndj deveria ter "Shdw rd Cl"*/
            .BNdj    {transform:translate(-50%,0%); left:50%; z-index:500 ; width:250px ; max-height:250px;  box-shadow:0 0 9px #00000069}
            .BNdj > a{position:absolute ; bottom:100%; left:50%; transform:translate(-50%,0%); z-index:1; width:20px ; height:11px} /*essa é a Pontinha da Bndj*/
            /*Particularidades*/
            .BndjFOT,.BndjFLT{overflow: hidden}
            .BndjSUG .Sugg    ,.BndjTBL .Sugg    ,.MySelect .Sugg    {border-radius:10px}
            .BndjSUG .Sugg > *,.BndjFOT .Sugg > *,.MySelect .Sugg > *{padding: 4px}
            .BndjTBL{padding:5px ; width:auto !important; height:auto !important}
            .BndjFOT{border-radius:10px 10px 0 0; bottom:0px}
            .BndjFLT{border-radius:0 0 10px 10px}
            .BjConf         {color:#ffffff; height:24px}
            .BjConf img     {height:18px; width:18px}
            .BjConf span.Atv{fill:#ffff00; background:#00df00}
            .BndjFLT input  {height:18px ; width:80px}
            .Sugg {overflow-x: hidden; overflow-y: auto; max-height: 200px; width: 100%;}
                th .Sugg div:hover div{opacity:1}
                th .Sugg div div      {opacity:0;font-size:15px; background:#d822ab; color:#ffffff; width:18px; height:18px; text-align: center; margin-left:10px ;} /*Bolinhas + e -*/
    
            /*Fica apenas nas Tabelas*/
            .Antig{color: #ffffff; font-size: 7px; top: 0px;}
            .Ant-Blu{background:#0000ff !important}
            .Ant-Red{background:#ff0000 !important}
            .Ant-Grn{background:#008000 !important}
            .Ant-Bol{width:6px; height:6px; border-radius:255px}
                td        .grifoo{display:none  ; height:5px; width:5px ; left:0px}
                td.Grifo2 .grifoo{display:block ; background:#ff880060}
                td.Grifo1 .grifoo{display:block ; background:#ff8800fd}
                select.Psq {background:#ff7b00} /*Grif do Select*/
            .TBLAA tfoot  [class*="Foot-Pgmt"] a{color:#00df00}
            .TBLAA tfoot .RS{color:#00df00; font-size:7px}
            .icoFone{height: 12px !important ; width: 12px !important ; top: -16px; right: -87px;}
            .CorID     {background:#94949473}
            /*Maneiras de Selecionar uma Célula*/
                .SelectSoma{background:#ff0000; color:#ffffff}
                .LinkAtv   {background:#028602; color:#ffffff}
                .LinkULT   {background:#1900ff; color:#ffffff}
                
            /*Cria as Linahs de Divisórias de Serv*/ /*Algo assim também pode ser Aplicado pra as Larguras das Colunas*/
            :is(.Bdj_SERV, #H_SERV) > * > tr > :is(td,th):is(:nth-child(3),:nth-child(09),:nth-child(15),:nth-child(20),:nth-child(22),:nth-child(25)){border-right:4px solid #bb0092}
            :is(.Bdj_SERV, #H_SERV) > * > tr > :is(td,th):is(:nth-child(4),:nth-child(10),:nth-child(16),:nth-child(21),:nth-child(23),:nth-child(26)){border-left :4px solid #bb0092}

            :is(#H_GRAD) > * > tr > :is(td,th):is(:nth-child(13),:nth-child(17)){border-right:4px solid #bb0092}
            :is(#H_GRAD) > * > tr > :is(td,th):is(:nth-child(44),:nth-child(18)){border-left :4px solid #bb0092}

            /*.TBLAA p.P-P{display: inline-block; white-space: nowrap; }*/

            table.Card {background: none !important;}
            table.Card > thead{display: none}
            table.Card > tfoot{display: none}
            table.Card > tbody{display:flex; flex-wrap:wrap; gap:12px ; padding:10px}
            table.Card > tbody > tr{ /*CARD*/
                padding: 8px;
                background:#ffffff;
                border-radius: 16px;
                box-shadow: 0 4px 12px #0000001a;
            }
            table.Card > tbody > tr {
                display: grid;
                grid-template-areas:
                    " Id   Id  Data"
                    "Clnt Clnt Stts"
                    "Serv Serv Serv"
                    "Valr Pgmt Deve"
                    "Obs  Obs  Obs ";
                grid-template-columns: 1fr auto auto;
                gap: 4px 4px
            }
            table.Card > tbody > tr[class^="n"]{display: none;}
            table.Card .AutoComp,table.Card .CorID{background: transparent !important;}
                                       table.Card > tbody > tr{width:calc(25% - 9px)}        /*Largura dos Cards 4 por Linha*/
            @media (max-width: 800px) {table.Card > tbody > tr {width: calc(33.333% - 8px)}} /* 3 por linha */
            @media (max-width: 500px) {table.Card > tbody > tr {width: 100%}}                /* 1 por linha */
            
            table.Card > tbody > tr > td{padding: 5px; border-radius: 255px ; height: auto !important; } /*border: 1px solid red;*/
            table.Card > tbody > tr > td:nth-child(1) { grid-area: Id   }table.Card > tbody > tr > td:nth-child(1) > div > .P-P {color:#780096; font-size: 10px ; font-weight:bold}
            table.Card > tbody > tr > td:nth-child(2) { grid-area: Data }table.Card > tbody > tr > td:nth-child(2) > div > .P-P {color:#666666; text-align:right                        } table.Card > tbody > tr > td:nth-child(2) > div > .P-P > img{height:11px; margin-right:3px ; display: block;}
            table.Card > tbody > tr > td:nth-child(3) { grid-area: Clnt }table.Card > tbody > tr > td:nth-child(3) > div > .P-P {color:#000000d5; font-size: 18px ;                     } table.Card > tbody > tr > td:nth-child(3) > .Ct{justify-content:start}
            table.Card > tbody > tr > td:nth-child(4) { grid-area: Serv }table.Card > tbody > tr > td:nth-child(4) > div > .P-P {color:#000000;                 ;                       } table.Card > tbody > tr > td:nth-child(4) > .Ct{justify-content:start}
            table.Card > tbody > tr > td:nth-child(5) { grid-area: Valr }table.Card > tbody > tr > td:nth-child(5) > div > .P-P {color:#008000; font-size: 16px ; font-weight:bold      } table.Card > tbody > tr > td:nth-child(5) > .Ct{justify-content:start}
            table.Card > tbody > tr > td:nth-child(6) { grid-area: Pgmt }table.Card > tbody > tr > td:nth-child(6) > div > .P-P {color:#000000; }
            table.Card > tbody > tr > td:nth-child(7) { grid-area: Deve }table.Card > tbody > tr > td:nth-child(7) > div > .P-P {color:#c7380c; font-size: 12px}
            table.Card > tbody > tr > td:nth-child(8) { grid-area: Cust ;display: none}table.Card > tbody > tr > td:nth-child(8) > div > .P-P {color:#c7380c; font-size: 12px}
            table.Card > tbody > tr > td:nth-child(9) { grid-area: Lcro; display: none;}
            table.Card > tbody > tr > td:nth-child(10){ grid-area: Stts }table.Card > tbody > tr > td:nth-child(10) > div > .P-P{color:#999999; width: 50px;}
            table.Card > tbody > tr > td:nth-child(11){ grid-area: Obs  ; display: none; color:#757575; font-size: 12px}
            table.Card > tbody > tr > td:nth-child(12){ grid-area: Lixo ; display: none;}

            /*Rodar as Ecessões*/
            table.Card > tbody > tr > td:nth-child(3) {background: none !important}

            table.Tbla td[class*="Data"] a{display: none}
            table.Tbla td[class*="Data"] p{display: flex}
            table.Card td[class*="Data"] a{display: flex}
            table.Card td[class*="Data"] p{display: none}

            .TBLAA tbody td:not([class*="-Bndj-"]) > div:not(.Sklt)        {width: 100% !important; height: 100% !important;} /*pra pegar as de Fora da Bndj*/
            .BndjTBL tbody td                      > div:not(.Sklt)        {width: 100% !important; height: 100% !important;} /*pra pegar as de dentro*/
            .TBLAA tbody td:not([class*="-Bndj-"]):not([class*="-Auto-"]) p{height:100%; width: 100%}
            .TBLAA   tbody td p                                            {padding:2px 6px; text-align:center}
            .BndjTBL tbody td p                                            {height:100%; width: 100%; padding:2px 6px; text-align:center}

            .TBLAA tbody > tr:not([class*="Hoov"]):hover      {filter: saturate(1.6) brightness(1.05); z-index: 999999}
            .TBLAA tbody > tr td:not([class*="Hoov"]):hover   {background:#7469713a;filter: saturate(1.6) brightness(0.8) ; z-index: 999999}

        </style>

        <script>// TABELAS (Transitar na Tabela com as Setas do Teclado)
            const Tm_R=(e,x,Typ,id)=>{const BSBS=(typ,x,idx)=>BS[typ][OjKy(typ)[x]][idx] ; return `Rastr-${Typ}-${e=='Foot'?'Foot':e[isArr(e)?0:id]}-${OjKy(Typ)[x]}-${CRYPP[BSBS(Typ,x,0)]}-${x+1}`}
            const Tm_Sklt=(Typ)=>For(16).map(()=>`<tr>${OjKy(Typ).map(()=>`<td><div class="Sklt"></div></td>`).join('')}</tr>`).join('') // Esqueleto
            const Tm_tdFoot=(arr,Typ)=>arr.map((e,x)=>`<td style="${NoneCol(Typ,e)}" class="${Tm_R('Foot',x,Typ,'')} Rltv"></td>`).join('')
            const Tm_Antg=(A)=>A ? `<div class="Abslt Antig Ant-${A[0]} ${A[1]==''?'Ant-Bol':''}">${A[1]}</div>` : ''

            const SrcsIMG=(e,R)=>{ //carregam usando seu próprio valor (Pois eu sempre Atribuo antes de chamar isso)
                if(e.includes('blob:')){return e} // quando eu Acabei de Importar! ela vem assim!
                const Past = 'Img' // BrevSrc[R.Col]||R.Col (Depois trocar de Pasta pra pegar versão Thumb)
                const Src  = ExtnArt(e) ; return Src ? `${BASE_URL}${Past}/${Src}` : `./SVG/${R.Col=='Arte'?'Upload':'placeholder'}.svg`
            }

            const FazerTitle=(col,Find)=>{ // fazer os Titulos para as Bandeijas
                return  col==='Serv' ? Find.length>3 ? Find[0].Desc : BrevTitle(Find.map(e=>e.Serv ? `${e.Qnt} - ${e.Serv} ${e.Lag&&e.Alt?`${Cm(e.Lag)} x ${Cm(e.Alt)}`:`${e.Lag}${e.Alt}`}` : `${e.Desc}`).join(' | ')) :
                        col==='Pgmt' ? Find.map(e=>`${e.Valr}${e.Form}` ).join(' | ') :
                                       Find.map(e=>`${e[col]}`          ).join(' | ')
            }

            // Passar pra PreScript removendo o 2
            const TrcFih2 = (e, showChild) => Filh(Pai(e)).forEach(f => (f === e ? None(f) : (showChild ? (f === showChild ? Show(f) : None(f)) : Show(f)))) || (showChild && showChild.focus());

            const Tm_Tm = {
                Fixo:(e,R,A)=>`<p class="P-P Ct" name="${e}">${e}</p>`, // o Fixo também tem Data por isso tinha informação de data aqui
                Auto:(e,R,A)=>`<p class="P-P Ct" name="${Num(e)}" onclick="CtrlSoma(this)">${e}</p>`,
                Sync:(e,R,A)=>`<p class="P-P Ct" name="${e}" onclick="CtrlSoma(this)">${e=='--'?'--':e==''?'':e==0?'--':RS(e)}</p>`, // a idéia seria receber aqui sempre um Numero
                Edit:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}" ${TM.Edi} onkeydown="EntBlr(this)" onblur="Rmv(_td(this),'Foco');EditCell(this)" onfocus="Add(_td(this),'Foco')">${e}</p>`,
                Valr:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}" ${TM.Edi} onkeydown="EntBlr(this)" onblur="Rmv(_td(this),'Foco');EditCell(this)" onfocus="Add(_td(this),'Foco');CurAll(this)" oninput="Mask.RS(this)">${e?RS(e):'R$ -'}</p>`,
                Mdds:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${e}" ${TM.Edi} onkeydown="EntBlr(this)" onblur="Rmv(_td(this),'Foco');EditCell(this)" onfocus="Add(_td(this),'Foco');CurAll(this)" oninput="Mask.Num(this)">${e?Cm(e):''}</p>`,
                Data:(e,R,A)=>`${Tm_Antg(A)}<p class="P-P Ct" name="${YMD(e)}" onclick="TrcFih2(this,$('input',Pai(this)))">${BrevData(DMY(e))}</p><a><img src="./SVG/Tempo.svg">${QntTempo(YMD(e))}</a><input type="date" class="none" value="${YMD(e)}" onchange="EditCell(this)" onblur="TrcFih2(this,$('p',Pai(this)))">`,
                Slct:(e,R,A)=>`${Tm_Antg(A)}<select class="P-P w100" name="${e}" onchange="EditCell(this)">${R.Col==='Serv' ? Tm_OptsGraff(O[R.Col],e) : Tm_Opt(O[R.Col],e)}</select>`,
                Chek:(e,R,A)=>`<input  class="P-P"      name="${e}" onchange="EditCell(this)" type="checkbox" ${Bool(e)?'checked':''}>`,            
                Imgs:(e,R,A,pai)=>/*pai?`<p class="P-P Ct" name="${e}">${e}</p>`:*/`<img class="P-P" loading="lazy" name="False" draggable="false" src="${SrcsIMG(e,R)}" onclick="AbrirImg('${R.Row}',this,'${ExtnArt(R.Row)?'':R.Col=='Arte'?'X':'Place'}')">`, // esse Pai ta aqui pra impedir q as imagens internas carregem (pra que sejam só carregadas quando Abrir a Bandeija)
                Sugg:(e,R,A)=>`<div class="Rltv"><p class="P-P">${e}</p><div class="BndjSUG BNdj Abslt none Cl"><a>${SVG.Ponta}</a><span class="Sugg Cl"></span><button class="Mini Stky2" onclick="Linkar(this)">Linkar</button></div></div>`, // daqui eu quero só o Botão
                
                // esse Link é pra Linkar uma ou Mais Linhas de Outra Tabela opções de "Apenas Troca" ou de "Adição"
                Link:(e,R,A)=>`<div class="Rltv"><p class="P-P" onclick="ShowBndj(_td(this))" name="${e}">${e==''?'-':e}</p><div class="BndjSUG MySelect BNdj Abslt none Cl"><a>${SVG.Ponta}</a>
                    
                    <input class="Stky" placeholder="${dbCol[R.Col]}" oninput="LinkSug('${AA(R.Col)}',this)" onkeydown="KeyEntr(()=>TestRow(this,'${R.Col}'))"><span class="Sugg Cl"></span>
                    
                    </div></div>`,
               
                Ssvg:(e,R,A)=>`<p class="P-P Ct" name="${e}">${e}</p>`,
                Lixo:(e,R,A)=>`<a onclick="RmvROW(this)" name="${e}">${SVG.Lixo}</a>`,
                Mdal:(e,R,A)=>``
            }
            

            function Tm_Bndj(Typ,col,Arr,r){
                const Ordem = ObjKey(BS[col.toUpperCase()])
                const Find  = col==='Clnt' ? [JJ[AA(col)][`${Arr}`]] : Arr||[]
                if((Typ=='SERV' || Typ=='PGMT') && col=='Clnt'){return Tm_Tm['Fixo'](Find[0]?.Clnt)} // Retornar Vazio quando for Bandeija Cliente
                            
                const Bandeija=(arr,TYP,RPai)=>`<table class="Bdj_${TYP} ${arr[1][0]==""?'none':''}">
                        <thead><tr>${arr[0].map(t=>`<th style="${NoneCol(TYP,t)}">${t}</th>`).join('')}</tr></thead>
                        <tbody>${arr.slice(1).map((LL,X)=>`<tr class="tr-${LL[0]}-${X}">${LL.map((v,x)=>Tm_Td(v,LL,x,TYP,RPai)).join('')}</tr>`).join('')}</tbody>
                    </table>`

                // da pra melhorar o Desempenho desse Bloco Reduzindo as repetições de Find.map()
                col=='Serv'? Find.map(e=>`${todoTitle[col].push(e.Serv)}`) : null
                const Cimg = col==='Serv'? Find.map(e=>{const Src = ExtnArt(e.Id) ; return Src ? `<img class="Img_T-T" onclick="AbrirImg('${e.Id}',this)" loading="lazy" src="${BASE_URL}/Img/${Src}">`:'<img class="Img_T-T" src="">'}).join('') : ''                
                const Fone = col==='Clnt'? Find[0] ? Find[0].Cntt==='' ? '' : `<img class="icoFone HOV" onclick="LOG('FONE')" src="./SVG/Icon_Fone.svg">`:'' : ''
                const Title = FazerTitle(col,Find)

                return `<div class="Ct"><p class="P-P T-T Ct" ${col==='Pgmt'?`name="${SunPix(Title)}"`:`name="${Title}"`}>${Title}</p>${Fone}${Cimg}<i class="grifoo RD"></i></div>
                        <div class="Rltv w100"><div class="BndjTBL BNdj Abslt none Cl"><a>${SVG.Ponta}</a>
                                ${Find.map((e,x)=>x===0 ? Bandeija(ArrObj_OrdnCol(Find,Ordem),AA(col),DrPai(r)) : '').join('') /*Tabela*/}
                                <button class="Mini" onclick="${col=='Clnt'?'TrocaClnt(this)':'AddRowBdj(this)'}">${col=='Clnt'?'Trocar':'+ Novo'} ${RmvPlural(D_Brev[AA(col)])}</button>
                                ${col=='Clnt'?`<div class="DivTrcCLNT none">
                                    ${/* Aqui Chamar, Tm_Tm['Link'](??,R,'')  é importante q isso esteja aqui dentro pra evitar problemas Futuros */''}
                                    <input class="Stky" placeholder="Clientes" oninput="LinkSug('CLNT',this)" onkeydown="KeyEntr(()=>TestRow(this))"><span class="Sugg Cl"></span>
                                    
                                    </div>`:''}
                            </div>
                        </div>`
            }

            function Tm_Td(v,e,x,Typ,RPai=''){
                const r = Tm_R(e,x,Typ,'Id') ; const R = D_R(r) ; const Scd = ObjKey(Secund).includes(Typ) ? 'Secund' : ''
                const valid = Typ!=='CLNT' && R.Tm=='Bndj' && R.Col=='Clnt' && v=="" && RPai=='' // se for uma Bndj de Clnt e tiver vazio então chama SuggClnt
                
                return valid     ? `<td style="${NoneCol(Typ,R.Col)}" class="${r} ${RPai} ${Scd} ${daClass(R)} Rltv"><div class="Ct">${Tm_Tm['Link'](v,R,'',RPai)}</div></td>` :
                    R.Tm=='Bndj' ? `<td style="${NoneCol(Typ,R.Col)}" class="${r} ${RPai} ${Scd} ${daClass(R)} Rltv" onclick="ShowBndj(this)">${Tm_Bndj(Typ,R.Col,v,r)}</td>` :
                    R.Tm=='Sugg' ? `<td style="${NoneCol(Typ,R.Col)}" class="${r} ${RPai} ${Scd} ${daClass(R)} Rltv" onclick="ShowBndj(this);SuggLink(this,'${r}')"><div class="Ct">${Tm_Tm[R.Tm](v,R)}</div></td>`
                                 : `<td style="${NoneCol(Typ,R.Col)}" class="${r} ${RPai} ${Scd} ${daClass(R)} Rltv"><div class="Ct">${Tm_Tm[R.Tm](v,R,'',RPai)}</div></td>`
            }

            function Tm_Table(Typ,arry,Rpai=''){ // Achava interessante ela mesmo aqui dar o Inner!
                const IN = performance.now()
                const Retorno = arry.reverse().map((e,X)=>{ // Reverso deve ser Opcional
                    const oID = Num(`${e.Id}`.split('_')[0]) // talvez isso deva virar biblioteca depois!
                    if(['PDDS','SERV','PGMT'].includes(Typ) && oID < U.Limt.INN || oID > U.Limt.OUT){return} // limitar as linhas a ser Exibida!
                    if(e.Lixo==true)       {return} // Remover os que estão Na Lixeira!
                    if(e.Stts=='Concluido'){return} // Remover as Concluidas
                    return `<tr class="tr-${e.Id}-${X}">${ObjOrdn(e,OjKy(Typ)).map((v,x)=>Tm_Td(v,e,x,Typ,Rpai)).join('')}</tr>`}).join('')
                LOG(`⏱️🔴 Tm_Table(${Typ}): ${MS(IN)}`)
                return Retorno
            }

            function loadtmtable(Typ){
                const LOAD=(TYP)=>{
                    Add_N($(`#H_${TYP}`)) // Oculta a Table Original pra poder ver o Esqueleto
                    setTimeout(()=>{
                        Inn($(`#H_${TYP} > tbody`),Tm_Table(TYP,J[TYP]))
                        RFresh(TYP,'All')
                        Rmv_N($(`#H_${TYP}`)) // Exibir a table Original
                        if($(`#SKLT_${TYP}`)){Add_N($(`#SKLT_${TYP}`))} // Ocultar o Esqueleto
                },0)}

                if(ObjKey(J).includes(Typ)){
                    if(PreTable[Typ]==true){ALERT(Mnsg['PreTbl'](D_Brev[Typ]));return} // Conferir se essa Aba já foi Aberta!
                         if(Typ=='PDDS'){LOAD(Typ);LOAD('SERV');LOAD('PGMT')         } // tem 3 Tabelas na #PagPDDS
                    else if(Typ=='PGMT'){LOAD('MPAG')                                } // tem 2 Tabelas na #PagPGMT
                    else if(Typ=='GRAD'){LOAD(Typ);LOAD('OOSS');LOAD('UBER')         } // tem 3 Tabelas na #PagGRAD
                    else{LOAD(Typ)}                                                    // os demais tem só 1 tabela
                    PreTable[Typ]=true                                                 // Declarar que a Aba já foi Aberta!
                }
            }
            
            // Grad OS e Uber terá sua própria Bndj, q será 
            // 💡 Criar um Tm pra Cont, q seria tipo uma Bandeija igual de Sugg, ContGrad e ContCLNT q mostrará uma Minitabelinha igual a um Sugg, vai ser feita na hora, com informações sobre oq tem ali
            // 💡 ao Clicar no ID, exibirá RG:[User,PC,Data,Hora] como Bandeija
            // 🚫 select deveria ter name pra n ser afetado pelo Realtime
            // 🚫 ao Excluir e Adicioanr linha na Bandeija ela está Fechando Sozinha
            // 🚫 impedir que cliente seja excluido quando ele tiver atribuido a pelomenos 1 Pedido
            // ⚡ Desempenho Fodah, só Carregar as imagens internas quando clicar na Bandeija (e Outras coisas mais Banais também)
            // ⚡ só Carregar a Bandeija de Clnt, quando clicar em Clnt, caso contrário ela n precisa existir (fazer algo parecido com as mini Bndj q ficará)
            // 💡 Opção de mais de 1 Designer
            // 💡 Mover-se nas células com as Setas
        </script>
    </div>

    <script> // PESQUISA - ⭐⭐⭐⭐_  (só UPGRADES )
        const Grifar  =(e,Rgx  )=>e.replace(Rgx,match=>`<strong style="background:orange" name="">${match}</strong>`)
        const Espelhar=(Org,Dst)=>{Dst.forEach(e=>{e.innerHTML = Org.innerHTML ; $('input',e) ? $('input',e).value = $('input',Org).value : null})} // Provavelmnte da pra usar com outras coisas tbm fora Pesq
        let debounceTimer

        function Pesq(Inpt,Typ){                // ✔️ Fazer a Pesquisa
            clearTimeout(debounceTimer) // cancela chamadas anteriores
            debounceTimer = setTimeout(()=>{
                Espelhar(Pai(Inpt),$$(`.Pesq_${Typ}`).filter(e=>e!==Pai(Inpt)))
                if(Typ=='ORC'){
                    const r = new RegExp(RxClear(Inpt.value),'i')
                    $$('#Div-Prod > div').forEach(e=>{
                        $$(".rgx",e).forEach(Rx=>{Rx.innerHTML = Grifar(Rx.textContent,r)}) // Grifar
                        e.style.display = r.test(RxClear(e.textContent)) ? '' : 'none'      // Ocultar
                })}
                else if($(`#Pag_${Typ}`).classList.contains('TBLAA')){ // Conferir se a pesquisa é uma Tabela
                    const Aa=$(`.Pesq_${Typ} .Pesq-Aa.Atv`)?  '' :'i'
                    const A_=$(`.Pesq_${Typ} .Pesq-A_.Atv`)?'\\b':''
                    const Bj=$(`.Pesq_${Typ} .Pesq-Bj.Atv`)
                    const rx=$(`.Pesq_${Typ} .Pesq-Rx.Atv`)
                    const CleaVal = Inpt.value.replace(/\[[^\]]*\]/g,' ').replace(/\s+/g,' ').trim()
                    const regex = new RegExp(`${A_}${rx ? Inpt.value : EscpRgx(CleaVal)}${A_}`,Aa)
                        const mtch = [...Inpt.value.matchAll(/\[([^\]]*)\]/g)]
                        const COL1 = mtch[0]?.[1] || false // Primeiro valor dentro de []
                        const COL2 = mtch[1]?.[1] || false // Segundo  valor dentro de []

                TRs(Typ).forEach(tr=>{
                    const P_P2  = !COL2 
                        ? $$(`:scope > ${COL1?Col(Typ,COL1):'td'} ${Bj?'':'> div >'} .P-P`,tr)
                        : $$(`:scope > ${COL1?Col(Typ,COL1):'td'} .BndjTBL ${COL2?Col((COL1||'').toUpperCase(),COL2):'td'} .P-P`,tr)

                    // Mantém a mesma lógica de grifar cada elemento
                    P_P2.forEach(Rx=>{
                        if(Rx.tagName=='P'){Inn(Rx,Grifar(Rx.textContent,regex))}
                        else{regex.source!=='' && regex.test(VAL(Rx)) && Inpt.value!=='' ? Add(Rx,'Psq') : Rmv(Rx,'Psq')}
                    })

                    $$(Rx2([Typ,'Bndj']),tr).forEach(e=>{
                        const Camada1_p = $$(':scope > div > .BndjTBL > table > tbody > tr > td > div > .P-P strong',e).some(E=>E.innerText!=='')
                        const Camada1_s = $$(':scope > div > .BndjTBL > table > tbody > tr > td > div > .Psq',e).some(E=>VAL(E)!=='')
                        const Camada2_p = $$('.BndjTBL > table > tbody > tr > td > div > .P-P strong',e).some(E=>E.innerText!=='')
                        const Camada2_s = $$('.BndjTBL > table > tbody > tr > td > div > .Psq',e).some(E=>VAL(E)!=='')
                        if(Camada1_p||Camada1_s){Add(e,'Grifo1')}else{Rmv(e,'Grifo1')}
                        if(Camada2_p||Camada2_s){Add(e,'Grifo2')}else{Rmv(e,'Grifo2')}
                    })
                    
                    const linhaMatch = P_P2.some(Rx=>{const val = `${VAL(Rx)}`.trim()
                        if(CleaVal === '""'){return val === ''}
                        else {return regex.test(val)}
                    })

                    if(linhaMatch){Rmv(tr,'n0')} else {Add(tr,'n0')}
                })
                Re_Foot(Typ)}
            },100)
        }
        // mais de um:'^(?=.*Fraco)(?=.*Lutar).*$'

        // 💡 a pesquisa q fica dentro do filter, pode ser igual a pesquisa geral q fica em cima, porem restrita apenas a uma Coluna
        // 💡 e ela deve funcionar nos 2, tanto na tabela, quando na minilista q fica dentro do Filter
    </script>

    <div>   <!--FILTROS  - ⭐⭐⭐⭐_  (só correções) -->
        <style> /*FILTROS - CSS*/
            /*Particularidades da BndjFLT*/
            .ThFilt > i    {position:absolute; cursor:pointer; font-size:9px; right:0px; top:50%; transform:translate(-0%,-50%);opacity:0.5}
            .ThFilt > i.Atv{opacity:1}
            .ThFilt > b    {position:absolute; border-radius:255px; width:15px; height:15px; text-align:center; top:-5px; }
            .ThFilt > b.Atv{background:#0c8f00; right:29px}
            .ThFilt > b.Rtv{background:#ff0000; right:10px}   

            .filtTrue{  color:#ffffff; background:#008000 !important} /*aplica no Tr*/
            .filtFals{  color:#ffffff; background:#ff0000 !important} /*aplica no Tr*/
            .ThFilt_Atv{color:#ffffff; background:#059b00}            /*aplica no Filt*/
            .ThFilt_Rtv{color:#ffffff; background:#ff0000}            /*aplica no Filt*/
        </style>
        <script> // FILTROS - SCRIPT
            const Tm_thSort=(arr,Typ)=>{             // ✔️ Carrega Todos os Cabeçalhos (melhorar os CSS do input=[date])
                return arr.map((e,x)=>e=='Lixo'?`<th style="${NoneCol(Typ,e)}"><p>${''}</p></th>`:
                    `<th style="${NoneCol(Typ,e)}" class="ThFilt Rltv PT" onclick="ShowBndj(this);OpcyFilt(_table(this).id);Tm_Filt(this,'${Typ}','${e}')">
                            <p class="PT" name="${e}">${Typ=="SERV"?e:dbCol[e] /*Gambiarra pra remvoer o DbCol*/}</p>
                            <i onclick="Orden(this,event,'${x}')">▼</i>
                            <b class="Ct none Atv">0</b>
                            <b class="Ct none Rtv">0</b>

                            <div class="Rltv w100">
                                <div class="BndjFLT BNdj Abslt none">
                                    <div class="BjConf Stky Ev" onclick="ShowDate(this,'${Typ}','${e}')"></div>
                                    ${e=='Data'?`<input type="date" onchange="RangeDate(this,'${Typ}','${e}')" class="D-Inn none">
                                                 <input type="date" onchange="RangeDate(this,'${Typ}','${e}')" class="D-Out none">` : ''}
                                    <span class="Sugg Cl">${e}</span>
                                </div>
                            </div>
                    </th>`).join('') // P=Texto, i=▼, b=Notfi, a=Config, span=Suggs
            }

            const Trato=(Arr,col)=>{                 // ❌ Corrige palavras
                return col==='Valr' ?  FazArry(Arr).map(e=>Cm(e.replace('R$','').trim()))     // Remove os R$ (não tão nessesário caso os dados venham certinhos)
                    : col==='Pgmt' ?      Arr.flatMap(e=>e.replace(/\d*/g,'').split(' | ')) // Pega apenas os ['Pix','Av'...]
                    : Arr
            }

            function Palavras(Typ,Col,n,Brute){      // ✔️ Encontra e Modifica as palavras q vai Exibir no Filtro
                const IN = performance.now()                                
                    const Clientes = ['Id','Clnt','Cmpt','Cntt','Lcal','Loja','CtLj','Cat','Stts','Lin','Link']
                    const Servicos = ['Id','Serv','Desc','Data','Valr','Detg','Grad','OS','Uber','Cmnt']
                    const Pagament = ['Id','Desc','Data','Link','Mpag','Valr']
                    const Pedidoss = ['Id','Lin' ,'Data']
                    const Mercapag = ['Id','Valr','Data','Hora','Mpag','Link']

                    const Valls =   Brute=='Brute'                        ? Uniq(Colls(Typ,Col,n).map(e=>VAL(e)))             :
                                    Typ=="SERV" && Col==='OK'             ? ['true','false']            :
                                    Typ=="SERV" && Col==='Entg'           ? ['true','false']            : 
                                    Typ=="SERV" && Col==='Arte'           ? ['true','false']            : 
                                    Typ=="CLNT" && Clientes.includes(Col) ? Uniq(J.CLNT.map(E=>E[Col])) :
                                    Typ=="MPAG" && Mercapag.includes(Col) ? Uniq(J.MPAG.map(E=>E[Col])) :
                                    Typ=="SERV" && Servicos.includes(Col) ? Uniq(J.PDDS.flatMap(e=>e['Serv'].map(E=>Trato(E[Col],Col)))) :
                                    Typ=="PGMT" && Pagament.includes(Col) ? Uniq(J.PDDS.flatMap(e=>e['Pgmt'].map(E=>Trato(E[Col],Col)))) :
                                    Typ=="PDDS" && Pedidoss.includes(Col) ? Uniq(J.PDDS.map(e=>e[Col])) :
                                    Col=='Clnt' ? ALL['CLNT'] :
                                    Typ=="PDDS" && ['Cust'].includes(Col) ? Uniq(todoTitle[Col]) :
                                    Typ=="PDDS" && Col==="Serv"                         ? Uniq(todoTitle[Col]) :
                                    Typ=="PDDS" && Col==='Valr'                         ? Uniq(todoTitle[`Sum_${Col}`].map(e=>Cm(e))) :
                                    AllList.includes(Col) ? O[Col] :
                                    // o Obigetivo central da Função é Evitar isso!
                                    Uniq(Colls(Typ,Col,n).map(e=>VAL(e))) // PEZADO

                    MSRX(MS(IN)) < 1.0 ? null : LOG(`⏱️🟡 palavras:(${Typ},${Col}): ${MS(IN)}`) // quando eu venho por F_Filt() não precisa do Typ
                    return Valls
            }
            
            function Tm_Filt(Eu,Typ,col){            // ✔️ Depende da Tabela Carregada
                if(BS[Typ][col][1]==true){return} ; BS[Typ][col][1]=true // Evita q carregue 2 Vezes!
                const IN = performance.now()
                const ThSugg = $('.Sugg',Eu)
                const X = IdxDe(_th(ThSugg))+1           
                const qry   = `#H_${Typ} > tbody > tr > ${Col(Typ,col)} > div > .P-P`
                const Qry_N = qry.replace('tr',"tr:not([class*=` n`])") // Aplicar apenas para Linhas Visiveis // Pode Sair!
                const QRY = [Typ,col]
                const Ex = `Ex_Filt('${Typ}','${col}')`

                $('.BjConf',_th(ThSugg)).innerHTML = `
                    <span class="HOV PT Ct" onclick="F_Filt(this,'${Typ}','${col}','Todos')"           ><img src="./SVG/Icon_Todos.svg">     <p class="none">Todos     </p> </span>
                    <span class="HOV PT Ct" onclick="F_Filt(this,'${Typ}','${col}','${Qry_N}','${X}')" ><img src="./SVG/Icon_Filtados.svg">  <p class="none">Filtados  </p> </span>
                    <input class="" placeholder="pesq">
                    <span id="icnFront_${col}" class="HOV PT Ct" onclick="TOV(this);${Ex}"             ><img src="./SVG/Icon_Lin.svg">                                      </span> 
                    <span class="HOV PT Ct" onclick="F_Rndn(this,'${Qry_N}')"                          ><img src="./SVG/Icon_Randomizar.svg"><p class="none">Randomizar</p> </span>
                    <span id="icnFilt_${col}"  class="HOV PT Ct" onclick="TOV(this);${Ex}"             ><img src="./SVG/Icon_Destacar.svg">  <p class="none">Destacar  </p> </span>
                `// no icon Linha ta afunção Ativa ou Desativa Frontira de palavras

                const Lista = Palavras(Typ,col)
                const NovoArry = Lista.map(e=>e===''?"'Vazio'":e).sort(e=>e==="'Vazio'"?-1:1)

                ThSugg.innerHTML = NovoArry.map(e=>`<div class="Ct w100">
                                                    <div class="PT RD HOV" onclick="F_Clik(this);${Ex}">-</div>
                                                    <p>${e}</p>
                                                    <div class="PT RD HOV" onclick="F_Clik(this);${Ex}">+</div>
                                                    </div>`).join('')

                MSRX(MS(IN)) < 1.0 ? null : LOG(`⏱️🔵 Tm_Filt(${Typ},${col}): ${MS(IN)}`)
            }

            function F_Filt(btn,Typ,cOl,Qry,Col){    // ✔️ Filtra o Filter (descobrir pq n funciona com Numeros)
                const ThSugg = $('.Sugg',_th(btn))
                const FotBndj = Col ? $(`:scope > tfoot > tr > td:nth-child(${Col}) .BndjFOT`,_table(btn)) : null
                const arry    = FotBndj ? $$('span',FotBndj).map(s=>s.innerText.split(':')[0]) : null
                const Plvrs   = !arry && Trato(Palavras(Typ,cOl,true,'Brute'),cOl) // tem q ser no Brute pra poder pegar apenas os visíveis
                    $$('p',ThSugg).forEach(E=>{
                        if(Qry==='Todos'){Rmv_N(Pai(E))
                        }else if(arry){
                            if(arry.includes(E.innerText)){Rmv_N(Pai(E))
                            }else{Add_N(Pai(E))}               // da pra remover isso
                        }else if(Plvrs.includes(E.innerText)){Rmv_N(Pai(E))
                        }else{Add_N(Pai(E))}                   // da pra remover isso
                    })
            }

            function F_Clik(Eu){                     // ✔️ Pinta o Filt com Ativo e Desativo
                Prvn()
                const [r,a]=['ThFilt_Rtv','ThFilt_Atv']
                const PP = $('p',Pai(Eu)) // Valor Clicado
                if(Inn(Eu)=='+'){ LOG(Inn(Eu)) ; if(Coten(PP,r)){Rmv(PP,r)}else{Tog(PP,a)}}
                if(Inn(Eu)=='-'){ LOG(Inn(Eu)) ; if(Coten(PP,a)){Rmv(PP,a)}else{Tog(PP,r)}}
                const Notifi=e=>{const l = $$(`.ThFilt_${e}`,_th(Eu)).length ; const n = $(`b.${e}`,_th(Eu)) ; if(l==0){None(n)}else{Show(n)} ; Inn(n,l) } // Atualiza Notificações + ou -
                Notifi('Atv') ; Notifi('Rtv')
            }

            function Ex_Filt(Typ,col){               // ✔️ Executa o Filto na Tabela (Adicioanr Maior < Menor >)
                const thh    = TH(Typ,col)
                const cOR    = $(`#icnFilt_${Nm($('p',thh))}.Atv`)
                const Front  = $(`#icnFront_${col}.Atv`)
                const aTV    = $$('.ThFilt_Atv',thh).map(e=>Front?`\\b${Inn(e)}\\b`:Inn(e)).join('|') ; const RxAtv = new RegExp(aTV,'i')
                const rTV    = $$('.ThFilt_Rtv',thh).map(e=>Front?`\\b${Inn(e)}\\b`:Inn(e)).join('|') ; const RxRtv = new RegExp(rTV,'i')
                const x      = IdxDe(thh)+1
                const Add_C  = e=>Add(e,'filtTrue') ; const Add_F=e=>Add(e,'filtFals')
                const Rmv_C  = e=>Rmv(e,'filtTrue') ; const Rmv_F=e=>Rmv(e,'filtFals')

                if(true){ // depois vira (Combinado = && E) ou (Independente = || OU)
                    const Qry = `#H_${Typ} > tbody > tr > ${Col(Typ,col)} > div > .P-P`
                    $$(Qry).forEach(e=>{
                        const VaL = `${VAL(_td(e))}` || "'Vazio'"
                        const tr = _tr(e)
                        if(aTV=='' && rTV==''){ Rmv(tr,`n${x}`) ; Rmv_C(tr) ; Rmv_F(tr) }
                        else{
                                 if(aTV!=='' && RxAtv.test(VaL)){cOR ? Add_C(tr) : Rmv(tr,`n${x}`)}
                            else if(rTV!=='' && RxRtv.test(VaL)){cOR ? Add_F(tr) : Add(tr,`n${x}`)}
                            else{if(aTV!==''){cOR ? Rmv_C(tr) : Add(tr,`n${x}`)}
                                 if(rTV!==''){cOR ? Rmv_F(tr) : Rmv(tr,`n${x}`)} }
                        }
                    })
                }
                Re_Foot(Typ)
            }

            function F_Rndn(Eu,Qry,Clik){            // ✔️ Randomiza
                const noCopy = true // impedir que pinte quando não tem cópias
                const PermitOculta = true // opção pra ocultar quem n tem Randon
                const QRY = Qry.replace('` n`','" n"')
                const ObbjClnt=()=>$$(QRY).map(e=>Inn(e))
                let NewObj = {}
                const QntCores = Uniq(ObbjClnt()).length
                const CoresEtr = ObjEtr(cRepet(ObbjClnt())).sort((a,b)=>b[1]-a[1]).forEach(([k,v])=>{
                        if(noCopy&&v===1   ){} // não faz nada caso seja apenas 1 ocorrência
                    else if(!k||k.trim()==''){} // n faz nada caso seja vazio
                    else{
                        if(true){NewObj[k]=RandoCor()}  // cor Randon
                        else{NewObj[k]=v}               // do maior pra o menor
                                                        // corsin Cor Não
                    }
                })
                $$(QRY).forEach(e=>{
                    Bkg(_tr(e),NewObj[Inn(e)])
                    if(PermitOculta && NewObj[Inn(e)]==undefined){Add(_tr(e),'none')} // tentar mudar pra UndfNull(NewObj[Inn(e)]) // pra usar a biblioteca
                })
            }
            
            function F_Clen(Typ){                    // ✔️ Limpa todos os Filtros
                TRs(Typ).forEach(e=>{For(20).forEach(E=>Rmv(e,`n${E}`)) ; Bkg(e,'')}) // Exibe todas as Linhas e Limpa o Random
                $$('.ThFilt b'  ).forEach(e=>None(e)) // Limpa Notifi dos Filter
                const Class = ['ThFilt_Atv','ThFilt_Rtv','filtTrue','filtFals','SelectSoma']
                Class.forEach(e=>{$$(`.${e}`).forEach(E=>{Rmv(E,e)})})
                Re_Foot(Typ)
            }

            function OpcyFilt(Typ){                  // ❌ Ativar Desativa opacy do Icon do F_Filt() //SIMPLIFICAR//
                const Valid = $$(`#${Typ} .ThFilt b`).some(e=>e.innerText!=0)
                const Icon1 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(1)`)
                const Icon2 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(2)`)
                const Icon3 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(4)`)
                const Icon4 = $$(`#${Typ} .ThFilt .BNdj > div span:nth-child(5)`)
                if(Valid){
                    Icon2.forEach(e=>e.style.opacity = 1)
                }else{Icon2.forEach(e=>e.style.opacity = 0.4)}
                // Precisa evitar o Click, tem q dar Return quando isso tiver Ativo!
            }

            function ShowDate(Eu,Typ,Col){           // ✔️ Oculta e Exibe a Bandeija de Range Data
                if(Col=='Data'){Tog($$(`.D-Inn,.D-Out`,_th(Eu)),'none')}
            }

            function RangeDate(Eu,Typ,col){          // ✔️ Seleciona o Intervalo de Data
                const inn   =  $(`.D-Inn`).value
                const out   =  $(`.D-Out`).value || inn
                $$('.Sugg > div',_th(Eu)).forEach(e=>{const D = $('p',e) // D é Data
                    if(Inn(D)>=inn && Inn(D)<=out){Add(D,'ThFilt_Atv')}
                    else{Rmv(D,'ThFilt_Atv')}
                })
                Ex_Filt(Typ,col)
                // Depois Evoluir pra Criar minha Próprio Calendário, pra eu poder fazer aquele Range de faixa
                // Adicionar Botão de Todo Período (oq seria Remover todos os Filtros)
            }

            function Orden(e,ev,x,order=null){       // ✔️
                function TogSeta(e,asc){AllI(_table(e)).forEach(i=>{DTV(i);i.textContent='▼'});const atu = SibQSl(e,'i') ; ATV(atu) ; atu.textContent = asc?'▼':'▲'}
                const table = _table(e)
                const cOl = $('p',_th(e))
                const tbody = $('tbody',table)
                const asc = order ? order === 'asc' : table.dataset.sortOrder !== "asc"
                const Get=E=>$('.P-P',E.children[x])

                const Ordn = [...tbody.rows].sort((a,b)=>{                    
                    if(KeyCtrl(ev)){ // se tiver com Cntrl Selecionado faz o Filtro por Caracteres
                        const lenA = (VAL(Get(a)) || '').length
                        const lenB = (VAL(Get(b)) || '').length
                        return asc ? lenA - lenB : lenB - lenA
                    }
                    if(cOl=='Data'){
                        // 📅 Se ambos forem datas válidas (ex: "2024-12-03")
                            const dateA = new Date(VAL(Get(a)).trim() || '2000-01-01')
                            const dateB = new Date(VAL(Get(b)).trim() || '2000-01-01')           
                            if(!isNaN(dateA) && !isNaN(dateB)){return asc ? dateA-dateB : dateB-dateA}
                    }
                    // Ordena se for Numeros
                        const valA = parseFloat(Txt(Get(a)).replace('R$',''))
                        const valB = parseFloat(Txt(Get(b)).replace('R$',''))
                        if(!isNaN(valA) && !isNaN(valB)){return asc ? valA-valB : valB-valA}
                        
                    // Ordena como texto se não forem números
                        const txtA = `${VAL(Get(a))}`.replace('R$','')
                        const txtB = `${VAL(Get(b))}`.replace('R$','')
                        return asc ? txtA.localeCompare(txtB) : txtB.localeCompare(txtA)
                })
                table.dataset.sortOrder = asc ? "asc" : "desc"
                Ordn.forEach(r=>tbody.appendChild(r))
                TogSeta(e,asc)
            }

            function IMGENS(){ // função q filtra linhas se existir imagem (e também opção de fazer o inverso!)
                $$(`#H_PDDS > tbody > tr`).forEach(tr=>{ //TRs(Typ)
                    const TD=(stg)=>$(`:scope > ${Col('PDDS',stg)}`,tr)
                    const ArryImg = $$(':scope > div > img',TD('Serv'))
                    const tem1 = ArryImg.some(e=>IsImgLod(e))
                    if(tem1){Rmv_N(tr )}else{Add_N(tr)}
                })
            }

            // Filtrar e Ordenar por Imagens
            // Retestar o Random e os outros, já q tenho Recolor pode afetar algo!
            // botar Icone na Exibição do Filtro, pra os q terão icones
            // Filtrar por imagem, False ou True
            // a Pesquisa dentro não está Funcionando!
            // Voltar Ordem ao Normal
        </script>
    </div>

    <div>   <!--RECOLOR  - ⭐⭐⭐⭐_  (só UPGRADES ) (Desempenho PEZADO: ⏳) (All usa Const Obj, e o individual que faz pelo DOM) -->
        <style> /*RECOLOR - CSS*/
            .EtpSVG{height: 25px; width: 25px}
            #H_PDDS > tbody > tr > td:nth-child(5) > div > .P-P{font-size:13px ; border-radius: 255px} /*Valr*/
            #H_PDDS > tbody > tr > td:nth-child(6) > div > .P-P{font-size:13px} /*Pgmt*/
            #H_PDDS > tbody > tr > td:nth-child(10) > div svg{margin: 0px 5px}  /*Lixo*/
        </style>

        <script> // RECOLOR  - SCRIPT
            
            const MinMax=(Atual,Lista)=>Math.min(Math.max(Atual/Lista,0),1) // Entre 0 e 1 
            const OB = { // Criterio 1  é Obrigaório existir
                CLNT:['Clnt','Cmpt','Cntt'],
                SERV:['Serv','TArt','Dsng','Grad','Uber','OK','Entg'],
                PGMT:['Data','Valr','Form'],
            }

            const EtpSERV = {
                'Serv-TArt-Dsng-Grad-Uber-OK-Entg-b' :['Concluído'  ,'147,196,125','39,80,12']
                ,'Serv-TArt-Dsng-Grad-Uber-OK-Entg-a':['Devendo'    ,'234,153,153','134,0,0' ]
                ,'Serv-TArt-Dsng-Grad-Uber-OK-Entg'  :['Entregue'   ,'147,196,125','39,80,12']
                ,'Serv-TArt-Dsng-Grad-OK-Entg'       :['Falta Uber' ,'241,194,50' ,'133,99,0']
                ,'Serv-TArt-Dsng-Grad-Uber-OK'       :['Pronto'     ,'164,194,244','0,54,146']
                ,'Serv-TArt-Dsng-Grad-Uber'          :['Acabamento' ,'255,229,153','133,99,0']
                ,'Serv-TArt-Dsng-OK-Entg'            :['Grad Uber'  ,'241,194,50' ,'133,99,0'] // desnessesário pq o q eu queria era só omitir Grad Uber
                ,'Serv-TArt-Dsng-OK'                 :['Grad Uber'  ,'241,194,50' ,'133,99,0'] // desnessesário pq o q eu queria era só omitir Grad Uber
                ,'Serv-TArt-Dsng-Grad'               :['Impressão'  ,'255,229,153','133,99,0']
                ,'Serv-TArt-Dsng'                    :['Analise Art','180,167,214','80,0,146']
                ,'Serv-Dsng'                         :['Analise Art','180,167,214','80,0,146'] // desnessesário pq o q eu queria era só omitir o TArt
                ,'Serv-TArt'                         :['Arte'       ,'180,167,214','80,0,146'] 
                ,'Serv'                              :['Orçamento'  ,'180,167,214','80,0,146']
            }

            function IconsEtapas(Typ,tr,Etapa,concat){
                const objj = {'PDDS':'Stts','SERV':'SStts'}
                stt = $(`:scope > ${Rx2([Typ,objj[Typ]])}`,tr)
                if(concat){Nm(stt,concat)}
                Inn(stt,`<div>${SVGEtapas[Etapa[0]]}</div>`)
                $$('svg',stt).forEach(e=>e.style.fill = `rgb(${Etapa[2]})`)
                if(Typ=='PDDS'){$$(`:scope > ${Rx2(['PDDS','Valr'])} .P-P`,tr).forEach(e=>{
                    const Pag  = $(`:scope > ${Rx2([Typ,'Pgmt'])} .P-P`,tr)
                    const Deve = Etapa[0]=='Entregue' && Nm(e) > Nm(Pag)
                    if(Etapa[0]=='Orçamento'){Bkg(e,'#00000000','black')}else{
                        if(Deve){
                            Bkg(e,'#740000','white')
                            Bkg(tr,'#ff000069')
                            Inn(stt,`<div>${SVGEtapas['Devendo']}</div>`)
                            $$('td',tr).forEach(d=>Bkg(d,''))
                        }else{Bkg(e,`rgb(${Etapa[2]})`,'white')}}
                })}
            }

            function Re_Colr(Typ,All){                // ✔️ Muda a cor de Todos os 'tr' ou de 1 'tr' só!
                const IN = performance.now()
                const trs = All=='All' ? TRs(Typ) : [All]

                if(Typ==='SERV'){trs.forEach(tr=>{R_Color(tr,Typ)})}

                if(Typ==='PDDS'){trs.forEach(tr=>{let ss = ''
                    const opc=e=>e.reduce((a,v)=>a+v[0],0)/e.length
                    const Menor =arr=> arr?.length ? arr.reduce((m,a) => O['Stts'].indexOf(a[2][0]) < O['Stts'].indexOf(m[2][0]) ? a : m) : null
                    const Exec=typ=>{
                        const s = $$(`.Bdj_${typ} > tbody > tr`,tr).map(tr2=>R_Color(tr2,typ))
                        if(typ=='SERV'){ss=s}
                        $$(`.Bdj_${typ}`,tr).forEach(e=>{if(Menor(ss)==null){return} ; R_Cor(_td(e),opc(s),Menor(ss)[1])})
                    }
                    Exec('SERV') ; Exec('CLNT') ; Exec('PGMT')
                    // Rodando agora na Linha tr
                    if(ss.length==0){return}
                    R_Cor(tr,opc(ss),Menor(ss)[1])
                    IconsEtapas(Typ,tr,Menor(ss)[2])
                })}
                
                if(Typ=='GRAD'){
                    trs.forEach(tr=>{
                        const Crit1 = TDv(tr,'VlrO')==TDv(tr,'Summ') && TDv(tr,'VlrO') !== ''
                        const Crit2 = TDv(tr,'Cont')==TDv(tr,'Cnt2') && TDv(tr,'Cont') !== ''
                        if(Crit1 && Crit2){R_Cor(tr,1,'147,196,125')}
                        
                    })
                }
                if(All=="All"){LOG(`🔄 Re_Colr:(${Typ}) ${MS(IN)}`)}
            }

            function R_Color(tr,Typ){ // Muda a cor apenas de 1 linha tr
                const tipo   = 'Etapa'
                const Arr    = $$(':scope > td',tr).map(td=>VAL(td)??'')  // Array Baseado no DOM
                const newobj = zipObj(ObjKey(BS[Typ]),Arr)
                const atual  = OB[Typ].filter(k=>NoVazi(newobj[k]))
                const opacy  = Number(MinMax(atual.length,OB[Typ].length).toFixed(2))
                const Coclui = atual.length === OB[Typ].length
                const [Atv1,Atv2] = [true,true] //[$(`#${Typ}_tdCor`).checked,$(`#${Typ}_trCor`).checked]               
                 const Etapa  = EtpSERV[atual.join('-')] ?? ['Orçamento','180,167,214']
                 const Cor = Typ=='SERV' ? Etapa[1] : '147,196,125'
                if(Typ=='SERV'){IconsEtapas(Typ,tr,Etapa,atual.join('-'))}

                atual.map(e=>$(Rx2([Typ,e]),tr)).forEach(td=>{
                    Bkg(td,'')                                    // Zera Fundo
                    td.style.border = ''                          // Zera Brorder
                    if(Atv1){R_Cor(td,opacy/2,Cor)}
                    if(Coclui){R_Cor(td,opacy,Cor)}
                })
                    Bkg(tr,'')    
                                                                  // Zera Fundo
                    $$('td',tr).forEach(e=>e.style.border = '')   // Zera Borda
                    if(Atv2){R_Cor(tr,tipo=='Etapa'&&Typ=='SERV' ? 1 : opacy/2,Cor)}
                    if(Coclui){R_Cor(tr,opacy,Cor)}
                return [opacy,Cor,Etapa]
            }

            function R_Cor(e,opacy,Cor){
                if(e.tagName=='TD'){Bkg(e,`rgba(${Cor},${(opacy).toFixed(2)})`)}        // Colore o Fundo com Opacidade
                else{Bkg(e,`rgb(${Cor.split(',').map(v=>Math.round(+v+(255-v)*(1-opacy))).join(',')})`)} // Colore o Fundo sem Opacidade
                e.style.color        = `rgb(${Cor.split(',').map(e=>e/4).join(',')})`   // Colore o Fundo
                e.style.borderBottom = `1px solid rgba(${Cor},${(opacy).toFixed(2)})`   // Colore a Borda
                $$('select',e).forEach(E=>Bkg(E,'#00000000'))
            }
            // Menu de Opções (Tipo de cores:['Etapas','Temperatura','Opacidade']) | aplicar ou Remover o Xadrez
            // Fazer o Hover ficar da cor do Elemento, só que mais Saturado
        </script>
    </div>
    
    <script> // AUTOCOMP - ⭐⭐⭐ _ _   (ainda falta Muito...)

        // Vira Biblioterca
        const Regra=v=>v==0 ? 0 : v < 10 ? 10 : v // Regras de Fornecerdores (BPRint e talvez Grafit)
        
        function ReOpt(td,arr){ // arr = valores disponiveis
            const Sel  = $('select',td)
            if(arr.length==1)         {DarVAL(td,arr[0],'Auto')} // Troca pra o Unico option, se Tiver
            if(!arr.includes(VAL(td))){DarVAL(td,""    ,'Auto')} // se o valor atual não Existir dar valor "Vazio"
            setTimeout(()=>{$$('option',td).forEach(o=>{Add_N(o);if(arr.includes(o.value)){Rmv_N(o)}})},500)   // Ocultar os Options Ausentes
        }

        function Tratamento(){ // Isso é usando antes de a tabela Carregar no DOM!
            ;['PDDS','CLNT'].forEach(Typ=>{Re_Cont(Typ,'All')}) // tem que ser chamado separado pois acessa 2 tabelas ao msm tempo
            
            ;['PDDS','CLNT','GRAD','OOSS','UBER'].forEach(Typ=>{
                // fazer o tratamento de Reorden se quiser
                if(Typ=='CLNT'){criaCol_Typ('Lcro','CLNT');criaCol_Typ('Medi','CLNT')} // Depois dar um jeito de fundir dentro de uma Função Geral
                if(Typ=='PDDS'){criaCol_Col('Grde','PDDS','Serv')}

                if(Typ=='PDDS'){criaCol_Typ('Deve','PDDS')}
                if(Typ=='UBER'){criaCol_Typ('Img','PDDS')}
                
                Re_Comp(Typ,'All')
                Re_Soma(Typ,'All')
            })
            
        }

        function RFresh(Typ,All,Auto,e){ // Tudo isso é Usado após Carregar no DOM!
            if(Typ=='GRAD' && Auto=='Auto'){return}
            //Re_Cont(Typ,All)
            if(All!=='All'){if(Auto!=='Auto'){Re_Comp(Typ,All,e)}} // ta com essa agonia toda mas vou ajeitar! (Provavelmente só o IF de All fica) (esse if de auto vai sair!)
            if(All!=='All'){Re_Soma(Typ,All)}
            Re_Colr(Typ,All)
            Re_Foot(Typ,All)
            LOG('🔄 Rfresh Geral')
        }

        function Re_Cont(Typ,All){  // ⭐⭐⭐_ _ Sempre é All contar quantas vezes algo aparece dentro e agrupar valores
            const IN = performance.now()
                 if(Typ=='PDDS'){J['SERV'].forEach(({Grad,Id,Valr})=>{if (!Grad || Grad === "" || Grad === "--"){return}
                    ContGrad[Grad]??={Qnt:0,Sum:0,List:[]}
                    ContGrad[Grad].Qnt++
                    ContGrad[Grad].Sum += Number(Valr)
                    ContGrad[Grad].List.push(Id)
                })
            }
            else if(Typ=='CLNT'){J['PDDS'].forEach(({Clnt,Id,Serv})=>{if (!Clnt || Clnt === "" || Clnt === "--"){return}
                    ContCLNT[Clnt]??={Qnt:0,Sum:0,List:[]}
                    ContCLNT[Clnt].Qnt++
                    ContCLNT[Clnt].Sum += Serv.reduce((acc,e)=>acc+Number(e.Valr),0)
                    ContCLNT[Clnt].List.push(Id)
                })
            }
            else{return}
            if(All=="All"){LOG(`🔄 Re_Cont:(${Typ}) ${MS(IN)}`)}
        }

        const Splii = {
    /*Opt*/  S_Tipo:j=>j.Serv ? Vari(j.Serv) : []
    /*Opt*/ ,S_TArt:j=>j ? Prod[j.Serv]?.Etpa.includes('Arte')?FiM(O['TArt']):['n Precisa'] : O['TArt']
            ,S_Arte:j=>j.Id
            ,S_CArt:j=>''
    /*Opt*/ ,S_Dsng:j=>j ? ['do Cliente','Ja Tinha','n Precisa'].includes(j.TArt)?['--']:FiM(O['Dsng']) : O['Dsng']
            ,S_Surg:j=>{return Seguro(j.Alt * j.Lag * j.Qnt * Prod[j.Serv]?.Variantes[j.Tipo]?.Valr).toFixed(2)}
            ,S_Forn:j=>j.Grad ? [Dbbrev[j.Grad[0]]] : ''
            ,S_Gimg:j=>j.Grad
            ,S_OS  :j=>{if(j.Grad==''){return ''} ; if(j.Grad=='--'){return '--'} ; const F = J['GRAD'].find(e=>e.Grad==j.Grad) ; const L = ContGrad[j.Grad] ; return F && L ? Seguro(Num(F.Valr) * (j.Valr / L.Sum)).toFixed(2) : ''} // Pega uma Porcentagem do Valor do Uber  // se for NaN retorna Zero
            ,S_Uber:j=>{if(j.Grad==''){return ''} ; if(j.Grad=='--'){return '--'} ; const F = J['GRAD'].find(e=>e.Grad==j.Grad) ; const L = ContGrad[j.Grad] ; return F && L ? Seguro(Num(F.VUbr) * (j.Valr / L.Sum)).toFixed(2) : ''} // Pega uma Porcentagem do Valor do Uber  // se for NaN retorna Zero // if(j.Grad=='B_264_2'){LOG('UB',L.Sum,F.VUbr)} ; 
            //-----------------------------------------------------------------------------------------------------------
            ,G_ImgU:j=>j.Grad ?? ''
            ,G_ImgG:j=>j.Grad.replace(/_\d*$/,"") ?? ''
    /*Opt*/ ,G_Forn:j=>[Dbbrev[j.Grad[0]]]
    /*Opt*/ ,G_SrvF:j=>ObjKey(ValForn[j.Forn]||{})
            ,G_Valr:j=>j.Forn=='Barraca' ? j.Qnt * 120 : Regra(NAN(j.Lag * j.Alt * ValForn[j.Forn]?.[j.SrvF]?.[0]?.val)) * j.Qnt
            ,G_Cnt2:j=>ContGrad[j.Grad]?.Qnt ?? ''
            ,G_VlrO:j=> JJ['OOSS'][j.OS]?.Valr || 0
            ,G_Summ:j=>j.OS=='' ? '' : sum(J['GRAD'].filter(e=>e.OS==j.OS).map(e=>e.Valr))
            ,G_Oimg:j=>j.OS   ?? ''
            ,G_VUbr:j=>{const u=J['UBER'].find(e=>e.Uber==j.Uber)?.Valr, q=J['GRAD']?.filter(e=>e.Uber==j.Uber).length||0 ; return q && u ? (u/q).toFixed(2) : 0}

            //-----------------------------------------------------------------------------------------------------------
            ,O_Oimg:j=>j.OS ?? ''
            ,O_Cnt2:j=>J['GRAD'].filter(e=>e.OS==j.OS).length
            //-----------------------------------------------------------------------------------------------------------
            ,C_Link:j=>ContCLNT[j.Id]?.Qnt ?? ''
            ,C_Lcro:j=>ContCLNT[j.Id]?.Sum ?? ''
            ,C_Medi:j=>{const q = ContCLNT[j.Id]?.Qnt; const s = ContCLNT[j.Id]?.Sum; return (q != null && s != null && s !== 0) ? (s / q).toFixed(2) : ""}  
        }

        function Re_Comp(Typ,All){ // Chama: Bndj , Nova Linha+ , Lixeira)
            const IN = performance.now()
            const trs = All=='All' ? J[Typ] : [All] // se for Bandeija entra edição na Linha do Pai

            const Edit=(Pre,col,Mod,tr)=>{ // Por enquanto nenhum aqui precisa de SB
                const Coa = {S:'SERV',P:'PGMT'}
                const TYP = Coa[Pre]||Typ
                const Key = All=='All' ? tr[Primary[TYP]] : VAL($(`:scope > ${Rx2([`${TYP}-${tr_ID(tr)}-${Primary[TYP]}`])}`,tr)) // Pegando a Chave Primaria
                const arg = All=='All' ? tr : JJ[TYP][Key]
                if(!arg){LOG('⚠️ o Objeto Não Existe') ; return}
                const Val = Splii[`${Pre}_${col}`](arg)   // arg deve sempre ser o Objeto!
                if(Mod.includes('O') && All!=='All'){ReOpt(TDd(tr,col),Val)}
                if(Mod.includes('V')){if(All=='All'){tr[col] = Val}else{DarVAL(TDd(tr,col),Val)}}
            }

            if(All!=='All'){LOG(`Edição Unica: ${Typ}`)}

            if(Typ=="PDDS"){
                trs.forEach(TR=>(All=='All' ? Array.isArray(TR.Serv) ? TR.Serv : [] : $$('.Bdj_SERV > tbody > tr',TR)).forEach(tr=>[['Surg','VN'],['Tipo','ON'],['TArt','ON'],/*['Grad','V' ],['Cbmt','N' ],['VCbt','N']*/         ].forEach(c=>Edit('S',c[0],c[1],tr))))
                trs.forEach(TR=>(All=='All' ? Array.isArray(TR.Serv) ? TR.Serv : [] : $$('.Bdj_SERV > tbody > tr',TR)).forEach(tr=>[['Dsng','ON'],['Arte','VN'],['CArt','N' ],['Gimg','VN'],['Forn','ON'],['OS','VN'],['Uber','VN']].forEach(c=>Edit('S',c[0],c[1],tr)))) // Dependem de TArt e de Grad
                //trs.forEach(tr=>[ aqui roda a terceira vez, q esse aqui é pra ocultar, mas só fica disponivel se for Individual
            }else if(Typ=="CLNT"){
                trs.forEach(tr=>[['Link','V'],['Lcro','V'],['Medi','V']].forEach(c=>Edit('C',c[0],c[1],tr)))
            }else if(Typ=="GRAD"){
                trs.forEach(tr=>[['ImgU','V'],['ImgG','V'],['Forn','O'],['Valr','V'],['Cnt2','V'],['Oimg','V'],['VlrO','V'],['VUbr','V']].forEach(c=>Edit('G',c[0],c[1],tr))) 
                trs.forEach(tr=>[['SrvF','O'],['Summ','V']                                                                              ].forEach(c=>Edit('G',c[0],c[1],tr))) /*SrvF-(Forn), Summ-(Valr,VlrO)*/
            }else if(Typ=='OOSS'){
                trs.forEach(tr=>[['Oimg','V'],['Cnt2','V']].forEach(c=>Edit('O',c[0],c[1],tr)))
            }else{return}

            // Lá no ReOption tem a opção de analisar se tem apenas 1, se for o caso, ao Rodar Todos, talvez de pra analisar antes
            // se for vazio ou apenas 1, já insere na const já antes! (claro, talvez se possivel deixar uma mensagem pedindo SB)
            // a Linha da GRAD ficará vermelha caso eu tenha digitado UBER ou OS, q ainda não exista na sua respectiva tabela
            if(All=="All"){LOG(`🔄 Re_Comp:(${Typ}) ${MS(IN)}`)}
        }

        function Re_Comp_Antigo(Typ,All,Eu){ // EXTRAIR apenas os Oculta Coluna e o lance de valor antigo!
            const Edit=(c1,c2,Mod,tr,Pre)=>{ // Critério pra Ocultar, só Disponivel no 'SERV'
                const [td1,td2] = [TDd2(tr,c1),TDd(tr,c2)]
                if(Mod.includes('N')){
                    const th      =  $(`thead > tr > th:nth-child(${Colx(Typ,c2)})`,_table(td2))   // Virar Obj
                    const AllServ = $$(`:scope > tr ${Rx2([`Serv-Slct`])}`,Pai(tr)).map(e=>VAL(e)) // Virar Obj
                    if(todosIguais(AllServ)){ // dar o return quando não precisar fazer nada!
                        /*se não precisa de Cbmt*/ if(Typ=='SERV' && c1=='Serv' && (c2=='Cbmt' || c2=='VCbt')){if(!(Prod[VAL(td1)]?.Etpa||[]).includes('Cbmt')){Add_N([td2,th]) ; return}else{Rmv_N([td2,th]) ; return}} 
                        /*se não precisa de Arte*/ if(Typ=='SERV' && c1=='TArt' && VAL(td1)=='n Precisa'){Add_N([td2,th])}else{Rmv_N([td2,th])}
                        /*se não precisa de Grad*/ if(Typ=='SERV' && c1=='Grad' && VAL(td1)=='--'       ){Add_N([td2,th])}else{Rmv_N([td2,th])}
                    }else{Rmv_N([td2,th])}
                }
            }

            // Feito Principalmente pra áreas onde ta diferente no Supabase pra poder adicionar lá, pois não quero adicionar de forma automatica
            function AutoAntig(obj,col,tr,v){ // (Como Chamar!) AutoAntig(obj,'Forn',tr,'NovoValor') // const obj = J[Typ][tr_X(tr)]
                const A = obj[col]                       // Valor Antigo
                const Cor = A==""&&v!==''?["Blu",'']:A==v?['Grn','']:['Red',A]
                if(A=="" && v==""){return}
                DarVAL($(Rx2([col]),tr),v,Cor)
            }
        }

        function Re_Soma(Typ,All){ // ⭐⭐⭐_ _ (Usado apenas em PDDS por enquanto!) ⚠️⚠️
            const IN = performance.now()
            if(Typ==='PDDS'){
                const trs = All=='All' ? J[Typ] : [All]
                trs.forEach(tr=>{
                    const oID=All=='All'? tr.Id : tr_ID(tr)                                             // Numeração do ID
                    const get=col=>     $(`${Rx2([`${Typ}-${oID}-${col}`])}`)                           // Concatenado é mais Preciso PDDS-oID-col
                    const ges=arr=>arr.map(col=>{return JJ[Typ][oID].Serv == '' ? 0 :JJ[Typ][oID].Serv.map(e=>Num(e?.[col] ?? 0))}).flat() // pega todos os Valores dessas Colunas (esses moi de proteção talvez nem precise tanto) (depois analisa pra proteger realmente só quando precisar!)
                    const gee=arr=>arr.map(col=>{return JJ[Typ][oID].Pgmt == '' ? 0 :JJ[Typ][oID].Pgmt.map(e=>Num(e?.[col] ?? 0))}).flat() // pega todos os Valores dessas Colunas (esses moi de proteção talvez nem precise tanto) (depois analisa pra proteger realmente só quando precisar!)
                    const vll=arr=>arr.map(e=>e??'').join('')                                           // Muda pra Const // se todos os Custos de cada linha do Serv for "Vazio", então Custo e Lucro fica "Vazio"

                    /*Somas*/ const SumV = sum(ges(['Valr']))               ; if(All=='All'){tr.Valr = RS(SumV)                      }else{DarVAL(get('Valr'),RS(SumV))}
                              const VllC = ges(['CArt','OS','Uber','VCbt'])
                              const VllP = gee(['Valr'])
                              const SumP = sum(VllP.map(e=>e==''?0:e))
                    /*Custo*/ const SumC = sum(VllC.map(e=>e==''?0:e))      ; if(All=='All'){tr.Cust = vll(VllC)==''?'':SumC     ==0?'':RS(SumC)     }else{DarVAL(get('Cust'),vll(VllC)==''?'':SumC     ==0?'':RS(SumC     ))} ; 
                                                                            ; if(All=='All'){tr.Lcro = vll(VllC)==''?'':SumV-SumC==0?'':RS(SumV-SumC)}else{DarVAL(get('Lcro'),vll(VllC)==''?'':SumV-SumC==0?'':RS(SumV-SumC))}
                                                                            ; if(All=='All'){tr.Deve = vll(VllP)==''?'':SumV-SumP==0?'':RS(SumV-SumP)}else{DarVAL(get('Deve'),vll(VllP)==''?'':SumV-SumP==0?'':RS(SumV-SumP))}
                    // se CArt e VCbt for '--' representa Zero.
                    // Evoluir pra adicionar alguns Critérios de Proteção pra saber se o Custo foi definido corretamente! ai só pinta msm se tiver realmente tudo certinho!
                })
            }else{return}
            if(All=="All"){LOG(`🔄 Re_Soma:(${Typ}) ${MS(IN)}`)}
            // ⚠️ o valor do Uber não atualiza correto ao Recomp individual (ele vai diminuindo a cada um)
        }

        function Re_Foot(Typ,All){ // Async ⚠️ Ainda está só no DOM
            if(Typ=='PDDS'||Typ=='SERV'||Typ=='PGMT'){setTimeout(()=>{ // Tavelas Disponiveis com Tfoot
                let IN = performance.now()
                // Tentar usar esses Obj em Filter também pra carregar apenas 1 Vez
                    const IDclass     = (p)=>{ const tr = $(`tbody > tr`,_td(p)) ; if(tr){return tr_ID(tr)}}
                    const objClnt     = Colls(Typ,'Clnt',true).map(p=>{const ID=IDclass(p) ; return {nome:Inn(p),Id:ID}})
                    const NovoOBJClnt = objClnt.reduce((acc,e)=>{acc[e.Id] = e.nome ; return acc},{})
                    const objClntID   = Uniq(objClnt.map(e=>e.Id))

                    // ao Filtrar ou Pesquisar, criarei uma Variavel Global q dirá todos os que estão visíveis const RowViews = ['150_1','1542_2']
                    // q será atualizada em tempo real conforme pesquisa!
                    // essa função abaixo vai percorrer J['PDDS'] e vai fazer a contagem, eliminando os que não contem na const RowViews
                    // vai aumentar a peformance
                    const objServ = Typ=="PDDS" ?
                          Colls(Typ,'Serv',true).map(e=>_td(e)).flatMap(f=>$$(Rx2(['Serv-Slct']),f).map(t=>$('select',t).value)) // da pra melhorar posso uar VAL()
                        : Colls(Typ,'Serv',true).map(e=>VAL(e))

                Inn($(Rx2([Typ,'Foot','Id'  ])),`<div onclick="Tog_N($('.BndjFOT',Pai(this)))">${objClnt.length  }         </div>`)
                Inn($(Rx2([Typ,'Foot','Clnt'])),`<div onclick="Tog_N($('.BndjFOT',Pai(this)))">${objClntID.length} Clientes</div> <div class="Abslt none Cl BndjFOT BNdj"><span class="Sugg Cl w100">${ObjEtr(cRepetID(objClnt)).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<a class="w100 PT">${k} - ${NovoOBJClnt[k]}: ${v}</a>`).join('')}</span><div class="BjConf Stky2 w100 Ct">${objClntID.length} Clientes</div></div>`)
                Inn($(Rx2([Typ,'Foot','Serv'])),`<div onclick="Tog_N($('.BndjFOT',Pai(this)))">${objServ.length  } Serviços</div> <div class="Abslt none Cl BndjFOT BNdj"><span class="Sugg Cl w100">${ObjEtr(  cRepet(objServ)).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<a class="w100 PT">${k}: ${v}</a>`                    ).join('')}</span><div class="BjConf Stky2 w100 Ct">${objServ.length  } Serviços</div></div>`)
                Inn($(Rx2([Typ,'Foot','Valr'])),` ${RS(SOMA(Colls(Typ,'Valr',true),s=>VAL(s)))}`)
                Inn($(Rx2([Typ,'Foot','Pgmt'])),`${SOMAPgmt(Colls(Typ,'Pgmt',true))}`)
                Inn($(Rx2([Typ,'Foot','Cust'])),` ${RS(SOMA(Colls(Typ,'Cust',true),s=>VAL(s)))}`)
                Inn($(Rx2([Typ,'Foot','Lcro'])),` ${RS(SOMA(Colls(Typ,'Lcro',true),s=>VAL(s)))}`)

                if(All=="All"){LOG(`🔄 Re_Foot:(${Typ}): ${MS(IN)}`)}
            },0)}
        }

        function SOMAPgmt(Arr){ // Soma Pix e Av
            const Tm_PixAv=(Pix,Av)=>`<div class="Cl"><div class="Ct">${Tm_RS(SOMA(Pix))}Pix</div> <div class="Ct">${Tm_RS(SOMA(Av))}Av</div></div>`
            let ArrPix = [] ; let ArrAv = []
            Arr.forEach(e=>{Inn(e).split('|').forEach(I=>{if(I===''){return}
                    if      (RgxPixAV(I)[2]==='Pix'){ArrPix.push(Num(RgxPixAV(I)[1]))}
                    else if (RgxPixAV(I)[2]==='Av' ){ ArrAv.push(Num(RgxPixAV(I)[1]))} }) })
            return Tm_PixAv(ArrPix,ArrAv)
        }
    
        /*
            // adiciona o evento de Click na coluna de Lunk de Pedidos na Tabela de Clientes
                _td(Cell).onclick = _td(Cell).onclick = function(event){if(event.ctrlKey){Tog(this,'LinkULT')}else{Tog(this,'LinkAtv')}}
            // Ocultar a Lixeira nas Linhas que tem pedidos atrelado, pra evitar de excluir clientes que tão em Uso
                if(PddsLink!==''){$(Rx2(['CLNT','Lixo']),tr).innerHTML = ""}
        */
    </script>

    <div>     <!--LINKS  - ⭐⭐_ _ _ -->
        <style> /*CSS apenas no SuggLinks*/
            .Sugg_Atv  {background: #d822ab; color: #ffffff}
        </style>

        <script> // LINK
            function TrocaClnt(Eu){Tog($('.DivTrcCLNT',Pai(Eu)),'none')}

            const Tm_Exib = {
                 Mpag:(e)=> `${e.Id} - ${e.Clnt}, ${e.Valr} ${e.Form}`
                ,Pgmt:(e)=> `${e.Id} - ${FindClnt(e)} - R$ ${e.Valr} (${e.Form}) ${e.Data}`
                ,Serv:(e)=> `${e.Id} - ${SERV_Find_CLNT(e)} ${e.Serv} ${e.Desc}`
                // Deve Virar Tabela (e pra os que tem Imagem, exibir a imagem bem grande tipo uma Pasta)
            }

            function LinkSug(Typ,inpt,MySelect,Lista){
                const list = $('.Sugg',Pai(inpt))
                    
                    const Val   = inpt.value
                    const regex = new RegExp(`(${aa(Val)})`, 'gi') // ignora maiúsculas
                    if(MySelect){ // Funciona pra quando eu tenho uma Lista de Options
                        const TipoFilt = {
                            Proc:(e,Val)=>aa(e).includes(aa(Val)),
                            Rest:(e,Val)=>aa(e).includes(aa(Val)), // Exibir só os que não estão Linkados
                            List:(e,Val)=>aa(Val)=="" ? true : aa(e).includes(aa(Val)),
                        }
                        list.innerHTML = Lista.split(',').filter(e=>TipoFilt['List'](e,Val))
                        .map(e=>{
                        const Nome =  aa(e).replace(regex,'<span style="background: #8f007c;color:white">$1</span>') // Destaca no Nome
                        return `<a class="PT w100 Ct" onclick="Selecty(this);None(Pai(this))"><p>${Nome}</p></a>`
                        }).join('')
                    }else{ // Funciona pra quando eu tenho uma array de objetos da Tabela
                        Show(list)
                        if (inpt.value){
                            list.innerHTML = J[Typ]
                            .filter(e=>aa(e[Aa(Typ)]).includes(aa(Val)) || String(e['Id']).includes(Val)) // Adicionar outras Formas de Filtro (oq ta Faltando)
                            .map(e=>{
                                const ID   = String(e['Id']).replace(regex,'<span style="background: #8f007c;color:white">$1</span>') // Destaca no Id
                                const Nome =  aa(e[Aa(Typ)]).replace(regex,'<span style="background: #8f007c;color:white">$1</span>') // Destaca no Nome
                                return `<a class="PT w100 Ct" onclick="LinkLink(this,'${e[Primary[Typ]]}');None(Pai(this))"><p>${ID}</p><p>${Nome}</p></a>`
                            }).join('')
                        }else{None(list);Inn(list,'')}
                    }  
                // Adicionar a Opção de Mostrar todos, com um determinado filtro q posso escolher por exeplo: os que Faltam!
                // Adicionar Opção de Adicionar uma Nova Linha quando for pra LinkTABELA
                // Opção pra Selecionar mais de 1
                // Encontrar GRAD Dentro de SERV (Visse Verse)
                // Encontrar CLNT Dentro de PDDS
                // Encontrar MPAG Dentro de PGMT (Visse Verse)
                // Encontrar  OS  dentro de GRAD (Visse Verse)
                // Encontrar UBER dentro de GRAD (Visse Verse)
            }
        </script>
    </div>

    <div>  <!--INTERAÇÕES- ⭐_ _ _ _ -->
        <style> /*Preview*/
            .MdalIMG{width: 800px; height: 500px}
            .MdalIMG img{max-width: 100%;max-height: 100%;
                        object-fit: contain; background: #474747; border-radius: 10px; padding: 5px;}
            .casusa{flex: 1 1 auto}
            
        </style>
        <script> // Previews
            function Tog_Card(Typ){
                const Card = Coten($(`#H_${Typ}`),'Card')
                    TRs(Typ).forEach(tr=>{
                        $$(`:scope > ${Rx(['Clnt'])}`,tr).forEach(e=>{Tog(e,'Hoov')})
                        $$(`:scope > ${Rx(['Stts'])}`,tr).forEach(e=>{Tog(e,'Hoov')})
                        $$(`:scope > ${Rx(['Serv'])} > div > .T-T`,tr).forEach(e=>{if(Card){Inn(e,Inn(e))}else{}})
                    })
            }

            // virar Biblioteca (serve pra garantir a compatibilidade da imagem, se corresponde ao q deve ser entrado)
            function SelectFiles(Inpt,Call){if(Inpt.files.length > 0 && typeof Call === "function"){Call(Inpt)}}
            function estaOculta(e) {return getComputedStyle(e).display === "none"}
            function CtrlSoma(Eu){Tog(Eu,'SelectSoma');Inn('#Sommma',`Soma: ${RS(SOMA($$('.SelectSoma').map(e=>Nm(e))))}`)}

            function AbrirImg(Nome,img,X){
                // if(X=='Place'){return} // isso deve só acontecer se for Placeholder de vdd, depois analizar pra ver q ter errinho lá em cima
                MdalShow('#FormIMG')
                const W = img.naturalWidth>img.naturalHeight
                const Stg =`<div class="MdalIMG ${W?'Cl':'Ct'}">
                                <img src="${img.src}">
                                <div class="casusa Cl ${W?'w100':'h100'}">
                                    <span>Nome</span>
                                    <input type="file" class="w80" onchange="SelectFiles(this,SellFilesIMG)" accept="image/*">
                                    <button onclick="SairMdal();ImgUPP($('input',Pai(this)),'${Nome}')">Enviar</button>
                                </div>
                            <div>`
                Inn($('#FormIMG'),Stg)
                if(X=='X'){$('#FormIMG input').click()}
                
            }

            function SellFilesIMG(Inpt) {
                const file = Inpt.files[0]
                $('img',Pai(Pai(Inpt))).src = URL.createObjectURL(file)
                $('span',Pai(Inpt)).textContent = file.name
            }

            document.addEventListener('DOMContentLoaded', function(){ // Função do Esc
                document.addEventListener('keydown',function(event){
                    if(event.key==='Escape'){
                        if(EShow($('#FModal'))){return}
                        else{$$(`#Pag_${Atual.Pag} .BNdj, #Pag_${Atual.Pag} .BNfot`).forEach(e=>Add_N(e))}
                    }// F_Clen(Atual.Pag) // se for outro botão
            })})

            const Mechenela=arr=>arr.map(e=>{
                e.Serv = `${e.Serv} (${e.Tipo})`.replace('Lona (Banner)','Banner') // Fazer um Padrão com isso aqui
                delete e.Tipo
                e.Vund  ? e.Vund   = `R$ ${e.Vund}`  : null
                e.SbTt  ? e.SbTt   = `R$ ${e.SbTt}`  : null
                e._ = '-' ; e.X = 'x'
                return e
            })

            function VerNota(Typ){
                MdalShow('#ModalNota')
                let dados = []
                if (Typ == 'ORC'){
                    dados = $$('#ORC tbody tr').map(tr=>{
                        const NewObj = {}
                        const tipo = Array.from(tr.classList).find(c=>c.startsWith('Calc_'))
                        const Rsut = ',.ORC_RSUT_Vund,.ORC_RSUT_SbTt'
                        const arr  = tipo === 'Calc_M2'  ? '.oQnt ,.oServ,.oTipo,.oLrg ,.oAlt '
                                   : tipo === 'Calc_OFS' ? '.oQntt,.oServ,.oTipo,.oCbmt,.oGram'
                                   : tipo === 'Calc_QNT' ? '.oQntt,.oServ,.oTipo,.oLrg ,.oAlt ' : ''
                        $$(arr + Rsut, tr).map(e => {
                            const cls_o   = Array.from(e.classList).find(c => c.startsWith('o'))
                            const cls_orc = Array.from(e.classList).find(c => c.startsWith('ORC_'))
                            const resto1  = cls_o   ? cls_o.slice(1)           : null
                            const resto2  = cls_orc ? cls_orc.split('_').pop() : null
                            const key   = resto1 || resto2
                            if (key) NewObj[key] = cls_o ? VAAL(e) : Inn($('a',e))
                        })
                        return NewObj})
                }
                // Deve Virar Biblioteca a diferença pra o outro é que esse filtra só as existentes
                const ArrObj_OrdnCol2 = (Obj,Ordn)=>{
                    const K = Object.keys(Obj[0])
                    const x = Ordn.filter(col => K.includes(col))
                    return [x, ...Obj.map(obj => x.map(col=>obj[col]))]
                }
                const dadosFmt = ArrObj_OrdnCol2(Mechenela(dados),['Qnt','Qntt','_','Serv','Cbmt','Gram','Lrg','X','Alt','Vund','SbTt'])
                const [head,...rows] = dadosFmt
                $('#ConteudoNota').innerHTML = `
                    <table id="TabelaNotinha" class="w100">
                        <thead><tr>${head.map(c=>`<th>${D_Brev[c]??c}</th>`).join('')}</tr></thead>
                        <tbody>    ${rows.map(r=>`<tr>${r.map(v=>`<td>${v??''}</td>`).join('')}</tr>`).join('')}</tbody>
                    </table>
                    <h2 id="TotalNotta" class="Hr Ct">${RS(dados.reduce((a,e)=>a+Num(e.SbTt),0))}</h2>`
            }
        </script>
    </div>
</div>

<body class="Ct" onclick="NoneBndj()">

    <style> /*CSS do Header*/
        /*Fixos*/
            header    {padding:0px ; z-index:999 ; transition: all ease-in-out 0.3s}
            header > *{transition: all ease-in-out 0.3s}
            #LgNome      , header nav div      {filter:drop-shadow(0px 0px 8px #3a002b)}
            #LgNome:hover, header nav div:hover{filter:drop-shadow(0px 0px 5px #f030c0)}
            #PAGES{flex:1 ; height:100vh ; overflow-y:scroll}
            .ConfigOrc{transition: all ease-in-out 0.3s}
            .Body1 .ConfigOrc{height: 0px}
            .Body2 .ConfigOrc{height: 40px}
        /*Body1*/
            .BBody1{height:8vh  ; width:100vw ; position:sticky; top:0}
            .Body2 .BBody1{height: 0vh; pointer-events: none;}.Body2 .BBody1 > *{opacity: 0}
            .Body1 #PAGES > div{height:100% ; overflow-y:scroll} /*Aqui são as Páginas de Fato*/
                .BBody1 #Title      {margin-left:15px}                @media(max-width:500px){.BBody1 #Title    {margin-left:3px}}
                .BBody1 #Title #Logo{margin:5px; height:30px}         
                .BBody1 #Title h1   {font-size:3vw}                   @media(max-width:500px){.BBody1 #Title h1 {display:none}}   
                .BBody1 nav         {margin:0px 10px}                 @media(max-width:700px){.BBody1 nav       {display:none}}
                .BBody1 nav img     {height:22px; margin:3px 3px}
                .BBody1 nav p       {display:none}
                .BBody1 nav div     {border-radius:5px ; margin: 0px 2px;}
                .Body1 #NavPerf     {flex-direction:row}
                .Body1 #LgNome      {display:none}
                .Body1 #LgMORE      {display:none}
        /*Body2*/
            .BBody2{height:100vh ; width:18% ; flex-direction: column}
            .Body1 .BBody2{width:0% ; pointer-events: none;}.Body1 .BBody2 > *{opacity: 0}
            .BBody2.recolhe{width:5% } @media(max-width:500px){.BBody2.recolhe{width:50% }}
            .BBody2.recolhe #Logo   {display: none}
                .BBody2 #Title      {width: 90%; justify-content: space-between}
                .BBody2 #Title #Logo{margin:5px; height:30px}
                .BBody2 #Title h1   {font-size:50% ; display:none}
                .BBody2 nav     {margin:10px 0px; flex-direction:column; width: 100%}
                .BBody2 nav img {height:22px; margin:5px 0px ; margin-right: 9px}                            .BBody2.recolhe nav img {margin-right: 0px}
                .BBody2 nav p   {display:block ; font-size: 14px}                                            .BBody2.recolhe nav p   {display:none}
                .BBody2 nav div {width: 90% ; justify-content: start; margin: 3px 0px ; border-radius: 8px}  .BBody2.recolhe nav div {justify-content:center}
                .BBody2 nav div:hover     {background: #ffffff15}
                .BBody2 nav #b1_HNVDv_LIN img{display: none}
                .BBody2 nav #b1_HNVDv_LIN    {border-bottom:1px solid #ffffff;opacity: 0.3}
                .BBody2 nav #b2_HNVDv_LIN img{display: none}
                .BBody2 nav #b2_HNVDv_LIN    {border-bottom:1px solid #ffffff;opacity: 0.3}
                .BBody2 #NavPerf         {flex-direction:column; width: 90%}
                .BBody2 #Div-Pesq        {display:none}
                .BBody2 #DivNav          {width:90%}
                .BBody2 #H_Login         {width: 100% ; justify-content: flex-end; background: #38003fa6}
                .BBody2 #LgNome          {display: flex; margin-right: 7px; font-size: 14px;}
                .BBody2 #LgMORE          {display: flex}
                nav > *.Atv              {background: #da00aa}
                nav > *.Atv:hover        {background: #ff00c8 !important; filter:drop-shadow(0px 0px 5px #f030c0) !important}
    </style>

    <header class="BBody1 Bt"> <!--Body1--> <!--HEADER-->

        <div id="Title" class="Ct"> <!--Titulo-->
            <img id="Logo"  draggable="false" src="./Img/Logo.png" onclick="TrocaBody()">
            <h1 class="PT" onclick="TrocaBody()">InfinityAPP 7.6</h1>
            <script>
                function TrocaBody(){if(window.innerWidth>500){TrcTog($('body'),'Body1','Body2')}else{Recolher()}}
                function Recolher(){Tog($('.BBody2'),'recolhe')}
                function TrocaCSS(nova){$('body').className = [...$('body').classList].filter(c=>!c.includes('CSS')).concat(nova).join(' ')}               
            </script>
        </div>

        <div class="w30"> <!--Pesquisa-->
            <style> /*Input de Pesquisa*/
                #Div-Pesq .H_Pesq{background:#00000018; color:#ffffff;border: 1px solid #ef3aff}
                #Div-Pesq .H_Pesq::placeholder{color: #ffffff;opacity:0.5}
                #Lupa{top:8px; right:6px; width:17px; opacity:0.5}
                #Lupa:hover{opacity:1}
                .pPesq a{color:#ffffff ; top:8px} .pPesq a.Atv{color:#00ff0d !important}
                .Pesq-A_{right:30px}.Pesq-Aa{right:50px}.Pesq-Bj{right:70px}.Pesq-Rx{right:90px}
                @media(max-width:500px){#Div-Pesq{width:50%}}
            </style>
            <div id="Div-Pesq" class="Rltv w100 hov"></div><!--Pesquisa-->
            <script>
                function Load_Pesq(Typ){
                    return `<div class="pPesq Pesq_${Typ} Rltv" class="none">
                        <input class="w100 H_Pesq" placeholder="Pesquisar em ${D_Brev[Typ]}..." oninput="Pesq(this,'${Typ}')">
                        <a class="Abslt HOV Pesq-Aa" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">Aa</a>
                        <a class="Abslt HOV Pesq-A_" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">A]</a>
                        <a class="Abslt HOV Pesq-Bj" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">Bj</a>
                        <a class="Abslt HOV Pesq-Rx" onclick="TOV(this);Pesq($('input',Pai(this)),'${Typ}')">Rx</a>
                        <img id="Lupa" class="Abslt HOV" src="./SVG/Icon_Lupa.svg">
                    </div>`
                }
                
            </script>
        </div>

        <div id="DivNav"><nav class="Ct H_Nav"></nav></div><!--nav-->

        <script>
            function NavPag(Typ){// ao Navegar
                Atual.Pag=Typ
                Show(`#Pag_${Typ}`,$$('#PAGES > *'))             // Troca Página
                if(!Cgo.Admn.nav.includes(Typ)){DTV($$('.H_Nav > *')) ; None($$('.pPesq')); return} // Caso a página não exista no nNav
                ATV($(`#b1_HNVDv_${Typ}`),$$('.BBody1 .H_Nav > *')) // Troca nNav.Atv do BBody1
                ATV($(`#b2_HNVDv_${Typ}`),$$('.BBody2 .H_Nav > *')) // Troca nNav.Atv do BBody2
                Show($$(`.Pesq_${Typ}`),$$('.pPesq'))            // Troca Pesquisa
                setTimeout(()=>getSBPromise.then(()=>loadtmtable(Typ)),0) // 100% Assíncrono
            }
        </script>

        <div id="H_Login" class="Ct"> <!--Perfil-->
            <style>
                #_LgFoto{background:url(./Img/FundoLogo.png); background-size:cover ; height: 100%; width: auto;}
                #LgFoto {width:42px; height:42px; margin:4px 4px}
                .Body1 #H_Mais{top:55px; right:0px}
                .Body2 #H_Mais{bottom: 0%; left:170px}
                #MAIS{background:#4e4e4e; width:250px ; color:white}
                #MAIS div{padding:10px;cursor:pointer;font-size:15px; width:100%}
                #MAIS div:not(:last-child):hover{background:gray;color:var(--Txt-Wit-Hover)}
                #MAIS div:last-child{padding:10px}
                #MAIS img{height:25px;margin-right:10px}
                #MAIS p,#MAIS p a{font-size:10px}
            </style>
            <img id="LgMORE" src="./SVG/More.svg" class="Hov" style="width:18px" onclick="ShowMore()" oncontextmenu="Prvn();ShowMore()">
            <div id="LgNome" class="Ct PT"  onclick="AbreLogin(true)">Login</div>
            <div id="_LgFoto"><img id="LgFoto" draggable="false" class="NObj" onclick="AbreLogin(true)" oncontextmenu="Prvn();ShowMore()"></div>

            <script>
                function ShowMore(){TogShow('#H_Mais')}
                function AbreLogin(valid){if(valid){if(Inn($('#LgNome'))!=='Login'){ShowMore();return}} ; MdalShow('#ModalLogin');Inn('#errPass','');Foco('#I_Pass')}
                function TestSenha(tipo,p){
                    const nome = $('#LgNome'),foto = $('#LgFoto')
                    const storg=e=>{StogeRmv('SenhaCryp');if(e){StogeSet('SenhaCryp',e)}}
                    const logaa=e=>{Inn(nome,USER[e].Nome);foto.src=USER[e].Foto;storg(e);SairMdal();Passs=e;PosLogin();LoadPerfil()}
                    if(tipo=='Dslog'){logaa('Login')}
                    if(tipo=='Storg'){if(p){logaa(p)}}
                    if(tipo=='Modal'){const P = CrypPass(p.value) ; if(USER[P]){logaa(P)}else{Inn('#errPass',TM.Pss) ; p.placeholder=TM.Pss};p.value='';p.focus()}
                }
                function PosLogin(){
                    U = USER[Passs] ; UCgo = Cgo[U.cgo]
                    $('body').className="" ; ['Ct',...U.body].forEach(e=>Add($('body'),e)) // Adiciona os CSS do Body
                    Inn('.BBody1 .H_Nav',UCgo.nav.map(e=>`<div id="b1_HNVDv_${e=='|'?'LIN':e}" class="Ct PT HOV" onclick="NavPag('${e}')"><img draggable="false" src="./SVG/${e=='|'?'LIN':e}.svg"><p>${D_Brev[e]}</p></div>`).join(''))
                    Inn('.BBody2 .H_Nav',UCgo.nav.map(e=>`<div id="b2_HNVDv_${e=='|'?'LIN':e}" class="Ct PT HOV" onclick="NavPag('${e}')"><img draggable="false" src="./SVG/${e=='|'?'LIN':e}.svg"><p>${D_Brev[e]}</p></div>`).join(''))
                    Inn('#Div-Pesq',UCgo.nav.map(Typ=>Load_Pesq(Typ)).join(''))
                    NavPag(Atual.Pag)
                    tmplt_Prod()
                    LOG('✅ Perfil Logado!')
                    $$('.TBLAA').forEach(e=>Add(e,U.cgo)) // Adicionando Cargo do Usuário a todas as Tabelas (com objetivo apenas de Ocultar ou não os ID)
                }
            </script>

            <div id="H_Mais" class="Abslt none bndj">
                <div id="MAIS" class="Ct Pose">
                    <div class="Start" onclick="NavPag('PRFL');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Edit.svg"><a> Ver Perfil       </a></div>
                    <div class="Start" onclick="AbreLogin()   ;None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Troc.svg"><a> Trocar de Conta  </a></div>
                    <div class="Start" onclick="NavPag('CONF');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Cnfg.svg"><a> Configurações    </a></div>
                    <div class="Start" onclick="NavPag('SPRT');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_Help.svg"><a> Central de Ajuda </a></div>
                    <div class="Start" onclick="TestSenha('Dslog');None('#H_Mais')"><img draggable="false" src="./SVG/Mais_LOff.svg"><a> Sair             </a></div>
                    <div><p>Confira os <a class="Link">Termos de Serviço</a> e as <a class="Link">Política de Privacidade</a></p></div>
                </div>
            </div>
        </div>
    </header>

    <div class="Ct w100">
        <header class="BBody2 Bt"> <!--Body2-->
            <div id="Title" class="Ct"> <!--Titulo-->
                <img id="Logo"  draggable="false" src="./Img/Logo.png" onclick="TrocaBody()">
                <img id="recolhe" style="height: 18px" src="./SVG/Recolhe.svg" onclick="Recolher()">
            </div>
            <div id="DivNav"><nav class="H_Nav Ct"></nav></div><!--nav-->
        </header>

        <div id="PAGES">

            <div id="Pag_HOME">
                <div class="Cl w100">
                    <div><!--Arte-->
                        <style>
                            .container{max-width: 300px; margin: auto;padding: 20px;border: 1px solid #ccc;border-radius: 10px;box-shadow: 2px 2px 10px rgba(0,0,0,0.1)}
                            .tootal, .tootal span {font-size: 18px;font-weight: bold;color: #00df00}
                            .Pcntalmt{margin-top: 15px;color: gray}
                        </style>                       

                        <div class="container" style="margin-bottom: 150px;margin-top: 50px;">
                            <h3>Orçamento de Arte:</h3>
                            <select id="designOptions" onchange="EscolheARTE()" class="w100">
                                <option value="20" data-extra="0">Post Digital - R$ 20,00</option>
                                <option value="20" data-extra="4">Carrossel - R$ 20,00 (+R$ 4,00 por unidade)</option>
                                <option value="25" data-extra="0">Banner Digital - R$ 25,00</option>
                                <option value="25" data-extra="0">Cartão de Visita - R$ 25,00</option>
                                <option value="50" data-extra="0">Flyer - R$ 50,00</option>
                                <option value="30" data-extra="0">Panfleto - R$ 30,00</option>
                                <option value="20" data-extra="0">Wing Banner - R$ 20,00</option>
                                <option value="50" data-extra="10">Cardápio - R$ 50,00 (+R$ 10,00 por página)</option>
                                <option value="25" data-extra="3">Backdrop Simples - R$ 25,00 (+R$ 3,00 por patrocinador)</option>
                                <option value="100"data-extra="0">Logo - R$ 100,00</option>
                                <option value="400"data-extra="0">Identidade - R$ 400,00</option>
                                <option value="40" data-extra="0">Manipulação/Tratamentos - R$ 40,00</option>
                                <option value="25" data-extra="0">Vetorização - R$ 25,00</option>
                                <option value="5"  data-extra="0">Banner Simples Texto - R$ 5,00</option>
                                <option value="30" data-extra="3">Arte para Camisa - R$ 30,00 (+R$ 3,00 por variação)</option>
                            </select>
                            <label for="quantidade">Quantidade:</label><input type="number" id="quantidade" value="1" min="1" oninput="EscolheARTE()">
                            </select>
                            <div id="Bruxos">
                                <label><input type="checkbox" value="20" onchange="EscolheARTE()"> Identidade Visual (20%)</label><br>
                                <label><input type="checkbox" value="15" onchange="EscolheARTE()"> Roteirizar (15%)</label><br>
                                <label><input type="checkbox" value="25" onchange="EscolheARTE()"> Criar Logomarca (25%)</label><br>
                                <label><input type="checkbox" value="8"  onchange="EscolheARTE()"> Digitação (8%)</label><br>
                                <label><input type="checkbox" value="7"  onchange="EscolheARTE()"> Escolha de Imagens (7%)</label><br>
                                <label><input type="checkbox" value="5"  onchange="EscolheARTE()"> Montagem (5%)</label><br>
                            </div>
                            <div class="Pcntalmt"></div>
                            <div class="tootal">Total: R$ <span id="total">0.00</span></div>
                        </div>

                        <script>
                            function EscolheARTE(){
                                const Slt = $("#designOptions")
                                const Qnt = $("#quantidade").value
                                const Val = parseFloat(Slt.value)
                                const Ext = parseFloat(Slt.options[Slt.selectedIndex].getAttribute("data-extra")) || 0
                                let Porcent = 0
                                $$('#Bruxos input[type="checkbox"]:checked').forEach(e=>{LOG(e) ; Porcent += parseFloat(e.value)})
                                const Pcnt = Porcent.toFixed(2)/100
                                const Total = Val+(Ext*(Qnt-1))
                                const Total2 = Total+(Total*Pcnt)
                                $(".Pcntalmt").innerHTML = `Porcentagem: R$ ${parseFloat(Pcnt)*100}%`
                                $(".tootal").innerHTML = `R$ ${Total2.toFixed(2).replace('.', ',')}`
                            }

                        </script>
                    </div>

                    <div class="Cl w100"> <!--GRAFICO-->

                        <style>
                            .Graficos {background:#1e1e2f; border-radius:20px; padding:20px; margin:10px;
                                box-shadow: 0 0 30px rgba(200, 100, 255, 0.2), 0 0 50px rgba(255, 100, 150, 0.1)}
                            #Grfc_Ftura{width: 40%;max-width: 40%; height: 300px; max-height: 300px;}
                            #Grfc_Servs{width: 40%;max-width: 40%; height: 300px; max-height: 300px;}
                            #Grfc_PixAv{width: 40%;max-width: 40%; height: 300px; max-height: 300px;}
                        </style>

                        <button onclick="RfreshGrafic()">Refresh</button>
                        <div class="Ct">
                            <canvas id="Grfc_Ftura" class="Graficos"></canvas>
                            <canvas id="Grfc_Servs"  class="Graficos"></canvas>
                            <canvas id="Grfc_PixAv"  class="Graficos"></canvas>
                        </div>
                        <script>
                            const coresGrafic = ['#c084fc','#f97316','#fb7185','#a855f7','#9d00ff','#ff6fb5']

                            function RfreshGrafic(){
                                Load_Grfc('Barra',Grfc_Ftura(J['PGMT']),$('#Grfc_Ftura'))
                                Load_Grfc('Pizza',Grfc_PixAv(J['PGMT']),$('#Grfc_PixAv'))
                                Load_Grfc('Barra',Grfc_Servs(J['SERV']),$('#Grfc_Servs'))
                            }
                            function Grfc_Servs(arr) {return ContFreq(arr,'Serv','Quantidade de Serviços')} // aqui ordenar do maior pra o Menor!
                            function Grfc_PixAv(arr) {return ContFreq(arr,'Form','Quantidade de Pagamentos')}

                            function Load_Grfc(tipo,base,ctx){
                                const mapa = {Barra:'bar',Linha:'line',Pizza:'pie',Rosca:'doughnut',Radar:'radar',Polar:'polarArea'}
                                ctx.chartInstance?.destroy() // limpa gráfico anterior
                                ctx.chartInstance = new Chart(ctx,{
                                    type: mapa[tipo], data: base,
                                    options:{responsive: true,animation: {duration: 1000,easing: 'easeOutBounce'},
                                        plugins: {
                                        legend: { labels: { color: '#fff' } },
                                        title:  { display: true, text: `Gráfico de ${tipo}`, color: '#ff79c6' }},
                                        scales: {
                                        x: { ticks: { color: '#c084fc' }, grid: { color: '#2a2a40' } },
                                        y: { ticks: { color: '#f97316' }, grid: { color: '#2a2a40' } }}}
                                })
                            }

                            // Função genérica que cria o objeto Chart.js
                            function criarBaseChart(labels, data, labelGrafico, cor = coresGrafic[0]) {
                                return {
                                    labels,
                                    datasets: [{
                                    label: labelGrafico,
                                    data,
                                    backgroundColor: Array.isArray(cor) ? cor : [cor],
                                    borderColor: '#fff',
                                    borderWidth: 1,
                                    tension: 0.4
                                    }]
                                };
                            }

                                // Faturamento Diário
                            function Grfc_Ftura(dados) {
                                const SemDATA = true;
                                const Intervalo = ['2025-10-01','Hoje'];
                                const hoje = new Date();
                                const inicio = new Date(Intervalo[0]);
                                const fim = Intervalo[1] === 'Hoje' ? hoje : new Date(Intervalo[1]);

                                const somaPorData = {};

                                const DADOS = dados
                                    .filter(e => e.Data?.trim() || !SemDATA)
                                    .map(e => ({ ...e, Data: e.Data ? YMD(e.Data) : "" }))
                                    .sort((a,b) => new Date(a.Data) - new Date(b.Data));

                                DADOS.forEach(e => {
                                    const data = e.Data?.trim();
                                    if (!data) return;
                                    const dataObj = new Date(data);
                                    if (dataObj < inicio || dataObj > fim) return;
                                    const chave = DMY(data);
                                    somaPorData[chave] = (somaPorData[chave] || 0) + Number(e.Valr || 0);
                                });

                                return criarBaseChart(Object.keys(somaPorData),Object.values(somaPorData),'Faturamento Diário (R$)',coresGrafic[0])
                            }

                            // Frequência de qualquer chave
                            function ContFreq(dados, chave, labelGrafico) {
                                const contagem = {};
                                dados.forEach(e => {const val = e[chave]?.trim();if (!val) return;contagem[val] = (contagem[val] || 0) + 1;});
                                const cores = Object.keys(contagem).map((_, i) => coresGrafic[i % coresGrafic.length]);
                                return criarBaseChart(Object.keys(contagem), Object.values(contagem), labelGrafico, cores);
                            }




                        </script>
                    </div>
                </div>
            </div>

            <style>
                /*Coisas que tem aver com a Página e não com a Tabela*/
                .Wrapper {overflow-X: hidden; width: 100%;position: relative}
                .Slide_Table {display: flex;transition: all 0.4s ease}
                .Slide_Table > div > div{transition: all 0.4s ease-in-out}
                .Slide_Table > div {flex: 0 0 100%;width: 100%;min-height: 100vh;box-sizing: border-box}
                #H_SERV{font-size: 10px}
                .Switch{margin: 8px;}
                #Sommma{color: white}
            </style>

            <div id="Pag_PDDS" class="TBLAA Cl">

                <div onload="Tm_Switch(this,['Pedidos','Serviços','Pagamento'],`slideTo(x,'PDDS')`,'PPDS')"></div>

                <div class="Wrapper">
                    <div id="Slide_PDDS" class="Slide_Table">
                        <div class="Cl">
                            <div class="Confy_PDDS">
                                <div class="Bt">
                                    <button onclick="AddROW('PDDS','<')">Nova Linha +</button>
                                    <div id="PagPesq_PDDS" class="PagPEsq" onload="Inn(this,Load_Pesq('PDDS'))"></div>
                                    <div id="COnf_PDDS"    class="Configs Ct">
                                        <div onclick="ReszH('PDDS')" onload="Tm_Check(this,`${SVG.RszH}`,'')"></div>
                                        <div onclick="ReszW('PDDS')" onload="Tm_Check(this,`${SVG.RszW}`,'')"></div>
                                    </div>
                                    <div onclick="Tog($$('#H_PDDS .AutoComp'),'Cor')" onload="Tm_Check(this,`${SVG.Chek}`,'Auto')"></div>
                                    <div id="Sommma">Soma: 00,00</div>
                                    <div onclick="TrcTog($('#H_PDDS'),'Tbla','Card');Tog_Card('PDDS')" onload="Tm_Interup(this,`${SVG.List}`,`${SVG.Card}`)"></div>
                                    <button onclick="F_Clen('PDDS')" onload="Inn(this,`${SVG.Cler.replace('HOV PT','')}Limpar`)"></button>
                                </div>  
                                <table id="SKLT_PDDS" class="hMin Tbla w90">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PDDS),'PDDS'))"></tr></thead>
                                    <tbody onload="Inn(this,Tm_Sklt('PDDS'))"></tbody>
                                    <tfoot class="Stky2"><tr></tr></tfoot>
                                </table>
                                <table id="H_PDDS" class="hMin Tbla">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PDDS),'PDDS'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.PDDS),'PDDS'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl">
                            <div class="Confy_SERV">
                                <div class="Bt">
                                    <button onclick="AddROW('SERV','<')">Nova Linha +</button>
                                    <div id="PagPesq_SERV" class="PagPEsq" onload="Inn(this,Load_Pesq('SERV'))"></div>
                                    <div id="COnf_SERV" class="Configs Ct"></div>
                                    <button onclick="F_Clen('SERV')">Limpar</button>
                                </div>
                                <table id="H_SERV" class="hMin">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.SERV),'SERV'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.SERV),'SERV'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl">
                            <div class="Confy_PGMT">
                                <div class="Bt">
                                    <button onclick="AddRowBdj('PGMT')">Nova Linha +</button>
                                    <div id="PagPesq_PGMT" class="PagPEsq" onload="Inn(this,Load_Pesq('PGMT'))"></div>
                                    <div id="COnf_PGMT" class="Configs Ct"></div>
                                    <button onclick="F_Clen('PGMT')">Limpar</button>
                                </div>
                                <table id="H_PGMT" class="hMin">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.PGMT),'PGMT'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.PGMT),'PGMT'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="Pag_PGMT" class="TBLAA none Cl">
                <div class="Ct Bt">
                    <button onclick="AddROW('MPAG','<')">Nova Linha +</button>
                    <div id="PagPesq_MPAG" class="PagPEsq" onload="Inn(this,Load_Pesq('MPAG'))"></div>
                    <div id="COnf_MPAG" class="Configs Ct"></div>
                    <button onclick="F_Clen('MPAG')">Limpar</button>
                </div>
                <table id="H_MPAG" class="w100 hMin">
                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.MPAG),'MPAG'))"></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div id="Pag_GRAD" class="TBLAA none Cl"> <!-- ⭐⭐_ _ _  (bem quse lá, na questão de organização e distribuição) -->

                <div onload="Tm_Switch(this,['GRAD','OS','UBER'],`slideTo(x,'GRAD')`,'GRAD')"></div>

                <div class="Wrapper">
                    <div id="Slide_GRAD" class="Slide_Table">
                        <div class="Cl">
                            <div class="Confy_GRAD">
                                <div class="Bt">
                                    <button onclick="AddROW('GRAD','<')">Nova Linha +</button>
                                    <div id="COnf_GRAD" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>
                                <table id="H_GRAD" class="hMin">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.GRAD),'GRAD'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.GRAD),'GRAD'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl">
                            <div class="Confy_OOSS">
                                <div class="Bt">
                                    <button onclick="AddROW('OOSS','<')">Nova Linha +</button>
                                    <div id="COnf_OOSS" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>

                                <table id="H_OOSS" class="hMin">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.OOSS),'OOSS'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.OOSS),'OOSS'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="Cl">
                            <div class="Confy_UBER">
                                <div class="Bt">
                                    <button onclick="AddROW('UBER','<')">Nova Linha +</button>
                                    <div id="COnf_UBER" class="Configs Ct"></div>
                                    <button>Limpar</button>
                                </div>
                                <table id="H_UBER" class="hMin">
                                    <thead class="Stky" style="z-index: 510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.UBER),'UBER'))"></tr></thead>
                                    <tbody></tbody>
                                    <tfoot class="Stky2"><tr onload="Inn(this,Tm_tdFoot(ObjKey(BS.UBER),'UBER'))"></tr></tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="Pag_CLNT" class="TBLAA none Cl">
                <div class="DivConf Ct Bt Stky">
                    <button onclick="AddROW('CLNT','<')">+ Nova Linha</button>
                    <h1>Tabela de Pagamentos</h1>
                    <button onclick="MesclarContato()">Mesclar</button>
                    <div id="PagPesq_CLNT" class="PagPEsq" onload="Inn(this,Load_Pesq('CLNT'))"></div>
                    <button onclick="F_Clen('CLNT')">Limpar Filtro</button>
                </div>
                <table id="H_CLNT" class="hMin">
                    <thead class="Stky" style="z-index:510"><tr onload="Inn(this,Tm_thSort(ObjKey(BS.CLNT),'CLNT'))"></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div id="Pag_LOJA" class=" none Cl">
                <style>
                    #Pag_LOJA img {width: 50%;margin: 15px}
                </style>

                <div id="DivListaKits"></div>
                <script>$('#DivListaKits')</script>

                <input type="file" id="svgInput" accept=".svg">
                <input id="SVGLarg" type="text" placeholder="Largura"><input id="SvgAlt" type="text" placeholder="Altura"><input id="SvgQnt" type="text" placeholder="Qnt">
                <div id="RsultsImgSvg"></div>
                <p id="resultadoSVG"></p>

                <script> // Render SVG
                    function contarNos(d) {
                        const comandos = d.match(/[a-zA-Z]|-?\d*\.?\d+/g);
                        if (!comandos) return 0;
                        let totalNos = 0;
                        let i = 0;
                        while (i < comandos.length) {
                            const cmd = comandos[i++].toUpperCase();
                            switch (cmd) {
                            case 'M':
                            case 'L':
                            case 'T': while (i + 1 < comandos.length && !isNaN(Number(comandos[i])) && !isNaN(Number(comandos[i + 1]))) {
                                totalNos++;i += 2;}break;
                            case 'H':
                            case 'V': while (i < comandos.length && !isNaN(Number(comandos[i]))){totalNos++;i++;}break;
                            case 'C': while (i + 5 < comandos.length) {totalNos++; // conta só o ponto final
                                i += 6;} break;
                            case 'S':
                            case 'Q': while (i + 3 < comandos.length) { totalNos++; i += 4; } break;
                            case 'A': while (i + 6 < comandos.length) {totalNos++; i += 7; }break;
                            case 'Z': /*não conta nó*/break;
                            default:if (!isNaN(Number(cmd))) {i++;}}
                        }return totalNos;
                    }
                    const ContPoly=p=>p?Math.floor(p.trim().split(/[\s,]+/).length/2):0

                    EvtChng($('#svgInput'),function(event){
                    const file = event.target.files[0]
                    if (!file) {return}

                    const reader = new FileReader()
                    reader.onload = function (e) {
                        const svgText = e.target.result
                        const parser = new DOMParser()
                        const svgDoc = parser.parseFromString(svgText, "image/svg+xml")

                        let totalNosPath = 0 ; let totalNosPoly = 0
                        $$('path'   ,svgDoc).forEach(path=>{totalNosPath += contarNos(path.getAttribute('d'     )||'')}) // Conta <path>
                        $$('polygon',svgDoc).forEach(poly=>{totalNosPoly += ContPoly( poly.getAttribute('points')||'')}) // Conta <polygon>

                        const Qnt = svgText.length
                        const qtdVirgulas = (svgText.match(/,/g) || []).length;
                        const valor = Num($('#SVGLarg').value) * Num($('#SvgAlt').value) * Num($('#SvgQnt').value) * 100
                        const TotalNos = totalNosPath+totalNosPoly
                        const Porcent = (TotalNos/100)*1.7
                        $('#resultadoSVG').textContent = `${TotalNos} Nós, R$ ${Cm(valor+(valor*Porcent))} - Porcent ${valor*Porcent}`
                        $('#RsultsImgSvg').innerHTML = svgText
                    }
                    reader.readAsText(file)
                    })
                </script>
            </div>

            <div id="Pag_GBRT" class=" none Ct" style="overflow: hidden">
                <!--
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
                -->
                <style> /*CSS da Aba de Config*/
                    #Config svg {cursor: pointer}
                    #Config .fil0{fill: #ff7300; width: 20px; margin: 5px; height: 20px}
                    #Config .fil0:hover {transform: scale(1.1)}
                    #Config .fil0:active{transform: scale(1.05)}
                    #Config .fil1{fill:#ff000000; width: 25px;height: 25px}
                    #Config .Cor1{fill: #ff4800}
                    #Config .Cor2{fill: purple}

                    #DivCnvs{width:75% ; height:100% ; overflow-y:auto ; padding-top: 70px;}
                    #Config {width:25% ; height:100% ; overflow-y:auto}
                    #Config > div {background:#50505025; border-radius:15px; margin:3px; width:97%; padding:20px}
                    #Config input[type="range"]{width:50%}
                    #IconsCofng{top:-10px; right:-10px}
                    #IconsCofng svg{width: 20px;}
                    #CropedID{top:5px; right:5px}
                    .Close{border-radius:5px; background:#ff3232; padding:1px; width:16px; height:16px; opacity: 0;top: 0; right: 0}
                    .Moldura{padding: 2px;border: 1px solid #ff480000}
                    .ConfigTxt canvas{margin:3px}
                    .ConfigTxt label {margin:2px}
                </style>

                <script> // Const Apenas para GABARITO
                    const OBJOBJ=[
                        [{id:'C_PP'  ,W:'1333',H:'1956'},{id:'F_PP'  ,W:'1333',H:'1899'},],
                        [{id:'C_P'   ,W:'1503',H:'2211'},{id:'F_P'   ,W:'1503',H:'2154'},],
                        [{id:'C_M'   ,W:'1559',H:'2353'},{id:'F_M'   ,W:'1559',H:'2296'},],
                        [{id:'C_G'   ,W:'1701',H:'2466'},{id:'F_G'   ,W:'1701',H:'2381'},],
                        [{id:'C_GG'  ,W:'1815',H:'2504'},{id:'F_GG'  ,W:'1815',H:'2468'},],
                        [{id:'C_XG'  ,W:'2041',H:'2565'},{id:'F_XG'  ,W:'2041',H:'2560'},],
                        [{id:'C_XXGG',W:'2239',H:'2749'},{id:'F_XXGG',W:'2239',H:'2743'},],
                    ]

                    let ObjCanvs = []
                    const ObjFundo = {F:'',V:''}
                </script>

                <script>
                // Biblioteca dos GBRT
                    const PrcAryObj=(e,Stg)=>e.find(E=>E.tamn===Stg)?.qnt || 'nada'
                    function Centlizar(e){e.value = 50}
                    const SplitFundo =e=>/costa|c\b/i.test(e)?'C':'F'
                // Funções Pequenas GABARITO
                    function Mdal_Area(e){ShowModal($(FMdal),'#Mdal-Area') ;  $(e).value = '' ; Foco(e)}
                    function Limpar(){$$('#Lista-001 tbody tr:not(:first-child)').forEach(e=>e.remove()) ; Clen_Alls($('#Lista-001 tbody tr:first-child'))}
                    function LimpObj(){ObjCanvs = []}
                    function AddRoW(){const newRow = $('#Lista-001 tbody tr:last-child').cloneNode(true) ; Clen_Alls(newRow) ; $('#Lista-001 tbody').appendChild(newRow)}
                // Funções Grandes GABARITO
                    function Upload(div,srcList){ // depois mudar de inner pra append pois inner ta subistituindo
                        const btnX = `<div class="Ct Abslt Close Opacy" onclick="Pai(this).remove();Read_Obj_Img()">X</div>`
                        $(div).innerHTML = srcList.map((src,x)=>`<div id="ImgDrop${x}" class="DivImgRsut Ct Rltv">${btnX}<img src="${src}" ondragstart="Drag2()"></div>`).join('')
                        $$(`${div} img`).forEach(img=>{img.onload=()=>{if(img.naturalWidth>img.naturalHeight){Add(img,'Larg')}else{Add(img,'Alt')}}})
                        Read_Obj_Img()
                    }  
                    async function ColarTudo(inpt){
                        const valor = await navigator.clipboard.readText()
                        if(!valor.match(/\n/g)&& valor.match(/\t/g)){Read_Ipt_Lin(inpt,valor) ; return}
                        if(!valor.match(/\n/g)&&!valor.match(/\t/g)){return}
                        $('#Area').value = valor ; Read_Obj_Area('#Area',inpt)
                    }
                </script>

                <script> // Read OBJ area img inpt
                    function Read_Obj_Area(Area,inpt){ // Atualiza Objeto Baseado na Area     // Depois tentar para Sincronizar
                        ObjCanvs.splice(IdxDe(Avo(inpt)))
                        $(Area).value.split('\n').map(match=>{
                        const {Nome,Tamn,Qnt} = SplitAvanc(match)
                        ObjCanvs.push({qnt:Qnt, tamn:Tamn, nome:Nome,src:'',Orgn:''})
                        })
                        Read_Ipt_Obj()
                    }

                    function Read_Obj_Img(imgs){       // Atualiza Objetos Baseado nas Imagens (Fundo e Nomes) // Depois tentar Sincronizar
                        ObjFundo['F'] = $('#DropsF img')?.src || ''
                        ObjFundo['V'] = $('#DropsV img')?.src || ''
                        
                        LOG('OBJ_IMG',ObjFundo)
                        /*
                        if(Imgss.length==0){Imgss.map(e=>{
                                const {Nome,Qnt,Tamn} = SplitAvanc(e.name)
                                ObjCanvs.push({qnt:Qnt,tamn:Tamn,nome:Nome,Orgn:'Imgs',src:e.src})});Read_Ipt_Obj()
                        }
                        */
                    }
                    
                    function Read_Ipt_Obj(){           // Atualiza Inputs Baseado no Objeto
                        None(FMdal)
                        Limpar()
                        ObjCanvs.forEach((i,x)=>{
                            if(x>0){AddRoW()}
                            const lastRow = $('#Lista-001 tbody tr:last-child')
                            $('.qnt',lastRow).value = i.qnt
                            $('.tamn',lastRow).value = i.tamn
                            $('.nome',lastRow).value = i.nome
                            $('.td-Src',lastRow).innerHTML = i.src
                            $('.td-Org',lastRow).innerHTML = i.Orgn
                        })
                    }
                    
                    function Read_Ipt_Lin(inpt,obj){   // Atualiza Inputs Baseado no ctrlV Unico
                        const {Nome,Tamn,Qnt} = SplitAvanc(obj)
                        const RowAtual = $('#Lista-001').rows[IdxDe(Avo(inpt))+1]
                        $('.qnt',RowAtual).value = Qnt
                        $('.tamn',RowAtual).value = Tamn
                        $('.nome',RowAtual).value = Nome
                        $('.td-Src',RowAtual).innerHTML = ''
                        $('.td-Org',RowAtual).innerHTML = ''
                        
                    }

                    function Read_Obj_Ipt(){           // Atualiza Objeto Baseado no Inputs
                        ObjCanvs = []
                        $$('#Lista-001 tbody tr').map(e=>{
                            const qnt  = $('.qnt',e).value
                            const tamn = $('.tamn',e).value
                            const nome = $('.nome',e).value
                            const src  = $('.td-Src',e).innerHTML
                            const org  = $('.td-Org',e).innerHTML

                            ObjCanvs.push({qnt:Number(qnt),tamn,nome,src,org})

                        //if(qnt&&tamn&&nome){LOG('tem tudo');}else{}
                        })
                        LOG('Objeto Atualizado',ObjCanvs)
                    }
                </script>

                <div id="Config" class="Cl"> <!--CONFIGURAÇÕES-->
                    <div class="Ct">           <!--NOME DO PEDIDO-->
                        <div><input id="NomeCliente" type="text" placeholder="Nome do Pedido"></div>
                    </div>

                    <div class="Ct Rltv">      <!--CONFIGURAÇÕES DE TAMANHO-->
                        <div id="CropedID" class="Ct DivCrop Abslt"> <!--Da pra Simplificar isso pra um Unico SVG-->
                            <div onclick="$('#Crop').click()" id="CropSvg" onload="Inn(this,SVG.Crop('fil0','Opacy'))"></div>
                            <input id="Crop" type="checkbox" class="none" onchange="Tog('.Croped','Opacy');Read_Canvs()">
                        </div>
        
                        <div class="w100"> <!--Aqui é o Controlador de Posições-->
                            <img src="./Testes/Tudi.jpg" height="150px">                          
                        </div> 
                        
                        <div class="controls">
                            <div class="w100">
                                <div class="Ct"><label>Tamanho</label><input type="range" id="size" min="0" max="150" value="50" oninput="Read_Canvs()"></div>
                                <div class="Ct"><label>Largura</label><input type="range" id="left" min="0" max="150" value="50" oninput="Read_Canvs()"><Button class="btnX" onclick="Centlizar($('#left'));Read_Canvs()">X</Button></div>
                                <div class="Ct"><label>Alturaa</label><input type="range" id="top"  min="0" max="150" value="50" oninput="Read_Canvs()"><Button class="btnY" onclick="Centlizar($('#top' ));Read_Canvs()">Y</Button></div>
                            </div>
                        </div>
                    </div>

                    <div class="ConfigTxt Ct"> <!--CONFIGURAÇÕES DE TEXTO-->
                        <div class="Ct w100"><label>Sombra:   </label><input class="w30" id="shadowColor"   type="color" value="#000000"> <input class="w30" id="shadowBlur"   type="number" value="10" oninput="Read_Canvs()"></div>
                        <hr class="w100">
                        <div class="Ct w100"><label>Contorno: </label><input class="w20" id="outlineColor"  type="color" value="#FFFFFF"> <input id="outlineWidth" type="range" value="2" min="1" max="10" step="0.2" oninput="Read_Canvs()"></div>
                        <hr class="w100">
                        <div class="Ct w100">
                            <div class="Ct"><label class="PT" id="TypeColor" onclick="InnTogg(this,'Cor:','Degradê:');Tog($$('.inptcolor1,.inptcolor2'),'none')">Degradê:</label></div>
                            <div class="Ct w30 none inptcolor1">
                                <input id="FontColor" type="color" value="#000000" oninput="Read_Canvs()">
                            </div>
                            <div class="Ct inptcolor2">
                                <canvas id="controlCanvas" class="Rd Moldura ClickCanv FOC" width="70" height="70"></canvas>
                                <input class="Opacy noClk" type="color" id="colorPicker1" style="display: none;">
                                <input class="Opacy noClk" type="color" id="colorPicker2" style="display: none;">
                                <div class="Cl">
                                    <div class="ClickCanv" id="alignX" onload="Inn(this,SVG.Aling('fil1'    ,'white','white'))">X</div>
                                    <div class="ClickCanv" id="alignY" onload="Inn(this,SVG.Aling('fil1 g90','white','white'))">Y</div>
                                </div>
                            </div>
                        </div>
                        <hr class="w100">
                        <div class="Ct w100"><label>Fonte:</label><select class="w50" id="fontFamily" onchange="CssFont('#fontFamily',this.value);Read_Canvs()"></select><script>Tm_OptFnt($('#fontFamily'),KitFonts)</script></div>
                    </div>

                    <div class="Ct">           <!--ABA DE LISTAS-->
                        <div class="Cl Rltv">
                            <button onclick="Mdal_Area('#Area')">Editar Inputs</button>

                            <div id="IconsCofng" class="Ct Abslt">
                                <div onload="Inn(this,SVG.Mais)" onclick="AddRoW()"          ></div>
                                <div onload="Inn(this,SVG.Cler)" onclick="Limpar();LimpObj()"></div>
                            </div>

                            <table id="Lista-001">
                                <thead><tr><th class="w60">Nome</th><th class="w20">Tamnh</th><th class="w20">Qnt</th></tr></thead>
                                <tbody>
                                    <tr>
                                        <td class="w60"><input  class="w90 nome" type="text"   placeholder="Nome" oninput="Rmv(this,'Error')" onchange="Read_Obj_Ipt()" onpaste="ColarTudo(this)" autocomplete="off"></td>
                                        <td class="w20"><select class="w90 tamn" onchange="Read_Obj_Ipt()"></select><script>load_Opts($('#Lista-001 .tamn'),O['Cams'])</script></td>
                                        <td class="w20"><input  class="w90 qnt"  type="number" placeholder="Qnt"  oninput="Rmv(this,'Error')" onchange="Read_Obj_Ipt()" autocomplete="off"></td>
                                        <td><div class="td-Src none"></div></td>
                                        <td><div class="td-Org none"></div></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="DivCnvs" class="Ct"> <!--ÁREA DE EXIBIÇÃO CANVAS-->
                    <style>
                        .DropZone{background:#50505023; padding:10px; border-radius:15px}
                        .DropZone .DivImgRsut{cursor: move; border:1px solid #ffffff2a; padding:2px; width:50px; height:50px}
                        .DropZone img.Larg{width:100%; height:auto}
                        .DropZone img.Alt {width:auto; height:100%}
                        .DivImgRsut:hover .Close{opacity:1}

                        .CanvBox{width: 380px;height: 350px; margin-top: 10px}
                        .CanvBox canvas {background:#505050;margin:5px}
                        .CanvBox canvas{width: 40%}
                        #Rodape{height: 200px}
                    </style>
                    <div class="w100" onload="Inn(this,IptFile('#DropIMG'))"></div>
                    <div class="Ct w100" style="margin-top:30px">
                        <div class="Cl"><label>Drop  </label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropIMG"></div></div>
                        <div class="Cl"><label>Frente</label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsF"></div></div>
                        <div class="Cl"><label>Costas</label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsV"></div></div>
                        <div class="Cl"><label>Manga </label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsM"></div></div>
                        <div class="Cl"><label>Nomes </label><div class="DropZone Ct" ondrop="Drop();Read_Obj_Img()" ondragover="Prvn()" id="DropsN"></div></div>
                    </div>                   
                    <div id="AllCanvas" class="Ct"></div>
                    <canvas id="gradientCanvas" width="400" height="400"></canvas>
                    <div id="Rodape" class="w100"></div>
                </div>

                <div id="FinaisCnvs" class="Ct Fx"> <!--CONFIRMAÇÕES FINAIS-->
                    <style>
                        #FinaisCnvs{left:45%; top:83vh; background:#1f1824f1; height:100px; width:500px; -webkit-backdrop-filter:blur(5px) ; backdrop-filter:blur(5px); border-radius: 255px}
                        #FinaisCnvs{border: 2px solid #2e2e2e96}
                    </style>
                    <button onclick="Load_Cnvs('#AllCanvas')">Carregar Canvas</button>
                </div>

                <script>     
                    LoadDegade($('#controlCanvas'))   
                    const FMdal = $('#FModal')

    
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
    //______________________________________________________________________________________________________________________________________________________________________________________________________
                </script>
            </div>

            <div id="Pag_ORC" class="none Cl">

                <div class="ConfigOrc w100 Ct">
                    <div id="PagPesq_ORC" class="PagPEsq" onload="Inn(this,Load_Pesq('ORC'))"></div>
                </div>

                <div id="DivIMGProd" class="Bt w90"> <!--IMAGENS dos PRODUTOS-->
                    <style>
                        #Div-Prod              {overflow-x:scroll; flex-wrap:nowrap}
                        #Div-Prod, #Div-Detalhes {transition: width 0.2s ease-in-out ; height:360px ; margin-bottom:12px}
                        #DivIMGProd     #Div-Prod {width: 100%}
                        #DivIMGProd.Atv #Div-Prod {width:  59%}
                        #DivIMGProd     #Div-Detalhes {width:  0% ; background: #00df0000}
                        #DivIMGProd.Atv #Div-Detalhes {width: 39% ; background: #00df0000 ; padding: 8px;}
                        #IconDtlh                     {top: 0px; left: 0px;}
                        #Div-Detalhes h3              {height: 10% ; font-size: 20px;}
                        #DetalheFotinha               {height: 90%}

                        #Div-Prod > div        {margin:9px 4px; display:flex; flex-direction:column}
                        #Div-Prod span         {margin-left:10px; margin-bottom:10px}
                        #Div-Prod span p       {margin:0px; font-size:9px}
                        #Div-Prod span p strong{font-size:9px}
                        #Div-Prod span img     {margin:5px; height:30px; width:30px}
                        #Div-Prod span h3, #Div-Prod span h3 strong{font-size:19px}
                        .CSS3 #Div-Prod span{color: #ffffff}
                        #Div-Prod .DivVrnts    {margin-top:20px}
                        .DivVrnts .vlM2  {margin-top: 5px;}
                        .DivVrnts .vlM2 a{font-size: 15px;}
                        .DivVrnts .vlM2 p{margin: 1px 2px;}
    
                        #Div-Prod .Opts               {top:45px; width:100%; height:30px; left:4px}
                        #Div-Prod .Opts img           {height:23px; width:23px; margin:3px 7px}
                        #Div-Prod .Opts div           {bottom:0; height:30px; width:50%; transition:all 0.1s ease-in-out; color: #000000;}
                            #Div-Prod .Opts div.Pre   {border-radius: 20px 0px 0 0 !important ; background:linear-gradient(to left,#bdb5be,#ffffff)}
                            #Div-Prod .Opts div.Pos   {border-radius: 0px 20px 0 0 !important ; background:linear-gradient(to right, #bdb5be,#ffffff)}
                            #Div-Prod .Opts div:hover {height: 35px ; border-radius: 20px 20px 0 0 !important}
                            #Div-Prod .Opts div.Atv   {z-index: 99 !important; border-radius: 20px 20px 0 0 !important ; background:linear-gradient(to right,#ffffff,#ffffff)} /*background:white;  era pra ter background mas ele ta fazendo Piscar, ai tirei*/ 

                        #Div-Prod .Conteudo{padding-top:10px; z-index:999}
                        :is(.CSS1,.CSS2) #Div-Prod .Conteudo,.offf{height:240px ; width:200px; margin:4px ; padding-bottom:15px; border-radius: 0px 0px 20px 20px ;background:linear-gradient(to top,#b3b3b3,#ffffff); color:#575757}
                        .CSS3 #Div-Prod .Conteudo,.offf{height:240px ; width:200px; margin:4px ; padding-bottom:15px; border-radius: 0px 0px 20px 20px ;background:linear-gradient(to top,#b3b3b35b,#ffffff); color:#575757;box-shadow:inset 0 0 8px #fdfdfd6e}
                        .offf{ top: 70px; background: #80808071; color: #ffffff;font-size: 20px;}
                        #Div-Prod .Conteudo .fotO {height:160px; width:150px}
                        #Div-Prod .Conteudo .fotO3{height:53px ; width:150px}
                        #Div-Prod .Conteudo .fotO4{height:80px ; width:80px}
                        #Div-Prod .Conteudo .fotO6{height:53px ; width:150px}
                        .tec2 { z-index: 999; top: 310px; left: 20%; width: 60%;}

                        /*esse Basicalmente é o Modal das Fotinahs q aparece a clicar na foto do Protudo*/
                        #Mdal-Prod     >.FotinhAA{width:500px; height:500px} /*Quando ela ta no Modal   */
                        #DetalheFotinha>.FotinhAA{width:76%  ; height:100% } /*Quando ela ta no Detalhes*/
                        .FotinhAA img            {top:0px; left:0px;}
                        .FotinhAA .Fotnh         {background:#00df00f8; width:18%; height:8%}
                        .FotinhAA .Fotnh2        {background:#00df0000; width:18%; height:8%}
                        .FotinhAA .Fotnh2:hover  {background:#f586ff63; border: 2px solid #ff00b3;}
                    </style>
                    <div id="Div-Prod" class="Start"></div>
                    <script>

                        function ShowVrnts(e){$$('.DivVrnts > div',Avo(e)).forEach((E,x)=>{
                            $$('div',Pai(e)).forEach((B,x,l)=>{Rmv(B,'Atv')
                                if(x < IdxDe(e)){Add(B,'Pre');Rmv(B,'Pos') ; B.style.zIndex = (l.length+x)-IdxDe(e)+10}
                                else{            Add(B,'Pos');Rmv(B,'Pre') ; B.style.zIndex = (l.length-x)+IdxDe(e)+10}})
                            Add(e,'Atv')
                            if(x===IdxDe(e)){Show(E)}else{None(E)}
                        })}

                        function tmplt_Prod(){ //GRANDE
                            Inn('#Div-Prod',AllProd.map(e=>{
                                const Fora = Prod[e].img=='Place' ? './SVG/placeholder.svg' : null
                                if(UCgo.orc.includes(e)) return
                                //if(U.cgo !== 'Admn' && Fora !== null){return}

                                const onck = `onclick="ExibeFotinha('${e}')"`
                                const vari = Prod[e].Variantes
                                
                                return `<div class="Rltv Start2">
                                    <span class="Start"><img src="${Fora || `./Prod/IconProd/${e}.svg`}"><div class="Start2"><h3 class="rgx">${e}</h3><p class="rgx">${Prod[e].Desc}</p></div></span>
                                    <div class="KeyInn none">...</div>

                                    <div class="Ct w100 Opts Abslt">${ // Faz o Menusiho de opções de cima
                                        Vari(e).map((vv,x,l)=>{
                                            const pose = `left:${(x*(200/l.length))-(x===0?0:15)}px;`
                                            const Larg = `width:${(200/l.length)+15}px;`
                                            const Zidx = `z-index:${(l.length-x)+10};`
                                            return `<div style="${pose+Larg+Zidx}" onclick="ShowVrnts(this)" class="Ct Abslt PT Pos ${x===0?'Atv':''}"><a class="none rgx">${vv}</a> <img name="${vv}" src="${Fora || `./Prod/IconProd/${vv=='Todos'?`${vv}`:`${e}_${vv}`}.svg`}"></div>`
                                        }).join('')}
                                    </div>

                                    <div class="Ct DivVrnts">${
                                        Vari(e).map((V,x)=>{const obj = vari[V]
                                            return `<div class="Conteudo Cl ${x===0?'':'none'}">
                                            ${Prod[e].Stts==="Offf"?`<div class="Ct Abslt offf">Indisponível no momento...</div>`:''}
                                            <div class="KeyVariants rgx">${V}</div>
                                            
                                            ${V == "Todos" ?
                                                `<div class="Ct">${ObjKey(vari).map((vV,x,l)=>vV=='Todos'?'':`<img class="fotO${l.length-1} Hov" src="${Fora || `./Prod/${e}_${V}_${vV}.webp`}" onclick="AddCarrinho('${e}','${vV}')">`).join('')}</div>`
                                                : `<img class="fotO Hov" src="${Fora || `./Prod/${e}_${V}.webp`}" ${onck}>`
                                            }
                                            ${Prod[e].Calc=='M2'  && V !== "Todos" ? `<div class="Ct vlM2" ${onck}>${Tm_RS(obj.Valr)}<p>m²</p></div>` : ''}
                                            ${Prod[e].Calc=='QNT' && V !== "Todos" && e=='Camisa' ? `<div class="Ct vlM2" ${onck}>${Tm_RS(obj.Valr['1'])}</div>` : ''}
                                            <div class="rgx none">${(HotKy[e] || []).map(e => e).join(',')}</div>
                                            <div class="RsutProduto w100 Ev">${/*OBJ.Valr.map((e,idx)=>{return tmplt_VlrTtl(OBJ.Valor[idx],e)}).join('')*/''}</div>
                                            <img class="Abslt tec2 HOV" onclick="AddCarrinho('${e}','${V}')" src="./SVG/Adicionar.svg">
                                            </div>`
                                        }).join('')}
                                    </div>

                                </div>`
                            }).join(''))
                        }
                                            
                        function ExibeFotinha(Serv){
                            const valid = $('#TrocaDetalheE').checked
                            LOG('check: ',valid)
                            const Exib  = valid ? '#Mdal-Prod' : '#DetalheFotinha'
                            if(valid){MdalShow('#Mdal-Prod')}
                            if(Prod[Serv].Prvw !== 'Fotinha'){Inn(Exib,`<div>${Prod[Serv].Prvw}</div>`)}
                            const procTab=(T,V)=>T.Table.flatMap(([l,p,i])=>i.map(s=>[V,l,p,s[0],s[3]]))
                            const Variants = Vari(Serv).flatMap((V,x)=>procTab(Prod[Serv].Variantes[V],V))
                            $(Exib).innerHTML = `<div class="FotinhAA Rltv">
                                <img class="Abslt w100 h100" src="./Fotos/${Serv}.webp">
                                ${Variants.map((e,x)=>`<div class="Abslt Fotnh2 Fotnh_Btn${x}" style="${e[4]||'left:0px;top:0px'}" onclick="AddCarrinho('${Serv}','${e[0]}','${e[1]}','${e[2]}','${e[3]}')"></div>`).join('')}
                            </div>`
                        }

                        function FotinhaMove(){ // serve só pra Mover as Fotinahs
                            const procTab=(T,V)=>T.Table.flatMap(([l,p,i])=>i.map(s=>[V,l,p,s[0],s[1]]))
                            const Variants = Vari(Serv).flatMap((V,x)=>procTab(Prod[Serv].Variantes[V],V))
                            $('#Mdal-Prod').innerHTML = `<div class="Rltv">
                                    <img class="Abslt w100 h100" src="./Fotos/${Serv}.webp">
                                    ${Variants.map((e,x)=>{
                                        return `<div class="Abslt movel Fotnh Fotnh_Btn${x}">
                                            ${e}
                                            <div class="dimens"></div>
                                            </div>`
                                    }).join('') }
                                </div>`
                        }
                        //FotinhaMove('Cardápio') // só pode chamar ela no final, pq tem q esperar o Modal Carregar! mas se pá eu jogue os Modais pra antes do Page

                        function ReloadDetalhes(){
                            None($$('#Div-Detalhes .canvi'))
                            const serv = VAAL($('#ORC tr.Atv .oServ')) || ""
                            
                            if(!Prod[serv]){return}
                            if(serv==""){// n exibe nada
                            }else if(Prod[serv].Prvw=='CanvMdd'){Show($('#CanvasMedidas'))
                            }else if(Prod[serv].Prvw=='Fotinha'){Show($('#DetalheFotinha'));ExibeFotinha(serv)
                            }else if(Prod[serv].Prvw=='PrevCAM'){
                            }else if(Prod[serv].Prvw=='CnvEcut'){
                            }else if(Prod[serv].Prvw=='MdalArt'){
                            }else if(Prod[serv].Prvw=='Canva3D'){Show($('#NewCanvas'))
                            }
                            // Estou Ocultando o Sugg do meu MySelect aqui por uma GAMBIARRA mas depois tentar tirar daquui
                        }
                        // Inventar o Add Folhas
                        // Adicionar as quantidade mínima
                        // Aumenta 15 pra Talões 2 Vias
                        // Criar os Limites de Medidas
                        // Mostrar Valor por UND de Cartões Tbm
                        // o Modal agora n precisa se restringir a 500 x 500
                    </script>
                    
                    <div id="Div-Detalhes" class="Rltv">
                        <h3 class="Start" onclick="TOV($('#DivIMGProd'))">Detalhes</h3>
                        <div id="IconDtlh" class="Abslt PT" onclick="TOV($('#DivIMGProd'))">⭐</div>
                        <div id="DetalheFotinha"   class="canvi Ct"></div>
                        <div id="NewCanvas"        class="canvi Ct Cnvs"></div>
                        <canvas id="CanvasMedidas" class="canvi Cnvs"></canvas>
                        <div id="ResutArea"></div>
                    </div>
                </div>
                
                <div id="NovoForm" class="Cl w90 Rltv Rd">
                    
                    <div id="CONFIG" class="Abslt Ct" style="right:10px;top:10px"> <!--CONFIGURAÇÕES-->
                        <div class="PT HOV O_All" onclick="ClrAll()">🧹</div><script></script>
                        <div class="PT HOV O_All" onclick="RmvAll()">❌</div><script></script>
                        <img draggable="false" src="./SVG/More.svg" class="NObj" style="width:20px;opacity:0.2" onclick="TogShow($('#CONFIG_Bdj'))">
                        <script>
                            function Hdd_Cblh(Valid){if(Valid){Add($$(`#ORC thead`),'none')}else{Rmv($$(`#ORC thead`),'none')}}
                            function Hdd_Cust(){Tog($$(`[class^="ORC_CUST_"]`),'none')}
                            function Hdd_Crct(){Tog($$(`[class^="ORC_CRCT_"]`),'none')}
                            document.addEventListener("keydown",function(e){if(e.key==="'"){Prvn();Hdd_Cust()}})
                        </script>
                        <style>#CONFIG_Bdj{width: 150px; right: 0px; background: #363636; padding: 10px}</style>
                        <div id="CONFIG_Bdj" class="Abslt none Start2 bndj">
                            <div class="Ct"><input id="Hdd-Cbclh" type="checkbox" checked onchange="Hdd_Cblh(this.checked)" onclick="SaveConfig(this)"><label>Exibir Cabeçalho</label></div>
                            <div class="Ct"><input type="checkbox" onchange="Hdd_Cust()"> <label>Exibir Custo    </label></div>
                            <div class="Ct"><input type="checkbox" onchange="Hdd_Crct()"> <label>Exibir Crescente</label></div>
                            <div class="Ct"><input type="checkbox" id="TrocaDetalheE">    <label>Trocar Detalhes </label></div> <!--q siguinfica mudar de Modal para Fixo na tela-->
                        </div>
                    </div>

                    <script> // Templates e Ações para Tabela de Orçamento
                        // Biblioteca
                            const cla = `[class^="ORC_CUST_"],[class^="ORC_CRCT_"],[class^="ORC_RSUT_"]`
                            const AddTrue=(e,Clss,True)=>$$(cla).forEach(e=>{if(True(e)){Add(e,Clss)}else{Rmv(e,Clss)}})
                            const InNa_RS=(e,val)=>{Inn(e,Tm_RS(val)) ; Nm(e,val)}
                            const ClrSlct=(arry)=>arry.forEach(e=>e.selectedIndex=0) // Deixar Junto com o Clear e Levar pra Biblioteca const Clear = e=>[e].flat().forEach(el=>$(el).value='')
                        // Templates
                            const Tm_ORC_Th=ary=>ary.map(e=>`<th class="${e==''?'':'O_Tx'}">${e==''?'':`<a>${e}</a><p>${D_Brev[e]}</p>`}</th>`).join('')
                            const Tm_Total=E=>[`CUST_${E} none`,`CRCT_${E} none`,`RSUT_${E}`].map(e=>`<div class="ORC_${e}" name="0">${Tm_RS(0)}</div>`).join('')
                        // Ações
                            const Check_W_Pag=()=>{if(window.innerWidth<=650){$$('#ORC .O_Tx').forEach(th=>Show($('a',th),$('p',th)))}
                                                   if(window.innerWidth> 650){$$('#ORC .O_Tx').forEach(th=>Show($('p',th),$('a',th)))}};window.addEventListener("resize",Check_W_Pag)
                            const RecolorVlr=()=>AddTrue($$(cla),'Branc',e=>Nm(e)==0)
                            const Zerar =tr=>$$(cla,tr).forEach(e=>InNa_RS(e,0))
                            const AddRow=tr=>{const a = tr.cloneNode(true) ; $$('input',a).forEach(e=>e.value='') ; Zerar(a) ; Insert(Pai(tr)).After(a,tr)}
                        // Clean e Remove
                            const ClrAll=()=>{$$(`#ORC tbody td:nth-child(10) > div`).forEach(E=>DispClick(E)) ; ReloadTotal()}
                            const RmvAll=()=>{$$(`#ORC tbody td:nth-child(11) > div`).forEach((E,X)=>{if(X==0){return}else{DispClick(E)}}) ; ReloadTotal()}
                            const ClrRow=tr=>{Clear($$('input',tr)) ; ClrSlct($$('select',tr)) ; Zerar(tr)}
                            const RmvRow=tr=>tr.remove()
                        
                            const Tm_Select=(Eu,e,lista)=>{
                                Eu.classList.add('Rltv','MySelect','Rltv','w100')
                                Inn(Eu,`<input class="Stky" placeholder="Clientes" onfocus="Rolada(this);LinkSug('ORC',this,'MySelect','${lista}')" oninput="LinkSug('ORC',this,'MySelect','${lista}')"><span class="Abslt Sugg Cl"></span>`)
                            // Antes de Tirar daqui fazer ele transitar com as SETAS
                            }
                            // As Gambiarra pra fazer o MySelect Funcionar, depois Imbutir tudo dentro dele msm
                            function Selecty(Eu){Vll($('input',_td(Eu)),Aa(Eu.innerText)) ; SERVChang($('input',_td(Eu)))}
                            function Rolada(Eu){Show($('.Sugg',Pai(Eu)))}
                            
                    </script>

                    <style>  /*CSS da Tabela de Orçamento*/
                        :is(.CSS1,.CSS2) #NovoForm{padding:20px 10px;background:#ffffff0a}
                        .CSS3 #NovoForm{padding:20px 10px;background:linear-gradient(to top,#ffffff5d,#ffffff09);box-shadow:inset 0 0 8px #fdfdfd6e;margin-bottom: 5px;}
                        #ORC input,#ORC select{width:100% !important ; margin:0}
                        #ORC   .RS    {font-size:9px  ; margin-right: 3px}
                        #ORC   .RS + a{font-size:15px ; font-weight: bold;}
                        .Final .RS + a{font-size:25px ; font-family:var(--Bold)}
                        .Final .RS    {margin-right:3px}
                        :is(.CSS1,.CSS2) [class^="ORC_CUST_"]{color:#ff6565}.CSS3 [class^="ORC_CUST_"]{color:#c42929}
                        :is(.CSS1,.CSS2) [class^="ORC_CRCT_"]{color:#65b5ff}.CSS3 [class^="ORC_CRCT_"]{color:#146bbd}
                        :is(.CSS1,.CSS2) [class^="ORC_RSUT_"]{color:#48ff00}.CSS3 [class^="ORC_RSUT_"]{color:#2c9402}
                        .CSS3 .ORC_RSUT_FINAL  {color:#ffffff !important;background:#2c9402;border-radius:255px;padding:0px 10px}
                        #ORC td{padding: 1px}
                        #ORC th a,#ORC th p{display: flex;align-items: center;justify-content: center; opacity: 0.8;}
                        #ORC .Atv input,#ORC .Atv select{border: solid 2px #ff008c}
                        #ORC .Atv .imita{box-shadow: 0 0 2px 2px #ff008c}
                        .Branc{color: #ffffff5d !important}
                        .imita{height: 30px; background: #ffffff11}
                        .sOFF{opacity:0.3}
                        #G_Cores div{width:80%;  height:30px; border:2px solid #ffffff2f}
                        #G_Cores p  {width:30px; height:30px; margin:2px}
                        .AvisoInpt{top: 25px;width: 70%;left: 50%;font-size: 10px;background: #710808;padding: 2px;transform: translate(-50%, 0%)}

                        .CSS1 :is(.OrcAdd,.OrcClr){fill:#ffa500 !important}
                        .CSS2 :is(.OrcAdd,.OrcClr){fill:#ffa500 !important}
                        .CSS3 :is(.OrcAdd,.OrcClr){fill:#6900569c !important} :is(.OrcAdd,.OrcClr) svg{width: 18px;}
                        .OrcRmv{fill:#ff0000e7 !important} .OrcRmv svg{width:15px}

                        .Calc_M2  :is(.oCbmt,.oGram,.oQntt){display:none}.Calc_M2  :is(.oLrg,.oAlt,.oQnt){display: flex}
                        .Calc_OFS :is(.oCbmt,.oGram,.oQntt){display:flex}.Calc_OFS :is(.oLrg,.oAlt,.oQnt){display: none}
                        .Calc_UND :is(.oCbmt,.oGram       ){display:none}.Calc_UND :is(.oQnt            ){display: flex}
                    </style>

                    <table id="ORC" class="w90" onkeydown="HandArrow(this,event)">
                        <thead><tr onload="Inn(this,Tm_ORC_Th(['','Serv','Tipo','Lrg','Alt','Qnt','Aplic','Und','SbTt','','']))"></tr></thead>
                        <tbody>
                            <tr class="TrRow" oninput="ORC_Calc(this);RecolorVlr()" onchange="ValidOpts()">
                                <td width="15px"            ><div class="PT Ct OrcAdd"   onclick="AddRow(_tr(this));Rload_Tbl();ReloadTotal()" onload="Inn(this,SVG.Mais)"></div></td><!--➕-->
                                <td                         ><div    class="oServ"       oninput="SERVChang(this)" onload="Tm_Select(this,'-',['Serviços',...AllProd])">       </div></td>
                                <td                         ><select class="oTipo"      onchange="TIPOChang(this)" onload="Inn(this,Tm_Opt(['Tipo']))"                     ></select></td>
                                <td width="10%" class="Rltv"><select class="oCbmt none" onchange="CBMTChang(this)" onload="Inn(this,Tm_Opt(['Acabamento']))"               ></select><input  class="oLrg" placeholder="Largura"      oninput="Mask.Num(this);RodaCanvMdds()"><span class="Abslt AvisoInpt none RD"></span></td>
                                <td width="10%" class="Rltv"><select class="oGram none" onchange="GRAMChang(this)" onload="Inn(this,Tm_Opt(['Gramatura']))"                ></select><input  class="oAlt" placeholder="Altura"       oninput="Mask.Num(this);RodaCanvMdds()"><span class="Abslt AvisoInpt none RD"></span></td>
                                <td width="10%"             ><select class="oQntt none" onchange="QNTTChang(this)" onload="Inn(this,Tm_Opt(['Qnt']))"                      ></select><input  class="oQnt" placeholder="Quantidade"></td>
                                <td width="10px"><div onload="Tm_Check(this,`${SVG.Chek}`)"></div>     </td>
                                <td width="10%" ><div onload="Inn(this,Tm_Total('Vund'))" style="height:auto;min-height:30px" class="imita RD Ct"></div></td>
                                <td width="10%" ><div onload="Inn(this,Tm_Total('SbTt'))" style="height:auto;min-height:30px" class="imita RD Ct"></div></td>
                                <td width="15px"><div class="PT Ct OrcClr" onclick="ClrRow(_tr(this));Rload_Tbl();ReloadTotal()" onload="Inn(this,SVG.Cler)"></div></td><!--🧹-->
                                <td width="15px"><div class="PT Ct OrcRmv" onclick="RmvRow(_tr(this));Rload_Tbl();ReloadTotal()" onload="Inn(this,SVG.Fexa)"></div></td><!--❌-->
                            </tr>
                        </tbody>
                    </table>

                    <script> // Funções do Tbody
                        // selecionar option automaticamente caso tenha apeans 1
                        // no Select se oq está atualmente selecionado, existir no option da próxima rodada, então mantem ele

                        function AddCarrinho(Serv,Tipo,Cbmt,Gram,Qntt){ // ta dando erro quando n tem Cbmnt, ou tipo ou outros
                            const  ult = $$('.OrcAdd').slice(-1)[0]
                            if(VAAL($('.oServ'))!==""){DispClick(ult)}
                            const SERV = $$('.oServ input').slice(-1)[0] ; SERV.value = Serv ; SERVChang(SERV) // Delay(0.2)
                            const TIPO = $$('.oTipo'      ).slice(-1)[0] ; TIPO.value = Tipo ; TIPOChang(TIPO) 
                            const CBMT = $$('.oCbmt'      ).slice(-1)[0] ; CBMT.value = Cbmt ; CBMTChang(TIPO)
                            const GRAM = $$('.oGram'      ).slice(-1)[0] ; GRAM.value = Gram ; GRAMChang(TIPO)
                            const QNTT = $$('.oQntt'      ).slice(-1)[0] ; QNTT.value = Qntt ; QNTTChang(TIPO)
                        }

                        const TipoCalc=(e)=>{
                            ['M2','OFS','UND'].forEach(t=>{Prod[VAAL(e)].Calc===t ? Add(_tr(e),'Calc_'+t) : Rmv(_tr(e),'Calc_'+t)}) // Tog_M2_OFS_UND
                            Prod[VAAL(e)].Etpa.includes('Aplic') ? Rmv_N($$(':is(td,th):nth-child(7)',_table(e))) : Add_N($$(':is(td,th):nth-child(7)',_table(e))) // se tem Aplicação ou Não
                        }

                        const cP=(Stg,e)=>VAAL($(Stg,_tr(e)))
                        function SERVChang(e){if(!Prod[VAAL(e)]){return} ; const Lista = ObjKey(Prod[VAAL(e)].Variantes) ; Inn($('.oTipo',_tr(e)),Tm_Opt(['Tipo',...Lista])) ; TipoCalc(e)}
                        function TIPOChang(e){const Lista = Prod[cP('.oServ',e)].Variantes[cP('.oTipo',e)].Table; Inn($('.oCbmt',_tr(e)),Tm_Opt(['Acabamento',...Uniq(Lista?.map(e=>e[0]))]))}
                        function CBMTChang(e){const Lista = Prod[cP('.oServ',e)].Variantes[cP('.oTipo',e)].Table; Inn($('.oGram',_tr(e)),Tm_Opt(['Acabamento',...Uniq(Lista?.map(e=>e[1]))]))}
                        function GRAMChang(e){const Lista = Prod[cP('.oServ',e)].Variantes[cP('.oTipo',e)].Table; Inn($('.oQntt',_tr(e)),Tm_Opt(['Acabamento',...Uniq(Lista?.map(e=>e[2])[0].map(e=>e[0]))]))}
                        function QNTTChang(e){const Lista = Prod[cP('.oServ',e)].Variantes[cP('.oTipo',e)].Table; ORC_Calc(_tr(e),Lista)}                       

                        function ORC_Calc(tr,Lista=null){
                            const TotalCress=(Valr,e)=>Math.round(e*(Valr+Valr*Crecent(e)))
                            const Colet =arr=>arr.map(e=> ['Lrg','Alt','Qnt'].includes(e) ? (Num($(`.o${e}`,tr).value)||0) : VAAL($(`.o${e}`,tr)))
                            let [Serv,Tipo,Cbmt,Gram,Qntt,Lrg,Alt,Qnt] = Colet(['Serv','Tipo','Cbmt','Gram','Qntt','Lrg','Alt','Qnt'])
                            
                            if(!Prod[Serv]){return}

                            const Calc = Prod[Serv].Calc
                            const M2   = Prod[Serv]['Variantes'][Tipo]
                            const QNT  = Num(Qntt.replace('.',''))
                            let F_Cust = 0 ; let F_Valr = 0
                            
                            if(Calc=='OFS'){ // Só pra OFS
                                const filt   = Lista.filter(e=>e[0]===Cbmt && e[1]===Gram)
                                const filt2  = filt [0][2].filter(e=>e[0]===Qntt)
                                F_Cust = filt2[0][2]
                                F_Valr = filt2[0][1]
                            }

                            if(Calc=='M2'){ // Se for M² então Determina Limite Maximo e Mínimo e Zera o Resultado Final

                                function AddAviso(Val,Inpt,MinMax){Rmv_N($('span',Pai(Inpt))) ; Inn($('span',Pai(Inpt)),`${MinMax}: ${Cm(Val)}`)}

                                function CheckLimit(La,Al){
                                    const Zerar=(inp)=>{ if(inp===La) Lrg=0 ; if(inp===Al) Alt=0 }
                                    /*Limpeza*/ Rmv(La,'Error') ; Rmv(Al,'Error') ; Add_N($('span',Pai(La))) ; Add_N($('span',Pai(Al)))
                                    const limits = Prod[Serv]?.Variantes[Tipo]?.Limit || {} // tem um erro aqui !!!!!!!!!!!!!!!!!!! alguns n tem Limit acho q é isso
                                    const Min = limits.Min || {} ; const Max = limits.Max || {}
                                    const map = {L:La,A:Al,x:La,X:Al};// mapa para saber qual input mexer
                                    ["L","A","x","X"].forEach(k=>{    // percorre todas as chaves possíveis
                                        let min = Min[k] || 0 ; let max = Max[k] || 0
                                        let val = (k === "L" || k === "x") ? Lrg : Alt // decide se é largura ou altura
                                        let input = map[k]
                                        if (val == '' || val == 0){return} // não vazer nada caso esteja vazio ainda!
                                        if (min && val < min){Add(input,"Error")  ; AddAviso(min,input,'Min') ; Zerar(input)}
                                        if (max && val > max){Add(input,"Error")  ; AddAviso(max,input,'Max') ; Zerar(input)} })
                                }
                                CheckLimit($('.oLrg',tr),$('.oAlt',tr)) // tem um erro aqui !!!!!!!!!!!!!!!!!!!
                            }

                            const oMetro  = Lrg*Alt*Qnt
                            const DESCt   = oMetro <= 5 ? 0 : oMetro >= 15 ? 0.15 : oMetro/100  // Melhorar Progressivo
                            const DescQtn = (oMetro <= 1 ? 0 : (Qnt/100))/2
                            
                            const Adicional = Serv=='Trofeu' ? 1*Qnt : 0
                            const Cust = M2?.Cust ?? 0
                            const Valr = M2?.Valr ?? 0
                            const CUSTO = Calc=='M2' ? Cust*Lrg*Alt*Qnt                       : F_Cust
                            const CRCT  = Calc=='M2' ? Valr*Lrg*Alt*Qnt+Adicional             : F_Cust
                            const VALOR = Calc=='M2' ? TotalCress(Valr,Lrg*Alt*Qnt)+Adicional : F_Valr
                            
                            const VALOR_D = Math.floor(VALOR-(VALOR*(DESCt-(DescQtn))))
                            
                            //LOG(`${oMetro}m² - `,'Desc1:',DESCt,' - Desc2:',DescQtn)

                            InNa_RS($('.ORC_CUST_Vund',tr),(CUSTO/Qnt || 0))
                            InNa_RS($('.ORC_CUST_SbTt',tr),CUSTO)
                            InNa_RS($('.ORC_CRCT_Vund',tr),(CRCT/Qnt || 0))
                            InNa_RS($('.ORC_CRCT_SbTt',tr),CRCT)
                            InNa_RS($('.ORC_RSUT_Vund',tr),(VALOR_D/Qnt || 0))
                            InNa_RS($('.ORC_RSUT_SbTt',tr),VALOR_D)

                            ReloadTotal()
                        }
                    
                        function ValidOpts(){$$('#ORC select').forEach(e=>$$('option',e).length==1 ? Add(e,'sOFF') : Rmv(e,'sOFF'))}

                        function Tm_OptsGraff(Ary,Stg=null){ //  Função que Carrega os Serviços dentro dos Grupos
                            const GpIt={}, GpOF={}
                            ObjEtr(Prod).forEach(([k,v])=>{GpIt[k] = v.Calc ; GpOF[k] = v.Stts})

                            return `<option value="" disabled selected>${Ary[0]}</option>
                                ${Object.entries(Ary.slice(1).reduce((a,e)=>{
                                    (a[GpIt[e]]||=[]).push(`<option value=\"${e}\" ${Stg === e ? 'selected' : ''} ${GpOF[e] === 'Offf' ? 'style=\"color:red;\"' : ''}>${e}</option>`);return a
                                },{})).map(([g,o]) => `<optgroup label=\"${g}\">${o.join('')}</optgroup>`).join('')}
                            `
                        }
                    </script>

                    <div> <!--Valores TOTAL-->
                        <p>Total</p>
                        <div class="ORC_CUST_FINAL Final none"></div>
                        <div class="ORC_CRCT_FINAL Final none"></div>
                        <div class="ORC_RSUT_FINAL Final"     ></div>
                        <script>
                            function ReloadTotal(){
                                const S1 = SOMA($$('.ORC_CUST_SbTt').map(e=>Nm(e))) ; Inn($('.ORC_CUST_FINAL'),Tm_RS(S1)) ; Nm($('.ORC_CUST_FINAL'),S1)
                                const S2 = SOMA($$('.ORC_CRCT_SbTt').map(e=>Nm(e))) ; Inn($('.ORC_CRCT_FINAL'),Tm_RS(S2)) ; Nm($('.ORC_CRCT_FINAL'),S2)
                                const S3 = SOMA($$('.ORC_RSUT_SbTt').map(e=>Nm(e))) ; Inn($('.ORC_RSUT_FINAL'),Tm_RS(S3)) ; Nm($('.ORC_RSUT_FINAL'),S3)
                            }
                        </script>
                    </div>

                    <script> // Funções Dedicadas a Tabelas de ORÇAMENTO
                        function Rload_Tbl(){Upp_Tabela('#ORC') ; Upp_RowCol('#ORC') ; RecolorVlr('#ORC') ; RecolorVlr()} ; Rload_Tbl()
                        function Upp_Tabela(Tbl){
                            $$(`${Tbl} tbody tr`).length == 1 ? None($$('.OrcRmv',$(Tbl))) : Show($$('.OrcRmv',$(Tbl))) // Remover o X
                            $$(`${Tbl} tbody tr`).length == 1 ? None($$('.O_All')) : Show($$('.O_All'))
                            // aqui pode ter mais coisas pra Atualizar a Tabela
                        }
                        function Upp_RowCol(Tbl){
                            const Lmt = $$(`${Tbl} tr:nth-child(1) input`).length
                            $$(`${Tbl} input`).forEach((I,x)=>{
                                I.dataset.row = Math.floor(x/Lmt)
                                I.dataset.col = x % Lmt})
                        }
                        function HandArrow(Tbl,e){
                            if (e.key === "Enter"){
                                const Inpts = $$(`input`,Tbl)
                                const Elemt = $(':focus')
                                const Next = Inpts[Array.from(Inpts).indexOf(Elemt)+1]
                                if(Next){Next.focus() ; Next.select() }}
                            let act = document.activeElement
                            if (act.tagName !== "INPUT") return
                            let r = +act.dataset.row, c = +act.dataset.col, nxt
                            if (e.key === "ArrowRight") nxt = `[data-row='${ r }'][data-col='${c+1}']`
                            if (e.key === "ArrowLeft")  nxt = `[data-row='${ r }'][data-col='${c-1}']`
                            if (e.key === "ArrowDown")  nxt = `[data-row='${r+1}'][data-col='${ c }']`
                            if (e.key === "ArrowUp")    nxt = `[data-row='${r-1}'][data-col='${ c }']`
                            if (nxt){$(nxt)?.focus() ; setTimeout(()=>$(nxt)?.select(),0)}
                        }
                        ValidOpts()
                    </script>

                    <div class="w100 Ct none" style="margin-top: 80px"> <!--Informações Extras-->
                        <div class="Cl"><label>Nome</label><input placeholder="Nome"></div>
                        <div class="Cl"><label>Contato</label><input placeholder="Contato"></div>
                        <div class="Cl"><label>Endereço</label><input placeholder="Endereço"></div>
                        <div class="Cl"><label>Comentário</label><input placeholder="Comentário"></div>
                    </div>
                    <button onclick="VerNota('ORC')">Ver Nota</button>
                </div>

                <div id="G_Cores" class="Ct none"> <!--AJEITAR-->
                    <!-- Ajeitar  
                        isso ficará disponível apenas para coisas com cores sólidas como Recorte e Router
                        deverá ser transformado em um Menu suspenso, uma Bandeija, pra n atrapalhar
                        pois ele vai ficar dentro da tabela
                        essa tabela terá uma Coluna Extra, [Serv, Tipo, Larg, Alt, Qnt, Extra]
                        esse extra quando for algo q tenha cor, será a Cor o extra
                        se for Placa, Plotagem o extra será comprimento
                    -->
                    <style>

                    </style>
                    <script>  
                        const Load_Cor =()=>StockjVinil.map(e=>`<p class="RD PT" style="background:${e}" onclick="mudarCor('${e}');VariasCor(this,'${e}')"></p>`).join('')
                        const mudarCor =cor=>Bkg($('#I_Cor'),cor)
                        const VariasCor=Cor=>{Cor.innerHTML = Cor.innerHTML==='1'?'':'1';Tog(Cor,'Atv')}
                    </script>
                    <div id="I_Cor" class="Ct Rd PT" onclick="Tog_N(Sib('a'))">Escolha uma Cor</div>
                    <a class="Ct none" onload="Inn(this,Load_Cor())"></a>
                </div>

                <div class="Cl">
                    <div class="Ct w100">    
                        <div id="AreaX" class="Cl"><label for="I_AreaX">Largura Area</label><input id="I_AreaX" placeholder="Largura Area" oninput="Mask.Num(this);RodaCanvMdds()"></div>
                        <div id="AreaY" class="Cl"><label for="I_AreaY">Altura Area </label><input id="I_AreaY" placeholder="Altura Area"  oninput="Mask.Num(this);RodaCanvMdds()"></div>
                    </div>
                    <div id="LoadCanvaaas">Lugar do Botão ShowCanvas</div>
                    
                    <div class="Cl"><input id="Compmnt" type="text" placeholder="Comprimento" value="0"></div> <!--Comprimento n precisa ser Value 0 aqui, se for Vazio então da Zero no Gera3D-->
                    <!--Não preciso de um Input aqui pra receber 0 ou 1, isso pode fica diretamente na class do Button q deveria ser um CheckBox e Xuva-->
                    <div class="Cl none"><button class="Ct" onclick="ValTogg('#BackCub','0','1')">Completar Cubo</button><input id="BackCub" class="none" value="0"></div>
                    <button class="none" onclick="Gera3d($('#NewCanvas'))">Roda 3D</button>
                    <div>
                        <!--
                            Permitir q cada linha Gere seu Canvas
                            ambos os Canvas, de Mdds e de Gera3D
                            Redimensionar canva 3D com base na altura se passar do preview (como no drop img do GBRT)
                        -->
                    </div>
                </div>

                <script>// Comentários Orçamento
                    // a soma de metros de produtos do mesmo tipo tem q resultar na soma da Diminuição da Crescente
                    // o Valor Crescente deve ficar verde, se ele for igual ao valor Final
                    // Criar meu Próprio Select (igual pesquisa de Cliente na Tabela) Mostrar o Valor por M2 ao Lado do Option
                    // imitar Bureal no Futuro (deixando todas bandeijas Aberta) (com meu Próprio Select eu Talvez Consiga)
                    // Permitir Drag nas Linhas

                    // quero criar meu próprio Teclado Numerico, com Opções de cm, m, e mm (Oculpando espaço nessesário na Tela, sem mover o Scroll)
                    // como impedir q a página dê zoom, pelo celular
                    // Tipos de Aplicação: Plana, Irregular, Alto e Baixo
                </script>
            </div>
           
            <div id="Pag_PRFL" class="none Cl">
                <style>
                    .st-mais {margin: 20px 0px;}
                    .profile { display: flex; align-items: center; gap: 20px; margin: 20px 0px;}
                    .profile img { width: 200px; border-radius: 50%}
                    .info h2 { margin: 0 ; font-size: 30px;}
                    .info a  { color: #ccc}
                    .info .Start2{margin-top: 5px;}
                    .profile .box{height: 100px;}
                    .box {border-radius: 10px; padding: 15px}
                    .CSS1 .box   {background: #6d6d6d3f}
                    .CSS2 .box   {background: #6d6d6d3f}
                    .CSS3 .box   {background: #ffffff71}
                    .box p {font-size: 1.2rem; margin-bottom: 10px}
                    .box a {color: #e600ac; font-weight: bold ; font-size: 28px;}
                    .task-item { display: flex; align-items: center; gap: 10px; padding: 5px 0; }
                    .task-item input[type="checkbox"] { transform: scale(1.2); }
                    .task-item.pendente::before { content: '\25CF'; color: magenta; font-size: 12px; margin-right: 6px; }
                    .gap {gap: 10px }

                    #tarefas table { width:100%; font-family:Arial,sans-serif; font-size:14px; color:#eee; background-color:#222; }
                    #tarefas th, #tarefas td { border:1px solid #444; padding:8px 12px; text-align:left; }
                    #tarefas th { background-color:#333; font-weight:bold; }
                    #tarefas tr:hover { background-color:#444; }
                    #tarefas input[type="checkbox"] { transform:scale(1.2); cursor:pointer; accent-color:#1e90ff; }
                    #tarefas td:first-child { text-align:center; width:50px; }


                </style>
                <div id="PerfilUser" class="w100 Cl"></div>
                <script>
                const rascunhos = [
                    { Alt: 100,Lag:200, Qnt:3 },
                    { Alt: 50, Lag: 70, Qnt:10 }
                ]

                function LoadPerfil(){
                    $("#PerfilUser").innerHTML = `
                        <div class="profile Ct w100">
                            <img class="Hov" src="${U.Foto}" onclick="RfreshPerfil('${U.Nome}')">
                            <div class="info">
                                <h2>${U.Nome}</h2><a>${U.cgo}</a>
                                <div class="Start2"><p>${U.Fone}</p><p>${U.Emal}</p><p>${U.Lcal}</p></div>
                            </div>
                            <div class="box Hov Cl Taranty1"><p>TOTAL DE PARTICIAÇÃO </p><a></a></div>
                            <div class="box Hov Cl Taranty1"><p>TOTAL DE REJEITADOS  </p><a></a></div>
                            <div class="box Hov Cl Taranty2"><p>TOTAL DE COMISSÃO    </p><a></a><button>Sacar Agora!</button></div>
                        </div>

                        <div class="task-list box w80"><p>Lista de Tarefas</p>
                            <div id="tarefas"></div>
                        </div>

                        <div class="st-mais w100 Ct gap none">
                            <div class="box Hov"><p>Total de Clientes </p><a>${'45'}</a></div>
                            <div class="box Hov"><p>Status Pendente   </p><a>${'155'}</a></div>
                            <div class="box Hov"><p>Outra coisa       </p><a>${'4545'}</a></div>
                        </div>

                        <div class="box w80 none">
                        <p>Meus Rascunhos</p>
                        <table class="TBLAA w100">
                            <thead><tr><th>Altura</th><th>Largura</th><th>Quantidade</th></tr></thead>
                            <tbody>${rascunhos.map(r=>`<tr><td>${r.Alt}</td><td>${r.Lag}</td><td>${r.Qnt}</td></tr>`).join('')}</tbody>
                        </table>
                        </div>
                    `
                }

                function RfreshPerfil(User){
                    let Partic = 0
                    let Comiss = 0
                    $('#tarefas').innerHTML = J['SERV'].map(e=>{
                                                if(e.Dsng == User){Partic+=1 ; Comiss+=e.CArt}
                                                if(e.Cbmt == User){Partic+=1 ; Comiss+=e.VCbt}
                                                const DSNG = e.Dsng == User ? `<a>${JJ['CLNT'][`${e.Clnt}`]?.Clnt}</a><a>${e.Serv}</a><a>Arte:    </a><a>${e.TArt  }</a><a>${e.CArt}</a>` : ''
                                                const CBMT = e.Cbmt == User ? `<a>${JJ['CLNT'][`${e.Clnt}`]?.Clnt}</a><a>${e.Serv}</a><a>Produção:</a><a>${'o Cbmt'}</a><a>${e.VCbt}</a>` : ''
                                                return DSNG == '' && CBMT == '' ? '' : `<div class="Ct"><input type="checkbox" ${true?"checked":""}>
                                                        <div class="Ct">${DSNG}${CBMT}</div>
                                                </div>`}).join('')

                    Inn($('.Taranty1'),Partic)
                    Inn($('.Taranty2'),RS(Comiss))
                }


                function RfreshPerfil(User){
                    const rows = J['SERV'].flatMap(e => {
                        if(e.Dsng=='Euryk'){LOG(e.Dsng,User)}
                        const tipos = [
                            { cond: e.Dsng == User, label: 'Arte:', vals: [e.TArt, e.CArt] },
                            { cond: e.Cbmt == User, label: 'Produção:', vals: ['o Cbmt', e.VCbt] }
                        ].filter(t => t.cond);

                        return tipos.map(t => `<tr>
                            <td><input type="checkbox" checked></td>
                            <td>${JJ['CLNT'][`${e.Clnt}`]?.Clnt}</td>
                            <td>${e.Serv}</td>
                            <td>${t.label}</td>
                            ${t.vals.map(v => `<td>${v}</td>`).join('')}
                        </tr>`);
                    }).join('');

                    $('#tarefas').innerHTML = `
                        <table border="1" cellspacing="0" cellpadding="5">
                            <thead>
                                <tr>
                                    <th>Selecionar</th>
                                    <th>Cliente</th>
                                    <th>Serviço</th>
                                    <th>Tipo</th>
                                    <th>Valor 1</th>
                                    <th>Valor 2</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${rows}
                            </tbody>
                        </table>
                    `;
                }

                </script>
            </div>

            <div id="Pag_CONF">
                <h1>Configurações</h1>
                <div id="ConfigPag" class="Cl Rltv Rd">
                    <div class="Ct Close" onclick="SairMdal()">X</div>
                    <div><input id="DarkLite" type="checkbox" onchange="DarkLite2('body',this.checked)" onclick="SaveConfig(this)"> <label>Modo Escuro</label></div>
                    <div><input id="TamFonte" type="range"> <label>Tamanho de Fonte</label></div>
                    <button onclick="TrocaCSS('CSS1')">CSS1</button>
                    <button onclick="TrocaCSS('CSS2')">CSS2</button>
                    <button onclick="TrocaCSS('CSS3')">CSS3</button>
                </div>
                <!--Tudo aqui será dependente do Login do Usuário-->
            </div>
        </div>
    </div>

    <style> /*CSS dos Modais*/
        .Dark #FModal>div{background:#1b1b1b}
        .Lite #FModal>div{background:#ffffff}
        .Dark #FModal > #ModalNota{background:#ffffff;color:black}
              #FModal h1{font-size:25px}

        #ModalLogin{width:300px;height:400px}
        #ModalCadastro{width:70%}
        #Modal-Item .Feed{width:400px;height:400px}
        #Modal-Item .Stry{width:250px;height:440px}
        #Modal-Info1,#Modal-Info2{padding:30px}
        #InnerVazio input{position:absolute;width:200px}

        #ModalNota{color:#000000}
        #ModalNota>div{padding:5px 0px}
        #Nota-Clnt>div>div>div{margin:0px 5px}
        #ModalNota img{width:50px;height:50px}
        #ModalNota .Start2 p{margin:1px 5px}
        #LugarFotoNotta{margin-right:3px}
        #TabelaNotinha td{padding:3px ; font-size: 15px;}
        #TabelaNotinha th{padding:3px ; font-size: 13px;}
        #TabelaNotinha thead tr{background:#5F009E; color:#ffffff}
        #TabelaNotinha tbody td:nth-child(3){text-align:start}
        #TabelaNotinha tbody td:nth-child(4){text-align:end}
        #TabelaNotinha tbody td:nth-child(5){color:#4f4f4f}
        #TabelaNotinha tbody td:nth-child(6){margin-right: 6px ; text-align: start;}
        #TabelaNotinha tbody td:nth-child(7){color:#00000093 ; font-size: 13px;}
        #TabelaNotinha tbody td:nth-child(8){font-weight: bold ; color:var(--Laranja);}
    </style>

    <div id="FModal" class="Ct">
        <script>function SairMdal(){None('#FModal')} </script>

        <div id="Mdal-Area">
            <textarea id="Area" placeholder="Digite aqui..." oninput="ResizeArea(this)" onkeydown="KeyEntr(()=>Read_Obj_Area('#Area'))"></textarea>
        </div>

        <div id="ModalLogin" class="Ct Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div class="Bt Loginn">Login</div>
              <div class="Ct Start">
                <label for="Senha">Senha</label>
                <input id="I_Pass" class="Inputss" type="password" onkeydown="KeyEntr(()=>TestSenha('Modal',this))">
              </div>
              <span id="errPass" class="erro"></span>
              <div class="Bt">
                <button class="Ct w40" onclick="TestSenha('Modal',$('#I_Pass'))">Logar</button>
                <button class="Ct w40" onclick="TestSenha('Dslog')">Sair</button>
              </div>
        </div>

        <div id="FormIMG" class="Ct Rltv Rd"></div>

        <div id="Mdal-Prod">fotrinhas</div>
    
        <div id="ModalNota" class="Cl Rltv Rd media30">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div id="Titulo-Nota" class="w100 Bt Hr"></div>
            <div id="Nota-Empresa" class="Ct Row Hr Bt w100">
                <div class="Ct">
                <div id="LugarFotoNotta"><img src="Img/Logo2.png"></div>
                <div>
                    <h2>INFINITY GRAFF</h2>
                    <h2>IMPRESSÃO DIGITAL</h2>
                </div>
                </div>
        
                <div class="Start2">
                    <div class="FtBd Ct">Endereço: <p>Estrada do Tip, N° 54A</p></div>
                    <div class="FtBd Ct">Cidade: <p>SÃO LOURENÇO DA MATA</p></div>
                    <div class="FtBd Ct">Email: <p>infinitygraff@outlook.com</p></div>
                    <div class="FtBd Ct">Contato: <p class="B">(81) 98726.5401</p></div>
                </div>
            </div>
        
            <div class="Ct Cl Hr"><h2>CUPOM FISCAL</h2><div id="DataNota"></div></div>
        
            <div class="Start2 Hr">
                <div class="Ct"><p class="FtBd">ORDEM DE SERVIÇO:<p><p>${id}</p></div>
                <div class="Ct"><p class="FtBd">Data:</p><p>00/00/2023</p></div>
            </div>
        
            <div id="Nota-Clnt" class="Row w100 Ev">
                <div>
                <div class="Ct FtLt">Nome:     <div data="Clnt"></div> </div>
                <div class="Ct FtLt">Fone:     <div data="Cntt"></div> </div>
                </div>
                <div>
                <div class="Ct FtLt">Endereço: <div data="Local"></div></div>
                <div class="Ct FtLt">Cidade:   <div data="City"></div> </div>
                </div>
                <div>
                <div class="Ct FtLt">CPF/CNPJ: <div data="CNPJ"></div> </div>
                </div>
            </div>
        
            <div id="ConteudoNota" class="w100"></div>
        
            <div class="w100 Ct">
                <button id="trocatroca" class="BTNota Ct RD magem" onclick="troctroc()">Troca-Troca</button>
                <button class="BTNota Ct RD magem" onclick="SairMdal()">Cancelar</button>
                <button class="BTNota Ct RD magem" onclick="NewPDF()">Imprimir<div id="imgnotta" class="Ct"></div></button>
            </div>
        </div>

        <div id="PagSUPORTE" class="Cl Rltv Rd">
            <div class="Close Ct" onclick="SairMdal()">X</div>
            <div>informações de Suporte</div>
            <div>dicas de como usar o APP, principalmente pra mim</div>
            <button onclick="CopyGRAFF('Pix',this)">Copiar Pix</button>
        </div>
    </div>

    <style>
        #ALERT{right:0px;bottom:0px;margin:10px;padding:10px;background:#696969; display: none;opacity: 0;transform: translateY(20px);transition: opacity 0.4s ease, transform 0.4s ease}
        #ALERT.show {display: flex;opacity: 1;transform: translateY(0)}
    </style>

    <div id="ALERT" class="Fixed rd none">
        <div class="Ct"><img draggable="false" src="./SVG/Plan.png" height="30px"><p style="margin-left:5px">Salvo com Sucesso</p></div>
        <span class="w100 Ct" style="height: 30px"></span>
    </div>
</body>

<script> //CRUD das Tabelas com SupaBase ⭐⭐⭐_ _ ⚠️ajeitar o DarJJ() nas Outras
    // MiniLib pra ser usada principalmente por essas Func de manipulações
        const LocLinId=(Typ,ID)=>J[Typ].find(e=>e.Id==ID)
        const orArr   =(e,fallback=[])=>Array.isArray(e) ? e : fallback
        const ClrObj  =obj=>Object.fromEntries(ObjKey(obj).map(k=>[k,'']))
        const NewID   =arr=>Math.max(...arr.map(o=>Num(o.Id)))+1

        function EditCell(e,vall=null,Auto,SB){      // ⭐⭐⭐⭐⭐✔️ (Muito Boa!) 🔝 Fundir com RmvROW()
            const tR     = _tr(Pai(_tr(e)))                // esse é o Tr do Typ Pai
            const R      = D_R(_td(e))                     // R é o atual Editado
            const isScnd = Secund[R.Typ]!==undefined       // Conferir se é uma Typ Secundária
            const d_p    = isScnd ? {Typ:Secund[R.Typ],Col:Aa(R.Typ),Row:R.Row.split('_')[0]} : {}
            const IsBdj  = isBdj(e)                        // se 'p' existir então tem Bandeija ⚠️   (isso vai ser true quando for Secundario)
            const P      = IsBdj && R.Typ!='PDDS' ? D_P(_td(e)) : isScnd ? d_p : null   // Extrair RPai se Estiver na Bndj ou da Tabela Secund
            const Nval   = vall==""?"":vall||VAL(e)
            if(Nval==Nm(e)   ){return} // quando não foi Aterado
            if(Nm(e)=='False'){return} // quando é uma imagem
            let Find     = []

            /*Lv1*/if(P==null || R.Typ == 'CLNT'){
                /*Obj*/ DarJJ('Edt',R.Typ,R.Row,R.Col,Nval)
                /*Sub*/ if(SB==null){Sb_EDIT(R.Typ,R.Col,R.Row,Nval)}else{LOG('sem SB')}
            /*Lv2*/}else{
                /*Obj*/ DarJJ('Edt',R.Typ,R.Row,R.Col,Nval,{pT:P.Typ,pR:P.Row,pC:P.Col}) // aqui como a função não precisa retornar nada, seria bom ela retornar esse X, pra eu usar logo abaixo no SupaBase
                /*Lv1*/ const X  = J[P.Typ].find(e=>e.Id==P.Row) ; Find = X[P.Col] // adquie o valor Alterado
                /*Sub*/ if(SB==null){Sb_EDIT(P.Typ,P.Col,P.Row,X[P.Col])}else{LOG('sem SB')}
            }
            /*DOM*/ $$(Rx2([`${R.Typ}-${R.Row}-${R.Col}`])).forEach(td=>{
                LOG(`${R.Typ}-${R.Row}-${R.Col}`,td)
                if(R.Col=='Clnt' && R.Typ=='PDDS' && isBdj(td)){return} // Condição especídica só pra escapar um erro q acontece ao trocar cliente
                if(Nm($('.P-P',td))!==Nval){ // Editar todas as Cópias
                    if(Auto=='Auto'){DarVAL_Tm(td,Nval)}else{DarVAL(td,Nval)}
                    if(IsBdj && _td(Pai(td)) !== null){ // pra entrar tem que ser Bndj e .T-T tem que Existir ⚠️ (esse primeiro IsBdj vai ser true masm quando for tabela Secund, ai vai da errado então a pesquisa correta é 'isBdj(e)' essa!)
                        const T_T  = $('.T-T',_td(Pai(td))) ; Nm(T_T,FazerTitle(P.Col,Find)) ; Inn(T_T,FazerTitle(P.Col,Find))
                        RFresh(P.Typ,tR,Auto,e)
                    }else{// Edita quando é fora da Bandeija
                        RFresh(R.Typ,_tr(td),Auto,e)
                    }
                }})
                // Melhorar ela pra o caso de eu precisar fazer um TM, e não um DarVal, no DOM por exeplo
        }
        
        function RmvROW(Eu,SB){                 // ⭐⭐⭐⭐⭐✔️ (Muito Boa!) 🔝
            // se vier do supabase então não tem acesso a 'eu' então deve procurar ele antes de começar com tudo!
            const Lxr = false
            const tR     = _tr(Pai(_tr(Eu)))                 // esse é o Tr do Typ Pai
            const R      = D_R(_td(Eu))                      // R é o atual Editado
            const P      = isBdj(Eu) ? D_P(_td(Eu)) : null   // Extrair RPai se Estiver na Bndj
            const IsBdj  = P!==null                          // se 'p' existir então tem Bandeija
            const Nval   = true
            let Find     = []
            const RmvById =(arr,rowId)=>(arr.splice(arr.findIndex(e=>e.Id==rowId),1),arr)
            /*Lv1*/if(!IsBdj){
                    /*Obj*/ DarJJ('Del',R.Typ,R.Row)
                    /*Sub*/ if(Lxr){if(!SB){Sb_EDIT(R.Typ,R.Col,R.Row,Nval)}}else{if(!SB){Sb_DELETE(R.Typ,R.Row)}}
            /*Lv2*/}else{ // para os da Bandeija estou com Preguiça de Mover pra Lixeira, ai por enquanto vou usar só Deletando na Tora
                /*Lv1*/ const X = J[P.Typ].find(e=>e.Id==P.Row)
                /*Lv2*/ const x = X[P.Col].find(e=>e.Id==R.Row)
                if(Lxr){/*Obj*/ x[R.Col] = Nval ; Find = X[P.Col]
                }else{  /*Obj*/ RmvById(X[P.Col],R.Row) ; Find = X[P.Col]}
                        /*Sub*/ if(!SB){Sb_EDIT(P.Typ,P.Col,P.Row,X[P.Col])}
            }
            
            /*DOM*/ $$(Rx2([`${R.Typ}-${R.Row}-${R.Col}`])).forEach(td=>{  // Editar todas as Cópias
                if(IsBdj){
                    Add_N(_tr(td)) // não consigo Remover dentro de Bandeija pois removendo ela oculta a bandeija
                /*Edit Title*/ const T_T  = $('.T-T',_td(Pai(td))) ; Nm(T_T,FazerTitle(P.Col,Find)) ; Inn(T_T,FazerTitle(P.Col,Find))
                    RFresh(P.Typ,tR)
                }else{_tr(td).remove()}
                /*Alerta    */ if(SB){LOG('Deletado pelo SupaBase')}
            })
        }
 
        function AddRowBdj(Eu){                 // ⭐⭐⭐⭐_ (Ta bem BOA!) // Evitar Reescrever o DOM quando tiver VAZIO, isso evita ocultar bandeija quando clicar
            const R = D_R(_td(Eu)) ; const col = AA(R.Col)
            if(ObjKey(Secund).includes(col)){            // só pra col q tem bndj
                const row = LocLinId(R.Typ,R.Row) // Localizar Linha pelo 'Id'
                const arr = orArr(row[R.Col])     // se n for um array, return []
                const lngh= l0(arr)               // conferir se é a Primeira vez!
                const Def = ClrObj(BS[col])     // Cria um Default Baseado na bndj
                const get = getClssIN(_td(Eu),'Rastr-')
                const NewID = lngh ? 1 : Math.max(...arr.map(o=>+o.Id.split('_')[1]))+1
                if(['Serv','Pgmt']){
                    Def.Id   = `${row.Id}_${NewID}`// Novo Id
                    if(R.Col=='Serv'){Def.Data = row.Data} // Clona Data só pra Serv
                    Def.Clnt = row.Clnt            // Clona Cliente
                }
                /*Obj*/ arr.push(Def) // Não Existe JJ['SERV'] então deixa pra lá n precisa botar nada
                /*DOM*/ lngh ? Inn(_td(Eu),Tm_Bndj(R.Typ,R.Col,arr,get)) : Befor($('table tbody',_td(Eu)),Tm_Table(col,[Def],get.replace('Rastr','Rpai')))
                /*Sub*/ Sb_EDIT(R.Typ,R.Col,R.Row,arr) // da um jeito de informar o Alert q é NewLin
                Rmv_N($('.BNdj',$(Rx2(['PDDS',row.Id,R.Col])))) /*Exibir bandeija denovo*/
                
            }
        }

        function AddROW(Typ,Ps,obj={},inpt,SB){ // ⭐⭐⭐⭐_ (Adicionar um OBJ se tiver!)
            const Def   = ClrObj(BS[Typ])        // Cria um Default Baseado na bndj
            const Tbody = $(`#H_${Typ} > tbody`)
            Def.Id = NewID(J[Typ])                // Atribuindo Novo Id
            ObjKey(obj).forEach(k=>Def[k]=obj[k]) // Atribuindo oq vem no Objeto doa argumento!
            const Clone = Tm_Table(Typ,[Def])
            const Arry = Typ=='PDDS' ? {Id:`${Def.Id}`,Rg:`${HOJE()} ${Inn($('#LgNome'))}`} :
                         Typ=='CLNT' ? {Id:`${Def.Id}`,Clnt:`${obj.Clnt}`} : {Id:`${Def.Id}`}
            /*DOM*/ Ps == "<" ? After(Tbody,Clone) : Befor(Tbody,Clone)
            /*Obj*/ DarJJ('Add',Typ,Def.Id,null,Def)
            /*Sub*/ if(!SB){Sb_CREATE(Typ,Arry)}
            if(SB){LOG('Linha Adicionada pelo SB')}
            if(Typ=='CLNT'){LinkLink(inpt,Def.Id)} // Parece q isso serve pra levar o nome do cliente pra T-T assim q adiciona
        }

        function insertOrden(Typ,arr){          // ⭐⭐⭐_ _ (Ativar ela) (ainda não testei dentro da Bndj | bndj não tem ordem ent sempre vai ser ID) 
            const NEWtr = NewTag('tr') ; Inn(NEWtr,Tm_Table(Typ,arr))
            const tbody= $(`#H_${Typ} > tbody`)
            const trs = [...tbody.rows]
            const Ordn= AllI(_table(tbody),'Atv')                    // orden Ativa
            const asc = Ordn.length==0?true:Ordn[0].innerText == '▼' // Conferir se é Desc ou Asec
            const col = Ordn.length==0?'Id':Nm(SibQSl(Ordn[0],'p'))  // Nome da Coluna
            const colX= Colx(Typ,col)                                // index da coluna
            const vall= arr[0][col]
            const compare=(a,b)=> asc ? b.localeCompare(a)<0 : a.localeCompare(b)<0
            const Alvo= trs.find(tr=>{const a = VAL($(Rx2([Typ,col]),tr)) ; return compare(a,vall)}) //(a,b)=>b<+a, quando é Valor
            tbody.insertBefore(NEWtr,Alvo||null)
        }

        function ImgUPP(Inpt,Nome){             // ⭐⭐⭐_ _  analisando com calma
            const f = Inpt.files[0] // pega o único arquivo
            const Past = Eximg.includes(RxExt(f.name)) ? "Img/" : "Arq/"
            const Src  = URL.createObjectURL(f)
            const td   = $(Rx2([`${Nome}-Arte`]))
            ListIMG.push(Nome)
            DarVAL(td,Src)
            Sb_UPLOAD(f,`${Past}${Nome}`)
            if(RxExt(f.name)!=='svg'){CriaThumb(f,20).then(t=>{Sb_UPLOAD(t,`${'Thumb'}/${Nome}`)})} // Só chama se não for SVG
        }

        function LinkLink(Eu,val){              // ⭐⭐⭐⭐_  (Faz o Básico)
            const td = _td(Eu)
            const R  = D_R(td)
            const get = getClssIN(_td(Eu),'Rastr-')
            EditCell(Eu,val)
            if(R.Col=='Clnt'){Inn(td,Tm_Bndj(R.Typ,R.Col,`${val}`,get)) ; td.addEventListener('click', function(){ShowBndj(this)}) }
        }
         
        function MesclarContato(){           // ⭐_ _ _ _ // Não tem efeito Prático, ao fazer isso tem q atualizar a Página
            const Fim = $('#H_CLNT .LinkULT') // futuramente n precisar disso pois ele vai ser oq tiver mais pedidos atrelado
            // se for a mesma quantidade então escolhe qualquer um
            if(!Fim){LOG('Faltou o Link Final') ; return}
            // também da erro se tiver mais de uma Selecioanda
            $$('#H_CLNT .LinkAtv').forEach(td=>{
                const [dR,dRf] = [D_Rastr(td),D_Rastr(Fim)]
                const Ids_PDDS = td.innerText.split(',')
                Ids_PDDS.forEach(ID=>{Sb_EDIT('PDDS','Clnt',ID,dRf[1])}) // Editar PDDS
                RmvROW(td) // remove a Linha
                
                // Editar Pedidos Prático e Const
                //const Obj_PDDS   = J['PDDS'].filter(e=>e.Clnt==dR[1])
                //Obj_PDDS['Clnt'] = linkFinal
            })
            // quando terminar Limpa o Filtro
        }

        function TestRow(inpt,col){            // isso é pra Saber se o Cliente existe na Tabela de Extra
            if(confirm(`Tem Certeza que quer salvar: ${inpt.value} em ${col}?`)){
                if(Nm(inpt)){return Nm(inpt)}else{AddROW(AA(col),'<',{[col]:inpt.value},inpt)}
            }
        }

        function SaveConfig(e){LOG('Salva Config no SB')}
        // Adicionar e trocar Cliente
</script>

<script> // SupaBASE ⭐⭐⭐⭐_
    async function getSB(){
        const INNN = performance.now()
        async function getIMG(){
            const {data,error} = await supabase.storage.from("uploads").list("Img",{limit:1000})
            if (error) {ERR("Erro ao listar:", error.message);return []}
            ListIMG = data.map(e=>e.name) ; LOG(`🖼️ IMGS`)
        }
        async function gett(Typ){ // isso apenas traz os dados e Joga na Const!
            let todas = [], lim = 1000, ofs = 0, data
            do{({data}=await supabase.from(Typ).select('*').order('Id',{ascending:true}).range(ofs,ofs+lim-1))
                if (!data) return ERR('Erro ao carregar dados')
                todas.push(...data) ; ofs+=lim
            }while(data.length===lim)
            
            if(Typ=='PDDS'){
                J['PDDS']=NULL__(todas.map(e=>PDDSconverterJSON(e)))
                J['PDDS'].forEach(TR=>TR.Serv = Array.isArray(TR.Serv) ? TR.Serv : [])
                criaCol_Col('Surg','PDDS','Serv')
                J['SERV']=J['PDDS'].flatMap(e=>e.Serv) ; JJ['SERV'] = ArrtoOBJ(J['SERV'],Primary['SERV']) // Cria a Segunda Const
                J['PGMT']=J['PDDS'].flatMap(e=>e.Pgmt) ; JJ['PGMT'] = ArrtoOBJ(J['PGMT'],Primary['PGMT']) // Cria a Segunda Const
            }else{J[Typ] = NULL__(todas.map(e=>PDDSconverterJSON(e)))
                if(Typ=='CLNT'){Listagem('CLNT','Clnt')}
            }
            JJ[Typ] = ArrtoOBJ(J[Typ],Primary[Typ]) // Cria a Segunda Const
            LOG(`✔️ ${Typ}`)
            
        }
        await Promise.all(['PDDS','CLNT','MPAG','GRAD','UBER','OOSS','IMGS'].map(Typ=>Typ=='IMGS'?getIMG():gett(Typ))) // Tabelas Disponíveis no SB! (Promisse espera terminar pra poder dar o Log)
          LOG(`✅ SB Carregado: ${MS(INNN)}`)
        ALERT(`✅ SB Carregado: ${MS(INNN)}`)
        //Liberar uma coisa Nova
        const INNNN = performance.now()
        Tratamento()
        LOG(`✅ Pre-Trat OK: ${MS(INNNN)}`)
    };const getSBPromise = getSB()

    async function Sb_DELETE(Typ,id){
        const {error} = await supabase.from(Typ).delete().eq("Id",id)
        if(error){ERR("Erro ao excluir:",error)}else{LOG(`SB_DELETE(${Typ},${id})`) ; ALERT(`SB_DELETE(${Typ},${id})`)}
    }
    
    async function Sb_CREATE(Typ,row){ // ⭐⭐⭐_ _ (Aparentemente ta boa)
        let baseId = Number(row.Id) || 0
        let tentativas = 0
        while (true) {
            const Id = baseId + tentativas
            const { error } = await supabase.from(Typ).insert([{ ...row, Id }])
            if (!error) {LOG("Linha criada:", Id) ; return Id }
            if (error.code !== "23505") {ERR("Erro:", error) ; return null }
            tentativas++ }
    }

    async function Sb_EDIT(Typ,col,id,Val){
        try {const {error} = await supabase.from(Typ).update({[col]:Val}).eq('Id',id)
            if (error){ERR('Erro ao atualizar:',error)}
            else  {    LOG(`💾✏️ SB_EDIT(${id},${Val})`) ; ALERT(`"${Val}" Editado no SB! (${Typ},${id},${col})`)}
        } catch (err){ ERR('Erro:',err)  ; ALERT('Erro ao atualizar serviço')}
    }

    async function Sb_UPLOAD(file,nome){ // Envia arquivo para Supabase Storage
      let {error} = await supabase.storage.from('uploads').upload(nome,file,{upsert:false})
      if  (error) {ERR("Erro no upload:", error.message) ; alert("Erro ao enviar: "+error.message)}
      else{LOG('✔️ Arquivo enviado!',nome)}
    }

    function Supa_RealTime(crud,nEw,Typ,old){ // ⭐⭐⭐_ _ (Adicionar e Remover Linha da Bandeija)
        if(crud==='UPDATE'){
            const NOVOO = NULL__([nEw])[0]
            const atual = J[Typ].find(e=>e.Id==nEw.Id)
            const Limparr = j => j ? Object.keys(j).length ? Object.fromEntries(Object.entries(j).filter(([k,v])=>BS[Typ][k]?.[1]!=='A')) : null : null
            const DiF = Limparr(Diferentes(NOVOO,atual,Typ))
            if(!DiF || (Object.keys(DiF).length === 1 && 'Id' in DiF)){LOG(`🌐 EDIT RealTime(${Typ},${nEw.Id}) OK👍`) ; return}

            /*Obj*/ ObjEtr(DiF).forEach(([col,Vlr])=>{if(col!=='Id'){atual[col]=NOVOO[col]}})// Atualiza a Const primeiro
            /*Obj*/ // falta atualziar o JJ[Typ]
            /*DOM*/ flatenObject(DiF,Typ).forEach(([TYP,ID,col,Vlr])=>{
                $$(Rx2([`${AA(TYP)}-${ID}-${col}`])).forEach(td=>{
                    // Add ou Rmv Linha da Bndj AddRowBdj(com obj)
                    if(col=='Clnt'){return}
                    if(col=='Lixo'){if(Vlr){_tr(td).remove() ; return}else{return}}
                    
                    if(td){if(VAL(td)!==Vlr){
                        if(D_R(td).Tm=='Auto'){return}  // a idéia é n precisar disso aqui pois isso só ta afetando a tabela de GRAD
                        if(D_R(td).Tm=='Sync'){return}
                        DarVAL(td,Vlr) // Editou valor
                         LOG(`✏️ RealTime() "${TYP}-${ID}-${col}" >> ${Vlr}`)} // chamar R_Color()
                    else{LOG('⚠️ RealTime() P-P ja Tava Igual')}}
                    else{LOG('⚠️ RealTime() P-P não Existe')}
                })
            })
        }
        else if(crud==='DELETE'){
            if(!J[Typ].some(e=>e.Id==old.Id)){LOG(`🌐 DELETE RealTime(${Typ},${old.Id}) OK👍`) ; return}
            /*Obj*/ // RmvLinByID(J[Typ],old.Id)
            RmvROW($(`${Rx2([Typ,old.Id,'Lixo'])} a`),true) //Simular o Click, true veio do SB 🌐
        }
        else if(crud==='INSERT'){
            if(J[Typ].some(e=>e.Id==nEw.Id)){LOG(`🌐 INSERT RealTime(${Typ },${nEw.Id}) OK👍`) ; return}
            AddROW(Typ,'<',NULL__([nEw]),'',true) // esse vazio é um input q fica em outra coisa relacionada a cliente, true veio do SB 🌐
        }
    }LOG('Movedissa')
    
    function PlayRealTime(){
        return supabase.channel('SuBs-CLNT').on('postgres_changes',{event:'*',schema:'public',table:'*'},e=>{
            const [crud,nEw,old,Typ] = [e.eventType,e.new,e.old,e.table] ; Supa_RealTime(crud,nEw,Typ,old)}).subscribe()
    };PlayRealTime()

</script>

<script>// Iniciação
    TestSenha('Storg',StogeGet('SenhaCryp'))
    function PosGet(){Onloads('body');Check_W_Pag();LOG('✅ Página Carregada!')}  ;PosGet()

    async function LOOP(){
        const cells = $$(Rx2(['PDDS','Cmnt']))
        for (const td of cells){await EditCell(td) ; await new Promise(res => setTimeout(res, 200))}
    }

    document.addEventListener('click',e=>{const targ = e.target
        Rmv($$('#ORC tr.Atv'),'Atv') // Remover todos Ativos
        if($('#ORC').contains(targ)){ATV(_tr(targ));ReloadDetalhes()}
        if(targ.closest('.Sugg')){return}{None($$('#ORC tr:not(.Atv) .Sugg'))} // LINDO TREXO é uma Gambiarra mais ta BOM (Fazer a Cascata igual Bureal Usando este metodo aqui!)
        // isso Deve virar Padão tipo algo genético, pra usar em varios
        // esta serve só pra ativar u desativar tr q estão dentro da tabela de ORC
    })
    document.addEventListener('click',e=>{const targ = e.target // isso Deve virar Padão tipo algo genético, pra usar em varios
        Rmv('.Moldura','Atv')
        if(Coten(targ,'ClickCanv')||targ.closest('.ClickCanv')){ATV('.Moldura.ClickCanv')}
        else{DTV('.Moldura.ClickCanv')}
    })
    // Atalhos C e E
    document.addEventListener('keydown',e=>{if($('.Moldura.ClickCanv.Atv')){if(e.key==='c'){$('#alignX').click()};if(e.key==='e'){$('#alignY').click()}}})
</script>

<script> // comentários ⏳ ❌ ✔️ ⚠️ 🔝 ⚡ 💡
    // ERROS pra corrigir
    // Pesquisa em tabela de GRAD, da erro em VAL(...).trim is not a function
    // ver se consigo a Possibilidade de botar mais de um Uber!
    // Todas Tabelas pode ter Modo Card, então o Botão Card ele fica sempre no msm Lugarzinho
    // na Soma lá em baixo dar o . quando passar de mil
    // 💡 Pesquisar dentro da bandeija de Serv, pra Localizar o Pedido


    // Adicionar o DROP, e no Drop CnltrV de imagem,
    // adicionar o novo ALERT

    

</script>
</html>
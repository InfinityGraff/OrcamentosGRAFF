<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Visualizador</title>

  <!--<link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/fontes.css"        rel="stylesheet">
      <link  href="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/CSSBiblioteca.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/gh/InfinityGraff/MyBiblioteca@main/PreScript.js"      ></script> -->

  <link  href="../MyBiblioteca/fontes.css"        rel="stylesheet">
  <link  href="../MyBiblioteca/CSSBiblioteca.css" rel="stylesheet">
  <script src="../MyBiblioteca/PreScript.js"      ></script>
  <link  href="./CssGRAFF.css" rel="stylesheet">
  <script src="./BaseIMG.js"      ></script>
</head>

<style>
    :root  {--g:12px;--w:220px;--bg:#f6f7fb;--cb:#fff}
    .Tudoo {width: 100vw;height: 100vh;padding:18px}
    .Config{gap:12px;margin-bottom:14px}
    #PesqImgs p {font-size:13px;color:#ffffff;margin-left: 10px;}
    .Bloco {display:grid ;gap:12px;grid-template-columns:repeat(auto-fill,minmax(var(--w),1fr))}
    .Alven {display:block;column-width:var(--w)}
    .Boxyy {display:inline-block;width:100%;overflow:hidden ; border-radius:10px}
    .Alven .Boxyy{margin:0 0 var(--g) 0}
    .Pasta .Boxyy{display:block}
    :is(#Galery,#Pastas).Crop .Boxyy img{object-fit:cover;width:100%;height:200px}
    #Galery[name="Pasta"].Bloco{display:block}
    #Galery[name="Pasta"].Alven{display:grid ;gap:12px;grid-template-columns:repeat(auto-fill,minmax(var(--w),1fr))} /*Depois ver se eu quero msm isso*/

    .Boxyy .iw    {padding:8px}
    .Boxyy .iw a  {top:15px;left:15px;background:#00000073;color:#ffffff;font-size:11px;padding:4px;pointer-events:none ; border-radius:5px}
    .Boxyy .iw img{width:100%;height:auto;max-width:100%;transition:object-fit .3s ease ; border-radius:6px}
    .Boxyy .mt    {padding:12px} .mt p{font-size:14px;font-weight:bold} .mt a{font-size:13px;color:#666}

    .Pasta {margin-bottom:20px;border-radius:10px;overflow:hidden}
    .Pasta     > a      {gap:8px;padding:10px 14px;cursor:pointer;background:#e9e9ef57;font-weight:bold}
    .Pasta     > a:hover{background:#e9e9ef7a}
    .Pasta     > a svg  {width:20px;height:20px;transition:transform .3s ease}
    .Pasta.Atv > a svg  {transform:rotate(-90deg)}
    .Pasta     > div{padding:12px} /*Fazer isso acontecer com uma animação*/
    .Pasta.Atv > div{display: none}
    @media(max-width:600px){:root{--w:140px}}
</style>

<body class="CSS3 Lite">
  <div id="saida"></div>
  <div class="Tudoo">
    <div class="Config Ct">
      <div onclick="TrcTog($('#Galery'),'Bloco','Alven')"              onload="Tm_Interup(this,SVG.Alvn,SVG.Blok)"></div>
      <div onclick="Tog($('#Galery'),'Crop');Tog($('#Pastas'),'Crop')" onload="  Tm_Check(this,SVG.Crop('',''))  "></div>
      <div><select onchange="Nm($('#Galery'),this.value);ren(BaseIMG,this.value)"><option value="Nome">Por Nome</option><option value="Pasta">Por Tipo</option></select></div>
      <div id="PesqImgs" class="Ct"><input placeholder="Buscar..." oninput="Pesq(this,event)"><p>0 imgs</p></div>
    </div>
    <div id="Galery" class="Alven"></div> <!--Começa como Alvenaria-->
  </div>
</body>

<script>
  const Tm_Boxyy=arr=>arr.map(i=>`<div class="Boxyy Boxy">
      <div class="iw Rltv"><a class="Abslt none">${i.src}</a><img src="./Kits/${i.src}" loading="lazy"></div>
      <div class="mt"><p>${i.src}</p><a>${i.Cat}</a><a>${i.id}</a></div>
  </div>`).join('')

  function ren(Find,Modo){
    const Grup = 'Cat'
    const Tm_Past = ObjEtr(Find.reduce((acc,i)=>{(acc[i[Grup]]??=[]).push(i);return acc},{})).map(([k,v])=>
      `<div class="Pasta Boxy"><a class="Start" onclick="TOV(Pai(this))">${SVG.Past}${k}</a><div class="Alven">${Tm_Boxyy(v)}</div></div>`
    ).join('')
    Inn($('#Galery'),Modo=='Nome'?Tm_Boxyy(Find):Tm_Past)
  }

  function Pesq(Eu,Ev){
    let Cont = 0
    const qq = aa(Vll(Eu).trim())
    $$('.Boxyy').forEach(e=>{Rmv_N(e);if(aa(Inn($('.mt',e))).includes(qq)){Rmv_N(e);Cont+=1}else{Add_N(e)}})
    $$('.Pasta').forEach(e=>$$('.Boxyy',e).every(b=>Coten(b,'none')) ? Add_N(e) : Rmv_N(e))
    Inn('#PesqImgs p',`${Cont} img${Cont>1?'s':''}`)
  }
  
  Onloads('body')
  ren(BaseIMG,'Nome')

  function exibirObjeto() {
    function adicionaID(arr) {
      return arr.map((obj, i) => ({ id: i, ...obj }));
  }
  const saida = document.getElementById("saida");
  saida.innerHTML = `<pre>${JSON.stringify(adicionaID(BaseIMG), null, 2)}</pre>`;
}


  // Adicionar os Scroll se eu quiser! pra rolar para os lados igual efeito q eu tinha antes nas tampa do Tanque Horizontal e Vertical
  // Alterar a LarguraMaxima das imagens, um Slide com Stop="5"
  // Mudar o CSS se precisar pra remover Border e gap se eu quser!
  // Opção de Modo Crop se, o "object-fit:cover" (posso usar um Swith de 3 Radios)
  // Botão de Renderização Mini (pra melhorar a Peformance)
  // a Lista com as informações fica no Supabase e são atualziadas em tempo Real, mas as imagens são sempre as Mesmas
  // Opção de Poder Editar Nome e todos os MetaDados de cada imagem, e atualizar diretamente no SupaBase!
  // Agora criar o Organizador de Pastas
    // lá em Cima eu escolho uma Categoria, ou até uma Chave nova se eu quiser!
    // e abaixo eu seleciono as imagens que estarão dentro dela
  
</script>
</html>